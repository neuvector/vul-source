Candidate: CVE-2021-28687
PublicDate: 2021-06-11 15:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28687
 https://xenbits.xen.org/xsa/advisory-368.html
Description:
 HVM soft-reset crashes toolstack libxl requires all data structures passed
 across its public interface to be initialized before use and disposed of
 afterwards by calling a specific set of functions. Many internal data
 structures also require this initialize / dispose discipline, but not all
 of them. When the "soft reset" feature was implemented, the
 libxl__domain_suspend_state structure didn't require any initialization or
 disposal. At some point later, an initialization function was introduced
 for the structure; but the "soft reset" path wasn't refactored to call the
 initialization function. When a guest nwo initiates a "soft reboot",
 uninitialized data structure leads to an assert() when later code finds the
 structure in an unexpected state. The effect of this is to crash the
 process monitoring the guest. How this affects the system depends on the
 structure of the toolstack. For xl, this will have no security-relevant
 effect: every VM has its own independent monitoring process, which contains
 no state. The domain in question will hang in a crashed state, but can be
 destroyed by `xl destroy` just like any other non-cooperating domain. For
 daemon-based toolstacks linked against libxl, such as libvirt, this will
 crash the toolstack, losing the state of any in-progress operations
 (localized DoS), and preventing further administrator operations unless the
 daemon is configured to restart automatically (system-wide DoS). If crashes
 "leak" resources, then repeated crashes could use up resources, also
 causing a system-wide DoS.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
 avital> introduced in 4.12
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H [5.5 MEDIUM]

Patches_xen:
-- Tags_xen: universe-binary
upstream_xen: needs-triage
precise/esm_xen: DNE
trusty_xen: ignored (end of standard support)
trusty/esm_xen: DNE
xenial_xen: not-affected (code not present)
esm-infra/xenial_xen: not-affected (code not present)
bionic_xen: not-affected (code not present)
esm-infra/bionic_xen: not-affected (code not present)
focal_xen: not-affected (code not present)
esm-apps/focal_xen: not-affected (code not present)
groovy_xen: not-affected (code not present)
devel_xen: not-affected (code not present)

