PublicDateAtUSN: 2023-04-14 01:15:00 UTC
Candidate: CVE-2023-29491
PublicDate: 2023-04-14 01:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-29491
 https://invisible-island.net/ncurses/NEWS.html#index-t20230408
 https://www.openwall.com/lists/oss-security/2023/04/13/4
 https://www.openwall.com/lists/oss-security/2023/04/12/5
 https://ubuntu.com/security/notices/USN-6099-1
Description:
 ncurses before 6.4 20230408, when used by a setuid application, allows
 local users to trigger security-relevant memory corruption via malformed
 data in a terminfo database file that is found in $HOME/.terminfo or
 reached via the TERMINFO or TERM environment variable.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> upstream commit has miscellaneous changes besides the
   security fix.
 mdeslaur> TODO: investigate why ncurses is built without
 mdeslaur> "with_root_environ=no" build option, that should be the default
 mdeslaur> going forward to prevent these types of issues.
 ccdm94> applying the upstream patch of ncurses that fixes this issue to
 ccdm94> focal and earlier would have been too intrusive, since changes
 ccdm94> such as the various made by commit 790a85db were not present in
 ccdm94> their versions of this package. Setting the
 ccdm94> --disable-root-environ option with a few additional changes to
 ccdm94> the code (as done by Debian in version 6.4-3 of the package)
 ccdm94> allows us to mitigate this issue and avoid other issues that
 ccdm94> involve the possibility of malicious use of environment
 ccdm94> variables through setuid applications, and, therefore, it was
 ccdm94> the fix chosen in order to resolve this vulnerability. 
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1034372
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]

Patches_ncurses:
 upstream: http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56
upstream_ncurses: released (6.4-3, 6.4+20230408)
trusty_ncurses: ignored (end of standard support)
trusty/esm_ncurses: released (5.9+20140118-1ubuntu1+esm3)
xenial_ncurses: ignored (end of standard support)
esm-infra/xenial_ncurses: released (6.0+20160213-1ubuntu1+esm3)
bionic_ncurses: released (6.1-1ubuntu1.18.04.1)
esm-infra/bionic_ncurses: released (6.1-1ubuntu1.18.04.1)
focal_ncurses: released (6.2-0ubuntu2.1)
jammy_ncurses: released (6.3-2ubuntu0.1)
kinetic_ncurses: released (6.3+20220423-2ubuntu0.1)
lunar_ncurses: released (6.4-2ubuntu0.1)
devel_ncurses: not-affected (6.4-4)
