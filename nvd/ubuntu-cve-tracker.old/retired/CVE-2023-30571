Candidate: CVE-2023-30571
PublicDate: 2023-05-29 20:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30571
Description:
 Libarchive through 3.6.2 can cause directories to have world-writable
 permissions. The umask() call inside archive_write_disk_posix.c changes the
 umask of the whole process for a very short period of time; a race
 condition with another thread can lead to a permanent umask 0 setting. Such
 a race condition could lead to implicit directory creation with permissions
 0777 (without the sticky bit), which means that any low-privileged local
 user can delete and rename files inside those directories.
Ubuntu-Description:
Notes:
 mdeslaur> Upstream fix is just a documentation change to specify that
 mdeslaur> users of libarchive need to use a mutex. We will not be
 mdeslaur> releasing a security update to change the documentation. Marking
 mdeslaur> this CVE as ignored for all releases.
Mitigation:
Bugs:
 https://github.com/libarchive/libarchive/issues/1876
Priority: negligible
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H [5.3 MEDIUM]

Patches_libarchive:
 upstream: https://github.com/libarchive/libarchive/pull/1875
 upstream: https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac
upstream_libarchive: needs-triage
trusty_libarchive: ignored (end of standard support)
trusty/esm_libarchive: ignored
xenial_libarchive: ignored (end of standard support)
esm-infra/xenial_libarchive: ignored
bionic_libarchive: ignored (end of standard support, was needs-triage)
esm-infra/bionic_libarchive: ignored
focal_libarchive: ignored
jammy_libarchive: ignored
kinetic_libarchive: ignored (end of life, was deferred [2023-07-10])
lunar_libarchive: ignored
devel_libarchive: ignored
