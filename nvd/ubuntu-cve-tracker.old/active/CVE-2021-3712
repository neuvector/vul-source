PublicDateAtUSN: 2021-08-24
Candidate: CVE-2021-3712
CRD: 2021-08-24
PublicDate: 2021-08-24 15:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3712
 https://www.openssl.org/news/secadv/20210824.txt
 https://ubuntu.com/security/notices/USN-5051-1
 https://ubuntu.com/security/notices/USN-5051-2
 https://ubuntu.com/security/notices/USN-5051-3
 https://ubuntu.com/security/notices/USN-5051-4 (regression only in trusty/esm)
 https://ubuntu.com/security/notices/USN-5088-1
Description:
 ASN.1 strings are represented internally within OpenSSL as an ASN1_STRING
 structure which contains a buffer holding the string data and a field
 holding the buffer length. This contrasts with normal C strings which are
 repesented as a buffer for the string data which is terminated with a NUL
 (0) byte. Although not a strict requirement, ASN.1 strings that are parsed
 using OpenSSL's own "d2i" functions (and other similar parsing functions)
 as well as any string whose value has been set with the ASN1_STRING_set()
 function will additionally NUL terminate the byte array in the ASN1_STRING
 structure. However, it is possible for applications to directly construct
 valid ASN1_STRING structures which do not NUL terminate the byte array by
 directly setting the "data" and "length" fields in the ASN1_STRING array.
 This can also happen by using the ASN1_STRING_set0() function. Numerous
 OpenSSL functions that print ASN.1 data have been found to assume that the
 ASN1_STRING byte array will be NUL terminated, even though this is not
 guaranteed for strings that have been directly constructed. Where an
 application requests an ASN.1 structure to be printed, and where that ASN.1
 structure contains ASN1_STRINGs that have been directly constructed by the
 application without NUL terminating the "data" field, then a read buffer
 overrun can occur. The same thing can also occur during name constraints
 processing of certificates (for example if a certificate has been directly
 constructed by the application instead of loading it via the OpenSSL
 parsing functions, and the certificate contains non NUL terminated
 ASN1_STRING structures). It can also occur in the X509_get1_email(),
 X509_REQ_get1_email() and X509_get1_ocsp() functions. If a malicious actor
 can cause an application to directly construct an ASN1_STRING and then
 process it through one of the affected OpenSSL functions then this issue
 could be hit. This might result in a crash (causing a Denial of Service
 attack). It could also result in the disclosure of private memory contents
 (such as private keys, or sensitive plaintext). Fixed in OpenSSL 1.1.1l
 (Affected 1.1.1-1.1.1k). Fixed in OpenSSL 1.0.2za (Affected 1.0.2-1.0.2y).
Ubuntu-Description: 
Notes: 
 mdeslaur> in 1.0.2, this bug is in X509_CERT_AUX_print()
 mdeslaur> list of commits below is incomplete
Mitigation: 
Bugs: 
Priority: medium
Discovered-by: Ingo Schwarze
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:H [7.4 HIGH]

Patches_openssl:
 upstream: https://git.openssl.org/?p=openssl.git;a=commit;h=c5dc9ab965f2a69bca964c709e648158f3e4cd67
upstream_openssl: needs-triage
trusty_openssl: ignored (end of standard support)
trusty/esm_openssl: released (1.0.1f-1ubuntu2.27+esm4)
xenial_openssl: ignored (end of standard support)
esm-infra/xenial_openssl: released (1.0.2g-1ubuntu4.20+esm1)
fips/xenial_openssl: needed
fips-updates/xenial_openssl: released (1.0.2g-1ubuntu4.fips.4.20.1)
bionic_openssl: released (1.1.1-1ubuntu2.1~18.04.13)
esm-infra/bionic_openssl: released (1.1.1-1ubuntu2.1~18.04.13)
fips/bionic_openssl: needed
fips-updates/bionic_openssl: released (1.1.1-1ubuntu2.fips.2.1~18.04.13.2)
focal_openssl: released (1.1.1f-1ubuntu2.8)
fips/focal_openssl: needed
fips-updates/focal_openssl: released (1.1.1f-1ubuntu2.fips.7.2)
hirsute_openssl: released (1.1.1j-1ubuntu3.5)
impish_openssl: released (1.1.1l-1ubuntu1)
jammy_openssl: released (1.1.1l-1ubuntu1)
kinetic_openssl: released (1.1.1l-1ubuntu1)
lunar_openssl: released (1.1.1l-1ubuntu1)
mantic_openssl: released (1.1.1l-1ubuntu1)
devel_openssl: released (1.1.1l-1ubuntu1)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: released (1.0.2n-1ubuntu5.7)
esm-infra/bionic_openssl1.0: released (1.0.2n-1ubuntu5.7)
focal_openssl1.0: DNE
hirsute_openssl1.0: DNE
impish_openssl1.0: DNE
jammy_openssl1.0: DNE
kinetic_openssl1.0: DNE
lunar_openssl1.0: DNE
mantic_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
trusty_nodejs: ignored (end of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
hirsute_nodejs: not-affected (uses system openssl1.1)
impish_nodejs: not-affected (uses system openssl1.1)
jammy_nodejs: not-affected (12.22.9~dfsg-1ubuntu3)
esm-apps/jammy_nodejs: not-affected (12.22.9~dfsg-1ubuntu3)
kinetic_nodejs: not-affected (uses system openssl1.1)
lunar_nodejs: not-affected (uses system openssl1.1)
mantic_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
Priority_edk2: low
upstream_edk2: needs-triage
trusty_edk2: ignored (end of standard support)
trusty/esm_edk2: DNE
xenial_edk2: ignored (end of standard support, was needs-triage)
esm-apps/xenial_edk2: needs-triage
bionic_edk2: ignored (end of standard support, was needs-triage)
esm-apps/bionic_edk2: needs-triage
focal_edk2: released (0~20191122.bd85bf54-2ubuntu3.3)
hirsute_edk2: released (2020.11-4ubuntu0.1)
impish_edk2: ignored (end of life)
jammy_edk2: needs-triage
kinetic_edk2: not-affected (2022.05-4)
lunar_edk2: not-affected (2022.11-2)
mantic_edk2: not-affected (2022.11-2)
devel_edk2: not-affected (2022.11-2)
