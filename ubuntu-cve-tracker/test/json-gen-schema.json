{
  "$schema": "http://json-schema.org/draft/2020-12/schema#",
  "type": "object",
  "properties": {
    "format": {"type": "string"},
    "published_at": {"type": "string", "format": "date-time"},
    "release": {"type": "string"},
    "packages": {
      "type": "object",
      "additionalProperties": {"$ref": "#/$defs/package"}
    },
    "security_issues": {
      "type": "object",
      "properties": {
        "cves": {
          "type": "object",
          "additionalProperties": {"$ref": "#/$defs/cve"}
        },
        "usns": {
          "type": "object",
          "additionalProperties": {"$ref": "#/$defs/usn"}
        }
      },
      "required": ["cves", "usns"]
    }
  },
  "$defs": {
    "package": {
      "type": "object",
      "properties": {
        "source_versions": {
          "type": "object",
          "additionalProperties": {"$ref": "#/$defs/sourceVersion"}
        },
        "ubuntu_security_notices": {
          "type": "object",
          "additionalProperties": {"$ref": "#/$defs/securityNotice"}
        },
        "ubuntu_security_notices_regressions": {
          "type": "object",
          "additionalProperties": {"$ref": "#/$defs/securityNoticeRegression"}
        },
        "cves": {
          "type": "object",
          "additionalProperties": {"$ref": "#/$defs/cvePkg"}
        }
      },
      "required": ["source_versions"]
    },
    "sourceVersion": {
      "type": "object",
      "properties": {
        "binary_packages": {
          "type": "object",
          "additionalProperties": {"type": "string"}
        },
        "pocket": {"type": "string"}
      },
      "required": ["binary_packages", "pocket"]
    },
    "securityNotice": {
      "type": "object",
      "properties": {
        "source_fixed_version": {"type": ["string", "null"]}
      },
      "required": ["source_fixed_version"]
    },
    "securityNoticeRegression": {
      "type": "object",
      "properties": {
        "source_fixed_version": {"type": ["string", "null"]}
      },
      "required": ["source_fixed_version"]
    },
    "cvePkg": {
      "type": "object",
      "properties": {
        "source_fixed_version": {"type": ["string", "null"]},
        "status": {
          "type": "string",
          "enum": ["not-vulnerable", "vulnerable", "fixed"]
        }
      },
      "required": ["source_fixed_version", "status"]
    },
    "cve": {
      "type": "object",
      "properties": {
        "description": {"type": "string"},
        "published_at": {"type": "string", "format": "date-time"},
        "notes": {
          "type": "array",
          "items": {"type": "string"}
        },
        "mitigation": {"type": ["string", "null"]},
        "ubuntu_priority": {
          "type": "string",
          "enum": ["untriaged", "negligible", "low", "medium", "high", "critical"]
        },
        "cvss_severity": {"type": ["string", "null"]},
        "cvss_score": {"type": ["number", "null"]}
      },
      "required": ["description", "published_at", "ubuntu_priority", "cvss_severity", "cvss_score"]
    },
    "usn": {
      "type": "object",
      "properties": {
        "description": {"type": "string"},
        "published_at": {"type": "string", "format": "date-time"},
        "related_cves": {
          "type": "array",
          "items": {"type": "string"}
        },
        "related_bugs": {
          "type": "array",
          "items": {"type": "string"}
        }
      },
      "required": ["description", "published_at"]
    }
  },
  "required": ["format", "published_at", "release", "packages", "security_issues"]
}
