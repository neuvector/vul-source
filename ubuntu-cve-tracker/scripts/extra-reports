#!/bin/bash
#
# SPDX-License-Identifier: GPL-3.0-only 
#
# This file is part of the Ubuntu CVE Tracker (UCT) scripts, its purpose is to
# emit reports for the Cloud Archive and UC16.
#
# Author: Emily Ratliff <emily.ratliff@canonical.com>
# Copyright 2017 Canonical Ltd.
#
# This program is free software: you can redistribute it and/or modify it under
# the terms of the GNU General Public License version 3, as published by the
# Free Software Foundation.
#
# This program is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,
# SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# this program. If not, see <http://www.gnu.org/licenses/>.


CVES=~/git-pulls/cve-tracker
HEADER='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head> <title>Ubuntu CVE Tracker</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="Canonical Ltd, Kees Cook and Jamie Strandboge" />
<meta name="description" content="Ubuntu CVE Tracker" />
<meta name="copyright" content="Canonical Ltd" />
<link rel="StyleSheet" href="toplevel.css" type="text/css" />
</head> <body> <div id="container">
<h2>Ubuntu CVE Tracker</h2> <h3>Introduction</h3>
<p class="intro">Ubuntu tracks its security vulnerabilities via the <a
href="https://launchpad.net/ubuntu-cve-tracker">Ubuntu CVE Tracker</a>. 
<p><a href="priority.html">Priority Color Key</a></p>'

FOOTER='<div id="footer"> &copy; Canonical Ltd. 2007-2017</div></body></html>'
cd $CVES
echo $HEADER > $TARGET/ubuntu-core-16.html
echo $HEADER > $TARGET/cloud-archive.html
$SCRIPTS/ubuntu-table --html --only-release xenial  $(grep -v "^#" $CVES/ubuntu-core-supported.txt |  sed -e 's/^/-p /')  >> $TARGET/ubuntu-core-16.html
$SCRIPTS/ubuntu-table --html $(grep -v "^#" $CVES/cloud-archive-supported.txt |  sed -e 's/^/-p /')  >> $TARGET/cloud-archive.html
echo $FOOTER >> $TARGET/ubuntu-core-16.html
echo $FOOTER >> $TARGET/cloud-archive.html
