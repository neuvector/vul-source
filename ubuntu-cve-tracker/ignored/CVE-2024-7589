Candidate: CVE-2024-7589
PublicDate: 2024-08-12 13:38:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-7589
Description:
 A signal handler in sshd(8) may call a logging function that is not
 async-signal-safe.  The signal handler is invoked when a client does not
 authenticate within the LoginGraceTime seconds (120 by default).  This
 signal handler executes in the context of the sshd(8)'s privileged code,
 which is not sandboxed and runs with full root privileges.
 
 This issue is another instance of the problem in CVE-2024-6387 addressed by
 FreeBSD-SA-24:04.openssh.  The faulty code in this case is from the
 integration of blacklistd in OpenSSH in FreeBSD.
 
 As a result of calling functions that are not async-signal-safe in the
 privileged sshd(8) context, a race condition exists that a determined
 attacker may be able to exploit to allow an unauthenticated remote code
 execution as root.
Ubuntu-Description:
Notes:
 seth-arnold> openssh-ssh1 is provided for compatibility with old devices
 seth-arnold> that
 seth-arnold> cannot be upgraded to modern protocols. Thus we may not
 seth-arnold> provide security
 seth-arnold> support for this package if doing so would prevent access to
 seth-arnold> equipment.
 alexmurray> Only affects OpenSSH on FreeBSD so Ubuntu is not affected.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]
 cisa-adp: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]


Patches_openssh:
upstream_openssh: not-affected (debian: Only affects OpenSSH as shipped in FreeBSD)
esm-infra-legacy/trusty_openssh: not-affected (only affects OpenSSH on FreeBSD)
trusty/esm_openssh: not-affected (only affects OpenSSH on FreeBSD)
esm-infra/xenial_openssh: not-affected (only affects OpenSSH on FreeBSD)
fips-updates/xenial_openssh: not-affected (only affects OpenSSH on FreeBSD)
fips/xenial_openssh: not-affected (only affects OpenSSH on FreeBSD)
esm-infra/bionic_openssh: not-affected (only affects OpenSSH on FreeBSD)
fips-updates/bionic_openssh: not-affected (only affects OpenSSH on FreeBSD)
fips/bionic_openssh: not-affected (only affects OpenSSH on FreeBSD)
focal_openssh: not-affected (only affects OpenSSH on FreeBSD)
esm-infra/focal_openssh: not-affected (only affects OpenSSH on FreeBSD)
fips-updates/focal_openssh: not-affected (only affects OpenSSH on FreeBSD)
fips/focal_openssh: not-affected (only affects OpenSSH on FreeBSD)
jammy_openssh: not-affected (only affects OpenSSH on FreeBSD)
noble_openssh: not-affected (only affects OpenSSH on FreeBSD)
devel_openssh: not-affected (only affects OpenSSH on FreeBSD)

Patches_openssh-ssh1:
upstream_openssh-ssh1: ignored (frozen on openssh 7.5p)
esm-apps/bionic_openssh-ssh1: not-affected (only affects OpenSSH on FreeBSD)
focal_openssh-ssh1: not-affected (only affects OpenSSH on FreeBSD)
esm-apps/focal_openssh-ssh1: not-affected (only affects OpenSSH on FreeBSD)
jammy_openssh-ssh1: not-affected (only affects OpenSSH on FreeBSD)
esm-apps/jammy_openssh-ssh1: not-affected (only affects OpenSSH on FreeBSD)
noble_openssh-ssh1: not-affected (only affects OpenSSH on FreeBSD)
esm-apps/noble_openssh-ssh1: not-affected (only affects OpenSSH on FreeBSD)
devel_openssh-ssh1: not-affected (only affects OpenSSH on FreeBSD)
