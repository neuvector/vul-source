PublicDateAtUSN: 2021-02-15 13:15:00 UTC
Candidate: CVE-2021-23336
PublicDate: 2021-02-15 13:15:00 UTC
References:
 https://github.com/python/cpython/pull/24297
 https://github.com/python/cpython/commit/fcbe0cb04d35189401c0c880ebfb4311e952d776 (master)
 https://snyk.io/blog/cache-poisoning-in-popular-open-source-packages/
 https://snyk.io/vuln/SNYK-UPSTREAM-PYTHONCPYTHON-1074933
 https://www.djangoproject.com/weblog/2021/feb/19/security-releases/
 https://ubuntu.com/security/notices/USN-4742-1
 https://www.cve.org/CVERecord?id=CVE-2021-23336
Description:
 The package python/cpython from 0 and before 3.6.13, from 3.7.0 and before
 3.7.10, from 3.8.0 and before 3.8.8, from 3.9.0 and before 3.9.2 are
 vulnerable to Web Cache Poisoning via urllib.parse.parse_qsl and
 urllib.parse.parse_qs by using a vector called parameter cloaking. When the
 attacker can separate query parameters using a semicolon (;), they can
 cause a difference in the interpretation of the request between the proxy
 (running with default configuration) and the server. This can result in
 malicious requests being cached as completely safe ones, as the proxy would
 usually not see the semicolon as a separator, and therefore would not
 include it in a cache key of an unkeyed parameter.
Ubuntu-Description:
Notes:
 mdeslaur> fixing this in stable releases will break compatibility with
 mdeslaur> existing applications. Marking as low priority. We may decide
 mdeslaur> not to fix this at all in stable releases in the future.
 rodrigo-zaiden> Decided not to fix. The proposed fixes could possibly
 rodrigo-zaiden> break existing python packages in Ubuntu. There are
 rodrigo-zaiden> known regressions to this CVE, such as:
 rodrigo-zaiden>  https://giters.com/scrapy/w3lib/issues/164
Mitigation:
Bugs:
 https://bugs.python.org/issue42967
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:H [5.9 MEDIUM]


Patches_python3.9:
 upstream: https://github.com/python/cpython/commit/c9f07813ab8e664d8c34413c4fc2d4f86c061a92
upstream_python3.9: released (3.9.2)
precise/esm_python3.9: DNE
trusty_python3.9: ignored (end of standard support)
trusty/esm_python3.9: DNE
esm-infra-legacy/trusty_python3.9: DNE
xenial_python3.9: DNE
bionic_python3.9: DNE
focal_python3.9: released (3.9.5-3~20.04.1)
esm-apps/focal_python3.9: released (3.9.5-3~20.04.1)
groovy_python3.9: released (3.9.5-3~20.10.1)
hirsute_python3.9: not-affected (3.9.2-1)
impish_python3.9: not-affected (3.9.2-1)
jammy_python3.9: DNE
kinetic_python3.9: DNE
lunar_python3.9: DNE
mantic_python3.9: DNE
noble_python3.9: DNE
devel_python3.9: DNE

Patches_python3.8:
 upstream: https://github.com/python/cpython/commit/e3110c3cfbb7daa690d54d0eff6c264c870a71bf
 upstream: https://github.com/python/cpython/commit/d5b80eb11b4812b4a579ce129ba4a10c5f5d27f6
upstream_python3.8: released (3.8.8)
precise/esm_python3.8: DNE
trusty_python3.8: ignored (end of standard support)
trusty/esm_python3.8: DNE
esm-infra-legacy/trusty_python3.8: DNE
xenial_python3.8: DNE
bionic_python3.8: ignored
esm-apps/bionic_python3.8: ignored
focal_python3.8: ignored
groovy_python3.8: ignored (end of life)
hirsute_python3.8: DNE
impish_python3.8: DNE
jammy_python3.8: DNE
kinetic_python3.8: DNE
lunar_python3.8: DNE
mantic_python3.8: DNE
noble_python3.8: DNE
devel_python3.8: DNE

Patches_python3.7:
 upstream: https://github.com/python/cpython/commit/d0d4d30882fe3ab9b1badbecf5d15d94326fd13e
upstream_python3.7: released (3.7.10)
precise/esm_python3.7: DNE
trusty_python3.7: ignored (end of standard support)
trusty/esm_python3.7: DNE
esm-infra-legacy/trusty_python3.7: DNE
xenial_python3.7: DNE
bionic_python3.7: ignored
esm-apps/bionic_python3.7: ignored
focal_python3.7: DNE
groovy_python3.7: DNE
hirsute_python3.7: DNE
impish_python3.7: DNE
jammy_python3.7: DNE
kinetic_python3.7: DNE
lunar_python3.7: DNE
mantic_python3.7: DNE
noble_python3.7: DNE
devel_python3.7: DNE

Patches_python3.6:
upstream_python3.6: released (3.6.13)
precise/esm_python3.6: DNE
trusty_python3.6: DNE
trusty/esm_python3.6: DNE
esm-infra-legacy/trusty_python3.6: DNE
xenial_python3.6: DNE
bionic_python3.6: ignored
esm-infra/bionic_python3.6: ignored
focal_python3.6: DNE
groovy_python3.6: DNE
hirsute_python3.6: DNE
impish_python3.6: DNE
jammy_python3.6: DNE
kinetic_python3.6: DNE
lunar_python3.6: DNE
mantic_python3.6: DNE
noble_python3.6: DNE
devel_python3.6: DNE

Patches_python3.5:
upstream_python3.5: needs-triage
precise/esm_python3.5: DNE
trusty_python3.5: ignored (end of standard support)
trusty/esm_python3.5: ignored
esm-infra-legacy/trusty_python3.5: ignored
xenial_python3.5: ignored (end of standard support, was needs-triage)
esm-infra/xenial_python3.5: ignored
bionic_python3.5: DNE
focal_python3.5: DNE
groovy_python3.5: DNE
hirsute_python3.5: DNE
impish_python3.5: DNE
jammy_python3.5: DNE
kinetic_python3.5: DNE
lunar_python3.5: DNE
mantic_python3.5: DNE
noble_python3.5: DNE
devel_python3.5: DNE

Patches_python3.4:
upstream_python3.4: needs-triage
precise/esm_python3.4: DNE
trusty_python3.4: ignored (end of standard support)
trusty/esm_python3.4: ignored
esm-infra-legacy/trusty_python3.4: ignored
xenial_python3.4: DNE
bionic_python3.4: DNE
focal_python3.4: DNE
groovy_python3.4: DNE
hirsute_python3.4: DNE
impish_python3.4: DNE
jammy_python3.4: DNE
kinetic_python3.4: DNE
lunar_python3.4: DNE
mantic_python3.4: DNE
noble_python3.4: DNE
devel_python3.4: DNE

Patches_python2.7:
upstream_python2.7: needs-triage
precise/esm_python2.7: ignored
trusty_python2.7: ignored (end of standard support)
trusty/esm_python2.7: ignored
esm-infra-legacy/trusty_python2.7: ignored
xenial_python2.7: ignored (end of standard support, was needs-triage)
esm-infra/xenial_python2.7: ignored
bionic_python2.7: ignored
esm-infra/bionic_python2.7: ignored
focal_python2.7: ignored
esm-apps/focal_python2.7: ignored
groovy_python2.7: ignored (end of life)
hirsute_python2.7: ignored (end of life)
impish_python2.7: ignored
jammy_python2.7: ignored
esm-apps/jammy_python2.7: ignored
kinetic_python2.7: ignored
lunar_python2.7: DNE
mantic_python2.7: DNE
noble_python2.7: DNE
devel_python2.7: DNE

Patches_python-django:
 upstream: https://github.com/django/django/commit/8f6d431b08cbb418d9144b976e7b972546607851
upstream_python-django: released (2.2.19)
precise/esm_python-django: DNE
trusty_python-django: ignored (end of standard support)
trusty/esm_python-django: not-affected (code not present)
esm-infra-legacy/trusty_python-django: not-affected (code not present)
xenial_python-django: not-affected (code not present)
esm-infra/xenial_python-django: not-affected (code not present)
bionic_python-django: released (1:1.11.11-1ubuntu1.11)
esm-infra/bionic_python-django: not-affected (1:1.11.11-1ubuntu1.11)
focal_python-django: released (2:2.2.12-1ubuntu0.4)
groovy_python-django: released (2:2.2.16-1ubuntu0.2)
hirsute_python-django: released (2.2.19-1)
impish_python-django: released (2.2.19-1)
jammy_python-django: released (2.2.19-1)
kinetic_python-django: released (2.2.19-1)
lunar_python-django: released (2.2.19-1)
mantic_python-django: released (2.2.19-1)
noble_python-django: released (2.2.19-1)
devel_python-django: released (2.2.19-1)
