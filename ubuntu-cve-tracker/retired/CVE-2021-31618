Candidate: CVE-2021-31618
PublicDate: 2021-06-15 09:15:00 UTC
References:
 https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2021-31618
 https://www.cve.org/CVERecord?id=CVE-2021-31618
Description:
 Apache HTTP Server protocol handler for the HTTP/2 protocol checks received
 request headers against the size limitations as configured for the server
 and used for the HTTP/1 protocol as well. On violation of these
 restrictions and HTTP response is sent to the client with a status code
 indicating why the request was rejected. This rejection response was not
 fully initialised in the HTTP/2 protocol handler if the offending header
 was the very first one received or appeared in a a footer. This led to a
 NULL pointer dereference on initialised memory, crashing reliably the child
 process. Since such a triggering HTTP/2 request is easy to craft and
 submit, this can be exploited to DoS the server. This issue affected
 mod_http2 1.15.17 and Apache HTTP Server version 2.4.47 only. Apache HTTP
 Server 2.4.47 was never released.
Ubuntu-Description:
Notes:
 mdeslaur> per upstream advisory, "This issue affected mod_http2 1.15.17
 mdeslaur> and Apache HTTP Server version 2.4.47 only. Apache HTTP Server
 mdeslaur> 2.4.47 was never released."
 mdeslaur> seems introduced by:
 mdeslaur> https://github.com/apache/httpd/commit/a4fba223668c554e06bc78d6e3a88f33d4238ae4
 mdeslaur>
 mdeslaur> Not sure the Debian patch in 2.4.46-5 is right, need to
 mdeslaur> investigate
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=989562
 https://bugzilla.redhat.com/show_bug.cgi?id=1968013
Priority: medium
Discovered-by: LI ZHI XIN
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]


Patches_apache2:

 upstream: https://github.com/apache/httpd/commit/f990e5ecad40b100a8a5c7c1033c46044a9cb244
 upstream: http://svn.apache.org/viewvc?view=revision&revision=1889759
 upstream: https://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/modules/http2/h2_stream.c?r1=1889759&r2=1889758&pathrev=1889759
upstream_apache2: released (2.4.46-5)
trusty_apache2: ignored (end of standard support)
trusty/esm_apache2: not-affected
esm-infra-legacy/trusty_apache2: not-affected
xenial_apache2: ignored (end of standard support)
esm-infra/xenial_apache2: not-affected
bionic_apache2: not-affected
esm-infra/bionic_apache2: not-affected
focal_apache2: not-affected
esm-infra/focal_apache2: not-affected
groovy_apache2: not-affected
hirsute_apache2: not-affected
impish_apache2: not-affected
jammy_apache2: not-affected
devel_apache2: not-affected
