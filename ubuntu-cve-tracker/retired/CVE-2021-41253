Candidate: CVE-2021-41253
PublicDate: 2021-11-08 22:15:00 UTC
References:
 https://github.com/zyantific/zydis/security/advisories/GHSA-q42v-hv86-3m4g
 https://www.cve.org/CVERecord?id=CVE-2021-41253
Description:
 Zydis is an x86/x86-64 disassembler library. Users of Zydis versions v3.2.0
 and older that use the string functions provided in `zycore` in order to
 append untrusted user data to the formatter buffer within their custom
 formatter hooks can run into heap buffer overflows. Older versions of Zydis
 failed to properly initialize the string object within the formatter
 buffer, forgetting to initialize a few fields, leaving their value to
 chance. This could then in turn cause zycore functions like
 `ZyanStringAppend` to make incorrect calculations for the new target size,
 resulting in heap memory corruption. This does not affect the regular
 uncustomized Zydis formatter, because Zydis internally doesn't use the
 string functions in zycore that act upon these fields. However, because the
 zycore string functions are the intended way to work with the formatter
 buffer for users of the library that wish to extend the formatter, we still
 consider this to be a vulnerability in Zydis. This bug is patched starting
 in version 3.2.1. As a workaround, users may refrain from using zycore
 string functions in their formatter hooks until updating to a patched
 version.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=999431
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H [5.9 MEDIUM]


Patches_zydis:
upstream_zydis: released (3.2.1-1)
trusty_zydis: ignored (end of standard support)
trusty/esm_zydis: DNE
esm-infra-legacy/trusty_zydis: DNE
xenial_zydis: ignored (end of standard support)
esm-infra/xenial_zydis: DNE
bionic_zydis: DNE
focal_zydis: DNE
esm-infra/focal_zydis: DNE
hirsute_zydis: DNE
impish_zydis: DNE
jammy_zydis: not-affected (3.2.1-1)
esm-apps/jammy_zydis: not-affected (3.2.1-1)
devel_zydis: not-affected (3.2.1-1)
