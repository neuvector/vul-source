PublicDateAtUSN: 2023-11-28 16:15:00 UTC
Candidate: CVE-2022-41678
PublicDate: 2023-11-28 16:15:00 UTC
References:
 https://lists.apache.org/thread/7g17kwbtjl011mm4tr8bn1vnoq9wh4sl
 https://activemq.apache.org/security-advisories.data/CVE-2022-41678-announcement.txt
 https://www.cve.org/CVERecord?id=CVE-2022-41678
 https://ubuntu.com/security/notices/USN-6910-1
 https://ubuntu.com/security/notices/USN-7268-1
Description:
 Once an user is authenticated on Jolokia, he can potentially trigger
 arbitrary code execution.Â 
 
 In details, in ActiveMQ configurations, jetty allows
 org.jolokia.http.AgentServlet to handler request to /api/jolokia
 
 org.jolokia.http.HttpRequestHandler#handlePostRequest is able to
 create JmxRequest through JSONObject. And calls to
 org.jolokia.http.HttpRequestHandler#executeRequest.
 
 Into deeper calling stacks,
 org.jolokia.handler.ExecHandler#doHandleRequest can be invoked
 through refection. This could lead to RCE through via
 various mbeans. One example is unrestricted deserialization in
 jdk.management.jfr.FlightRecorderMXBeanImpl which exists on Java version
 above 11.
 
 1 Call newRecording.
 
 2 Call setConfiguration. And a webshell data hides in it.
 
 3 Call startRecording.
 
 4 Call copyTo method. The webshell will be written to a .jsp file.
 
 The mitigation is to restrict (by default) the actions authorized on
 Jolokia, or disable Jolokia.
 A more restrictive Jolokia configuration has been defined in default
 ActiveMQ distribution. We encourage users to upgrade to ActiveMQ
 distributions version including updated Jolokia configuration: 5.16.6,
 5.17.4, 5.18.0, 6.0.0.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]

Patches_activemq:
upstream_activemq: released (5.17.6+dfsg-1)
trusty_activemq: ignored (end of standard support)
xenial_activemq: ignored (end of standard support)
esm-apps/xenial_activemq: released (5.13.2+dfsg-2ubuntu0.1~esm1)
bionic_activemq: ignored (end of standard support)
esm-apps/bionic_activemq: released (5.15.8-2~18.04.1~esm1)
focal_activemq: ignored (end of standard support, was needed)
esm-apps/focal_activemq: released (5.15.11-1ubuntu0.1~esm1)
jammy_activemq: released (5.16.1-1ubuntu0.1)
esm-apps/jammy_activemq: released (5.16.1-1ubuntu0.1)
lunar_activemq: ignored (end of life, was needs-triage)
mantic_activemq: ignored (end of life, was needs-triage)
noble_activemq: not-affected (5.17.6+dfsg-1)
esm-apps/noble_activemq: not-affected (5.17.6+dfsg-1)
oracular_activemq: not-affected (5.17.6+dfsg-1)
plucky_activemq: not-affected (5.17.6+dfsg-1)
devel_activemq: not-affected (5.17.6+dfsg-1)
