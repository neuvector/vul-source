PublicDateAtUSN: 2021-04-15 15:15:00 UTC
Candidate: CVE-2021-20288
PublicDate: 2021-04-15 15:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2021/04/14/2
 https://docs.ceph.com/en/latest/security/CVE-2021-20288/#cve-2021-20288
 https://ubuntu.com/security/notices/USN-4998-1
 https://ubuntu.com/security/notices/USN-5128-1
 https://www.cve.org/CVERecord?id=CVE-2021-20288
Description:
 An authentication flaw was found in ceph in versions before 14.2.20. When
 the monitor handles CEPHX_GET_AUTH_SESSION_KEY requests, it doesn't
 sanitize other_keys, allowing key reuse. An attacker who can request a
 global_id can exploit the ability of any user to request a global_id
 previously associated with another user, as ceph does not force the reuse
 of old keys to generate new ones. The highest threat from this
 vulnerability is to data confidentiality and integrity as well as system
 availability.
Ubuntu-Description:
 It was discovered that Ceph contained an authentication flaw, leading
 to key reuse. An attacker could use this to cause a denial of service
 or possibly impersonate another user.
Notes:
 mdeslaur> we will not be backporting this fix to Ubuntu 18.04 LTS and
 mdeslaur> earlier.
 mdeslaur> this is fixed in 16.2.1 in hirsute-updates but has not been
 mdeslaur> pushed to the security pocket
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=986974
Priority: medium
Discovered-by: Ilya Dryomov
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H [7.2 HIGH]


Patches_ceph:
 upstream: https://github.com/ceph/ceph/commit/059eabcc0ada81078a898cdc25cf72bf3d506ad0 (nautilus)
 upstream: https://github.com/ceph/ceph/commit/05b3b6a305ddbb56cc53bbeadf5866db4d785f49 (nautilus)
upstream_ceph: released (15.2.11,16.2.1)
precise/esm_ceph: ignored (end of life, was needs-triage)
trusty_ceph: ignored (end of standard support)
trusty/esm_ceph: ignored
esm-infra-legacy/trusty_ceph: ignored
xenial_ceph: ignored (end of standard support, was needs-triage)
esm-infra/xenial_ceph: ignored
bionic_ceph: ignored
esm-infra/bionic_ceph: ignored
focal_ceph: released (15.2.12-0ubuntu0.20.04.1)
esm-infra/focal_ceph: released (15.2.12-0ubuntu0.20.04.1)
groovy_ceph: released (15.2.12-0ubuntu0.20.10.1)
hirsute_ceph: released (16.2.6-0ubuntu0.21.04.2)
impish_ceph: released (16.2.1-0ubuntu1)
jammy_ceph: released (16.2.1-0ubuntu1)
devel_ceph: released (16.2.1-0ubuntu1)
