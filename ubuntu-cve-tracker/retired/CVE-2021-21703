PublicDateAtUSN: 2021-10-21 00:00:00 UTC
Candidate: CVE-2021-21703
PublicDate: 2021-10-25 06:15:00 UTC
References:
 https://github.com/php/php-src/commit/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b
 https://www.ambionics.io/blog/php-fpm-local-root
 https://ubuntu.com/security/notices/USN-5125-1
 https://www.cve.org/CVERecord?id=CVE-2021-21703
Description:
 In PHP versions 7.3.x up to and including 7.3.31, 7.4.x below 7.4.25 and
 8.0.x below 8.0.12, when running PHP FPM SAPI with main FPM daemon process
 running as root and child worker processes running as lower-privileged
 users, it is possible for the child processes to access memory shared with
 the main process and write to it, modifying it in a way that would cause
 the root process to conduct invalid memory reads and writes, which can be
 used to escalate privileges from local unprivileged user to the root user.
Ubuntu-Description:
Notes:
 sbeattie> PEAR issues should go against php-pear as of xenial
Mitigation:
Bugs:
 https://bugs.php.net/bug.php?id=81026
Priority: high
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H [7.0 HIGH]
 php: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H [7.8 HIGH]

Patches_php5:
Tags_php5: universe-binary
upstream_php5: needs-triage
trusty_php5: ignored (end of standard support)
trusty/esm_php5: released (5.5.9+dfsg-1ubuntu4.29+esm15)
esm-infra-legacy/trusty_php5: not-affected (5.5.9+dfsg-1ubuntu4.29+esm15)
xenial_php5: DNE
bionic_php5: DNE
focal_php5: DNE
esm-infra/focal_php5: DNE
hirsute_php5: DNE
impish_php5: DNE
jammy_php5: DNE
devel_php5: DNE

Patches_php7.0:
Tags_php7.0: universe-binary
upstream_php7.0: needs-triage
trusty_php7.0: DNE
trusty/esm_php7.0: DNE
esm-infra-legacy/trusty_php7.0: DNE
xenial_php7.0: ignored (end of standard support, was needs-triage)
esm-infra/xenial_php7.0: released (7.0.33-0ubuntu0.16.04.16+esm2)
bionic_php7.0: DNE
focal_php7.0: DNE
esm-infra/focal_php7.0: DNE
hirsute_php7.0: DNE
impish_php7.0: DNE
jammy_php7.0: DNE
devel_php7.0: DNE

Patches_php7.2:
Tags_php7.2: universe-binary
upstream_php7.2: needs-triage
trusty_php7.2: DNE
trusty/esm_php7.2: DNE
esm-infra-legacy/trusty_php7.2: DNE
xenial_php7.2: DNE
bionic_php7.2: released (7.2.24-0ubuntu0.18.04.10)
esm-infra/bionic_php7.2: not-affected (7.2.24-0ubuntu0.18.04.10)
focal_php7.2: DNE
esm-infra/focal_php7.2: DNE
hirsute_php7.2: DNE
impish_php7.2: DNE
jammy_php7.2: DNE
devel_php7.2: DNE

Patches_php7.4:
Tags_php7.4: universe-binary
upstream_php7.4: needs-triage
trusty_php7.4: DNE
trusty/esm_php7.4: DNE
esm-infra-legacy/trusty_php7.4: DNE
xenial_php7.4: DNE
bionic_php7.4: DNE
focal_php7.4: released (7.4.3-4ubuntu2.7)
esm-infra/focal_php7.4: not-affected (7.4.3-4ubuntu2.7)
hirsute_php7.4: released (7.4.16-1ubuntu2.2)
impish_php7.4: DNE
jammy_php7.4: DNE
devel_php7.4: DNE

Patches_php8.0:
Tags_php8.0: universe-binary
upstream_php8.0: released (8.0.12)
trusty_php8.0: DNE
trusty/esm_php8.0: DNE
esm-infra-legacy/trusty_php8.0: DNE
xenial_php8.0: DNE
bionic_php8.0: DNE
focal_php8.0: DNE
esm-infra/focal_php8.0: DNE
hirsute_php8.0: DNE
impish_php8.0: released (8.0.8-1ubuntu0.1)
jammy_php8.0: DNE
devel_php8.0: DNE

Patches_php8.1:
upstream_php8.1: needs-triage
precise/esm_php8.1: DNE
trusty_php8.1: DNE
trusty/esm_php8.1: DNE
esm-infra-legacy/trusty_php8.1: DNE
xenial_php8.1: DNE
bionic_php8.1: DNE
focal_php8.1: DNE
esm-infra/focal_php8.1: DNE
groovy_php8.1: DNE
hirsute_php8.1: DNE
impish_php8.1: DNE
jammy_php8.1: not-affected (8.1.0-1)
devel_php8.1: not-affected (8.1.0-1)
