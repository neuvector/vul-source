PublicDateAtUSN: 2021-04-08 23:15:00 UTC
Candidate: CVE-2021-3448
PublicDate: 2021-04-08 23:15:00 UTC
References:
 https://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2021q1/014835.html
 https://ubuntu.com/security/notices/USN-4976-1
 https://ubuntu.com/security/notices/USN-4976-2
 https://www.cve.org/CVERecord?id=CVE-2021-3448
Description:
 A flaw was found in dnsmasq in versions before 2.85. When configured to use
 a specific server for a given network interface, dnsmasq uses a fixed port
 while forwarding queries. An attacker on the network, able to find the
 outgoing port used by dnsmasq, only needs to guess the random transmission
 ID to forge a reply and get it accepted by dnsmasq. This flaw makes a DNS
 Cache Poisoning attack much easier. The highest threat from this
 vulnerability is to data integrity.
Ubuntu-Description:
Notes:
 mdeslaur> This issue only affects dnsmasq in non-default configurations
 mdeslaur> where the server=<address>@<interface> option is used. In those
 mdeslaur> environments, this issue can be prevented by disabling cache by
 mdeslaur> also using a cache-size=0 configuration option.
 mdeslaur>
 mdeslaur> For the dnsmasq instance used by Network-Manager, it is not
 mdeslaur> vulnerable to this issue as Ubuntu disables caching by
 mdeslaur> default. (See Update-dnsmasq-parameters.patch in the
 mdeslaur> network-manager package)
Mitigation:
Bugs:
 https://bugzilla.redhat.com/show_bug.cgi?id=1939368
Priority: low
Discovered-by: Petr Mensik
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N [4.0 MEDIUM]


Patches_dnsmasq:
 upstream: https://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=74d4fcd756a85bc1823232ea74334f7ccfb9d5d2
upstream_dnsmasq: released (2.85)
precise/esm_dnsmasq: ignored (end of life, was needs-triage)
trusty_dnsmasq: ignored (end of standard support)
trusty/esm_dnsmasq: ignored (end of ESM support, was needed)
esm-infra-legacy/trusty_dnsmasq: ignored (changes too intrusive)
xenial_dnsmasq: ignored (end of standard support, was needed)
esm-infra/xenial_dnsmasq: released (2.79-1ubuntu0.16.04.1+esm1)
bionic_dnsmasq: released (2.79-1ubuntu0.4)
esm-infra/bionic_dnsmasq: released (2.79-1ubuntu0.4)
focal_dnsmasq: released (2.80-1.1ubuntu1.4)
esm-infra/focal_dnsmasq: released (2.80-1.1ubuntu1.4)
groovy_dnsmasq: released (2.82-1ubuntu1.3)
hirsute_dnsmasq: released (2.84-1ubuntu2.1)
impish_dnsmasq: released (2.85-1ubuntu1)
jammy_dnsmasq: released (2.85-1ubuntu1)
kinetic_dnsmasq: released (2.85-1ubuntu1)
lunar_dnsmasq: released (2.85-1ubuntu1)
mantic_dnsmasq: released (2.85-1ubuntu1)
noble_dnsmasq: released (2.85-1ubuntu1)
oracular_dnsmasq: released (2.85-1ubuntu1)
plucky_dnsmasq: released (2.85-1ubuntu1)
devel_dnsmasq: released (2.85-1ubuntu1)
