PublicDateAtUSN: 2024-02-07 22:15:00 UTC
Candidate: CVE-2024-24806
PublicDate: 2024-02-07 22:15:00 UTC
References:
 https://github.com/libuv/libuv/security/advisories/GHSA-f74f-cvh7-c6q6
 http://www.openwall.com/lists/oss-security/2024/02/08/2
 https://ubuntu.com/security/notices/USN-6666-1
 https://www.cve.org/CVERecord?id=CVE-2024-24806
Description:
 libuv is a multi-platform support library with a focus on asynchronous I/O.
 The `uv_getaddrinfo` function in `src/unix/getaddrinfo.c` (and its windows
 counterpart `src/win/getaddrinfo.c`), truncates hostnames to 256 characters
 before calling `getaddrinfo`. This behavior can be exploited to create
 addresses like `0x00007f000001`, which are considered valid by
 `getaddrinfo` and could allow an attacker to craft payloads that resolve to
 unintended IP addresses, bypassing developer checks. The vulnerability
 arises due to how the `hostname_ascii` variable (with a length of 256
 bytes) is handled in `uv_getaddrinfo` and subsequently in
 `uv__idna_toascii`. When the hostname exceeds 256 characters, it gets
 truncated without a terminating null byte. As a result attackers may be
 able to access internal APIs or for websites (similar to MySpace) that
 allows users to have `username.example.com` pages. Internal services that
 crawl or cache these user pages can be exposed to SSRF attacks if a
 malicious user chooses a long vulnerable username. This issue has been
 addressed in release version 1.48.0. Users are advised to upgrade. There
 are no known workarounds for this vulnerability.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1063484
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L [7.3 HIGH]
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L [7.3 HIGH]


Patches_libuv1:
 upstream: https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)
 upstream: https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)
 upstream: https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)
upstream_libuv1: needs-triage
trusty_libuv1: DNE
xenial_libuv1: ignored (end of standard support)
esm-apps/xenial_libuv1: not-affected (code not present)
bionic_libuv1: ignored (end of standard support)
esm-infra/bionic_libuv1: not-affected (code not present)
focal_libuv1: released (1.34.2-1ubuntu1.5)
esm-infra/focal_libuv1: not-affected (1.34.2-1ubuntu1.5)
jammy_libuv1: released (1.43.0-1ubuntu0.1)
mantic_libuv1: released (1.44.2-1ubuntu0.1)
noble_libuv1: not-affected (1.48.0-1)
devel_libuv1: not-affected (1.48.0-1)
