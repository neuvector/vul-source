Candidate: CVE-2023-50386
PublicDate: 2024-02-09 18:15:00 UTC
References:
 https://solr.apache.org/security.html#cve-2023-50386-apache-solr-backuprestore-apis-allow-for-deployment-of-executables-in-malicious-configsets
 https://www.openwall.com/lists/oss-security/2024/02/09/1
 https://www.cve.org/CVERecord?id=CVE-2023-50386
Description:
 Improper Control of Dynamically-Managed Code Resources, Unrestricted Upload
 of File with Dangerous Type, Inclusion of Functionality from Untrusted
 Control Sphere vulnerability in Apache Solr.This issue affects Apache Solr:
 from 6.0.0 through 8.11.2, from 9.0.0 before 9.4.1. In the affected
 versions, Solr ConfigSets accepted Java jar and class files to be uploaded
 through the ConfigSets API. When backing up Solr Collections, these
 configSet files would be saved to disk when using the
 LocalFileSystemRepository (the default for backups). If the backup was
 saved to a directory that Solr uses in its ClassPath/ClassLoaders, then the
 jar and class files would be available to use with any ConfigSet, trusted
 or untrusted. When Solr is run in a secure way (Authorization enabled), as
 is strongly suggested, this vulnerability is limited to extending the
 Backup permissions with the ability to add libraries. Users are recommended
 to upgrade to version 8.11.3 or 9.4.1, which fix the issue. In these
 versions, the following protections have been added: * Users are no longer
 able to upload files to a configSet that could be executed via a Java
 ClassLoader. * The Backup API restricts saving backups to directories that
 are used in the ClassLoader.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by: L3yx
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]


Patches_lucene-solr:
upstream_lucene-solr: released (3.6.2+dfsg-23)
trusty_lucene-solr: ignored (end of standard support)
trusty/esm_lucene-solr: not-affected
esm-infra-legacy/trusty_lucene-solr: not-affected
xenial_lucene-solr: ignored (end of standard support)
esm-apps/xenial_lucene-solr: not-affected
bionic_lucene-solr: ignored (end of standard support)
esm-apps/bionic_lucene-solr: not-affected
focal_lucene-solr: not-affected
esm-infra/focal_lucene-solr: DNE (focal was not-affected)
esm-apps/focal_lucene-solr: not-affected
jammy_lucene-solr: not-affected (3.6.2+dfsg-24)
esm-apps/jammy_lucene-solr: not-affected
mantic_lucene-solr: not-affected
noble_lucene-solr: not-affected
esm-apps/noble_lucene-solr: not-affected
devel_lucene-solr: not-affected
