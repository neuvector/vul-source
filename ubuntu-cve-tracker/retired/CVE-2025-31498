PublicDateAtUSN: 2025-04-08 14:15:00 UTC
Candidate: CVE-2025-31498
PublicDate: 2025-04-08 14:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-31498
 https://github.com/c-ares/c-ares/security/advisories/GHSA-6hxc-62jh-p29v
 http://www.openwall.com/lists/oss-security/2025/04/08/3
 https://github.com/c-ares/c-ares/commit/29d38719112639d8c0ba910254a3dd4f482ea2d1
 https://github.com/c-ares/c-ares/pull/821
 https://ubuntu.com/security/notices/USN-7477-1
Description:
 c-ares is an asynchronous resolver library. From 1.32.3 through 1.34.4,
 there is a use-after-free in read_answers() when process_answer() may
 re-enqueue a query either due to a DNS Cookie Failure or when the upstream
 server does not properly support EDNS, or possibly on TCP queries if the
 remote closed the connection immediately after a response. If there was an
 issue trying to put that new transaction on the wire, it would close the
 connection handle, but read_answers() was still expecting the connection
 handle to be available to possibly dequeue other responses. In theory a
 remote attacker might be able to trigger this by flooding the target with
 ICMP UNREACHABLE packets if they also control the upstream nameserver and
 can return a result with one of those conditions, this has been untested.
 Otherwise only a local attacker might be able to change system behavior to
 make send()/write() return a failure condition. This vulnerability is fixed
 in 1.34.5.
Ubuntu-Description:
Notes:
 mdeslaur> introduced in 1.32.3 by:
 mdeslaur> https://github.com/c-ares/c-ares/commit/ccd11aa37771ece1956c791a6232995317ac595e
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:

Patches_c-ares:
 upstream: https://github.com/c-ares/c-ares/commit/066b396.patch (1.34)
 upstream: https://github.com/c-ares/c-ares/compare/9a48eed..d3a507e.patch (1.34)
 upstream: https://github.com/c-ares/c-ares/compare/69e1ad5..82489f2.patch (1.33)
upstream_c-ares: released (1.34.5-1)
esm-infra/xenial_c-ares: not-affected
esm-infra/bionic_c-ares: not-affected
focal_c-ares:not-affected (1.15.0-1ubuntu0.5)
esm-infra/focal_c-ares: not-affected (1.15.0-1ubuntu0.5)
jammy_c-ares: not-affected (1.18.1-1ubuntu0.22.04.3)
noble_c-ares: not-affected (1.27.0-1.0ubuntu1)
oracular_c-ares: released (1.33.0-1ubuntu0.1)
plucky_c-ares: released (1.34.4-2.1ubuntu0.1)
devel_c-ares: not-affected (1.34.5-1)
