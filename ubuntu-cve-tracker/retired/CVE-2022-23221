PublicDateAtUSN: 2022-01-19 17:15:00 UTC
Candidate: CVE-2022-23221
PublicDate: 2022-01-19 17:15:00 UTC
References:
 https://github.com/h2database/h2database/security/advisories
 https://github.com/h2database/h2database/releases/tag/version-2.1.210
 https://twitter.com/d0nkey_man/status/1483824727936450564
 https://ubuntu.com/security/notices/USN-5365-1
 https://www.cve.org/CVERecord?id=CVE-2022-23221
 https://ubuntu.com/security/notices/USN-6834-1
Description:
 H2 Console before 2.1.210 allows remote attackers to execute arbitrary code
 via a jdbc:h2:mem JDBC URL containing the
 IGNORE_UNKNOWN_SETTINGS=TRUE;FORBID_CREATION=FALSE;INIT=RUNSCRIPT
 substring, a different vulnerability than CVE-2021-42392.
Ubuntu-Description:
Notes:
 yomonokio> Upstream states that persistent databases created by H2 1.4.200 and
 yomonokio> older versions require export into SQL script with that old version
 yomonokio> and creation of a new database with the new version and execution
 yomonokio> of this script in it.

Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]


Patches_h2database:
upstream_h2database: 2.1.210
trusty_h2database: ignored (end of standard support)
xenial_h2database: ignored (end of standard support)
esm-apps/xenial_h2database: released (1.4.191-1ubuntu0.1~esm1)
bionic_h2database: ignored (end of standard support, was needs-triage)
esm-apps/bionic_h2database: released (1.4.196-2ubuntu0.1~esm1)
focal_h2database: released (1.4.197-4+deb10u1build0.20.04.1)
esm-apps/focal_h2database: released (1.4.197-4+deb10u1build0.20.04.1)
hirsute_h2database: ignored (end of life)
impish_h2database: released (1.4.197-4+deb10u1build0.21.10.1)
jammy_h2database: released (2.1.210+really1.4.197-1)
esm-apps/jammy_h2database: released (2.1.210+really1.4.197-1)
kinetic_h2database: ignored (end of life, was needs-triage)
lunar_h2database: ignored (end of life, was needs-triage)
mantic_h2database: not-affected (2.1.210)
noble_h2database: not-affected (2.1.210)
esm-apps/noble_h2database: not-affected (2.1.210)
devel_h2database: not-affected (2.1.210)
