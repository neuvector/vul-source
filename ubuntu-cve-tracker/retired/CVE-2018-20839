Candidate: CVE-2018-20839
PublicDate: 2019-05-17 04:29:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20839
 https://github.com/systemd/systemd/pull/12378
 https://github.com/systemd/systemd/pull/13109
Description:
 systemd 242 changes the VT1 mode upon a logout, which allows attackers to
 read cleartext passwords in certain circumstances, such as watching a
 shutdown, or using Ctrl-Alt-F1 and Ctrl-Alt-F2. This occurs because the
 KDGKBMODE (aka current keyboard mode) check is mishandled.
Ubuntu-Description:
Notes:
 seth-arnold> Possible regression when running startx manually
 mdeslaur> commit was reverted in (240-6ubuntu7)
 mdeslaur>
 mdeslaur> possibly a bug in plymouth, not systemd
 mdeslaur> as of 2021-04-12, we can no longer reproduce this issue with
 mdeslaur> all updates applied. I am therefore marking this CVE as
 mdeslaur> not affecting systemd and closing it out. This was possibly
 mdeslaur> fixed by the plymouth change in bug 1817738.
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/systemd/+bug/1803993
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=929116
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=929229
 https://gitlab.freedesktop.org/xorg/xserver/issues/857
Priority: medium
Discovered-by: Balint Reczey
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 nvd: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]


Patches_systemd:
 upstream: https://github.com/systemd/systemd/commit/9725f1a10f80f5e0ae7d9b60547458622aeb322f
 upstream: https://github.com/systemd/systemd/commit/bb5ac84d79ac3aef606a4a9eeaafef94a1f199be
 upstream: https://github.com/systemd/systemd/commit/13a43c73d8cbac4b65472de04bb88ea1bacdeb89
upstream_systemd: needed
precise/esm_systemd: DNE
trusty_systemd: ignored (end of standard support)
trusty/esm_systemd: not-affected
xenial_systemd: ignored (end of standard support, was deferred)
esm-infra/xenial_systemd: not-affected
bionic_systemd: not-affected
esm-infra/bionic_systemd: not-affected
cosmic_systemd: ignored (end of life)
disco_systemd: ignored (end of life)
eoan_systemd: ignored (end of life)
focal_systemd: not-affected
groovy_systemd: not-affected
hirsute_systemd: not-affected
impish_systemd: not-affected
jammy_systemd: not-affected
devel_systemd: not-affected
