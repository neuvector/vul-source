PublicDateAtUSN: 2017-10-04
Candidate: CVE-2017-1000254
PublicDate: 2017-10-06 13:29:00 UTC
References: 
 https://curl.haxx.se/docs/adv_20171004.html
 https://ubuntu.com/security/notices/USN-3441-1
 https://ubuntu.com/security/notices/USN-3441-2
 https://www.cve.org/CVERecord?id=CVE-2017-1000254
Description:
 libcurl may read outside of a heap allocated buffer when doing FTP. When
 libcurl connects to an FTP server and successfully logs in (anonymous or
 not), it asks the server for the current directory with the `PWD` command.
 The server then responds with a 257 response containing the path, inside
 double quotes. The returned path name is then kept by libcurl for
 subsequent uses. Due to a flaw in the string parser for this directory
 name, a directory name passed like this but without a closing double quote
 would lead to libcurl not adding a trailing NUL byte to the buffer holding
 the name. When libcurl would then later access the string, it could read
 beyond the allocated heap buffer and crash or wrongly access data beyond
 the buffer, thinking it was part of the path. A malicious server could
 abuse this fact and effectively prevent libcurl-based clients to work with
 it - the PWD command is always issued on new FTP connections and the
 mistake has a high chance of causing a segfault. The simple fact that this
 has issue remained undiscovered for this long could suggest that malformed
 PWD responses are rare in benign servers. We are not aware of any exploit
 of this flaw. This bug was introduced in commit
 [415d2e7cb7](https://github.com/curl/curl/commit/415d2e7cb7), March 2005.
 In libcurl version 7.56.0, the parser always zero terminates the string but
 also rejects it if not terminated properly with a final double quote.
Ubuntu-Description: 
Notes: 
Bugs: 
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=877671
Priority: medium
Discovered-by: Max Dymond
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_curl:
 upstream: https://curl.haxx.se/CVE-2017-1000254.patch
 upstream: https://github.com/curl/curl/commit/5ff2c5ff25750aba1a8f64fbcad8e5b891512584
upstream_curl: released (7.56.0)
precise/esm_curl: not-affected (7.22.0-3ubuntu4.18)
trusty_curl: released (7.35.0-1ubuntu2.11)
trusty/esm_curl: released (7.35.0-1ubuntu2.11)
esm-infra-legacy/trusty_curl: released (7.35.0-1ubuntu2.11)
vivid/ubuntu-core_curl: ignored (end of life)
xenial_curl: released (7.47.0-1ubuntu2.3)
esm-infra/xenial_curl: released (7.47.0-1ubuntu2.3)
zesty_curl: released (7.52.1-4ubuntu1.2)
artful_curl: released (7.55.1-1ubuntu2)
devel_curl: released (7.55.1-1ubuntu2)
