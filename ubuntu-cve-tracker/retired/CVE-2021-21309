PublicDateAtUSN: 2021-02-26 22:15:00 UTC
Candidate: CVE-2021-21309
PublicDate: 2021-02-26 22:15:00 UTC
References:
 https://github.com/redis/redis/pull/8522
 https://ubuntu.com/security/notices/USN-5221-1
 https://www.cve.org/CVERecord?id=CVE-2021-21309
Description:
 Redis is an open-source, in-memory database that persists on disk. In
 affected versions of Redis an integer overflow bug in 32-bit Redis version
 4.0 or newer could be exploited to corrupt the heap and potentially result
 with remote code execution. Redis 4.0 or newer uses a configurable limit
 for the maximum supported bulk input size. By default, it is 512MB which is
 a safe value for all platforms. If the limit is significantly increased,
 receiving a large request from a client may trigger several integer
 overflow scenarios, which would result with buffer overflow and heap
 corruption. We believe this could in certain conditions be exploited for
 remote code execution. By default, authenticated Redis users have access to
 all configuration parameters and can therefore use the “CONFIG SET
 proto-max-bulk-len” to change the safe default, making the system
 vulnerable. **This problem only affects 32-bit Redis (on a 32-bit system,
 or as a 32-bit executable running on a 64-bit system).** The problem is
 fixed in version 6.2, and the fix is back ported to 6.0.11 and 5.0.11. Make
 sure you use one of these versions if you are running 32-bit Redis. An
 additional workaround to mitigate the problem without patching the
 redis-server executable is to prevent clients from directly executing
 `CONFIG SET`: Using Redis 6.0 or newer, ACL configuration can be used to
 block the command. Using older versions, the `rename-command` configuration
 directive can be used to rename the command to a random string unknown to
 users, rendering it inaccessible. Please note that this workaround may have
 an additional impact on users or operational systems that expect `CONFIG
 SET` to behave in certain ways.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=983446
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:L [5.4 MEDIUM]


Patches_redis:
upstream_redis: released (5:6.0.11-1)
precise/esm_redis: DNE
trusty_redis: ignored (end of standard support)
trusty/esm_redis: not-affected (code not present)
esm-infra-legacy/trusty_redis: not-affected (code not present)
xenial_redis: ignored (end of standard support, was needs-triage)
esm-apps/xenial_redis: not-affected (code not present)
bionic_redis: ignored (end of standard support, was needed)
esm-apps/bionic_redis: released (5:4.0.9-1ubuntu0.2+esm3)
focal_redis: not-affected (no 32bit version)
esm-infra/focal_redis: DNE (focal was not-affected [no 32bit version])
esm-apps/focal_redis: not-affected (no 32bit version)
groovy_redis: ignored (end of life)
hirsute_redis: released (5:6.0.11-1)
impish_redis: not-affected (5:6.0.11-1)
jammy_redis: not-affected (5:6.0.11-1)
esm-apps/jammy_redis: not-affected (5:6.0.11-1)
kinetic_redis: not-affected (5:6.0.11-1)
lunar_redis: not-affected (5:6.0.11-1)
devel_redis: not-affected (5:6.0.11-1)
