Candidate: CVE-2021-4044
PublicDate: 2021-12-14 19:15:00 UTC
References:
 https://www.openssl.org/news/secadv/20211214.txt
 https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=758754966791c537ea95241438454aa86f91f256
 https://www.cve.org/CVERecord?id=CVE-2021-4044
Description:
 Internally libssl in OpenSSL calls X509_verify_cert() on the client side to
 verify a certificate supplied by a server. That function may return a
 negative return value to indicate an internal error (for example out of
 memory). Such a negative return value is mishandled by OpenSSL and will
 cause an IO function (such as SSL_connect() or SSL_do_handshake()) to not
 indicate success and a subsequent call to SSL_get_error() to return the
 value SSL_ERROR_WANT_RETRY_VERIFY. This return value is only supposed to be
 returned by OpenSSL if the application has previously called
 SSL_CTX_set_cert_verify_callback(). Since most applications do not do this
 the SSL_ERROR_WANT_RETRY_VERIFY return value from SSL_get_error() will be
 totally unexpected and applications may not behave correctly as a result.
 The exact behaviour will depend on the application but it could result in
 crashes, infinite loops or other similar incorrect responses. This issue is
 made more serious in combination with a separate bug in OpenSSL 3.0 that
 will cause X509_verify_cert() to indicate an internal error when processing
 a certificate chain. This will occur where a certificate does not include
 the Subject Alternative Name extension but where a Certificate Authority
 has enforced name constraints. This issue can occur even with valid chains.
 By combining the two issues an attacker could induce incorrect, application
 dependent behaviour. Fixed in OpenSSL 3.0.1 (Affected 3.0.0).
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_openssl:
upstream_openssl: not-affected (debian: Vulnerable code not present)
trusty_openssl: ignored (end of standard support)
trusty/esm_openssl: not-affected (code not present)
esm-infra-legacy/trusty_openssl: not-affected (code not present)
xenial_openssl: not-affected (code not present)
esm-infra/xenial_openssl: not-affected (code not present)
fips/xenial_openssl: not-affected (code not present)
fips-updates/xenial_openssl: not-affected (code not present)
bionic_openssl: not-affected (code not present)
esm-infra/bionic_openssl: not-affected (code not present)
fips/bionic_openssl: not-affected (code not present)
fips-updates/bionic_openssl: not-affected (code not present)
focal_openssl: not-affected (code not present)
esm-infra/focal_openssl: not-affected (code not present)
fips/focal_openssl: not-affected (code not present)
fips-updates/focal_openssl: not-affected (code not present)
hirsute_openssl: not-affected (code not present)
impish_openssl: not-affected (code not present)
jammy_openssl: released (3.0.1-0ubuntu1)
devel_openssl: released (3.0.1-0ubuntu1)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
esm-infra-legacy/trusty_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: not-affected (code not present)
esm-infra/bionic_openssl1.0: not-affected (code not present)
focal_openssl1.0: DNE
esm-infra/focal_openssl1.0: DNE
hirsute_openssl1.0: DNE
impish_openssl1.0: DNE
jammy_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
trusty_nodejs: ignored (end of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
esm-infra-legacy/trusty_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-infra/focal_nodejs: DNE (focal was not-affected [uses system openssl1.1])
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
hirsute_nodejs: not-affected (uses system openssl1.1)
impish_nodejs: not-affected (uses system openssl1.1)
jammy_nodejs: not-affected (uses system openssl1.1)
esm-apps/jammy_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
upstream_edk2: needs-triage
trusty_edk2: ignored (end of standard support)
trusty/esm_edk2: DNE
esm-infra-legacy/trusty_edk2: DNE
xenial_edk2: not-affected (code not present)
esm-apps/xenial_edk2: not-affected (code not present)
bionic_edk2: not-affected (code not present)
esm-apps/bionic_edk2: not-affected (code not present)
focal_edk2: not-affected (code not present)
esm-infra/focal_edk2: not-affected (code not present)
hirsute_edk2: not-affected (code not present)
impish_edk2: not-affected (code not present)
jammy_edk2: not-affected (code not present)
devel_edk2: not-affected (code not present)
