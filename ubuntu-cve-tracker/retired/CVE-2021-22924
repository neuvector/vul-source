PublicDateAtUSN: 2021-07-21
Candidate: CVE-2021-22924
CRD: 2021-07-21
PublicDate: 2021-08-05 21:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22924
 https://curl.se/docs/CVE-2021-22924.html
 https://ubuntu.com/security/notices/USN-5021-1
Description:
 libcurl keeps previously used connections in a connection pool for
 subsequenttransfers to reuse, if one of them matches the setup.Due to
 errors in the logic, the config matching function did not take 'issuercert'
 into account and it compared the involved paths *case insensitively*,which
 could lead to libcurl reusing wrong connections.File paths are, or can be,
 case sensitive on many systems but not all, and caneven vary depending on
 used file systems.The comparison also didn't include the 'issuer cert'
 which a transfer can setto qualify how to verify the server certificate.
Ubuntu-Description: 
Notes: 
 mdeslaur> introduced in 7.10.4
 rodrigo-zaiden> although the issue was introduced in 7.10.4, versions
 rodrigo-zaiden> earlier than 7.52.0 would need at least parts of commit
 rodrigo-zaiden> cb4e2be7 so the fix for this CVE can be applied. this
 rodrigo-zaiden> change seems quite intrusive and there is a high risk of
 rodrigo-zaiden> regressions. hence, versions earlier than 7.52 will be
 rodrigo-zaiden> ignored.
Mitigation: 
Bugs: 
Priority: medium
Discovered-by: Harry Sintonen
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N [3.7 LOW]


Patches_curl:
 upstream: https://github.com/curl/curl/commit/5ea3145850ebff1dc2b13d17440300a01ca38161
upstream_curl: released (7.78.0)
trusty_curl: ignored (out of standard support)
trusty/esm_curl: ignored (changes too intrusive)
xenial_curl: ignored (out of standard support)
esm-infra/xenial_curl: ignored (changes too intrusive)
bionic_curl: released (7.58.0-2ubuntu3.14)
focal_curl: released (7.68.0-1ubuntu2.6)
groovy_curl: ignored (reached end-of-life)
hirsute_curl: released (7.74.0-1ubuntu2.1)
impish_curl: released (7.74.0-1.2ubuntu4)
jammy_curl: released (7.74.0-1.2ubuntu4)
kinetic_curl: released (7.74.0-1.2ubuntu4)
lunar_curl: released (7.74.0-1.2ubuntu4)
devel_curl: released (7.74.0-1.2ubuntu4)
