PublicDateAtUSN: 2018-02-13
Candidate: CVE-2018-6954
PublicDate: 2018-02-13 20:29:00 UTC
References:
 https://ubuntu.com/security/notices/USN-3816-1
 https://ubuntu.com/security/notices/USN-3816-2
 https://www.cve.org/CVERecord?id=CVE-2018-6954
Description:
 systemd-tmpfiles in systemd through 237 mishandles symlinks present in
 non-terminal path components, which allows local users to obtain ownership
 of arbitrary files via vectors involving creation of a directory and a file
 under that directory, and later replacing that directory with a symlink.
 This occurs even if the fs.protected_symlinks sysctl is turned on.
Ubuntu-Description:
Notes:
 mdeslaur> original fix was incomplete, see second pull
 chrisccoulson> Fix reverted in xenial because it breaks containers running
  on pre-2.6.39 kernels
 mdeslaur> fix was re-introduced in xenial in 229-4ubuntu21.15
Bugs:
 https://github.com/systemd/systemd/issues/7986
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=890779
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]
 cisa-adp: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]
 nvd: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_systemd:
 upstream: https://github.com/systemd/systemd/pull/8358
 upstream: https://github.com/systemd/systemd/pull/8822
 upstream: https://github.com/systemd/systemd/commit/936f6bdb803c432578e2cdcc5f93f3bfff93aff0
upstream_systemd: needs-triage
precise/esm_systemd: DNE
trusty_systemd: not-affected (binary not built)
trusty/esm_systemd: not-affected (binary not built)
esm-infra-legacy/trusty_systemd: not-affected (binary not built)
xenial_systemd: released (229-4ubuntu21.15)
esm-infra/xenial_systemd: not-affected (229-4ubuntu21.15)
artful_systemd: ignored (end of life)
bionic_systemd: released (237-3ubuntu10.9)
esm-infra/bionic_systemd: not-affected (237-3ubuntu10.9)
cosmic_systemd: released (239-7ubuntu10.4)
devel_systemd: released (239-7ubuntu10.4)
