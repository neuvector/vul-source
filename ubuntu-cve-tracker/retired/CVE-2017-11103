PublicDateAtUSN: 2017-07-13
Candidate: CVE-2017-11103
PublicDate: 2017-07-13 13:29:00 UTC
References:
 https://orpheus-lyre.info/
 https://github.com/heimdal/heimdal/commit/6dd3eb836bbb80a00ffced4ad57077a1cdf227ea
 https://www.samba.org/samba/security/CVE-2017-11103.html
 http://www.h5l.org/advisories.html?show=2017-07-11
 https://github.com/heimdal/heimdal/releases/tag/heimdal-7.4.0
 https://www.freebsd.org/security/advisories/FreeBSD-SA-17:05.heimdal.asc
 https://www.orpheus-lyre.info/
 https://ubuntu.com/security/notices/USN-3353-2
 https://ubuntu.com/security/notices/USN-3353-1
 https://ubuntu.com/security/notices/USN-3353-3
 https://ubuntu.com/security/notices/USN-3353-4
 https://www.cve.org/CVERecord?id=CVE-2017-11103
Description:
 Heimdal before 7.4 allows remote attackers to impersonate services with
 Orpheus' Lyre attacks because it obtains service-principal names in a way
 that violates the Kerberos 5 protocol specification. In
 _krb5_extract_ticket() the KDC-REP service name must be obtained from the
 encrypted version stored in 'enc_part' instead of the unencrypted version
 stored in 'ticket'. Use of the unencrypted version provides an opportunity
 for successful server impersonation and other attacks. NOTE: this CVE is
 only for Heimdal and other products that embed Heimdal code; it does not
 apply to other instances in which this part of the Kerberos 5 protocol
 specification is violated.
Ubuntu-Description:
Notes:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=868209
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=868208
Priority: medium
Discovered-by: Jeffrey Altman, Viktor Dukhovni, and Nicolas Williams
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]

Patches_samba:
upstream_samba: needs-triage
precise/esm_samba: not-affected (2:3.6.25-0ubuntu0.12.04.12)
trusty_samba: released (2:4.3.11+dfsg-0ubuntu0.14.04.10)
trusty/esm_samba: released (2:4.3.11+dfsg-0ubuntu0.14.04.10)
esm-infra-legacy/trusty_samba: released (2:4.3.11+dfsg-0ubuntu0.14.04.10)
vivid/ubuntu-core_samba: DNE
xenial_samba: released (2:4.3.11+dfsg-0ubuntu0.16.04.9)
esm-infra/xenial_samba: released (2:4.3.11+dfsg-0ubuntu0.16.04.9)
yakkety_samba: released (2:4.4.5+dfsg-2ubuntu5.8)
zesty_samba: released (2:4.5.8+dfsg-0ubuntu0.17.04.4)
devel_samba: released (2:4.5.8+dfsg-2ubuntu4)

Patches_heimdal:
upstream_heimdal: needs-triage
precise/esm_heimdal: not-affected (1.6~git20120311.dfsg.1-2ubuntu0.2)
trusty_heimdal: released (1.6~git20131207+dfsg-1ubuntu1.2)
trusty/esm_heimdal: released (1.6~git20131207+dfsg-1ubuntu1.2)
esm-infra-legacy/trusty_heimdal: released (1.6~git20131207+dfsg-1ubuntu1.2)
vivid/ubuntu-core_heimdal: ignored (end of life)
xenial_heimdal: released (1.7~git20150920+dfsg-4ubuntu1.16.04.1)
esm-infra/xenial_heimdal: released (1.7~git20150920+dfsg-4ubuntu1.16.04.1)
yakkety_heimdal: released (1.7~git20150920+dfsg-4ubuntu1.16.10.1)
zesty_heimdal: released (7.1.0+dfsg-9ubuntu1.1)
devel_heimdal: not-affected (7.4.0.dfsg.1-1)
