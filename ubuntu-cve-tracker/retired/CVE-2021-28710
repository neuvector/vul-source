Candidate: CVE-2021-28710
PublicDate: 2021-11-21 15:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2021/11/19/9
 https://xenbits.xen.org/xsa/advisory-390.html
 https://xenbits.xenproject.org/xsa/advisory-390.txt
 https://www.cve.org/CVERecord?id=CVE-2021-28710
Description:
 certain VT-d IOMMUs may not work in shared page table mode For efficiency
 reasons, address translation control structures (page tables) may (and, on
 suitable hardware, by default will) be shared between CPUs, for
 second-level translation (EPT), and IOMMUs. These page tables are presently
 set up to always be 4 levels deep. However, an IOMMU may require the use of
 just 3 page table levels. In such a configuration the lop level table needs
 to be stripped before inserting the root table's address into the hardware
 pagetable base register. When sharing page tables, Xen erroneously skipped
 this stripping. Consequently, the guest is able to write to leaf page table
 entries.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: high
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H [8.8 HIGH]

Patches_xen:
-- Tags_xen: universe-binary
upstream_xen: not-affected (debian: Only affects 4.15 series)
trusty_xen: ignored (end of standard support)
trusty/esm_xen: DNE
esm-infra-legacy/trusty_xen: DNE
xenial_xen: not-affected
esm-infra/xenial_xen: not-affected
bionic_xen: not-affected
esm-infra/bionic_xen: not-affected
focal_xen: not-affected
esm-apps/focal_xen: not-affected
hirsute_xen: not-affected
impish_xen: not-affected
jammy_xen: not-affected
esm-apps/jammy_xen: not-affected
devel_xen: not-affected

