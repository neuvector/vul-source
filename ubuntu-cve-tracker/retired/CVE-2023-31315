PublicDateAtUSN: 2024-08-12 13:38:00 UTC
Candidate: CVE-2023-31315
PublicDate: 2024-08-12 13:38:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2023-31315
 https://www.amd.com/en/resources/product-security/bulletin/amd-sb-7014.html
 https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/commit?id=091bd5adf19c7ab01214c64689952acb4833b21d
 https://ioactive.com/event/def-con-talk-amd-sinkclose-universal-ring-2-privilege-escalation/
 https://ubuntu.com/security/notices/USN-7077-1
Description:
 Improper validation in a model specific register (MSR) could allow a
 malicious program with ring0 access to modify SMM configuration while SMI
 lock is enabled, potentially leading to arbitrary code execution.
Ubuntu-Description:
 Enrique Nissim and Krzysztof Okupski discovered that some AMD processors
 did not properly restrict access to the System Management Mode (SMM)
 configuration when the SMM Lock was enabled. A privileged local attacker
 could possibly use this issue to further escalate their privileges and
 execute arbitrary code within the processor's firmware layer.
Notes:
 alexmurray> The affected processors were only released after the LTS period
  for Ubuntu 14.04 finished so there should be no affected machines running
  Ubuntu 14.04 hence this will not be patched in that release.
Mitigation:
Bugs:
Priority: medium
Discovered-by: Enrique Nissim and Krzysztof Okupski
Assigned-to:
CVSS:
 amd: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H [7.5 HIGH]
 cisa-adp: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L [6.8 MEDIUM]

Patches_amd64-microcode:
 upstream: https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/commit?id=091bd5adf19c7ab01214c64689952acb4833b21d
upstream_amd64-microcode: needs-triage
esm-infra-legacy/trusty_amd64-microcode: ignored (processor not supported during LTS)
trusty/esm_amd64-microcode: ignored (end of ESM support, was ignored [processor not supported during LTS])
esm-infra/xenial_amd64-microcode: released (3.20191021.1+really3.20180524.1~ubuntu0.16.04.2+esm3)
esm-infra/bionic_amd64-microcode: released (3.20191021.1+really3.20181128.1~ubuntu0.18.04.1+esm3)
focal_amd64-microcode: released (3.20191218.1ubuntu1.3)
jammy_amd64-microcode: released (3.20191218.1ubuntu2.3)
noble_amd64-microcode: released (3.20231019.1ubuntu2.1)
oracular_amd64-microcode: released (3.20240116.2+nmu1ubuntu1.1)
devel_amd64-microcode: not-affected (3.20240820.1)
