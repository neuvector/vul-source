Candidate: CVE-2021-37713
PublicDate: 2021-08-31 17:15:00 UTC
References:
 https://github.com/npm/node-tar/security/advisories/GHSA-5955-9wpr-37jh
 https://www.npmjs.com/package/tar
 https://www.cve.org/CVERecord?id=CVE-2021-37713
Description:
 The npm package "tar" (aka node-tar) before versions 4.4.18, 5.0.10, and
 6.1.9 has an arbitrary file creation/overwrite and arbitrary code execution
 vulnerability. node-tar aims to guarantee that any file whose location
 would be outside of the extraction target directory is not extracted. This
 is, in part, accomplished by sanitizing absolute paths of entries within
 the archive, skipping archive entries that contain `..` path portions, and
 resolving the sanitized paths against the extraction target directory. This
 logic was insufficient on Windows systems when extracting tar files that
 contained a path that was not an absolute path, but specified a drive
 letter different from the extraction target, such as `C:some\path`. If the
 drive letter does not match the extraction target, for example
 `D:\extraction\dir`, then the result of `path.resolve(extractionDirectory,
 entryPath)` would resolve against the current working directory on the `C:`
 drive, rather than the extraction target directory. Additionally, a `..`
 portion of the path could occur immediately after the drive letter, such as
 `C:../foo`, and was not properly sanitized by the logic that checked for
 `..` within the normalized and split portions of the path. This only
 affects users of `node-tar` on Windows systems. These issues were addressed
 in releases 4.4.18, 5.0.10 and 6.1.9. The v3 branch of node-tar has been
 deprecated and did not receive patches for these issues. If you are still
 using a v3 release we recommend you update to a more recent version of
 node-tar. There is no reasonable way to work around this issue without
 performing the same path normalization procedures that node-tar now does.
 Users are encouraged to upgrade to the latest patched versions of node-tar,
 rather than attempt to sanitize paths themselves.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H [8.6 HIGH]
 github: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N [8.2 HIGH]


Patches_node-tar:
upstream_node-tar: not-affected (debian: Only affects node-tar on Windows)
trusty_node-tar: ignored (end of standard support)
trusty/esm_node-tar: not-affected (debian: Only affects node-tar on Windows)
esm-infra-legacy/trusty_node-tar: not-affected (debian: Only affects node-tar on Windows)
xenial_node-tar: ignored (end of standard support)
esm-apps/xenial_node-tar: not-affected (debian: Only affects node-tar on Windows)
bionic_node-tar: ignored (end of standard support, was needs-triage)
esm-apps/bionic_node-tar: not-affected (debian: Only affects node-tar on Windows)
focal_node-tar: not-affected (debian: Only affects node-tar on Windows)
esm-infra/focal_node-tar: DNE (focal was not-affected [debian: Only affects node-tar on Windows])
esm-apps/focal_node-tar: not-affected (debian: Only affects node-tar on Windows)
hirsute_node-tar: ignored (end of life)
impish_node-tar: ignored (end of life)
jammy_node-tar: not-affected (debian: Only affects node-tar on Windows)
esm-apps/jammy_node-tar: not-affected (debian: Only affects node-tar on Windows)
kinetic_node-tar: ignored (end of life, was needs-triage)
lunar_node-tar: ignored (end of life, was needs-triage)
mantic_node-tar: ignored (end of life, was needs-triage)
noble_node-tar: not-affected (debian: Only affects node-tar on Windows)
esm-apps/noble_node-tar: not-affected (debian: Only affects node-tar on Windows)
devel_node-tar: not-affected (debian: Only affects node-tar on Windows)
