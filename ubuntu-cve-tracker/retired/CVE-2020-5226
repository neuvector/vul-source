Candidate: CVE-2020-5226
PublicDate: 2020-01-24 22:15:00 UTC
References:
 https://github.com/simplesamlphp/simplesamlphp/security/advisories/GHSA-mj9p-v2r8-wf8w
 https://simplesamlphp.org/security/202001-01
 https://www.cve.org/CVERecord?id=CVE-2020-5226
Description:
 Cross-site scripting in SimpleSAMLphp before version 1.18.4. The
 www/erroreport.php script allows error reports to be submitted and sent to
 the system administrator. Starting with SimpleSAMLphp 1.18.0, a new
 SimpleSAML\Utils\EMail class was introduced to handle sending emails,
 implemented as a wrapper of an external dependency. This new wrapper allows
 us to use Twig templates in order to create the email sent with an error
 report. Since Twig provides automatic escaping of variables, manual
 escaping of the free-text field in www/errorreport.php was removed to avoid
 double escaping. However, for those not using the new user interface yet,
 an email template is hardcoded into the class itself in plain PHP. Since no
 escaping is provided in this template, it is then possible to inject HTML
 inside the template by manually crafting the contents of the free-text
 field.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: untriaged
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N [5.4 MEDIUM]
 github: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N [4.4 MEDIUM]


Patches_simplesamlphp:
upstream_simplesamlphp: released (1.18.4-1)
precise/esm_simplesamlphp: DNE
trusty_simplesamlphp: ignored (end of standard support)
trusty/esm_simplesamlphp: DNE
esm-infra-legacy/trusty_simplesamlphp: DNE
xenial_simplesamlphp: not-affected (code not present)
esm-apps/xenial_simplesamlphp: not-affected (code not present)
bionic_simplesamlphp: not-affected (code not present)
esm-apps/bionic_simplesamlphp: not-affected (code not present)
eoan_simplesamlphp: not-affected (code not present)
devel_simplesamlphp: not-affected (1.18.4-1)
