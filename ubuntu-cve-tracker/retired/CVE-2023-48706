PublicDateAtUSN: 2023-11-22 22:15:00 UTC
Candidate: CVE-2023-48706
PublicDate: 2023-11-22 22:15:00 UTC
References:
 https://github.com/vim/vim/security/advisories/GHSA-c8qm-x72m-q53q
 https://github.com/vim/vim/pull/13552
 https://github.com/gandalf4a/crash_report/blob/main/vim/vim_huaf
 http://www.openwall.com/lists/oss-security/2023/11/22/3
 https://ubuntu.com/security/notices/USN-6557-1
 https://www.cve.org/CVERecord?id=CVE-2023-48706
Description:
 Vim is a UNIX editor that, prior to version 9.0.2121, has a
 heap-use-after-free vulnerability. When executing a `:s` command for the
 very first time and using a sub-replace-special atom inside the
 substitution part, it is possible that the recursive `:s` call causes
 free-ing of memory which may later then be accessed by the initial `:s`
 command. The user must intentionally execute the payload and the whole
 process is a bit tricky to do since it seems to work only reliably for the
 very first :s command. It may also cause a crash of Vim. Version 9.0.2121
 contains a fix for this issue.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:H [4.7 MEDIUM]

Patches_vim:
 upstream: https://github.com/vim/vim/commit/26c11c56888d01e298cd8044caf860f3c26f57bb
upstream_vim: released (9.0.2121)
trusty_vim: ignored (end of standard support)
trusty/esm_vim: not-affected (code not present)
esm-infra-legacy/trusty_vim: not-affected (code not present)
xenial_vim: ignored (end of standard support)
esm-infra/xenial_vim: not-affected (code not present)
bionic_vim: ignored (end of standard support)
esm-infra/bionic_vim: not-affected (code not present)
focal_vim: not-affected (code not present)
jammy_vim: released (2:8.2.3995-1ubuntu2.15)
lunar_vim: released (2:9.0.1000-4ubuntu3.3)
mantic_vim: released (2:9.0.1672-1ubuntu2.2)
noble_vim: released (2:9.0.2116-1ubuntu2)
devel_vim: released (2:9.0.2116-1ubuntu2)
