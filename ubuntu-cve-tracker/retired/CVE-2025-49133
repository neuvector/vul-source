PublicDateAtUSN: 2025-06-10 20:15:00 UTC
Candidate: CVE-2025-49133
PublicDate: 2025-06-10 20:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-49133
 https://github.com/stefanberger/libtpms/security/advisories/GHSA-25w5-6fjj-hf8g
 https://trustedcomputinggroup.org/resource/tpm-library-specification
 https://trustedcomputinggroup.org/wp-content/uploads/TPM-2.0-1.83-Part-4-Supporting-Routines-Code.pdf
 https://ubuntu.com/security/notices/USN-7617-1
Description:
 Libtpms is a library that targets the integration of TPM functionality into
 hypervisors, primarily into Qemu. Libtpms, which is derived from the TPM
 2.0 reference implementation code published by the Trusted Computing Group,
 is prone to a potential out of bounds (OOB) read vulnerability. The
 vulnerability occurs in the ‘CryptHmacSign’ function with an inconsistent
 pairing of the signKey and signScheme parameters, where the signKey is
 ALG_KEYEDHASH key and inScheme is an ECC or RSA scheme. The reported
 vulnerability is in the ‘CryptHmacSign’ function, which is defined in the
 "Part 4: Supporting Routines – Code" document, section "7.151 -
 /tpm/src/crypt/CryptUtil.c ". This vulnerability can be triggered from
 user-mode applications by sending malicious commands to a TPM 2.0/vTPM
 (swtpm) whose firmware is based on an affected TCG reference
 implementation. The effect on libtpms is that it will cause an abort due to
 the detection of the out-of-bounds access, thus for example making a vTPM
 (swtpm) unavailable to a VM. This vulnerability is fixed in 0.7.12, 0.8.10,
 0.9.7, and 0.10.1.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1107617
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:N/I:N/A:H [5.9 MEDIUM]

Patches_libtpms:
 upstream: https://github.com/stefanberger/libtpms/commit/04b2d8e9afc0a9b6bffe562a23e58c0de11532d1 (master)
 upstream: https://github.com/stefanberger/libtpms/commit/9f9baccdba9cd3fc32f1355613abd094b21f7ba0 (0.9)
upstream_libtpms: released (0.9.7)
jammy_libtpms: released (0.9.3-0ubuntu1.22.04.2)
noble_libtpms: released (0.9.3-0ubuntu4.24.04.1)
oracular_libtpms: released (0.9.3-0ubuntu4.24.10.1)
plucky_libtpms: released (0.9.3-0ubuntu4.25.04.1)
devel_libtpms: released (0.9.3-0ubuntu5)
