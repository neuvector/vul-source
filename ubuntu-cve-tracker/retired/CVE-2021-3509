PublicDateAtUSN: 2021-05-27 00:15:00 UTC
Candidate: CVE-2021-3509
PublicDate: 2021-05-27 00:15:00 UTC
References: 
 https://www.openwall.com/lists/oss-security/2021/05/14/4
 https://ubuntu.com/security/notices/USN-4998-1
 https://ubuntu.com/security/notices/USN-5128-1
 https://www.cve.org/CVERecord?id=CVE-2021-3509
Description:
 A flaw was found in Red Hat Ceph Storage 4, in the Dashboard component. In
 response to CVE-2020-27839, the JWT token was moved from localStorage to an
 httpOnly cookie. However, token cookies are used in the body of the HTTP
 response for the documentation, which again makes it available to XSS.The
 greatest threat to the system is for confidentiality, integrity, and
 availability.
Ubuntu-Description: 
 Sergey Bobrov discovered that the Ceph dashboard was susceptible to a
 cross-site scripting attack. An attacker could use this to expose
 sensitive information or gain unintended access.
Notes: 
 mdeslaur> this is fixed in 16.2.4 in hirsute-updates but has not been
 mdeslaur> pushed to the security pocket
 sbeattie> incomplete fix for CVE-2020-27839.
Mitigation: 
Bugs: 
Priority: medium
Discovered-by: Sergey Bobrov
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N [6.1 MEDIUM]


Patches_ceph:
 upstream: https://github.com/ceph/ceph/commit/adda853e64bdba1288d46bc7d462d23d8f2f10ca (nautilus)
 upstream: https://github.com/ceph/ceph/commit/7a1ca8d372da3b6a4fc3d221a0e5f72d1d61c27b (octopus)
 upstream: https://github.com/ceph/ceph/commit/af3fffab3b0f13057134d96e5d481e400d8bfd27 (pacific)
upstream_ceph: released (15.2.12)
precise/esm_ceph: ignored (end of life, was needs-triage)
trusty_ceph: ignored (end of standard support)
trusty/esm_ceph: not-affected
esm-infra-legacy/trusty_ceph: not-affected
xenial_ceph: ignored (end of standard support)
esm-infra/xenial_ceph: not-affected
bionic_ceph: not-affected (12.2.13-0ubuntu0.18.04.8)
esm-infra/bionic_ceph: not-affected (12.2.13-0ubuntu0.18.04.8)
focal_ceph: released (15.2.12-0ubuntu0.20.04.1)
esm-infra/focal_ceph: released (15.2.12-0ubuntu0.20.04.1)
groovy_ceph: released (15.2.12-0ubuntu0.20.10.1)
hirsute_ceph: released (16.2.6-0ubuntu0.21.04.2)
impish_ceph: released (16.2.4-0ubuntu1)
jammy_ceph: released (16.2.4-0ubuntu1)
devel_ceph: released (16.2.4-0ubuntu1)
