PublicDateAtUSN: 2023-12-06
Candidate: CVE-2023-45866
PublicDate: 2023-12-08 06:15:00 UTC
CRD: 2023-12-06
References:
 https://github.com/skysafe/reblog/tree/main/cve-2023-45866
 https://ubuntu.com/security/notices/USN-6540-1
 https://www.cve.org/CVERecord?id=CVE-2023-45866
Description:
 Bluetooth HID Hosts in BlueZ may permit an unauthenticated Peripheral role
 HID Device to initiate and establish an encrypted connection, and accept
 HID keyboard reports, potentially permitting injection of HID messages when
 no user interaction has occurred in the Central role to authorize such
 access. An example affected package is bluez 5.64-0ubuntu1 in Ubuntu
 22.04LTS. NOTE: in some cases, a CVE-2020-0556 mitigation would have
 already addressed this Bluetooth HID Hosts issue.
Ubuntu-Description:
 It was discovered that BlueZ did not properly restrict non-bonded
 devices from injecting HID events into the input subsystem. This
 could allow a physically proximate attacker to inject keystrokes
 and execute arbitrary commands whilst the device is discoverable.
Notes:
 eslerm| underlying issue was addressed in CVE-2020-0556, but was
  not enabled and not compliant with Security Mode 4
 eslerm> patch released ahead of public CRD
Mitigation:
  In `/etc/bluetooth/input.conf` set `ClassicBondedOnly=true` and
  then `systemctl restart bluetooth`.
  Setting `ClassicBondedOnly=false` will re-enable legacy device
  support (like the PS3 controller) and the vulnerability.
Bugs:
Priority: medium
Discovered-by: Marc Newlin
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L [6.3 MEDIUM]

Patches_bluez:
 upstream: https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675
upstream_bluez: needs-triage
trusty_bluez: ignored (end of standard support)
xenial_bluez: ignored (end of standard support)
esm-infra/xenial_bluez: released (5.37-0ubuntu5.3+esm3)
bionic_bluez: ignored (end of standard support)
esm-infra/bionic_bluez: released (5.48-0ubuntu3.9+esm1)
focal_bluez: released (5.53-0ubuntu3.7)
esm-infra/focal_bluez: not-affected (5.53-0ubuntu3.7)
jammy_bluez: released (5.64-0ubuntu1.1)
lunar_bluez: released (5.66-0ubuntu1.1)
mantic_bluez: released (5.68-0ubuntu1.1)
noble_bluez: released (5.70-0ubuntu3)
devel_bluez: released (5.70-0ubuntu3)
