Candidate: CVE-2024-27308
PublicDate: 2024-03-06 20:15:00 UTC
References:
 https://rustsec.org/advisories/RUSTSEC-2024-0019.html
 https://github.com/tokio-rs/mio/security/advisories/GHSA-r8w9-5wcg-vfj7
 https://github.com/tokio-rs/tokio/issues/6369
 https://github.com/tokio-rs/mio/pull/1760
 https://github.com/tokio-rs/mio/commit/90d4fe00df870acd3d38f3dc4face9aacab8fbb9
 https://www.cve.org/CVERecord?id=CVE-2024-27308
Description:
 Mio is a Metal I/O library for Rust. When using named pipes on Windows, mio
 will under some circumstances return invalid tokens that correspond to
 named pipes that have already been deregistered from the mio registry. The
 impact of this vulnerability depends on how mio is used. For some
 applications, invalid tokens may be ignored or cause a warning or a crash.
 On the other hand, for applications that store pointers in the tokens, this
 vulnerability may result in a use-after-free. For users of Tokio, this
 vulnerability is serious and can result in a use-after-free in Tokio. The
 vulnerability is Windows-specific, and can only happen if you are using
 named pipes. Other IO resources are not affected. This vulnerability has
 been fixed in mio v0.8.11. All versions of mio between v0.7.2 and v0.8.10
 are vulnerable. Tokio is vulnerable when you are using a vulnerable version
 of mio AND you are using at least Tokio v1.30.0. Versions of Tokio prior to
 v1.30.0 will ignore invalid tokens, so they are not vulnerable. Vulnerable
 libraries that use mio can work around this issue by detecting and ignoring
 invalid tokens.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N [7.5 HIGH]

Patches_rust-mio:
upstream_rust-mio: not-affected (debian: Windows-specific)
focal_rust-mio: not-affected (Windows only)
esm-infra/focal_rust-mio: DNE (focal was not-affected [Windows only])
esm-apps/focal_rust-mio: not-affected (Windows only)
jammy_rust-mio: not-affected (Windows only)
esm-apps/jammy_rust-mio: not-affected (Windows only)
mantic_rust-mio: not-affected (Windows only)
noble_rust-mio: not-affected (Windows only)
esm-apps/noble_rust-mio: not-affected (Windows only)
devel_rust-mio: not-affected (Windows only)

Patches_rust-mio-0.6:
upstream_rust-mio-0.6: not-affected (debian: Vulnerable code not present)
focal_rust-mio-0.6: DNE
esm-infra/focal_rust-mio-0.6: DNE
jammy_rust-mio-0.6: not-affected (code not present)
esm-apps/jammy_rust-mio-0.6: not-affected (code not present)
mantic_rust-mio-0.6: not-affected (code not present)
noble_rust-mio-0.6: not-affected (code not present)
esm-apps/noble_rust-mio-0.6: not-affected (code not present)
devel_rust-mio-0.6: not-affected (code not present)
