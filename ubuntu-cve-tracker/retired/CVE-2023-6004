PublicDateAtUSN: 2024-01-03 17:15:00 UTC
Candidate: CVE-2023-6004
PublicDate: 2024-01-03 17:15:00 UTC
References:
 https://vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html
 https://www.libssh.org/security/advisories/CVE-2023-6004.txt
 https://ubuntu.com/security/notices/USN-6592-1
 https://ubuntu.com/security/notices/USN-6592-2
 https://www.cve.org/CVERecord?id=CVE-2023-6004
Description:
 A flaw was found in libssh. By utilizing the ProxyCommand or ProxyJump
 feature, users can exploit unchecked hostname syntax on the client. This
 issue may allow an attacker to inject malicious code into the command of
 the features mentioned through the hostname parameter.
Ubuntu-Description:
Notes:
 mdeslaur> original patches introduce a regression, see upstream bug
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1059061
 https://gitlab.com/libssh/libssh-mirror/-/issues/227 (regression)
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L [4.8 MEDIUM]
 redhat: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L [4.8 MEDIUM]

Patches_libssh:
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/c2c56bacab00766d01671413321d564227aabf19 (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/a66b4a6eae6614d200a3625862d77565b96a7cd3 (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/8615c24647f773a5e04203c7459512715d698be1 (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/c6180409677c765e6b9ae2b18a3a7a9671ac1dbe (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/9bbb817c0c5434f03613d0783b2ef5f52235b901 (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/22492b69bba22b102342afc574800d354a08e405 (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/d7467498fd988949edde9c6384973250fd454a8b (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/62d3101c1f76b6891b70c50154e0e934d6b8cb57 (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/cea841d71c025f9c998b7d5fc9f2a2839df62921 (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/2c492ee179d5caa2718c5e768bab6e0b2b64a8b0 (libssh-0.10.6)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/1a02364b5107a4125ea3cb76fcdb6beabaebf3be (0.10.x regression fix)
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/6f1b1e76bb38bc89819132e1810e4301ec9034a4 (0.10.x regression fix)
upstream_libssh: released (0.10.6-1)
trusty_libssh: ignored (end of standard support)
xenial_libssh: ignored (end of standard support)
esm-infra/xenial_libssh: released (0.6.3-4.3ubuntu0.6+esm1)
bionic_libssh: ignored (end of standard support)
esm-infra/bionic_libssh: released (0.8.0~20170825.94fa1e38-1ubuntu0.7+esm3)
focal_libssh: released (0.9.3-2ubuntu2.5)
esm-infra/focal_libssh: not-affected (0.9.3-2ubuntu2.5)
jammy_libssh: released (0.9.6-2ubuntu0.22.04.3)
lunar_libssh: released (0.10.4-2ubuntu0.3)
mantic_libssh: released (0.10.5-3ubuntu1.2)
devel_libssh: not-affected (0.10.6-2)
