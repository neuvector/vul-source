PublicDateAtUSN: 2022-04-13 16:15:00 UTC
Candidate: CVE-2015-20107
PublicDate: 2022-04-13 16:15:00 UTC
References:
 https://mail.python.org/archives/list/security-announce@python.org/thread/QDSXNCW77UGULFG2JMDFZQ7H4DIR32LA/
 https://github.com/python/cpython/pull/91542/commits/340251550897cb98ae83ad1040750d6300112e80
 https://github.com/python/cpython/pull/91993
 https://github.com/python/cpython/pull/98191
 https://ubuntu.com/security/notices/USN-5519-1
 https://ubuntu.com/security/notices/USN-5888-1
 https://www.cve.org/CVERecord?id=CVE-2015-20107
 https://ubuntu.com/security/notices/USN-6891-1
Description:
 In Python (aka CPython) up to 3.10.8, the mailcap module does not add
 escape characters into commands discovered in the system mailcap file. This
 may allow attackers to inject shell commands into applications that call
 mailcap.findmatch with untrusted input (if they lack validation of
 user-provided filenames or arguments). The fix is also back-ported to 3.7,
 3.8, 3.9
Ubuntu-Description:
Notes:
 leosilva> patch was proposed in cpython Lib/mailcap.py but not merged yet.
 leosilva> it sounds a better approach was PR to fix that issue, but still
 leosilva> not merged yet.
 leosilva> there are plenty of discussions going on about proper ways to fix
 leosilva> that issue, but none was accept yet that fix the issue and keep
 leosilva> the software working properly.
Mitigation:
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/python3.5/+bug/1510317
 https://github.com/python/cpython/issues/68966
 https://bugs.python.org/issue24778
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L [7.6 HIGH]


Patches_python2.7:
upstream_python2.7: needed
trusty/esm_python2.7: released (2.7.6-8ubuntu0.6+esm11)
esm-infra-legacy/trusty_python2.7: not-affected (2.7.6-8ubuntu0.6+esm11)
esm-infra/xenial_python2.7: released (2.7.12-1ubuntu0~16.04.18+esm2)
trusty_python2.7: ignored (end of standard support)
xenial_python2.7: ignored (end of standard support)
bionic_python2.7: released (2.7.17-1~18.04ubuntu1.8)
esm-infra/bionic_python2.7: not-affected (2.7.17-1~18.04ubuntu1.8)
focal_python2.7: released (2.7.18-1~20.04.3)
esm-infra/focal_python2.7: DNE (focal was released [2.7.18-1~20.04.3])
esm-apps/focal_python2.7: released (2.7.18-1~20.04.3)
impish_python2.7: released (2.7.18-8ubuntu0.2)
jammy_python2.7: released (2.7.18-13ubuntu1.1)
esm-apps/jammy_python2.7: released (2.7.18-13ubuntu1.1)
kinetic_python2.7: released (2.7.18-13ubuntu2)
lunar_python2.7: DNE
mantic_python2.7: DNE
noble_python2.7: DNE
oracular_python2.7: DNE
plucky_python2.7: DNE
devel_python2.7: DNE

Patches_python3.4:
upstream_python3.4: needed
trusty/esm_python3.4: released (3.4.3-1ubuntu1~14.04.7+esm13)
esm-infra-legacy/trusty_python3.4: not-affected (3.4.3-1ubuntu1~14.04.7+esm13)
trusty_python3.4: ignored (end of standard support)
xenial_python3.4: DNE
bionic_python3.4: DNE
focal_python3.4: DNE
esm-infra/focal_python3.4: DNE
impish_python3.4: DNE
jammy_python3.4: DNE
kinetic_python3.4: DNE
lunar_python3.4: DNE
mantic_python3.4: DNE
noble_python3.4: DNE
oracular_python3.4: DNE
plucky_python3.4: DNE
devel_python3.4: DNE

Patches_python3.5:
upstream_python3.5: needed
trusty/esm_python3.5: released (3.5.2-2ubuntu0~16.04.4~14.04.1+esm1)
esm-infra-legacy/trusty_python3.5: not-affected (3.5.2-2ubuntu0~16.04.4~14.04.1+esm1)
esm-infra/xenial_python3.5: released (3.5.2-2ubuntu0~16.04.13+esm3)
trusty_python3.5: ignored (end of standard support)
xenial_python3.5: ignored (end of standard support)
bionic_python3.5: DNE
focal_python3.5: DNE
esm-infra/focal_python3.5: DNE
impish_python3.5: DNE
jammy_python3.5: DNE
kinetic_python3.5: DNE
lunar_python3.5: DNE
mantic_python3.5: DNE
noble_python3.5: DNE
oracular_python3.5: DNE
plucky_python3.5: DNE
devel_python3.5: DNE

Patches_python3.6:
upstream_python3.6: needed
trusty_python3.6: DNE
xenial_python3.6: DNE
bionic_python3.6: released (3.6.9-1~18.04ubuntu1.8)
esm-infra/bionic_python3.6: not-affected (3.6.9-1~18.04ubuntu1.8)
focal_python3.6: DNE
esm-infra/focal_python3.6: DNE
impish_python3.6: DNE
jammy_python3.6: DNE
kinetic_python3.6: DNE
lunar_python3.6: DNE
mantic_python3.6: DNE
noble_python3.6: DNE
oracular_python3.6: DNE
plucky_python3.6: DNE
devel_python3.6: DNE

Patches_python3.7:
upstream_python3.7: needed
trusty_python3.7: DNE
xenial_python3.7: DNE
bionic_python3.7: ignored (end of standard support, was needed)
esm-apps/bionic_python3.7: released (3.7.5-2ubuntu1~18.04.2+esm3)
focal_python3.7: DNE
esm-infra/focal_python3.7: DNE
impish_python3.7: DNE
jammy_python3.7: DNE
kinetic_python3.7: DNE
lunar_python3.7: DNE
mantic_python3.7: DNE
noble_python3.7: DNE
oracular_python3.7: DNE
plucky_python3.7: DNE
devel_python3.7: DNE

Patches_python3.8:
upstream_python3.8: needed
trusty_python3.8: DNE
xenial_python3.8: DNE
bionic_python3.8: ignored (end of standard support, was needed)
esm-apps/bionic_python3.8: released (3.8.0-3ubuntu1~18.04.2+esm2)
focal_python3.8: released (3.8.10-0ubuntu1~20.04.5)
esm-infra/focal_python3.8: not-affected (3.8.10-0ubuntu1~20.04.5)
impish_python3.8: DNE
jammy_python3.8: DNE
kinetic_python3.8: DNE
lunar_python3.8: DNE
mantic_python3.8: DNE
noble_python3.8: DNE
oracular_python3.8: DNE
plucky_python3.8: DNE
devel_python3.8: DNE

Patches_python3.9:
upstream_python3.9: needed
trusty_python3.9: DNE
xenial_python3.9: DNE
bionic_python3.9: DNE
focal_python3.9: ignored (end of standard support, was needed)
esm-infra/focal_python3.9: DNE (focal was needed)
esm-apps/focal_python3.9: released (3.9.5-3ubuntu0~20.04.1+esm1)
impish_python3.9: released (3.9.7-2ubuntu0.1)
jammy_python3.9: DNE
kinetic_python3.9: DNE
lunar_python3.9: DNE
mantic_python3.9: DNE
noble_python3.9: DNE
oracular_python3.9: DNE
plucky_python3.9: DNE
devel_python3.9: DNE

Patches_python3.10:
upstream_python3.10: needed
trusty_python3.10: DNE
xenial_python3.10: DNE
bionic_python3.10: DNE
focal_python3.10: DNE
esm-infra/focal_python3.10: DNE
impish_python3.10: ignored (end of life)
jammy_python3.10: released (3.10.4-3ubuntu0.1)
kinetic_python3.10: not-affected (3.10.6-1)
lunar_python3.10: DNE
mantic_python3.10: DNE
noble_python3.10: DNE
oracular_python3.10: DNE
plucky_python3.10: DNE
devel_python3.10: DNE
