Candidate: CVE-2022-23552
PublicDate: 2023-01-27 23:15:00 UTC
References:
 https://github.com/grafana/grafana/commit/1c8a50b36973bd59a1cc5f34c30de8a9a6a431f0
 https://github.com/grafana/grafana/security/advisories/GHSA-8xmm-x63g-f6xv
 https://github.com/grafana/grafana/commit/8b574e22b53aa4c5a35032a58844fd4aaaa12f5f
 https://github.com/grafana/grafana/commit/c022534e3848a5d45c0b3face23b43aa44e4400a
 https://github.com/grafana/grafana/pull/62143
 https://www.cve.org/CVERecord?id=CVE-2022-23552
Description:
 Grafana is an open-source platform for monitoring and observability.
 Starting with the 8.1 branch and prior to versions 8.5.16, 9.2.10, and
 9.3.4, Grafana had a stored XSS vulnerability affecting the core plugin
 GeoMap. The stored XSS vulnerability was possible because SVG files weren't
 properly sanitized and allowed arbitrary JavaScript to be executed in the
 context of the currently authorized user of the Grafana instance.
 
 An attacker needs to have the Editor role in order to change a panel to
 include either an external URL to a SVG-file containing JavaScript, or use
 the `data:` scheme to load an inline SVG-file containing JavaScript. This
 means that vertical privilege escalation is possible, where a user with
 Editor role can change to a known password for a user having Admin role if
 the user with Admin role executes malicious JavaScript viewing a dashboard.
  
 
 Users may upgrade to version 8.5.16, 9.2.10, or 9.3.4 to receive a fix.
Ubuntu-Description:
Notes:
 alexmurray| Only affectes grafana versions since 8.1
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N [5.4 MEDIUM]
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N [7.3 HIGH]

Patches_grafana:
upstream_grafana: needs-triage
trusty_grafana: ignored (end of standard support)
xenial_grafana: ignored (end of standard support)
bionic_grafana: DNE
focal_grafana: DNE
esm-infra/focal_grafana: DNE
jammy_grafana: DNE
kinetic_grafana: DNE
esm-apps/xenial_grafana: not-affected (code not present)
