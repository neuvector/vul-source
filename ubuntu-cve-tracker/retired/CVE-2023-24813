Candidate: CVE-2023-24813
PublicDate: 2023-02-07 19:15:00 UTC
References:
 https://github.com/dompdf/dompdf/security/advisories/GHSA-56gj-mvh6-rp75
 https://github.com/dompdf/dompdf/commit/95009ea98230f9b084b040c34e3869ef3dccc9aa
 https://www.cve.org/CVERecord?id=CVE-2023-24813
Description:
 Dompdf is an HTML to PDF converter written in php. Due to the difference in
 the attribute parser of Dompdf and php-svg-lib, an attacker can still call
 arbitrary URLs with arbitrary protocols. Dompdf parses the href attribute
 of `image` tags and respects `xlink:href` even if `href` is specified.
 However, php-svg-lib, which is later used to parse the svg file, parses the
 href attribute. Since `href` is respected if both `xlink:href` and `href`
 is specified, it's possible to bypass the protection on the Dompdf side by
 providing an empty `xlink:href` attribute. An attacker can exploit the
 vulnerability to call arbitrary URLs with arbitrary protocols if they
 provide an SVG file to the Dompdf. In PHP versions before 8.0.0, it leads
 to arbitrary unserialize, which will lead, at the very least, to arbitrary
 file deletion and might lead to remote code execution, depending on
 available classes. This vulnerability has been addressed in commit
 `95009ea98` which has been included in release version 2.0.3. Users are
 advised to upgrade. There are no known workarounds for this vulnerability.
Ubuntu-Description:
Notes:
 sbeattie> in Ubuntu versions src/Image/Cache.php is in
   ./include/image_cache.cls.php and does not contain the affected code.
Mitigation:
Bugs:
Priority: high
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H [10.0 CRITICAL]

Patches_php-dompdf:
 upstream: https://github.com/dompdf/dompdf/commit/95009ea98230f9b084b040c34e3869ef3dccc9aa
upstream_php-dompdf: released (2.0.3)
trusty_php-dompdf: not-affected (code not present)
xenial_php-dompdf: not-affected (code not present)
bionic_php-dompdf: not-affected (code not present)
focal_php-dompdf: not-affected (code not present)
jammy_php-dompdf: not-affected (code not present)
kinetic_php-dompdf: not-affected (code not present)
esm-apps/xenial_php-dompdf: not-affected (code not present)
esm-apps/bionic_php-dompdf: not-affected (code not present)
esm-apps/focal_php-dompdf: not-affected (code not present)
esm-apps/jammy_php-dompdf: not-affected (code not present)
lunar_php-dompdf: DNE
devel_php-dompdf: DNE
