PublicDateAtUSN: 2020-02-02 14:15:00 UTC
Candidate: CVE-2019-20446
PublicDate: 2020-02-02 14:15:00 UTC
References:
 https://ubuntu.com/security/notices/USN-4436-1
 https://ubuntu.com/security/notices/USN-4436-2
 https://www.cve.org/CVERecord?id=CVE-2019-20446
Description:
 In xml.rs in GNOME librsvg before 2.46.2, a crafted SVG file with nested
 patterns can cause denial of service when passed to the library for
 processing. The attacker constructs pattern elements so that the number of
 final rendered objects grows exponentially.
Ubuntu-Description:
Notes:
 mdeslaur> also affects older versions written in C
 mdeslaur> The fixes added to 2.40.21 cause a regression, and upstream will
 mdeslaur> not be fixing them.
 rodrigo-zaiden> backporting the missing part of the fix from the 2.46
 rodrigo-zaiden> version (in Rust) to 2.40 (in C) is not trivial and
 rodrigo-zaiden> requires an effort for someone involved in the project.
 rodrigo-zaiden> as of 2022-11-25, there is no new commits in 2.40 branch.
 ccdm94> upstream has released a fix for this issue, and also a new version
 ccdm94> containing said fix (2.40.21). Applying the patch recovered from
 ccdm94> version 2.40.21 caused a regression, as per launchpad bug 1889206,
 ccdm94> and there have been no additional commits in branch 2.40 in the
 ccdm94> last 2 years (last commit in 2020-02-26). In issue 612, upstream
 ccdm94> mentions that they will no longer provide fixes to branch 2.40. 
 ccdm94> They also mention the fix to the regression, available for later
 ccdm94> versions of the code, but backporting it is not viable, as the
 ccdm94> code has been refactored and is now in an entirely different
 ccdm94> programming language. This mean there are no possible commits
 ccdm94> provided that would allow a fix for the regression in releases
 ccdm94> containing the C version of the code. Therefore, this issue will
 ccdm94> be marked as ignored for bionic and earlier. 
Mitigation:
Bugs:
 https://gitlab.gnome.org/GNOME/librsvg/issues/515
 https://bugs.launchpad.net/ubuntu/+source/librsvg/+bug/1889206 (regression)
 https://gitlab.gnome.org/GNOME/librsvg/-/issues/612 (regression)
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H [6.5 MEDIUM]


Patches_librsvg:
 upstream: https://gitlab.gnome.org/GNOME/librsvg/commit/572f95f739529b865e2717664d6fefcef9493135
 upstream: https://gitlab.gnome.org/GNOME/librsvg/commit/27f1f35557515747c423ab780d7b1a2d7a711fa1 (2.40)
upstream_librsvg: released (2.46.4-1, 2.40.21)
precise/esm_librsvg: DNE
trusty_librsvg: ignored (end of standard support)
trusty/esm_librsvg: DNE
esm-infra-legacy/trusty_librsvg: DNE
xenial_librsvg: ignored (end of standard support, was needed)
esm-infra/xenial_librsvg: ignored (see notes)
bionic_librsvg: ignored (end of standard support)
esm-infra/bionic_librsvg: ignored (see notes)
eoan_librsvg: ignored (end of life)
focal_librsvg: not-affected (2.48.7-1ubuntu0.20.04.1)
esm-infra/focal_librsvg: not-affected (2.48.7-1ubuntu0.20.04.1)
groovy_librsvg: not-affected (2.46.4-1ubuntu1)
hirsute_librsvg: not-affected (2.46.4-1ubuntu1)
impish_librsvg: not-affected (2.46.4-1ubuntu1)
jammy_librsvg: not-affected (2.46.4-1ubuntu1)
kinetic_librsvg: not-affected (2.46.4-1ubuntu1)
devel_librsvg: not-affected (2.46.4-1ubuntu1)
