PublicDateAtUSN: 2024-11-06
Candidate: CVE-2024-9681
PublicDate: 2024-11-06 08:15:00 UTC
CRD: 2024-11-06
References:
 https://www.cve.org/CVERecord?id=CVE-2024-9681
 https://curl.se/docs/CVE-2024-9681.html
 https://ubuntu.com/security/notices/USN-7104-1
 https://hackerone.com/reports/2764830
Description:
 When curl is asked to use HSTS, the expiry time for a subdomain might
 overwrite a parent domain's cache entry, making it end sooner or later than
 otherwise intended.
 
 This affects curl using applications that enable HSTS and use URLs with the
 insecure `HTTP://` scheme and perform transfers with hosts like
 `x.example.com` as well as `example.com` where the first host is a
 subdomain
 of the second host.
 
 (The HSTS cache either needs to have been populated manually or there needs
 to
 have been previous HTTPS accesses done as the cache needs to have entries
 for
 the domains involved to trigger this problem.)
 
 When `x.example.com` responds with `Strict-Transport-Security:` headers,
 this
 bug can make the subdomain's expiry timeout *bleed over* and get set for
 the
 parent domain `example.com` in curl's HSTS cache.
 
 The result of a triggered bug is that HTTP accesses to `example.com` get
 converted to HTTPS for a different period of time than what was asked for
 by
 the origin server. If `example.com` for example stops supporting HTTPS at
 its
 expiry time, curl might then fail to access `http://example.com` until the
 (wrongly set) timeout expires. This bug can also expire the parent's entry
 *earlier*, thus making curl inadvertently switch back to insecure HTTP
 earlier
 than otherwise intended.
Ubuntu-Description:
Notes:
 mdeslaur> affects curl 7.74.0 to and including 8.10.1
Mitigation:
Bugs:
Priority: low
 Curl developers have rated this issue as being low severity
Discovered-by: newfunction
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:L [6.5 MEDIUM]
 cisa-adp: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N [5.9 MEDIUM]

Patches_curl:
 upstream: https://github.com/curl/curl/commit/a94973805df96269bf
upstream_curl: released (8.11.0)
esm-infra-legacy/trusty_curl: not-affected (code not present)
trusty/esm_curl: not-affected (code not present)
esm-infra/xenial_curl: not-affected (code not present)
esm-infra/bionic_curl: not-affected (code not present)
focal_curl: not-affected (7.68.0-1ubuntu2.24)
jammy_curl: released (7.81.0-1ubuntu1.19)
noble_curl: released (8.5.0-2ubuntu10.5)
oracular_curl: released (8.9.1-2ubuntu2.1)
devel_curl: not-affected (8.9.1-2ubuntu3)
