PublicDateAtUSN: 2022-05-02 19:15:00 UTC
Candidate: CVE-2021-3750
PublicDate: 2022-05-02 19:15:00 UTC
References:
 https://ubuntu.com/security/notices/USN-5772-1
 https://www.cve.org/CVERecord?id=CVE-2021-3750
Description:
 A DMA reentrancy issue was found in the USB EHCI controller emulation of
 QEMU. EHCI does not verify if the Buffer Pointer overlaps with its MMIO
 region when it transfers the USB packets. Crafted content may be written to
 the controller's registers and trigger undesirable actions (such as reset)
 while the device is still transferring packets. This can ultimately lead to
 a use-after-free issue. A malicious guest could use this flaw to crash the
 QEMU process on the host, resulting in a denial of service condition, or
 potentially execute arbitrary code within the context of the QEMU process
 on the host. This flaw affects QEMU versions before 7.0.0.
Ubuntu-Description:
Notes:
 mdeslaur> Part of the DMA reentrancy issues
Mitigation:
Bugs:
 https://gitlab.com/qemu-project/qemu/-/issues/541
 https://gitlab.com/qemu-project/qemu/-/issues/556
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H [8.2 HIGH]

Patches_qemu:
 upstream: https://lists.nongnu.org/archive/html/qemu-devel/2021-08/msg03692.html
 upstream: https://lists.nongnu.org/archive/html/qemu-devel/2021-12/msg02356.html (newer)
 upstream: https://git.qemu.org/?p=qemu.git;a=commit;h=b9d383ab797f54ae5fa8746117770709921dc529 (1/3)
 upstream: https://git.qemu.org/?p=qemu.git;a=commit;h=58e74682baf4e1ad26b064d8c02e5bc99c75c5d9 (2/3)
 upstream: https://git.qemu.org/?p=qemu.git;a=commit;h=3ab6fdc91b72e156da22848f0003ff4225690ced (3/3)
 upstream: https://gitlab.com/qemu-project/qemu/-/commit/3ab6fdc9
upstream_qemu: needs-triage
trusty_qemu: ignored (end of standard support)
trusty/esm_qemu: not-affected (code not present)
esm-infra-legacy/trusty_qemu: not-affected (code not present)
xenial_qemu: ignored (end of standard support, was deferred)
esm-infra/xenial_qemu: not-affected (code not present)
bionic_qemu: released (1:2.11+dfsg-1ubuntu7.41)
esm-infra/bionic_qemu: not-affected (1:2.11+dfsg-1ubuntu7.41)
focal_qemu: released (1:4.2-3ubuntu6.24)
hirsute_qemu: ignored (end of life)
impish_qemu: ignored (end of life)
jammy_qemu: released (1:6.2+dfsg-2ubuntu6.6)
kinetic_qemu: released (1:7.0+dfsg-7ubuntu1)
devel_qemu: released (1:7.0+dfsg-7ubuntu1)
