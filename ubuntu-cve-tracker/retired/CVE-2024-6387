PublicDateAtUSN: 2024-07-01
Candidate: CVE-2024-6387
PublicDate: 2024-07-01 13:15:00 UTC
CRD: 2024-07-01
References:
 https://www.cve.org/CVERecord?id=CVE-2024-6387
 https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt
 https://ubuntu.com/security/notices/USN-6859-1
 https://ubuntu.com/blog/ubuntu-regresshion-security-fix
Description:
 A security regression (CVE-2006-5051) was discovered in OpenSSH's server
 (sshd). There is a race condition which can lead sshd to handle some
 signals in an unsafe manner. An unauthenticated, remote attacker may be
 able to trigger it by failing to authenticate within a set time period.
Ubuntu-Description:
 It was discovered that OpenSSH incorrectly handled signal management. A
 remote attacker could use this issue to bypass authentication and remotely
 access systems without proper credentials.
Notes:
 seth-arnold> openssh-ssh1 is provided for compatibility with old
   devices that cannot be upgraded to modern protocols. Thus we may
   not provide security support for this package if doing so would
   prevent access to equipment.
 sbeattie> introduced in upstream commit 752250caa ("upstream: revised
   log infrastructure for OpenSSH", 2020-10-16) (v8.5p1)
 sbeattie> essentially a regression of CVE-2006-5051
 sbeattie> Because of a quirk of the 24.04/noble patch to allow
   systemd socket activation, it is believed that that release is
   not vulnerable to the exploitation approach taken by Qualys.
   https://git.launchpad.net/ubuntu/+source/openssh/tree/debian/patches/systemd-socket-activation.patch
Mitigation:
 Set LoginGraceTime to 0 in /etc/ssh/sshd_config. This makes sshd
 vulnerable to a denial of service (the exhaustion of all MaxStartups
 connections), but it makes it safe from this vulnerability.
Bugs:
 https://bugzilla.mindrot.org/show_bug.cgi?id=3690
 https://bugs.launchpad.net/ubuntu/+source/openssh/+bug/2070497
Priority: high
 Potential remote code execution
Discovered-by: Qualys Threat Research Unit (TRU)
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]
 redhat: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]


Patches_openssh:
upstream_openssh: released (9.8p1)
trusty/esm_openssh: not-affected (introduced in v8.5p1)
esm-infra-legacy/trusty_openssh: not-affected (introduced in v8.5p1)
esm-infra/xenial_openssh: not-affected (introduced in v8.5p1)
fips-updates/xenial_openssh: not-affected (introduced in v8.5p1)
fips/xenial_openssh: not-affected (introduced in v8.5p1)
esm-infra/bionic_openssh: not-affected (introduced in v8.5p1)
fips-updates/bionic_openssh: not-affected (introduced in v8.5p1)
fips/bionic_openssh: not-affected (introduced in v8.5p1)
focal_openssh: not-affected (introduced in v8.5p1)
esm-infra/focal_openssh: not-affected (introduced in v8.5p1)
fips-updates/focal_openssh: not-affected (introduced in v8.5p1)
fips/focal_openssh: not-affected (introduced in v8.5p1)
jammy_openssh: released (1:8.9p1-3ubuntu0.10)
mantic_openssh: released (1:9.3p1-1ubuntu3.6)
noble_openssh: released (1:9.6p1-3ubuntu13.3)
devel_openssh: released (1:9.6p1-3ubuntu15)

Patches_openssh-ssh1:
upstream_openssh-ssh1: ignored (frozen on openssh 7.5p)
esm-apps/bionic_openssh-ssh1: not-affected (introduced in v8.5p1)
focal_openssh-ssh1: not-affected (introduced in v8.5p1)
esm-infra/focal_openssh-ssh1: DNE (focal was not-affected [introduced in v8.5p1])
esm-apps/focal_openssh-ssh1: not-affected (introduced in v8.5p1)
jammy_openssh-ssh1: not-affected (introduced in v8.5p1)
esm-apps/jammy_openssh-ssh1: not-affected (introduced in v8.5p1)
mantic_openssh-ssh1: not-affected (introduced in v8.5p1)
noble_openssh-ssh1: not-affected (introduced in v8.5p1)
esm-apps/noble_openssh-ssh1: not-affected (introduced in v8.5p1)
devel_openssh-ssh1: not-affected (introduced in v8.5p1)
