PublicDateAtUSN: 2020-04-15 20:15:00 UTC
Candidate: CVE-2019-12520
PublicDate: 2020-04-15 20:15:00 UTC
References:
 http://www.squid-cache.org/Versions/v4/
 http://www.squid-cache.org/Versions/v4/changesets/
 https://github.com/squid-cache/squid/commits/v4
 https://gitlab.com/jeriko.one/security/-/blob/master/squid/CVEs/CVE-2019-12520.txt
 http://www.squid-cache.org/Advisories/SQUID-2019_4.txt
 https://ubuntu.com/security/notices/USN-4446-1
 https://www.cve.org/CVERecord?id=CVE-2019-12520
Description:
 An issue was discovered in Squid through 4.7 and 5. When receiving a
 request, Squid checks its cache to see if it can serve up a response. It
 does this by making a MD5 hash of the absolute URL of the request. If
 found, it servers the request. The absolute URL can include the decoded
 UserInfo (username and password) for certain protocols. This decoded info
 is prepended to the domain. This allows an attacker to provide a username
 that has special characters to delimit the domain, and treat the rest of
 the URL as a path or query string. An attacker could first make a request
 to their domain using an encoded username, then when a request for the
 target domain comes in that decodes to the exact URL, it will serve the
 attacker's HTML instead of the real HTML. On Squid servers that also act as
 reverse proxies, this allows an attacker to gain access to features that
 only reverse proxies can use, such as ESI.
Ubuntu-Description:
Notes:
 mdeslaur> fixed in Debian's 3.5.23-5+deb9u2
Mitigation:
Bugs:
Priority: medium
Discovered-by: Jeriko One
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]

Patches_squid3:
upstream_squid3: needs-triage
precise/esm_squid3: ignored (end of life, was needs-triage)
trusty_squid3: ignored (end of standard support)
trusty/esm_squid3: DNE
esm-infra-legacy/trusty_squid3: DNE
xenial_squid3: not-affected (code not present)
esm-infra/xenial_squid3: not-affected (code not present)
bionic_squid3: released (3.5.27-1ubuntu1.7)
esm-infra/bionic_squid3: released (3.5.27-1ubuntu1.7)
eoan_squid3: DNE
focal_squid3: DNE
esm-infra/focal_squid3: DNE
groovy_squid3: DNE
hirsute_squid3: DNE
devel_squid3: DNE

Patches_squid:
 upstream: http://www.squid-cache.org/Versions/v4/changesets/SQUID-2019_4.patch
upstream_squid: released (4.8)
precise/esm_squid: DNE
trusty_squid: ignored (end of standard support)
trusty/esm_squid: DNE
esm-infra-legacy/trusty_squid: DNE
xenial_squid: DNE
bionic_squid: DNE
eoan_squid: not-affected (4.8-1ubuntu2.2)
focal_squid: not-affected (4.10-1ubuntu1)
esm-infra/focal_squid: not-affected (4.10-1ubuntu1)
groovy_squid: not-affected (4.10-1ubuntu1)
hirsute_squid: not-affected (4.10-1ubuntu1)
devel_squid: not-affected (4.10-1ubuntu1)
