Candidate: CVE-2024-42367
PublicDate: 2024-08-12 13:38:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-42367
 https://github.com/aio-libs/aiohttp/security/advisories/GHSA-jwhx-xcg6-8xhj
 https://github.com/aio-libs/aiohttp/pull/8653
 https://github.com/aio-libs/aiohttp/commit/ce2e9758814527589b10759a20783fb03b98339f (v3.10.2)
Description:
 aiohttp is an asynchronous HTTP client/server framework for asyncio and
 Python. In versions on the 3.10 branch prior to version 3.10.2, static
 routes which contain files with compressed variants (`.gz` or `.br`
 extension) are vulnerable to path traversal outside the root directory if
 those variants are symbolic links. The server protects static routes from
 path traversal outside the root directory when `follow_symlinks=False`
 (default).  It does this by resolving the requested URL to an absolute path
 and then checking that path relative to the root. However, these checks are
 not performed when looking for compressed variants in the `FileResponse`
 class, and symbolic links are then automatically followed when performing
 the `Path.stat()` and `Path.open()` to send the file. Version 3.10.2
 contains a patch for the issue.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N [4.8 MEDIUM]

Patches_python-aiohttp:
upstream_python-aiohttp: released (3.10.2)
esm-apps/xenial_python-aiohttp: not-affected (code not present)
esm-apps/bionic_python-aiohttp: not-affected (code not present)
focal_python-aiohttp: ignored (end of standard support, was needs-triage)
esm-apps/focal_python-aiohttp: not-affected (code not present)
jammy_python-aiohttp: not-affected (code not present)
esm-apps/jammy_python-aiohttp: not-affected (code not present)
noble_python-aiohttp: not-affected (code not present)
esm-apps/noble_python-aiohttp: not-affected (code not present)
oracular_python-aiohttp: ignored (end of life, was needed)
plucky_python-aiohttp: not-affected (3.10.11-1build1)
devel_python-aiohttp: not-affected (3.11.16-1)
