PublicDateAtUSN: 2024-05-05
Candidate: CVE-2024-4418
PublicDate: 2024-05-08 03:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-4418
 https://ubuntu.com/security/notices/USN-6763-1
Description:
 A race condition leading to a stack use-after-free flaw was found in
 libvirt. Due to a bad assumption in the virNetClientIOEventLoop() method,
 the `data` pointer to a stack-allocated virNetClientIOEventData structure
 ended up being used in the virNetClientIOEventFD callback while the data
 pointer's stack frame was concurrently being "freed" when returning from
 virNetClientIOEventLoop(). The 'virtproxyd' daemon can be used to trigger
 requests. If libvirt is configured with fine-grained access control, this
 issue, in theory, allows a user to escape their otherwise limited access.
 This flaw allows a local, unprivileged user to access virtproxyd without
 authenticating. Remote users would need to authenticate before they could
 access it.
Ubuntu-Description:
Notes:
 mdeslaur> This issue is probably introduced by:
 mdeslaur> https://gitlab.com/libvirt/libvirt/-/commit/7cb03e6a28e465c49f0cabe8fe2e7d21edb5aadf
 mdeslaur> so only noble and higher are affected.
Mitigation:
Bugs:
 https://bugzilla.redhat.com/show_bug.cgi?id=2278616
Priority: medium
Discovered-by: Martin Å irokov
Assigned-to:
CVSS:
 redhat: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [6.2 MEDIUM]

Patches_libvirt:
 upstream: https://gitlab.com/libvirt/libvirt/-/commit/8074d64dc2eca846d6a61efe1a9b7428a0ce1dd1
upstream_libvirt: needs-triage
trusty/esm_libvirt: not-affected (code not present)
esm-infra-legacy/trusty_libvirt: not-affected (code not present)
esm-infra/xenial_libvirt: not-affected (code not present)
esm-infra/bionic_libvirt: not-affected (code not present)
focal_libvirt: not-affected (code not present)
jammy_libvirt: not-affected (code not present)
mantic_libvirt: not-affected (code not present)
noble_libvirt: released (10.0.0-2ubuntu8.2)
oracular_libvirt: released (10.0.0-2ubuntu8.2)
devel_libvirt: released (10.0.0-2ubuntu8.2)
