PublicDateAtUSN: 2018-08-15 18:29:00 UTC
Candidate: CVE-2018-14779
PublicDate: 2018-08-15 18:29:00 UTC
References:
 https://www.x41-dsec.de/lab/advisories/x41-2018-001-Yubico-Piv/
 https://ubuntu.com/security/notices/USN-4276-1
 https://www.cve.org/CVERecord?id=CVE-2018-14779
 https://ubuntu.com/security/notices/USN-4846-1
Description:
 A buffer overflow issue was discovered in the Yubico-Piv 1.5.0 smartcard
 driver. The file lib/ykpiv.c contains the following code in the function
 `ykpiv_transfer_data()`: {% highlight c %} if(*out_len + recv_len - 2 >
 max_out) { fprintf(stderr, "Output buffer to small, wanted to write %lu,
 max was %lu.", *out_len + recv_len - 2, max_out); } if(out_data) {
 memcpy(out_data, data, recv_len - 2); out_data += recv_len - 2; *out_len +=
 recv_len - 2; } {% endhighlight %} -- it is clearly checked whether the
 buffer is big enough to hold the data copied using `memcpy()`, but no error
 handling happens to avoid the `memcpy()` in such cases. This code path can
 be triggered with malicious data coming from a smartcard.
Ubuntu-Description:
 It was discovered that libykpiv, a supporting library of the Yubico PIV
 tool and YubiKey PIV Manager, mishandled specially crafted input. An attacker
 with a custom-made, malicious USB device could potentially execute arbitrary
 code on a computer running the Yubico PIV Tool or Yubikey PIV Manager.
Notes:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=906128
Priority: high
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [6.8 MEDIUM]


Patches_yubico-piv-tool:
upstream_yubico-piv-tool: released (1.6.1-1, 1.4.2-2+deb9u1)
precise/esm_yubico-piv-tool: DNE
trusty_yubico-piv-tool: DNE
trusty/esm_yubico-piv-tool: DNE
esm-infra-legacy/trusty_yubico-piv-tool: DNE
xenial_yubico-piv-tool: ignored (end of standard support, was needed)
esm-apps/xenial_yubico-piv-tool: released (1.0.3-1ubuntu0.1~esm1)
bionic_yubico-piv-tool: released (1.4.2-2ubuntu0.1)
esm-apps/bionic_yubico-piv-tool: released (1.4.2-2ubuntu0.1)
cosmic_yubico-piv-tool: ignored (end of life)
disco_yubico-piv-tool: ignored (end of life)
eoan_yubico-piv-tool: not-affected (1.7.0-1)
focal_yubico-piv-tool: not-affected (1.7.0-1)
esm-infra/focal_yubico-piv-tool: DNE (focal was not-affected [1.7.0-1])
esm-apps/focal_yubico-piv-tool: not-affected (1.7.0-1)
groovy_yubico-piv-tool: not-affected (1.7.0-1)
hirsute_yubico-piv-tool: not-affected (1.7.0-1)
impish_yubico-piv-tool: not-affected (1.7.0-1)
jammy_yubico-piv-tool: not-affected (1.7.0-1)
esm-apps/jammy_yubico-piv-tool: not-affected (1.7.0-1)
devel_yubico-piv-tool: not-affected (1.7.0-1)
