PublicDateAtUSN: 2023-03-17 04:15:00 UTC
Candidate: CVE-2023-28531
PublicDate: 2023-03-17 04:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2023/03/15/8
 https://ubuntu.com/security/notices/USN-6560-1
 https://www.cve.org/CVERecord?id=CVE-2023-28531
Description:
 ssh-add in OpenSSH before 9.3 adds smartcard keys to ssh-agent without the
 intended per-hop destination constraints. The earliest affected version is
 8.9.
Ubuntu-Description:
Notes:
 seth-arnold> openssh-ssh1 is provided for compatibility with old
   devices that cannot be upgraded to modern protocols. Thus we may
   not provide security support for this package if doing so would
   prevent access to equipment.
 sbeattie> introduced in openssh 8.9
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1033166
Priority: low
 Only affects configurations using agent forwarding, smartcard keys, and
 per-hop destination constraints. Policy bypass only.
Discovered-by: Luci Stanescu
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_openssh:
 upstream: https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed
upstream_openssh: released (9.3)
trusty_openssh: not-affected (only affects 8.9 and newer)
trusty/esm_openssh: not-affected (only affects 8.9 and newer)
esm-infra-legacy/trusty_openssh: not-affected (only affects 8.9 and newer)
xenial_openssh: not-affected (only affects 8.9 and newer)
esm-infra/xenial_openssh: not-affected (only affects 8.9 and newer)
fips/xenial_openssh: not-affected (only affects 8.9 and newer)
fips-updates/xenial_openssh: not-affected (only affects 8.9 and newer)
bionic_openssh: not-affected (only affects 8.9 and newer)
esm-infra/bionic_openssh: not-affected (only affects 8.9 and newer)
fips/bionic_openssh: not-affected (only affects 8.9 and newer)
fips-updates/bionic_openssh: not-affected (only affects 8.9 and newer)
focal_openssh: not-affected (only affects 8.9 and newer)
esm-infra/focal_openssh: not-affected (only affects 8.9 and newer)
fips/focal_openssh: not-affected (only affects 8.9 and newer)
fips-updates/focal_openssh: not-affected (only affects 8.9 and newer)
jammy_openssh: released (1:8.9p1-3ubuntu0.5)
kinetic_openssh: ignored (end of life)
lunar_openssh: released (1:9.0p1-1ubuntu8.6)
mantic_openssh: not-affected (1:9.3p1-1ubuntu1)
devel_openssh: not-affected (1:9.3p1-1ubuntu1)

Patches_openssh-ssh1:
upstream_openssh-ssh1: ignored (frozen on openssh 7.5p)
trusty_openssh-ssh1: DNE
xenial_openssh-ssh1: DNE
bionic_openssh-ssh1: not-affected (only affects 8.9 and newer)
focal_openssh-ssh1: not-affected (only affects 8.9 and newer)
jammy_openssh-ssh1: not-affected (only affects 8.9 and newer)
kinetic_openssh-ssh1: not-affected (only affects 8.9 and newer)
esm-apps/bionic_openssh-ssh1: not-affected (only affects 8.9 and newer)
esm-apps/focal_openssh-ssh1: not-affected (only affects 8.9 and newer)
esm-apps/jammy_openssh-ssh1: not-affected (only affects 8.9 and newer)
lunar_openssh-ssh1: not-affected (only affects 8.9 and newer)
mantic_openssh-ssh1: not-affected (only affects 8.9 and newer)
devel_openssh-ssh1: not-affected (only affects 8.9 and newer)
