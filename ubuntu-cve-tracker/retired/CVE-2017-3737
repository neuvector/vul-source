PublicDateAtUSN: 2017-12-07
Candidate: CVE-2017-3737
PublicDate: 2017-12-07 16:29:00 UTC
References: 
 https://www.openssl.org/news/secadv/20171207.txt
 https://ubuntu.com/security/notices/USN-3512-1
 https://www.cve.org/CVERecord?id=CVE-2017-3737
Description:
 OpenSSL 1.0.2 (starting from version 1.0.2b) introduced an "error state"
 mechanism. The intent was that if a fatal error occurred during a handshake
 then OpenSSL would move into the error state and would immediately fail if
 you attempted to continue the handshake. This works as designed for the
 explicit handshake functions (SSL_do_handshake(), SSL_accept() and
 SSL_connect()), however due to a bug it does not work correctly if
 SSL_read() or SSL_write() is called directly. In that scenario, if the
 handshake fails then a fatal error will be returned in the initial function
 call. If SSL_read()/SSL_write() is subsequently called by the application
 for the same SSL object then it will succeed and the data is passed without
 being decrypted/encrypted directly from the SSL/TLS record layer. In order
 to exploit this issue an application bug would have to be present that
 resulted in a call to SSL_read()/SSL_write() being issued after having
 already received a fatal error. OpenSSL version 1.0.2b-1.0.2m are affected.
 Fixed in OpenSSL 1.0.2n. OpenSSL 1.1.0 is not affected.
Ubuntu-Description: 
Notes: 
 leosilva> this issue does not affect OpenSSL 1.1.0
 mdeslaur> 1.0.2b introduced a security hardening mechanism designed to
 mdeslaur> protect against bugs in application code.
 mdeslaur> https://git.openssl.org/?p=openssl.git;a=commit;h=e4f77bf1833245d2b6aa4ce6a16c85e1cdf78589
 mdeslaur> This CVE applies to the hardening mechanism being incomplete.
 mdeslaur> openssl versions older than 1.0.2b don't have the hardening
 mdeslaur> mechanism at all.
Bugs: 
Priority: medium
Discovered-by: David Benjamin
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N [5.9 MEDIUM]

Patches_openssl:
 upstream: https://git.openssl.org/?p=openssl.git;a=commit;h=898fb884b706aaeb283de4812340bb0bde8476dc
 upstream: https://git.openssl.org/?p=openssl.git;a=commit;h=c7383fb5f21aa3451f76bb98bdd5a96b070a2c47 (test)
upstream_openssl: needs-triage
precise/esm_openssl: not-affected (code not present)
trusty_openssl: not-affected (code not present)
trusty/esm_openssl: not-affected (code not present)
esm-infra-legacy/trusty_openssl: not-affected (code not present)
xenial_openssl: released (1.0.2g-1ubuntu4.10)
esm-infra/xenial_openssl: released (1.0.2g-1ubuntu4.10)
zesty_openssl: released (1.0.2g-1ubuntu11.4)
artful_openssl: released (1.0.2g-1ubuntu13.3)
devel_openssl: released (1.0.2n-1ubuntu1)

