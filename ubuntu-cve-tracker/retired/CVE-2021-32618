Candidate: CVE-2021-32618
PublicDate: 2021-05-17 18:15:00 UTC
References:
 https://github.com/Flask-Middleware/flask-security/issues/486
 https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c
 https://www.cve.org/CVERecord?id=CVE-2021-32618
Description:
 The Python "Flask-Security-Too" package is used for adding security
 features to your Flask application. It is an is an independently maintained
 version of Flask-Security based on the 3.0.0 version of Flask-Security. All
 versions of Flask-Security-Too allow redirects after many successful views
 (e.g. /login) by honoring the ?next query param. There is code in FS to
 validate that the url specified in the next parameter is either relative OR
 has the same netloc (network location) as the requesting URL. This check
 utilizes Pythons urlsplit library. However many browsers are very lenient
 on the kind of URL they accept and 'fill in the blanks' when presented with
 a possibly incomplete URL. As a concrete example - setting
 http://login?next=\\\github.com will pass FS's relative URL check however
 many browsers will gladly convert this to http://github.com. Thus an
 attacker could send such a link to an unwitting user, using a legitimate
 site and have it redirect to whatever site they want. This is considered a
 low severity due to the fact that if Werkzeug is used (which is very common
 with Flask applications) as the WSGI layer, it by default ALWAYS ensures
 that the Location header is absolute - thus making this attack vector mute.
 It is possible for application writers to modify this default behavior by
 setting the 'autocorrect_location_header=False`.
Ubuntu-Description:
Notes:
 yomonokio> This CVE is a duplicate of CVE-2021-23385, but for
 yomonokio> flask-security-too (new upstream). In Ubuntu, the
 yomonokio> flask-security source package started to be based
 yomonokio> on flask-security-too starting from mantic, therefore
 yomonokio> we will track only CVE-2021-23385 and mark this one as
 yomonokio> ignored.
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N [6.1 MEDIUM]
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N [3.1 LOW]


Patches_flask-security:
upstream_flask-security: needs-triage
precise/esm_flask-security: DNE
trusty_flask-security: ignored (end of standard support)
trusty/esm_flask-security: DNE
esm-infra-legacy/trusty_flask-security: DNE
xenial_flask-security: ignored (end of standard support)
bionic_flask-security: ignored (end of standard support, was needs-triage)
esm-apps/bionic_flask-security: ignored (see notes)
focal_flask-security: ignored (end of standard support, was ignored [see notes])
esm-infra/focal_flask-security: DNE (focal was ignored [see notes])
esm-apps/focal_flask-security: ignored (see notes)
groovy_flask-security: ignored (end of life)
hirsute_flask-security: ignored (end of life)
impish_flask-security: ignored (end of life)
jammy_flask-security: ignored (see notes)
esm-apps/jammy_flask-security: ignored (see notes)
kinetic_flask-security: ignored (end of life, was needs-triage)
lunar_flask-security: ignored (end of life, was needs-triage)
mantic_flask-security: ignored (end of life, was ignored [see notes])
noble_flask-security: ignored (see notes)
esm-apps/noble_flask-security: ignored (see notes)
devel_flask-security: ignored (see notes)
