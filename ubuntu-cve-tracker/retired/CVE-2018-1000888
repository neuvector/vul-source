PublicDateAtUSN: 2018-12-28
Candidate: CVE-2018-1000888
PublicDate: 2018-12-28 16:29:00 UTC
References:
 https://blog.ripstech.com/2018/new-php-exploitation-technique/
 https://cdn2.hubspot.net/hubfs/3853213/us-18-Thomas-It%27s-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-....pdf
 https://pear.php.net/package/Archive_Tar/download/
 http://blog.pear.php.net/2018/12/20/security-vulnerability-announcement-archive_tar/
 https://ubuntu.com/security/notices/USN-3857-1
 https://www.cve.org/CVERecord?id=CVE-2018-1000888
Description:
 PEAR Archive_Tar version 1.4.3 and earlier contains a CWE-502, CWE-915
 vulnerability in the Archive_Tar class. There are several file operations
 with `$v_header['filename']` as parameter (such as file_exists, is_file,
 is_dir, etc). When extract is called without a specific prefix path, we can
 trigger unserialization by crafting a tar file with
 `phar://[path_to_malicious_phar_file]` as path. Object injection can be
 used to trigger destruct in the loaded PHP classes, e.g. the Archive_Tar
 class itself. With Archive_Tar object injection, arbitrary file deletion
 can occur because `@unlink($this->_temp_tarname)` is called. If another
 class with useful gadget is loaded, it may possible to cause remote code
 execution that can result in files being deleted or possibly modified. This
 vulnerability appears to have been fixed in 1.4.4.
Ubuntu-Description:
Notes:
 mdeslaur> the 1.4.4 release broke symlinks, see:
 mdeslaur> https://pear.php.net/bugs/bug.php?id=23788
 mdeslaur> 1.4.5 was released with symlink fix
 mdeslaur> the regression is unrelated to the fix for this CVE
Bugs:
 https://pear.php.net/bugs/bug.php?id=23782
Priority: medium
Discovered-by: Fariskhi Vidyan
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H [8.8 HIGH]

Patches_php-pear:
 upstream: https://github.com/pear/Archive_Tar/commit/59ace120ac5ceb5f0d36e40e48e1884de1badf76
upstream_php-pear: released (1:1.10.6+submodules+notgz-1.1)
precise/esm_php-pear: DNE
trusty_php-pear: DNE
trusty/esm_php-pear: DNE
esm-infra-legacy/trusty_php-pear: DNE
xenial_php-pear: released (1:1.10.1+submodules+notgz-6ubuntu0.1)
esm-infra/xenial_php-pear: not-affected (1:1.10.1+submodules+notgz-6ubuntu0.1)
bionic_php-pear: released (1:1.10.5+submodules+notgz-1ubuntu1.18.04.1)
esm-infra/bionic_php-pear: not-affected (1:1.10.5+submodules+notgz-1ubuntu1.18.04.1)
cosmic_php-pear: released (1:1.10.5+submodules+notgz-1ubuntu1.18.10.1)
devel_php-pear: released (1:1.10.6+submodules+notgz-1.1)
