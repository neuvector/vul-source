Candidate: CVE-2020-11091
PublicDate: 2020-06-03 23:15:00 UTC
References:
 https://github.com/weaveworks/weave/commit/15f21f1899060f7716c70a8555a084e836f39a60
 https://github.com/weaveworks/weave/security/advisories/GHSA-59qg-grp7-5r73
 https://www.cve.org/CVERecord?id=CVE-2020-11091
Description:
 In Weave Net before version 2.6.3, an attacker able to run a process as
 root in a container is able to respond to DNS requests from the host and
 thereby insert themselves as a fake service. In a cluster with an IPv4
 internal network, if IPv6 is not totally disabled on the host (via
 ipv6.disable=1 on the kernel cmdline), it will be either unconfigured or
 configured on some interfaces, but it's pretty likely that ipv6 forwarding
 is disabled, ie /proc/sys/net/ipv6/conf//forwarding == 0. Also by default,
 /proc/sys/net/ipv6/conf//accept_ra == 1. The combination of these 2 sysctls
 means that the host accepts router advertisements and configure the IPv6
 stack using them. By sending rogue router advertisements, an attacker can
 reconfigure the host to redirect part or all of the IPv6 traffic of the
 host to the attacker controlled container. Even if there was no IPv6
 traffic before, if the DNS returns A (IPv4) and AAAA (IPv6) records, many
 HTTP libraries will try to connect via IPv6 first then fallback to IPv4,
 giving an opportunity to the attacker to respond. If by chance you also
 have on the host a vulnerability like last year's RCE in apt
 (CVE-2019-3462), you can now escalate to the host. Weave Net version 2.6.3
 disables the accept_ra option on the veth devices that it creates.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: untriaged
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:H/A:N [5.8 MEDIUM]
 github: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:H/A:N [5.8 MEDIUM]


Patches_golang-github-weaveworks-mesh-dev:
upstream_golang-github-weaveworks-mesh-dev: needs-triage
precise/esm_golang-github-weaveworks-mesh-dev: DNE
trusty_golang-github-weaveworks-mesh-dev: ignored (end of standard support)
trusty/esm_golang-github-weaveworks-mesh-dev: DNE
esm-infra-legacy/trusty_golang-github-weaveworks-mesh-dev: DNE
xenial_golang-github-weaveworks-mesh-dev: DNE
bionic_golang-github-weaveworks-mesh-dev: DNE
eoan_golang-github-weaveworks-mesh-dev: DNE
focal_golang-github-weaveworks-mesh-dev: DNE
devel_golang-github-weaveworks-mesh-dev: DNE
