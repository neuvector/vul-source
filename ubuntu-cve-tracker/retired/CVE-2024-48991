PublicDateAtUSN: 2024-11-19 16:00:00 UTC
Candidate: CVE-2024-48991
PublicDate: 2024-11-19 18:15:00 UTC
CRD: 2024-11-19 16:00:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-48991
 https://www.qualys.com/2024/11/19/needrestart/needrestart.txt
 https://ubuntu.com/security/notices/USN-7117-1
 https://ubuntu.com/security/notices/USN-7117-2
 https://github.com/liske/needrestart/issues/317
Description:
 Qualys discovered that needrestart, before version 3.8, allows local
 attackers to execute arbitrary code as root by winning a race condition and
 tricking needrestart into running their own, fake Python interpreter
 (instead of the system's real Python interpreter). The initial security fix
 (6ce6136) introduced a regression which was subsequently resolved
 (42af5d3).
Ubuntu-Description:
Notes:
 eslerm| The security fix 6ce6136 ("core: prevent race condition on
 eslerm| /proc/$PID/exec evaluation") introduces regressions. See upstream
 eslerm| issue #317. As of 2024-11-21, no regression fix exists.
 sudhackar| See USN-7117-2 for the regression fix.
Mitigation:
 Edit /etc/needrestart/needrestart.conf so that the following line
 appears after "# Disable interpreter scanners." and reboot:
 $nrconf{interpscan} = 0;
Bugs:
Priority: high
 Local privilege escalation
Discovered-by: Qualys
Assigned-to:
CVSS:
 ubuntu: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]

Patches_needrestart:
 upstream: https://github.com/liske/needrestart/commit/6ce6136cccc307c6b8a0f8cae12f9a22ac2aad59
upstream_needrestart: needed
esm-apps/xenial_needrestart: released (2.6-1ubuntu0.1~esm1)
esm-apps/bionic_needrestart: released (3.1-1ubuntu0.1+esm1)
focal_needrestart: ignored (end of standard support, was needed)
esm-apps/focal_needrestart: released (3.4-6ubuntu0.1+esm1)
jammy_needrestart: released (3.5-5ubuntu2.2)
noble_needrestart: released (3.6-7ubuntu4.3)
oracular_needrestart: released (3.6-8ubuntu4.2)
plucky_needrestart: released (3.6-8ubuntu6)
devel_needrestart: released (3.6-8ubuntu6)
