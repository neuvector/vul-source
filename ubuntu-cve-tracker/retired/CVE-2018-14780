PublicDateAtUSN: 2018-08-15 18:29:00 UTC
Candidate: CVE-2018-14780
PublicDate: 2018-08-15 18:29:00 UTC
References:
 https://www.x41-dsec.de/lab/advisories/x41-2018-001-Yubico-Piv/
 https://ubuntu.com/security/notices/USN-4276-1
 https://www.cve.org/CVERecord?id=CVE-2018-14780
 https://ubuntu.com/security/notices/USN-4846-1
Description:
 An out-of-bounds read issue was discovered in the Yubico-Piv 1.5.0
 smartcard driver. The file lib/ykpiv.c contains the following code in the
 function `_ykpiv_fetch_object()`: {% highlight c %} if(sw == SW_SUCCESS) {
 size_t outlen; int offs = _ykpiv_get_length(data + 1, &outlen); if(offs ==
 0) { return YKPIV_SIZE_ERROR; } memmove(data, data + 1 + offs, outlen);
 *len = outlen; return YKPIV_OK; } else { return YKPIV_GENERIC_ERROR; } {%
 endhighlight %} -- in the end, a `memmove()` occurs with a length retrieved
 from APDU data. This length is not checked for whether it is outside of the
 APDU data retrieved. Therefore the `memmove()` could copy bytes behind the
 allocated data buffer into this buffer.
Ubuntu-Description:
 It was discovered that libykpiv, a supporting library of the Yubico PIV
 tool and YubiKey PIV Manager, mishandled specially crafted input. An attacker
 with a custom-made, malicious USB device could potentially execute arbitrary
 code on a computer running the Yubico PIV Tool or Yubikey PIV Manager.
Notes:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=906128
Priority: high
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [4.6 MEDIUM]


Patches_yubico-piv-tool:
upstream_yubico-piv-tool: released (1.6.1-1)
precise/esm_yubico-piv-tool: DNE
trusty_yubico-piv-tool: DNE
trusty/esm_yubico-piv-tool: DNE
esm-infra-legacy/trusty_yubico-piv-tool: DNE
xenial_yubico-piv-tool: ignored (end of standard support, was needed)
esm-apps/xenial_yubico-piv-tool: released (1.0.3-1ubuntu0.1~esm1)
bionic_yubico-piv-tool: released (1.4.2-2ubuntu0.1)
esm-apps/bionic_yubico-piv-tool: released (1.4.2-2ubuntu0.1)
cosmic_yubico-piv-tool: ignored (end of life)
disco_yubico-piv-tool: ignored (end of life)
eoan_yubico-piv-tool: not-affected (1.7.0-1)
focal_yubico-piv-tool: not-affected (1.7.0-1)
esm-infra/focal_yubico-piv-tool: DNE (focal was not-affected [1.7.0-1])
esm-apps/focal_yubico-piv-tool: not-affected (1.7.0-1)
groovy_yubico-piv-tool: not-affected (1.7.0-1)
hirsute_yubico-piv-tool: not-affected (1.7.0-1)
impish_yubico-piv-tool: not-affected (1.7.0-1)
jammy_yubico-piv-tool: not-affected (1.7.0-1)
esm-apps/jammy_yubico-piv-tool: not-affected (1.7.0-1)
devel_yubico-piv-tool: not-affected (1.7.0-1)
