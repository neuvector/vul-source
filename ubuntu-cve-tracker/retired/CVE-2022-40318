Candidate: CVE-2022-40318
PublicDate: 2023-05-03 12:16:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40318
Description:
 An issue was discovered in bgpd in FRRouting (FRR) through 8.4. By crafting
 a BGP OPEN message with an option of type 0xff (Extended Length from RFC
 9072), attackers may cause a denial of service (assertion failure and
 daemon restart, or out-of-bounds read). This is possible because of
 inconsistent boundary checks that do not account for reading 3 bytes
 (instead of 2) in this 0xff case. NOTE: this behavior occurs in
 bgp_open_option_parse in the bgp_open.c file, a different location (with a
 different attack vector) relative to CVE-2022-40302.
Ubuntu-Description:
Notes:
 mdeslaur> Commits below fix CVE-2022-40302, CVE-2022-40318, CVE-2022-43681
 mdeslaur> Introduced by https://github.com/FRRouting/frr/commit/d08c0c8077fbb3e100ed2e87927edec1a09d224b
Mitigation:
Bugs:
 https://github.com/FRRouting/frr/issues/13480
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1035829
Priority: medium
Discovered-by:
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H [6.5 MEDIUM]

Patches_frr:
 upstream: https://github.com/FRRouting/frr/commit/1117baca3c592877a4d8a13ed6a1d9bd83977487
 upstream: https://github.com/FRRouting/frr/commit/3e46b43e3788f0f87bae56a86b54d412b4710286
 upstream: https://github.com/FRRouting/frr/commit/766eec1b7accffe2c04a5c9ebb14e9f487bb9f78
upstream_frr: needs-triage
trusty_frr: ignored (out of standard support)
xenial_frr: ignored (out of standard support)
bionic_frr: DNE
focal_frr: not-affected (7.2.1-1ubuntu0.2)
esm-apps/focal_frr: not-affected (7.2.1-1ubuntu0.2)
jammy_frr: not-affected (8.1-1ubuntu1.3)
kinetic_frr: not-affected (8.1-1ubuntu3.1)
lunar_frr: not-affected (8.4.2-1ubuntu1)
devel_frr: not-affected (8.4.2-1ubuntu1)
