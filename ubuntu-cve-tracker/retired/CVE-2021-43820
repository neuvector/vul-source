Candidate: CVE-2021-43820
PublicDate: 2021-12-14 19:15:00 UTC
References:
 https://github.com/haiwen/seafile-server/security/advisories/GHSA-m3wc-jv6r-hvv8
 https://github.com/haiwen/seafile-server/pull/520
 https://www.cve.org/CVERecord?id=CVE-2021-43820
Description:
 Seafile is an open source cloud storage system. A sync token is used in
 Seafile file syncing protocol to authorize access to library data. To
 improve performance, the token is cached in memory in seaf-server. Upon
 receiving a token from sync client or SeaDrive client, the server checks
 whether the token exist in the cache. However, if the token exists in
 cache, the server doesn't check whether it's associated with the specific
 library in the URL. This vulnerability makes it possible to use any valid
 sync token to access data from any **known** library. Note that the
 attacker has to first find out the ID of a library which it has no access
 to. The library ID is a random UUID, which is not possible to be guessed.
 There are no workarounds for this issue.
Ubuntu-Description:
Notes:
 ebarretto> seafile-server only
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N [5.9 MEDIUM]
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N [7.4 HIGH]


Patches_seafile:
upstream_seafile: not-affected (see notes)
trusty_seafile: ignored (end of standard support)
xenial_seafile: ignored (end of standard support)
bionic_seafile: not-affected
esm-apps/bionic_seafile: not-affected
focal_seafile: not-affected
esm-infra/focal_seafile: DNE (focal was not-affected)
esm-apps/focal_seafile: not-affected
hirsute_seafile: not-affected
impish_seafile: not-affected
jammy_seafile: not-affected
esm-apps/jammy_seafile: not-affected
devel_seafile: not-affected
