PublicDateAtUSN: 2018-11-25 10:29:00 UTC
Candidate: CVE-2018-19518
PublicDate: 2018-11-25 10:29:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2018/11/22/3
 https://antichat.com/threads/463395/#post-4254681
 https://github.com/Bo0oM/PHP_imap_open_exploit/blob/master/exploit.php
 https://ubuntu.com/security/notices/USN-4160-1
 https://www.cve.org/CVERecord?id=CVE-2018-19518
Description:
 University of Washington IMAP Toolkit 2007f on UNIX, as used in imap_open()
 in PHP and other products, launches an rsh command (by means of the
 imap_rimap function in c-client/imap4r1.c and the tcp_aopen function in
 osdep/unix/tcp_unix.c) without preventing argument injection, which might
 allow remote attackers to execute arbitrary OS commands if the IMAP server
 name is untrusted input (e.g., entered by a user of a web application) and
 if rsh has been replaced by a program with different argument semantics.
 For example, if rsh is a link to ssh (as seen on Debian and Ubuntu
 systems), then the attack can use an IMAP server name containing a
 "-oProxyCommand" argument.
Ubuntu-Description:
 It was discovered that UW IMAP incorrectly handled inputs. A remote attacker
 could possibly use this issue to execute arbitrary OS commands.
Notes:
 mdeslaur> php5 in precise and trusty doesn't build imap, it is in a
 mdeslaur> separate php-imap source package.
 msalvatore> uw-imap has been defunct since 2008.
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=914632
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=913775
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=913835
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=913836
 https://bugs.launchpad.net/ubuntu/+source/php7.2/+bug/1803657
 https://bugs.php.net/bug.php?id=76428
 https://bugs.php.net/bug.php?id=77153
 https://bugs.php.net/bug.php?id=77160
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H [7.5 HIGH]
 nvd: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H [7.5 HIGH]

Patches_php5:
upstream_php5: needs-triage
precise/esm_php5: not-affected (code not present)
trusty_php5: not-affected (code not present)
trusty/esm_php5: not-affected (code not present)
esm-infra-legacy/trusty_php5: not-affected (code not present)
xenial_php5: DNE
bionic_php5: DNE
cosmic_php5: DNE
disco_php5: DNE
eoan_php5: DNE
focal_php5: DNE
esm-infra/focal_php5: DNE
groovy_php5: DNE
hirsute_php5: DNE
impish_php5: DNE
jammy_php5: DNE
devel_php5: DNE

Patches_php-imap:
upstream_php-imap: needs-triage
precise/esm_php-imap: DNE
trusty_php-imap: released (5.4.6-0ubuntu5.1)
trusty/esm_php-imap: not-affected (5.4.6-0ubuntu5.1)
esm-infra-legacy/trusty_php-imap: not-affected (5.4.6-0ubuntu5.1)
xenial_php-imap: DNE
bionic_php-imap: DNE
cosmic_php-imap: DNE
disco_php-imap: DNE
eoan_php-imap: DNE
focal_php-imap: DNE
esm-infra/focal_php-imap: DNE
groovy_php-imap: DNE
hirsute_php-imap: DNE
impish_php-imap: DNE
jammy_php-imap: DNE
devel_php-imap: DNE

Patches_php7.0:
Tags_php7.0: universe-binary
upstream_php7.0: released (7.0.33)
precise/esm_php7.0: DNE
trusty_php7.0: DNE
trusty/esm_php7.0: DNE
esm-infra-legacy/trusty_php7.0: DNE
xenial_php7.0: released (7.0.33-0ubuntu0.16.04.1)
esm-infra/xenial_php7.0: not-affected (7.0.33-0ubuntu0.16.04.1)
bionic_php7.0: DNE
cosmic_php7.0: DNE
disco_php7.0: DNE
eoan_php7.0: DNE
focal_php7.0: DNE
esm-infra/focal_php7.0: DNE
groovy_php7.0: DNE
hirsute_php7.0: DNE
impish_php7.0: DNE
jammy_php7.0: DNE
devel_php7.0: DNE

Patches_php7.2:
Tags_php7.2: universe-binary
upstream_php7.2: released (7.2.13)
precise/esm_php7.2: DNE
trusty_php7.2: DNE
trusty/esm_php7.2: DNE
esm-infra-legacy/trusty_php7.2: DNE
xenial_php7.2: DNE
bionic_php7.2: released (7.2.15-0ubuntu0.18.04.1)
esm-infra/bionic_php7.2: not-affected (7.2.15-0ubuntu0.18.04.1)
cosmic_php7.2: released (7.2.15-0ubuntu0.18.20.1)
disco_php7.2: released (7.2.15-0ubuntu2)
eoan_php7.2: DNE
focal_php7.2: DNE
esm-infra/focal_php7.2: DNE
groovy_php7.2: DNE
hirsute_php7.2: DNE
impish_php7.2: DNE
jammy_php7.2: DNE
devel_php7.2: DNE

Patches_uw-imap:
upstream_uw-imap: released (8:2007f~dfsg-6)
precise/esm_uw-imap: DNE
trusty_uw-imap: ignored (end of standard support)
trusty/esm_uw-imap: released (8:2007f~dfsg-2ubuntu0.1~esm1)
esm-infra-legacy/trusty_uw-imap: not-affected (8:2007f~dfsg-2ubuntu0.1~esm1)
xenial_uw-imap: released (8:2007f~dfsg-4+deb8u1build0.16.04.1)
esm-apps/xenial_uw-imap: released (8:2007f~dfsg-4+deb8u1build0.16.04.1)
bionic_uw-imap: released (8:2007f~dfsg-5ubuntu0.18.04.2)
esm-apps/bionic_uw-imap: released (8:2007f~dfsg-5ubuntu0.18.04.2)
cosmic_uw-imap: ignored (end of life)
disco_uw-imap: released (8:2007f~dfsg-5ubuntu0.19.04.2)
eoan_uw-imap: not-affected (8:2007f~dfsg-6)
focal_uw-imap: not-affected (8:2007f~dfsg-6)
esm-apps/focal_uw-imap: not-affected (8:2007f~dfsg-6)
groovy_uw-imap: not-affected (8:2007f~dfsg-6)
hirsute_uw-imap: not-affected (8:2007f~dfsg-6)
impish_uw-imap: not-affected (8:2007f~dfsg-6)
jammy_uw-imap: not-affected (8:2007f~dfsg-6)
esm-apps/jammy_uw-imap: not-affected (8:2007f~dfsg-6)
devel_uw-imap: not-affected (8:2007f~dfsg-6)

Patches_php7.3:
 upstream: http://git.php.net/?p=php-src.git;a=commit;h=336d2086a9189006909ae06c7e95902d7d5ff77e
Tags_php7.3: universe-binary
upstream_php7.3: released (7.3.0)
precise/esm_php7.3: DNE
trusty_php7.3: DNE
trusty/esm_php7.3: DNE
esm-infra-legacy/trusty_php7.3: DNE
xenial_php7.3: DNE
bionic_php7.3: DNE
cosmic_php7.3: DNE
disco_php7.3: DNE
eoan_php7.3: not-affected (7.3.4-2)
focal_php7.3: DNE
esm-infra/focal_php7.3: DNE
groovy_php7.3: DNE
hirsute_php7.3: DNE
impish_php7.3: DNE
jammy_php7.3: DNE
devel_php7.3: DNE
