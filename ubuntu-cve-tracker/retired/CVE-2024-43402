Candidate: CVE-2024-43402
PublicDate: 2024-09-04 16:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-43402
 https://github.com/rust-lang/rust/security/advisories/GHSA-2xg3-7mm6-98jj
 https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html
 https://learn.microsoft.com/en-us/troubleshoot/windows-client/shell-experience/file-folder-name-whitespace-characters
Description:
 Rust is a programming language. The fix for CVE-2024-24576, where
 `std::process::Command` incorrectly escaped arguments when invoking batch
 files on Windows, was incomplete. Prior to Rust version 1.81.0, it was
 possible to bypass the fix when the batch file name had trailing whitespace
 or periods (which are ignored and stripped by Windows). To determine
 whether to apply the `cmd.exe` escaping rules, the original fix for the
 vulnerability checked whether the command name ended with `.bat` or `.cmd`.
 At the time that seemed enough, as we refuse to invoke batch scripts with
 no file extension. Windows removes trailing whitespace and periods when
 parsing file paths. For example, `.bat. .` is interpreted by Windows as
 `.bat`, but the original fix didn't check for that. Affected users who are
 using Rust 1.77.2 or greater can remove the trailing whitespace (ASCII
 0x20) and trailing periods (ASCII 0x2E) from the batch file name to bypass
 the incomplete fix and enable the mitigations. Users are affected if their
 code or one of their dependencies invoke a batch script on Windows with
 trailing whitespace or trailing periods in the name, and pass untrusted
 arguments to it. Rust 1.81.0 will update the standard library to apply the
 CVE-2024-24576 mitigations to all batch files invocations, regardless of
 the trailing chars in the file name.
Ubuntu-Description:
Notes:
 sbeattie> cargo in mantic was merged into rustc
 leosilva> not affect us, only windows vulnerability
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H [8.8 HIGH]
 github: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H [8.1 HIGH]


Patches_rustc:
upstream_rustc: needs-triage
esm-infra-legacy/trusty_rustc: not-affected (window only)
trusty/esm_rustc: not-affected (window only)
esm-apps/xenial_rustc: not-affected (window only)
esm-apps/bionic_rustc: not-affected (window only)
focal_rustc: not-affected (window only)
esm-infra/focal_rustc: DNE (focal was not-affected [window only])
esm-apps/focal_rustc: not-affected (window only)
jammy_rustc: not-affected (window only)
noble_rustc: not-affected (window only)
devel_rustc: DNE

Patches_cargo:
upstream_cargo: not-affected (window only)
esm-apps/xenial_cargo: not-affected (window only)
esm-apps/bionic_cargo: not-affected (window only)
focal_cargo: not-affected (window only)
esm-infra/focal_cargo: DNE (focal was not-affected [window only])
esm-apps/focal_cargo: not-affected (window only)
jammy_cargo: not-affected (window only)
esm-apps/jammy_cargo: not-affected (window only)
noble_cargo: DNE
devel_cargo: DNE
