PublicDateAtUSN: 2018-01-24
Candidate: CVE-2018-1000005
PublicDate: 2018-01-24 22:29:00 UTC
References:
 https://github.com/curl/curl/pull/2231
 https://curl.haxx.se/docs/adv_2018-824a.html
 https://ubuntu.com/security/notices/USN-3554-1
 https://www.cve.org/CVERecord?id=CVE-2018-1000005
Description:
 libcurl 7.49.0 to and including 7.57.0 contains an out bounds read in code
 handling HTTP/2 trailers. It was reported
 (https://github.com/curl/curl/pull/2231) that reading an HTTP/2 trailer
 could mess up future trailers since the stored size was one byte less than
 required. The problem is that the code that creates HTTP/1-like headers
 from the HTTP/2 trailer data once appended a string like `:` to the target
 buffer, while this was recently changed to `: ` (a space was added after
 the colon) but the following math wasn't updated correspondingly. When
 accessed, the data is read out of bounds and causes either a crash or that
 the (too large) data gets passed to client write. This could lead to a
 denial-of-service situation or an information disclosure if someone has a
 service that echoes back or uses the trailers for something.
Ubuntu-Description:
 leosilva> vulnerability code was introduced after version 7.47
 leosilva> trusty and precise/esm are not-affected.
Notes:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H [9.1 CRITICAL]


Patches_curl:
 other: https://github.com/curl/curl/commit/fa3dbb9a147488a294.patch
upstream_curl: released (7.58.0-1)
precise/esm_curl: not-affected
trusty_curl: not-affected
trusty/esm_curl: not-affected
esm-infra-legacy/trusty_curl: not-affected
xenial_curl: released (7.47.0-1ubuntu2.6)
esm-infra/xenial_curl: released (7.47.0-1ubuntu2.6)
artful_curl: released (7.55.1-1ubuntu2.3)
devel_curl: not-affected (7.58.0-2ubuntu1)
