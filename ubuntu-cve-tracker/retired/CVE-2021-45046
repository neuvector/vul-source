PublicDateAtUSN: 2021-12-14 16:30:00 UTC
Candidate: CVE-2021-45046
PublicDate: 2021-12-14 19:15:00 UTC
References:
 https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Log4Shell
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046
 https://www.openwall.com/lists/oss-security/2021/12/14/4
 https://lists.apache.org/thread/83y7dx5xvn3h5290q1twn16tltolv88f
 https://issues.apache.org/jira/browse/LOG4J2-3221
 https://ubuntu.com/security/notices/USN-5197-1
Description:
 It was found that the fix to address CVE-2021-44228 in Apache Log4j 2.15.0
 was incomplete in certain non-default configurations. This could allows
 attackers with control over Thread Context Map (MDC) input data when the
 logging configuration uses a non-default Pattern Layout with either a
 Context Lookup (for example, $${ctx:loginId}) or a Thread Context Map
 pattern (%X, %mdc, or %MDC) to craft malicious input data using a JNDI
 Lookup pattern resulting in an information leak and remote code execution
 in some environments and local code execution in all environments. Log4j
 2.16.0 (Java 8) and 2.12.2 (Java 7) fix this issue by removing support for
 message lookup patterns and disabling JNDI functionality by default.
Ubuntu-Description:
Notes:
 alexmurray| Ubuntu 18.04 LTS is not affected since the JndiLookup.class was
  removed in the previous update for CVE-2021-44228
 ebarretto> above is also true for Ubuntu 16.04 ESM
Mitigation:
Bugs:
Priority: high
Discovered-by:
Assigned-to: pfsmorigo
CVSS:
 asf: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L [3.7 LOW]
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H [9.0 CRITICAL]


Patches_apache-log4j2:
upstream_apache-log4j2: needed
trusty_apache-log4j2: ignored (out of standard support)
trusty/esm_apache-log4j2: DNE
xenial_apache-log4j2: ignored (out of standard support)
esm-infra/xenial_apache-log4j2: not-affected (code not present)
bionic_apache-log4j2: not-affected (code not present)
esm-apps/bionic_apache-log4j2: not-affected (code not present)
focal_apache-log4j2: released (2.16.0-0.20.04.1)
esm-apps/focal_apache-log4j2: released (2.16.0-0.20.04.1)
hirsute_apache-log4j2: released (2.16.0-0.21.04.1)
impish_apache-log4j2: released (2.16.0-0.21.10.1)
jammy_apache-log4j2: not-affected (2.16.0-1)
esm-apps/jammy_apache-log4j2: not-affected (2.16.0-1)
devel_apache-log4j2: not-affected (2.16.0-1)
