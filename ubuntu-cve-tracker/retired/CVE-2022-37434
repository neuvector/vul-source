PublicDateAtUSN: 2022-08-05 07:15:00 UTC
Candidate:CVE-2022-37434
PublicDate: 2022-08-05 07:15:00 UTC
References:
 https://github.com/ivd38/zlib_overflow
 https://ubuntu.com/security/notices/USN-5570-1
 https://ubuntu.com/security/notices/USN-5573-1
 https://ubuntu.com/security/notices/USN-5570-2
 https://www.cve.org/CVERecord?id=CVE-2022-37434
 https://ubuntu.com/security/notices/USN-6736-1
 https://ubuntu.com/security/notices/USN-6736-2
Description:
 zlib through 1.2.12 has a heap-based buffer over-read or buffer overflow in
 inflate in inflate.c via a large gzip header extra field. NOTE: only
 applications that call inflateGetHeader are affected. Some common
 applications bundle the affected zlib source code but may be unable to call
 inflateGetHeader (e.g., see the nodejs/node reference).
Ubuntu-Description:
Notes:
 mdeslaur> Since 3.1.3-7, rsync builds with the system zlib.
 mdeslaur> Apps are only vulnerable if they use inflateGetHeader() and
 mdeslaur> call inflate() in a loop.
 mdeslaur> This fix caused a regression, see:
 mdeslaur> https://www.openwall.com/lists/oss-security/2022/08/09/1
 mdeslaur> https://github.com/curl/curl/issues/9271
 mdeslaur> The second commit below fixes the regression.
Mitigation: 
Bugs: 
Priority: medium
Discovered-by: Evgeny Legerov
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]


Patches_zlib:
 upstream: https://github.com/madler/zlib/commit/eff308af425b67093bab25f80f1ae950166bece1
 upstream: https://github.com/madler/zlib/commit/1eb7682f845ac9e9bf9ae35bbfb3bad5dacbd91d
upstream_zlib: released (1.2.13, 1:1.2.11.dfsg-4.1)
trusty_zlib: ignored (end of standard support)
trusty/esm_zlib: released (1:1.2.8.dfsg-1ubuntu1.1+esm2)
esm-infra-legacy/trusty_zlib: not-affected (1:1.2.8.dfsg-1ubuntu1.1+esm2)
xenial_zlib: ignored (end of standard support)
esm-infra/xenial_zlib: released (1:1.2.8.dfsg-2ubuntu4.3+esm2)
bionic_zlib: released (1:1.2.11.dfsg-0ubuntu2.2)
esm-infra/bionic_zlib: not-affected (1:1.2.11.dfsg-0ubuntu2.2)
focal_zlib: released (1:1.2.11.dfsg-2ubuntu1.5)
esm-infra/focal_zlib: not-affected (1:1.2.11.dfsg-2ubuntu1.5)
jammy_zlib: released (1:1.2.11.dfsg-2ubuntu9.2)
kinetic_zlib: not-affected (1:1.2.11.dfsg-4.1ubuntu1)
mantic_zlib: not-affected (1:1.2.11.dfsg-4.1ubuntu1)
noble_zlib: not-affected (1:1.2.11.dfsg-4.1ubuntu1)
devel_zlib: not-affected (1:1.2.11.dfsg-4.1ubuntu1)

Patches_rsync:
 upstream: https://github.com/WayneD/rsync/commit/788f11ea6afeb96f0d84f140192165a1ca12ade4
 upstream: https://github.com/WayneD/rsync/commit/9e2921fce8c518e370c324407d35bc83ba12f2d5
upstream_rsync: needs-triage
trusty_rsync: ignored (end of standard support)
trusty/esm_rsync: not-affected (uses system zlib)
esm-infra-legacy/trusty_rsync: not-affected (uses system zlib)
xenial_rsync: ignored (end of standard support)
esm-infra/xenial_rsync: released (3.1.1-3ubuntu1.3+esm2)
bionic_rsync: released (3.1.2-2.1ubuntu1.5)
esm-infra/bionic_rsync: not-affected (3.1.2-2.1ubuntu1.5)
focal_rsync: released (3.1.3-8ubuntu0.4)
esm-infra/focal_rsync: not-affected (3.1.3-8ubuntu0.4)
jammy_rsync: not-affected (uses system zlib)
kinetic_rsync: not-affected (uses system zlib)
mantic_rsync: not-affected (uses system zlib)
noble_rsync: not-affected (uses system zlib)
devel_rsync: not-affected (uses system zlib)

Patches_klibc:
upstream_klibc: needs-triage
trusty/esm_klibc: released (2.0.3-0ubuntu1.14.04.3+esm3)
esm-infra-legacy/trusty_klibc: not-affected (2.0.3-0ubuntu1.14.04.3+esm3)
esm-infra/xenial_klibc: released (2.0.4-8ubuntu1.16.04.4+esm2)
esm-infra/bionic_klibc: released (2.0.4-9ubuntu2.2+esm1)
focal_klibc: released (2.0.7-1ubuntu5.2)
esm-infra/focal_klibc: not-affected (2.0.7-1ubuntu5.2)
jammy_klibc: released (2.0.10-4ubuntu0.1)
mantic_klibc: released (2.0.13-1ubuntu0.1)
noble_klibc: released (2.0.13-4ubuntu0.1)
devel_klibc: released (2.0.13-4ubuntu1)
