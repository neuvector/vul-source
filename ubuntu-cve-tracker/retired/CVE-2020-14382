PublicDateAtUSN: 2020-09-03 00:00:00 UTC
Candidate: CVE-2020-14382
PublicDate: 2020-09-16 15:15:00 UTC
References:
 https://gitlab.com/cryptsetup/cryptsetup/-/merge_requests/102
 https://ubuntu.com/security/notices/USN-4493-1
 https://www.cve.org/CVERecord?id=CVE-2020-14382
Description:
 A vulnerability was found in upstream release cryptsetup-2.2.0 where,
 there's a bug in LUKS2 format validation code, that is effectively invoked
 on every device/image presenting itself as LUKS2 container. The bug is in
 segments validation code in file 'lib/luks2/luks2_json_metadata.c' in
 function hdr_validate_segments(struct crypt_device *cd, json_object
 *hdr_jobj) where the code does not check for possible overflow on memory
 allocation used for intervals array (see statement "intervals =
 malloc(first_backup * sizeof(*intervals));"). Due to the bug, library can
 be *tricked* to expect such allocation was successful but for far less
 memory then originally expected. Later it may read data FROM image crafted
 by an attacker and actually write such data BEYOND allocated memory.
Ubuntu-Description:
Notes:
 debian> Introduced with v2.2.0-rc0 with a7f80a27701450e40ef37e2224577f1a0c98cf0f
Mitigation:
Bugs:
 https://bugzilla.redhat.com/show_bug.cgi?id=1874712
Priority: medium
Discovered-by: Tobias Stoeckmann
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_cryptsetup:
 upstream: https://gitlab.com/cryptsetup/cryptsetup/-/commit/52f5cb8cedf22fb3e14c744814ec8af7614146c7
upstream_cryptsetup: needs-triage
precise/esm_cryptsetup: not-affected (code not present)
trusty_cryptsetup: ignored (end of standard support)
trusty/esm_cryptsetup: not-affected (code not present)
esm-infra-legacy/trusty_cryptsetup: not-affected (code not present)
xenial_cryptsetup: not-affected (code not present)
esm-infra/xenial_cryptsetup: not-affected (code not present)
bionic_cryptsetup: not-affected (code not present)
esm-infra/bionic_cryptsetup: not-affected (code not present)
focal_cryptsetup: released (2:2.2.2-3ubuntu2.2)
devel_cryptsetup: released (2:2.3.3-1ubuntu5)
