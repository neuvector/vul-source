Candidate: CVE-2024-3661
PublicDate: 2024-05-06 19:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-3661
 https://datatracker.ietf.org/doc/html/rfc2131#section-7
 https://datatracker.ietf.org/doc/html/rfc3442#section-7
 https://tunnelvisionbug.com/
 https://www.leviathansecurity.com/research/tunnelvision
 https://news.ycombinator.com/item?id=40279632
 https://arstechnica.com/security/2024/05/novel-attack-against-virtually-all-vpn-apps-neuters-their-entire-purpose/
 https://krebsonsecurity.com/2024/05/why-your-vpn-may-not-be-as-secure-as-it-claims/
 https://issuetracker.google.com/issues/263721377
 https://mullvad.net/en/blog/evaluating-the-impact-of-tunnelvision
 https://www.zscaler.com/blogs/security-research/cve-2024-3661-k-tunnelvision-exposes-vpn-bypass-vulnerability
 https://lowendtalk.com/discussion/188857/a-rogue-dhcp-server-within-your-network-can-and-will-hijack-your-vpn-traffic
 https://news.ycombinator.com/item?id=40284111
 https://www.agwa.name/blog/post/hardening_openvpn_for_def_con
Description:
 DHCP can add routes to a clientâ€™s routing table via the classless static
 route option (121). VPN-based security solutions that rely on routes to
 redirect traffic can be forced to leak traffic over the physical interface.
 An attacker on the same local network can read, disrupt, or possibly modify
 network traffic that was expected to be protected by the VPN.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> other VPN softwares may be affected.
 rodrigo-zaiden> as of 2024-05-08, there isn't vpn providers reports
 mdeslaur> This issue is actually in the way DHCP clients handle the route
 mdeslaur> option. There is no clear solution to this issue as of
 mdeslaur> 2024-05-14, marking all packages are deferred for now.
 nic89> This relies on a victim connecting to an untrusted network with a
 nic89> rogue DHCP server via a DHCP client that implements option 121. It
 nic89> can be mitigated by using namespaces on Linux
 ebarretto> It can also be mitigated by disabling option 121 in DHCP
 ebarretto> configuration
Mitigation:
Bugs:
Priority: high
 An attacker on the same local network can read, disrupt, or possibly modify network traffic that was expected to be protected by the VPN.
Discovered-by:
Assigned-to:
CVSS:
 cisa: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L [7.6 HIGH]
 nvd: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L [7.6 HIGH]

Patches_connman:
upstream_connman: needs-triage
esm-apps/xenial_connman: ignored (see notes)
esm-apps/bionic_connman: ignored (see notes)
focal_connman: ignored (end of standard support, was deferred)
esm-apps/focal_connman: ignored (see notes)
jammy_connman: ignored (see notes)
esm-apps/jammy_connman: ignored (see notes)
mantic_connman: ignored (end of life, was deferred)
noble_connman: ignored (see notes)
esm-apps/noble_connman: ignored (see notes)
oracular_connman: ignored (end of life, was deferred)
plucky_connman: ignored (see notes)
devel_connman: ignored (see notes)

Patches_gadmin-openvpn-client:
upstream_gadmin-openvpn-client: needs-triage
esm-apps/xenial_gadmin-openvpn-client: ignored (see notes)
esm-apps/bionic_gadmin-openvpn-client: ignored (see notes)
focal_gadmin-openvpn-client: ignored (end of standard support, was deferred)
esm-apps/focal_gadmin-openvpn-client: ignored (see notes)
jammy_gadmin-openvpn-client: DNE
mantic_gadmin-openvpn-client: DNE
noble_gadmin-openvpn-client: DNE
oracular_gadmin-openvpn-client: DNE
plucky_gadmin-openvpn-client: DNE
devel_gadmin-openvpn-client: DNE

Patches_gadmin-openvpn-server:
upstream_gadmin-openvpn-server: needs-triage
esm-apps/xenial_gadmin-openvpn-server: ignored (see notes)
esm-apps/bionic_gadmin-openvpn-server: ignored (see notes)
focal_gadmin-openvpn-server: ignored (end of standard support, was deferred)
esm-apps/focal_gadmin-openvpn-server: ignored (see notes)
jammy_gadmin-openvpn-server: DNE
mantic_gadmin-openvpn-server: DNE
noble_gadmin-openvpn-server: DNE
oracular_gadmin-openvpn-server: DNE
plucky_gadmin-openvpn-server: DNE
devel_gadmin-openvpn-server: DNE

Patches_golang-github-apparentlymart-go-openvpn-mgmt:
upstream_golang-github-apparentlymart-go-openvpn-mgmt: needs-triage
focal_golang-github-apparentlymart-go-openvpn-mgmt: ignored (end of standard support, was deferred)
esm-apps/focal_golang-github-apparentlymart-go-openvpn-mgmt: ignored (see notes)
jammy_golang-github-apparentlymart-go-openvpn-mgmt: ignored (see notes)
esm-apps/jammy_golang-github-apparentlymart-go-openvpn-mgmt: ignored (see notes)
mantic_golang-github-apparentlymart-go-openvpn-mgmt: ignored (end of life, was deferred)
noble_golang-github-apparentlymart-go-openvpn-mgmt: ignored (see notes)
esm-apps/noble_golang-github-apparentlymart-go-openvpn-mgmt: ignored (see notes)
oracular_golang-github-apparentlymart-go-openvpn-mgmt: ignored (end of life, was deferred)
plucky_golang-github-apparentlymart-go-openvpn-mgmt: ignored (see notes)
devel_golang-github-apparentlymart-go-openvpn-mgmt: ignored (see notes)

Patches_kvpnc:
upstream_kvpnc: needs-triage
esm-apps/xenial_kvpnc: ignored (see notes)
esm-apps/bionic_kvpnc: ignored (see notes)
focal_kvpnc: DNE
esm-infra/focal_kvpnc: DNE
jammy_kvpnc: DNE
mantic_kvpnc: DNE
noble_kvpnc: DNE
oracular_kvpnc: DNE
plucky_kvpnc: DNE
devel_kvpnc: DNE

Patches_libreswan:
upstream_libreswan: needs-triage
esm-apps/bionic_libreswan: ignored (see notes)
focal_libreswan: ignored (end of standard support, was deferred)
esm-apps/focal_libreswan: ignored (see notes)
jammy_libreswan: ignored (see notes)
esm-apps/jammy_libreswan: ignored (see notes)
mantic_libreswan: ignored (end of life, was deferred)
noble_libreswan: ignored (see notes)
esm-apps/noble_libreswan: ignored (see notes)
oracular_libreswan: ignored (end of life, was deferred)
plucky_libreswan: ignored (see notes)
devel_libreswan: ignored (see notes)

Patches_mozillavpn:
upstream_mozillavpn: needs-triage
focal_mozillavpn: DNE
esm-infra/focal_mozillavpn: DNE
jammy_mozillavpn: ignored (see notes)
esm-apps/jammy_mozillavpn: ignored (see notes)
mantic_mozillavpn: DNE
noble_mozillavpn: DNE
oracular_mozillavpn: DNE
plucky_mozillavpn: DNE
devel_mozillavpn: DNE

Patches_n2n:
upstream_n2n: needs-triage
esm-apps/xenial_n2n: ignored (see notes)
esm-apps/bionic_n2n: ignored (see notes)
focal_n2n: ignored (end of standard support, was deferred)
esm-apps/focal_n2n: ignored (see notes)
jammy_n2n: ignored (see notes)
esm-apps/jammy_n2n: ignored (see notes)
mantic_n2n: ignored (end of life, was deferred)
noble_n2n: ignored (see notes)
esm-apps/noble_n2n: ignored (see notes)
oracular_n2n: ignored (end of life, was deferred)
plucky_n2n: ignored (see notes)
devel_n2n: ignored (see notes)

Patches_network-manager-fortisslvpn:
upstream_network-manager-fortisslvpn: needs-triage
esm-apps/bionic_network-manager-fortisslvpn: ignored (see notes)
focal_network-manager-fortisslvpn: ignored (end of standard support, was deferred)
esm-apps/focal_network-manager-fortisslvpn: ignored (see notes)
jammy_network-manager-fortisslvpn: ignored (see notes)
esm-apps/jammy_network-manager-fortisslvpn: ignored (see notes)
mantic_network-manager-fortisslvpn: ignored (end of life, was deferred)
noble_network-manager-fortisslvpn: ignored (see notes)
esm-apps/noble_network-manager-fortisslvpn: ignored (see notes)
oracular_network-manager-fortisslvpn: ignored (end of life, was deferred)
plucky_network-manager-fortisslvpn: ignored (see notes)
devel_network-manager-fortisslvpn: ignored (see notes)

Patches_network-manager-iodine:
upstream_network-manager-iodine: needs-triage
esm-apps/xenial_network-manager-iodine: ignored (see notes)
esm-apps/bionic_network-manager-iodine: ignored (see notes)
focal_network-manager-iodine: ignored (end of standard support, was deferred)
esm-apps/focal_network-manager-iodine: ignored (see notes)
jammy_network-manager-iodine: ignored (see notes)
esm-apps/jammy_network-manager-iodine: ignored (see notes)
mantic_network-manager-iodine: ignored (end of life, was deferred)
noble_network-manager-iodine: ignored (see notes)
esm-apps/noble_network-manager-iodine: ignored (see notes)
oracular_network-manager-iodine: ignored (end of life, was deferred)
plucky_network-manager-iodine: ignored (see notes)
devel_network-manager-iodine: ignored (see notes)

Patches_network-manager-l2tp:
upstream_network-manager-l2tp: needs-triage
esm-apps/bionic_network-manager-l2tp: ignored (see notes)
focal_network-manager-l2tp: ignored (end of standard support, was deferred)
esm-apps/focal_network-manager-l2tp: ignored (see notes)
jammy_network-manager-l2tp: ignored (see notes)
esm-apps/jammy_network-manager-l2tp: ignored (see notes)
mantic_network-manager-l2tp: ignored (end of life, was deferred)
noble_network-manager-l2tp: ignored (see notes)
esm-apps/noble_network-manager-l2tp: ignored (see notes)
oracular_network-manager-l2tp: ignored (end of life, was deferred)
plucky_network-manager-l2tp: ignored (see notes)
devel_network-manager-l2tp: ignored (see notes)

Patches_network-manager-openconnect:
upstream_network-manager-openconnect: needs-triage
esm-apps/xenial_network-manager-openconnect: ignored (see notes)
esm-apps/bionic_network-manager-openconnect: ignored (see notes)
focal_network-manager-openconnect: ignored (end of standard support, was deferred)
esm-apps/focal_network-manager-openconnect: ignored (see notes)
jammy_network-manager-openconnect: ignored (see notes)
esm-apps/jammy_network-manager-openconnect: ignored (see notes)
mantic_network-manager-openconnect: ignored (end of life, was deferred)
noble_network-manager-openconnect: ignored (see notes)
esm-apps/noble_network-manager-openconnect: ignored (see notes)
oracular_network-manager-openconnect: ignored (end of life, was deferred)
plucky_network-manager-openconnect: ignored (see notes)
devel_network-manager-openconnect: ignored (see notes)

Patches_network-manager-openvpn:
upstream_network-manager-openvpn: needs-triage
esm-apps/xenial_network-manager-openvpn: ignored (see notes)
esm-infra/bionic_network-manager-openvpn: ignored (see notes)
focal_network-manager-openvpn: ignored (end of standard support, was deferred)
esm-infra/focal_network-manager-openvpn: ignored (see notes)
jammy_network-manager-openvpn: ignored (see notes)
mantic_network-manager-openvpn: ignored (end of life, was deferred)
noble_network-manager-openvpn: ignored (see notes)
oracular_network-manager-openvpn: ignored (end of life, was deferred)
plucky_network-manager-openvpn: ignored (see notes)
devel_network-manager-openvpn: ignored (see notes)

Patches_network-manager-pptp:
upstream_network-manager-pptp: needs-triage
esm-infra/xenial_network-manager-pptp: ignored (see notes)
esm-infra/bionic_network-manager-pptp: ignored (see notes)
focal_network-manager-pptp: ignored (end of standard support, was deferred)
esm-infra/focal_network-manager-pptp: ignored (see notes)
jammy_network-manager-pptp: ignored (see notes)
mantic_network-manager-pptp: ignored (end of life, was deferred)
noble_network-manager-pptp: ignored (see notes)
oracular_network-manager-pptp: ignored (end of life, was deferred)
plucky_network-manager-pptp: ignored (see notes)
devel_network-manager-pptp: ignored (see notes)

Patches_network-manager-sstp:
upstream_network-manager-sstp: DNE
focal_network-manager-sstp: DNE
esm-infra/focal_network-manager-sstp: DNE
jammy_network-manager-sstp: ignored (see notes)
esm-apps/jammy_network-manager-sstp: ignored (see notes)
mantic_network-manager-sstp: ignored (end of life, was deferred)
noble_network-manager-sstp: ignored (see notes)
esm-apps/noble_network-manager-sstp: ignored (see notes)
oracular_network-manager-sstp: ignored (end of life, was deferred)
plucky_network-manager-sstp: ignored (see notes)
devel_network-manager-sstp: ignored (see notes)

Patches_network-manager-strongswan:
upstream_network-manager-strongswan: needs-triage
esm-apps/xenial_network-manager-strongswan: ignored (see notes)
esm-apps/bionic_network-manager-strongswan: ignored (see notes)
focal_network-manager-strongswan: ignored (end of standard support, was deferred)
esm-apps/focal_network-manager-strongswan: ignored (see notes)
jammy_network-manager-strongswan: ignored (see notes)
esm-apps/jammy_network-manager-strongswan: ignored (see notes)
mantic_network-manager-strongswan: ignored (end of life, was deferred)
noble_network-manager-strongswan: ignored (see notes)
esm-apps/noble_network-manager-strongswan: ignored (see notes)
oracular_network-manager-strongswan: ignored (end of life, was deferred)
plucky_network-manager-strongswan: ignored (see notes)
devel_network-manager-strongswan: ignored (see notes)

Patches_network-manager-vpnc:
upstream_network-manager-vpnc: needs-triage
esm-apps/xenial_network-manager-vpnc: ignored (see notes)
esm-apps/bionic_network-manager-vpnc: ignored (see notes)
focal_network-manager-vpnc: ignored (end of standard support, was deferred)
esm-apps/focal_network-manager-vpnc: ignored (see notes)
jammy_network-manager-vpnc: ignored (see notes)
esm-apps/jammy_network-manager-vpnc: ignored (see notes)
mantic_network-manager-vpnc: ignored (end of life, was deferred)
noble_network-manager-vpnc: ignored (see notes)
esm-apps/noble_network-manager-vpnc: ignored (see notes)
oracular_network-manager-vpnc: ignored (end of life, was deferred)
plucky_network-manager-vpnc: ignored (see notes)
devel_network-manager-vpnc: ignored (see notes)

Patches_openconnect:
upstream_openconnect: needs-triage
esm-apps/xenial_openconnect: ignored (see notes)
esm-apps/bionic_openconnect: ignored (see notes)
focal_openconnect: ignored (end of standard support, was deferred)
esm-apps/focal_openconnect: ignored (see notes)
jammy_openconnect: ignored (see notes)
esm-apps/jammy_openconnect: ignored (see notes)
mantic_openconnect: ignored (end of life, was deferred)
noble_openconnect: ignored (see notes)
esm-apps/noble_openconnect: ignored (see notes)
oracular_openconnect: ignored (end of life, was deferred)
plucky_openconnect: ignored (see notes)
devel_openconnect: ignored (see notes)

Patches_openfortivpn:
upstream_openfortivpn: needs-triage
esm-apps/bionic_openfortivpn: ignored (see notes)
focal_openfortivpn: ignored (end of standard support, was deferred)
esm-apps/focal_openfortivpn: ignored (see notes)
jammy_openfortivpn: ignored (see notes)
esm-apps/jammy_openfortivpn: ignored (see notes)
mantic_openfortivpn: ignored (end of life, was deferred)
noble_openfortivpn: ignored (see notes)
esm-apps/noble_openfortivpn: ignored (see notes)
oracular_openfortivpn: ignored (end of life, was deferred)
plucky_openfortivpn: ignored (see notes)
devel_openfortivpn: ignored (see notes)

Patches_openvpn:
upstream_openvpn: needs-triage
trusty/esm_openvpn: ignored (end of ESM support, was deferred)
esm-infra-legacy/trusty_openvpn: ignored (see notes)
esm-infra/xenial_openvpn: ignored (see notes)
esm-infra/bionic_openvpn: ignored (see notes)
focal_openvpn: ignored (end of standard support, was deferred)
esm-infra/focal_openvpn: ignored (see notes)
jammy_openvpn: ignored (see notes)
mantic_openvpn: ignored (end of life, was deferred)
noble_openvpn: ignored (see notes)
oracular_openvpn: ignored (end of life, was deferred)
plucky_openvpn: ignored (see notes)
devel_openvpn: ignored (see notes)

Patches_pptp-linux:
upstream_pptp-linux: needs-triage
esm-infra/xenial_pptp-linux: ignored (see notes)
esm-infra/bionic_pptp-linux: ignored (see notes)
focal_pptp-linux: ignored (end of standard support, was deferred)
esm-infra/focal_pptp-linux: ignored (see notes)
jammy_pptp-linux: ignored (see notes)
mantic_pptp-linux: ignored (end of life, was deferred)
noble_pptp-linux: ignored (see notes)
oracular_pptp-linux: ignored (end of life, was deferred)
plucky_pptp-linux: ignored (see notes)
devel_pptp-linux: ignored (see notes)

Patches_pptpd:
upstream_pptpd: needs-triage
trusty/esm_pptpd: ignored (end of ESM support, was deferred)
esm-infra-legacy/trusty_pptpd: ignored (see notes)
esm-infra/xenial_pptpd: ignored (see notes)
esm-infra/bionic_pptpd: ignored (see notes)
focal_pptpd: ignored (end of standard support, was deferred)
esm-infra/focal_pptpd: ignored (see notes)
jammy_pptpd: ignored (see notes)
mantic_pptpd: ignored (end of life, was deferred)
noble_pptpd: DNE
oracular_pptpd: DNE
plucky_pptpd: DNE
devel_pptpd: DNE

Patches_quicktun:
upstream_quicktun: needs-triage
esm-apps/bionic_quicktun: ignored (see notes)
focal_quicktun: ignored (end of standard support, was deferred)
esm-apps/focal_quicktun: ignored (see notes)
jammy_quicktun: ignored (see notes)
esm-apps/jammy_quicktun: ignored (see notes)
mantic_quicktun: ignored (end of life, was deferred)
noble_quicktun: ignored (see notes)
esm-apps/noble_quicktun: ignored (see notes)
oracular_quicktun: ignored (end of life, was deferred)
plucky_quicktun: ignored (see notes)
devel_quicktun: ignored (see notes)

Patches_riseup-vpn:
upstream_riseup-vpn: needs-triage
focal_riseup-vpn: DNE
esm-infra/focal_riseup-vpn: DNE
jammy_riseup-vpn: DNE
mantic_riseup-vpn: ignored (end of life, was deferred)
noble_riseup-vpn: ignored (see notes)
esm-apps/noble_riseup-vpn: ignored (see notes)
oracular_riseup-vpn: ignored (end of life, was deferred)
plucky_riseup-vpn: ignored (see notes)
devel_riseup-vpn: ignored (see notes)

Patches_softether-vpn:
upstream_softether-vpn: needs-triage
focal_softether-vpn: DNE
esm-infra/focal_softether-vpn: DNE
jammy_softether-vpn: ignored (see notes)
esm-apps/jammy_softether-vpn: ignored (see notes)
mantic_softether-vpn: ignored (end of life, was deferred)
noble_softether-vpn: ignored (see notes)
esm-apps/noble_softether-vpn: ignored (see notes)
oracular_softether-vpn: ignored (end of life, was deferred)
plucky_softether-vpn: ignored (see notes)
devel_softether-vpn: ignored (see notes)

Patches_sshuttle:
upstream_sshuttle: needs-triage
esm-apps/xenial_sshuttle: ignored (see notes)
esm-apps/bionic_sshuttle: ignored (see notes)
focal_sshuttle: ignored (end of standard support, was deferred)
esm-apps/focal_sshuttle: ignored (see notes)
jammy_sshuttle: ignored (see notes)
esm-apps/jammy_sshuttle: ignored (see notes)
mantic_sshuttle: ignored (end of life, was deferred)
noble_sshuttle: ignored (see notes)
esm-apps/noble_sshuttle: ignored (see notes)
oracular_sshuttle: ignored (end of life, was deferred)
plucky_sshuttle: ignored (see notes)
devel_sshuttle: ignored (see notes)

Patches_tinc:
upstream_tinc: needs-triage
esm-apps/xenial_tinc: ignored (see notes)
esm-apps/bionic_tinc: ignored (see notes)
focal_tinc: ignored (end of standard support, was deferred)
esm-apps/focal_tinc: ignored (see notes)
jammy_tinc: ignored (see notes)
esm-apps/jammy_tinc: ignored (see notes)
mantic_tinc: ignored (end of life, was deferred)
noble_tinc: ignored (see notes)
esm-apps/noble_tinc: ignored (see notes)
oracular_tinc: ignored (end of life, was deferred)
plucky_tinc: ignored (see notes)
devel_tinc: ignored (see notes)

Patches_vpnc:
upstream_vpnc: needs-triage
esm-apps/xenial_vpnc: ignored (see notes)
esm-apps/bionic_vpnc: ignored (see notes)
focal_vpnc: ignored (end of standard support, was deferred)
esm-apps/focal_vpnc: ignored (see notes)
jammy_vpnc: ignored (see notes)
esm-apps/jammy_vpnc: ignored (see notes)
mantic_vpnc: ignored (end of life, was deferred)
noble_vpnc: ignored (see notes)
esm-apps/noble_vpnc: ignored (see notes)
oracular_vpnc: ignored (end of life, was deferred)
plucky_vpnc: ignored (see notes)
devel_vpnc: ignored (see notes)

Patches_wireguard:
upstream_wireguard: needs-triage
esm-apps/xenial_wireguard: ignored (see notes)
esm-apps/bionic_wireguard: ignored (see notes)
focal_wireguard: ignored (end of standard support, was deferred)
esm-apps/focal_wireguard: ignored (see notes)
jammy_wireguard: ignored (see notes)
mantic_wireguard: ignored (end of life, was deferred)
noble_wireguard: ignored (see notes)
oracular_wireguard: ignored (end of life, was deferred)
plucky_wireguard: ignored (see notes)
devel_wireguard: ignored (see notes)
