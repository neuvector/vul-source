PublicDateAtUSN: 2020-07-15 12:00:00 UTC
Candidate: CVE-2020-11933
CRD: 2020-07-15 12:00:00 UTC
PublicDate: 2020-07-29 17:15:00 UTC
References:
 https://ubuntu.com/security/notices/USN-4424-1
 https://www.cve.org/CVERecord?id=CVE-2020-11933
Description:
 cloud-init as managed by snapd on Ubuntu Core 16 and Ubuntu Core 18 devices
 was run without restrictions on every boot, which a physical attacker could
 exploit by crafting cloud-init user-data/meta-data via external media to
 perform arbitrary changes on the device to bypass intended security
 mechanisms such as full disk encryption. This issue did not affect
 traditional Ubuntu systems. Fixed in snapd version 2.45.2, revision 8539
 and core version 2.45.2, revision 9659.
Ubuntu-Description:
 It was discovered that cloud-init as managed by snapd on Ubuntu Core 16 and
 Ubuntu Core 18 devices ran on every boot without restrictions. A physical
 attacker could exploit this to craft cloud-init user-data/meta-data via
 external media to perform arbitrary changes on the device to bypass
 intended security mechanisms such as full disk encryption. This issue did
 not affect traditional Ubuntu systems. (CVE-2020-11933)
Notes:
 jdstrand> cloud-init as managed by snapd is only used on Ubuntu Core 16 and 18
  devices. This does not affect traditional Ubuntu cloud, desktop and server
  systems or the upcoming Ubuntu Core 20.
 jdstrand> Since the attack requires physical presence, the vulnerability
  provides no additional access to standard Ubuntu Core devices. For Ubuntu
  Core devices with full disk encryption, the vulnerability allows admin access
  to the device after the disk has been decrypted.
 jdstrand> snapd will be updated to disable/restrict cloud-init after the first
  boot. Since this does not affect traditional deb-based Ubuntu systems,
  security updates will not be provided for the snapd deb in the Ubuntu archive
  and these debs are marked as 'not-affected'. For notification purposes we
  will issue a USN for this.
 jdstrand> Ubuntu Core 16 devices will be updated via the 'core' snap which
  includes snapd
 jdstrand> Ubuntu Core 18 devices will be updated via the 'snapd' snap (which
  is provided separated from the core18 snap)
 jdstrand> 20.04 LTS Raspberry Pi images are affected but do not include FDE.
  A non-security bug task has been added to https://launchpad.net/bugs/1879530.
Mitigation:
 jdstrand> On provisioned devices, disable cloud-init using:
  $ sudo systemctl disable cloud-init
 jdstrand> For unprovisioned devices, provision then disable cloud-init
Bugs:
 https://launchpad.net/bugs/1879530
Priority: medium
Discovered-by: Ian Johnson
Assigned-to:
CVSS:
 ubuntu: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N [7.3 HIGH]
 nvd: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [6.8 MEDIUM]


Patches_snapd:
upstream_snapd: released (2.45.2)
upstream_core: not-affected
upstream_core18: not-affected
upstream_core20: not-affected
precise/esm_snapd: DNE
trusty_snapd: not-affected
trusty/esm_snapd: DNE
esm-infra-legacy/trusty_snapd: DNE
xenial_snapd: not-affected
esm-infra/xenial_snapd: not-affected
bionic_snapd: not-affected
esm-infra/bionic_snapd: not-affected
eoan_snapd: not-affected
focal_snapd: not-affected
devel_snapd: not-affected
snap_snapd: released (2.45.2, revisions 8539+)
snap_core: released (2.45.2, revisions 9659+)
snap_core18: not-affected (code-not-present)
snap_core20: not-affected (code-not-present)
