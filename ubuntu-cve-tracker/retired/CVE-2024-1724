PublicDateAtUSN: 2024-07-01
Candidate: CVE-2024-1724
PublicDate: 2024-07-25 19:15:00 UTC
CRD: 2024-07-01
References:
 https://www.cve.org/CVERecord?id=CVE-2024-1724
 https://github.com/snapcore/snapd/pull/13689
 https://gld.mcphail.uk/posts/explaining-cve-2024-1724/
 https://ubuntu.com/security/notices/USN-6940-1
 https://ubuntu.com/security/notices/USN-6940-2
Description:
 In snapd versions prior to 2.62, when using AppArmor for enforcement of
 sandbox permissions, snapd failed to restrict writes to the $HOME/bin
 path. In Ubuntu, when this path exists, it is automatically added to
 the users PATH. An attacker who could convince a user to install a
 malicious snap which used the 'home' plug could use this vulnerability
 to install arbitrary scripts into the users PATH which may then be run
 by the user outside of the expected snap sandbox and hence allow them
 to escape confinement.
Ubuntu-Description:
Notes:
 sarnold> CWE-732
 sarnold> CAPEC-1
Mitigation:
Bugs:
Priority: medium
Discovered-by: Neil McPhail
Assigned-to:
CVSS:
 ubuntu: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L [6.3 MEDIUM]
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H [8.2 HIGH]

Patches_snapd:
 upstream: https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6
upstream_snapd: released (2.62)
snap_snapd: released (2.62)
trusty_snapd: ignored (end of standard support)
xenial_snapd: ignored (end of standard support)
esm-infra/xenial_snapd: released (2.61.4ubuntu0.16.04.1+esm1)
bionic_snapd: ignored (end of standard support)
esm-infra/bionic_snapd: released (2.61.4ubuntu0.18.04.1+esm1)
focal_snapd: released (2.63+20.04ubuntu0.1)
esm-infra/focal_snapd: not-affected (2.63+20.04ubuntu0.1)
jammy_snapd: released (2.63+22.04ubuntu0.1)
mantic_snapd: ignored (end of life, was needed)
noble_snapd: released (2.62+24.04build1)
oracular_snapd: released (2.63+24.10)
devel_snapd: released (2.63+24.10)
