Candidate: CVE-2022-35948
PublicDate: 2022-08-15 11:21:00 UTC
References:
 https://github.com/nodejs/undici/security/advisories/GHSA-f772-66g8-q5h3
 https://github.com/nodejs/undici/commit/66165d604fd0aee70a93ed5c44ad4cc2df395f80 (v5.8.2)
 https://www.cve.org/CVERecord?id=CVE-2022-35948
Description:
 undici is an HTTP/1.1 client, written from scratch for Node.js.`=<
 undici@5.8.0` users are vulnerable to _CRLF Injection_ on headers when
 using unsanitized input as request headers, more specifically, inside the
 `content-type` header. Example: ``` import { request } from 'undici' const
 unsanitizedContentTypeInput = 'application/json\r\n\r\nGET /foo2 HTTP/1.1'
 await request('http://localhost:3000, { method: 'GET', headers: {
 'content-type': unsanitizedContentTypeInput }, }) ``` The above snippet
 will perform two requests in a single `request` API call: 1)
 `http://localhost:3000/` 2) `http://localhost:3000/foo2` This issue was
 patched in Undici v5.8.1. Sanitize input when sending content-type headers
 using user input as a workaround.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N [5.3 MEDIUM]
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N [5.3 MEDIUM]


Patches_node-undici:
 upstream: https://github.com/nodejs/undici/commit/66165d604fd0aee70a93ed5c44ad4cc2df395f80
upstream_node-undici: released (5.8.2+dfsg1+~cs18.9.18.1-1)
trusty_node-undici: DNE
xenial_node-undici: DNE
bionic_node-undici: DNE
focal_node-undici: DNE
esm-infra/focal_node-undici: DNE
jammy_node-undici: DNE
kinetic_node-undici: not-affected (5.8.2+dfsg1+~cs18.9.18.1-1)
devel_node-undici: not-affected (5.8.2+dfsg1+~cs18.9.18.1-1)
