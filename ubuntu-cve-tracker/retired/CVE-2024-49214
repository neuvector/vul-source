Candidate: CVE-2024-49214
PublicDate: 2024-10-14 04:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-49214
 https://www.haproxy.org/download/3.1/src/CHANGELOG
 https://www.haproxy.org/download/3.0/src/CHANGELOG
 https://www.haproxy.org/download/2.9/src/CHANGELOG
 https://www.mail-archive.com/haproxy%40formilux.org/msg45291.html
 https://www.mail-archive.com/haproxy%40formilux.org/msg45314.html
 https://www.mail-archive.com/haproxy%40formilux.org/msg45315.html
Description:
 QUIC in HAProxy 3.1.x before 3.1-dev7, 3.0.x before 3.0.5, and 2.9.x before
 2.9.11 allows opening a 0-RTT session with a spoofed IP address. This can
 bypass the IP allow/block list functionality.
Ubuntu-Description:
Notes:
 mdeslaur> Per the CVE description, this affects 2.9.x+, per the commit
 mdeslaur> description, this affects 2.6+.
 mdeslaur> As of 2024-10-29, there is no backport to 2.8.x available.
 mdeslaur> The fix consists of providing a token to the client each time it
 mdeslaur> successfully managed to connect to haproxy. The token code is
 mdeslaur> only enabled if HAVE_SSL_0RTT_QUIC is set, which is only set
 mdeslaur> when aws-lc and perhaps boringssl is being used as the ssl
 mdeslaur> backend. In Ubuntu, packages are built with OpenSSL, so the
 mdeslaur> QUIC support doesn't handle 0RTT and hence packages are not
 mdeslaur> vulnerable.
Mitigation:
Bugs:
Priority: medium
Discovered-by: Wedl Michael
Assigned-to:
CVSS:
 mitre: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N [5.3 MEDIUM]

Patches_haproxy:
 upstream: https://github.com/haproxy/haproxy/commit/f627b9272bd8ffca6f2f898bfafc6bf0b84b7d46 (v3.1-dev7)
 upstream: https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=8f0d380f3905e7a5814e9ffed29bc83c66383864 (2.9 dep)
 upstream: https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=fa00c0a1b692f4bfbb0dd1360d35528e554607d8 (2.9 dep)
 upstream: https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=d60edbde4834ce3db567053ab9b8973dc62dbe2f (2.9 dep)
 upstream: https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=78f36a6ee40ff00ec1519ad1a5aec73c6371c51b (2.9 dep)
 upstream: https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=0282a82f79ceb9f15515edf49542e7199eede408 (2.9 dep)
 upstream: https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=cf4b5e1001880bcece3c4d12b5aa422d378dcf1d (2.9 dep)
 upstream: https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=ab5a390451239282d8a3fd2c45f56162b92a3bd3 (2.9 dep)
 upstream: https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=fe5685af820ae62fe5b0d80b5ed7a2ffc41a036f (2.9.x)
upstream_haproxy: released (2.9.11-1)
esm-infra/xenial_haproxy: not-affected (code not present)
esm-infra/bionic_haproxy: not-affected (code not present)
focal_haproxy: not-affected (code not present)
esm-infra/focal_haproxy: not-affected (code not present)
jammy_haproxy: not-affected (code not present)
noble_haproxy: not-affected (built with OpenSSL)
oracular_haproxy: not-affected (built with OpenSSL)
devel_haproxy: not-affected (built with OpenSSL)
