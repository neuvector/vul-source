Candidate: CVE-2022-24812
PublicDate: 2022-04-12 17:15:00 UTC
References:
 https://github.com/grafana/grafana/security/advisories/GHSA-82gq-xfg3-5j7v
 https://grafana.com/docs/grafana/latest/release-notes/release-notes-8-4-6/
 https://grafana.com/blog/2022/04/12/grafana-enterprise-8.4.6-released-with-high-severity-security-fix/
 https://www.cve.org/CVERecord?id=CVE-2022-24812
Description:
 Grafana is an open-source platform for monitoring and observability. When
 fine-grained access control is enabled and a client uses Grafana API Key to
 make requests, the permissions for that API Key are cached for 30 seconds
 for the given organization. Because of the way the cache ID is constructed,
 the consequent requests with any API Key evaluate to the same permissions
 as the previous requests. This can lead to an escalation of privileges,
 when for example a first request is made with Admin permissions, and the
 second request with different API Key is made with Viewer permissions, the
 second request will get the cached permissions from the previous Admin,
 essentially accessing higher privilege than it should. The vulnerability is
 only impacting Grafana Enterprise when the fine-grained access control beta
 feature is enabled and there are more than one API Keys in one organization
 with different roles assigned. All installations after Grafana Enterprise
 v8.1.0-beta1 should be upgraded as soon as possible. As an alternative,
 disable fine-grained access control will mitigate the vulnerability.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium 
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]
 github: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H [8.0 HIGH]


Patches_grafana:
upstream_grafana: released (8.4.6) 
trusty_grafana: DNE 
xenial_grafana: ignored (end of standard support, was not-affected)
esm-apps/xenial_grafana: not-affected
bionic_grafana: DNE
focal_grafana: DNE
esm-infra/focal_grafana: DNE
impish_grafana: DNE
jammy_grafana: DNE
devel_grafana: DNE

