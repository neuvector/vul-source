Candidate: CVE-2021-23839
PublicDate: 2021-02-16 17:15:00 UTC
References:
 https://www.openssl.org/news/secadv/20210216.txt
 https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=901f1ef7dacb6b3bde63233a1f623e1fa2f0f058 (OpenSSL_1_1_1j)
 https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=30919ab80a478f2d81f2e9acdcca3fa4740cd547
 https://www.cve.org/CVERecord?id=CVE-2021-23839
Description:
 OpenSSL 1.0.2 supports SSLv2. If a client attempts to negotiate SSLv2 with
 a server that is configured to support both SSLv2 and more recent SSL and
 TLS versions then a check is made for a version rollback attack when
 unpadding an RSA signature. Clients that support SSL or TLS versions
 greater than SSLv2 are supposed to use a special form of padding. A server
 that supports greater than SSLv2 is supposed to reject connection attempts
 from a client where this special form of padding is present, because this
 indicates that a version rollback has occurred (i.e. both client and server
 support greater than SSLv2, and yet this is the version that is being
 requested). The implementation of this padding check inverted the logic so
 that the connection attempt is accepted if the padding is present, and
 rejected if it is absent. This means that such as server will accept a
 connection if a version rollback attack has occurred. Further the server
 will erroneously reject a connection if a normal SSLv2 connection attempt
 is made. Only OpenSSL 1.0.2 servers from version 1.0.2s to 1.0.2x are
 affected by this issue. In order to be vulnerable a 1.0.2 server must: 1)
 have configured SSLv2 support at compile time (this is off by default), 2)
 have configured SSLv2 support at runtime (this is off by default), 3) have
 configured SSLv2 ciphersuites (these are not in the default ciphersuite
 list) OpenSSL 1.1.1 does not have SSLv2 support and therefore is not
 vulnerable to this issue. The underlying error is in the implementation of
 the RSA_padding_check_SSLv23() function. This also affects the
 RSA_SSLV23_PADDING padding mode used by various other functions. Although
 1.1.1 does not support SSLv2 the RSA_padding_check_SSLv23() function still
 exists, as does the RSA_SSLV23_PADDING padding mode. Applications that
 directly call that function or use that padding mode will encounter this
 issue. However since there is no support for the SSLv2 protocol in 1.1.1
 this is considered a bug and not a security issue in that version. OpenSSL
 1.0.2 is out of support and no longer receiving public updates. Premium
 support customers of OpenSSL 1.0.2 should upgrade to 1.0.2y. Other users
 should upgrade to 1.1.1j. Fixed in OpenSSL 1.0.2y (Affected 1.0.2s-1.0.2x).
Ubuntu-Description:
Notes:
 avital> openssl in Ubuntu is compiled with no-ssl2
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N [3.7 LOW]

Patches_openssl:
upstream_openssl: needs-triage
precise/esm_openssl: not-affected
trusty_openssl: ignored (end of standard support)
trusty/esm_openssl: not-affected
esm-infra-legacy/trusty_openssl: not-affected
xenial_openssl: not-affected
esm-infra/xenial_openssl: not-affected
bionic_openssl: not-affected
esm-infra/bionic_openssl: not-affected
focal_openssl: not-affected
esm-infra/focal_openssl: not-affected
groovy_openssl: not-affected
hirsute_openssl: not-affected
devel_openssl: not-affected

Patches_openssl1.0:
upstream_openssl1.0: not-affected (debian: SSL2 disabled before openssl1.0 was uploaded)
precise/esm_openssl1.0: DNE
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
esm-infra-legacy/trusty_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: not-affected
esm-infra/bionic_openssl1.0: not-affected
focal_openssl1.0: DNE
esm-infra/focal_openssl1.0: DNE
groovy_openssl1.0: DNE
hirsute_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
precise/esm_nodejs: DNE
trusty_nodejs: ignored (end of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
esm-infra-legacy/trusty_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-infra/focal_nodejs: DNE (focal was not-affected [uses system openssl1.1])
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
groovy_nodejs: not-affected (uses system openssl1.1)
hirsute_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
upstream_edk2: not-affected
precise/esm_edk2: DNE
trusty_edk2: ignored (end of standard support)
trusty/esm_edk2: DNE
esm-infra-legacy/trusty_edk2: DNE
xenial_edk2: not-affected
esm-apps/xenial_edk2: not-affected
bionic_edk2: not-affected
esm-apps/bionic_edk2: not-affected
focal_edk2: not-affected
esm-infra/focal_edk2: not-affected
groovy_edk2: not-affected
hirsute_edk2: not-affected
devel_edk2: not-affected
