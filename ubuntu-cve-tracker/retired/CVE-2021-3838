PublicDateAtUSN: 2023-02-14
Candidate: CVE-2021-3838
PublicDate: 2024-11-15 11:15:00 UTC
References:
 https://github.com/dompdf/dompdf/issues/2564
 https://huntr.dev/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
 https://ubuntu.com/security/notices/USN-6277-1
 https://ubuntu.com/security/notices/USN-6277-2
 https://www.cve.org/CVERecord?id=CVE-2021-3838
Description:
 DomPDF before version 2.0.0 is vulnerable to PHAR deserialization due to a
 lack of checking on the protocol before passing it into the
 file_get_contents() function. An attacker who can upload files of any type
 to the server can pass in the phar:// protocol to unserialize the uploaded
 file and instantiate arbitrary PHP objects. This can lead to remote code
 execution, especially when DOMPdf is used with frameworks with documented
 POP chains like Laravel or vulnerable developer code.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 huntr.dev: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_php-dompdf:
 upstream: https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a
upstream_php-dompdf: released (2.0.2+dfsg-1, 2.0.0)
trusty_php-dompdf: ignored (end of standard support)
xenial_php-dompdf: ignored (end of standard support)
bionic_php-dompdf: ignored (end of standard support, was needed)
focal_php-dompdf: released (0.6.2+dfsg-3ubuntu0.20.04.1)
jammy_php-dompdf: released (0.6.2+dfsg-3.1ubuntu0.1)
kinetic_php-dompdf: ignored (end of life, was needed)
esm-apps/xenial_php-dompdf: released (0.6.1+dfsg-2ubuntu1+esm1)
esm-apps/bionic_php-dompdf: released (0.6.2+dfsg-3ubuntu0.18.04.1~esm1)
esm-apps/focal_php-dompdf: released (0.6.2+dfsg-3ubuntu0.20.04.1)
esm-apps/jammy_php-dompdf: released (0.6.2+dfsg-3.1ubuntu0.1)
lunar_php-dompdf: DNE
devel_php-dompdf: DNE
