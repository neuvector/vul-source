PublicDateAtUSN: 2011-05-29
Candidate: CVE-2011-1751
PublicDate: 2012-06-21 15:55:00 UTC
References: 
 http://lists.nongnu.org/archive/html/qemu-devel/2011-05/msg01810.html
 https://ubuntu.com/security/notices/USN-1145-1
 https://www.cve.org/CVERecord?id=CVE-2011-1751
Description:
 The pciej_write function in hw/acpi_piix4.c in the PIIX4 Power Management
 emulation in qemu-kvm does not check if a device is hotpluggable before
 unplugging the PCI-ISA bridge, which allows privileged guest users to cause
 a denial of service (guest crash) and possibly execute arbitrary code by
 sending a crafted value to the 0xae08 (PCI_EJ_BASE) I/O port, which leads
 to a use-after-free related to "active qemu timers."
Ubuntu-Description: 
Notes: 
 jdstrand> patch requires several other patches to be applied first
 jdstrand> adding apparmor tag since qemu-kvm is typically used with libvirt
  on Ubuntu, and is therefore confined by AppArmor
Bugs: 
 https://bugzilla.redhat.com/show_bug.cgi?id=699773
Priority: medium
Discovered-by: Nelson Elhage
Assigned-to:
CVSS: 

Tags_qemu-kvm: apparmor
Patches_qemu-kvm:
 other: http://lists.nongnu.org/archive/html/qemu-devel/2011-05/msg01810.html
 vendor: http://www.debian.org/security/2011/dsa-2241
 vendor: https://rhn.redhat.com/errata/RHSA-2011-0534.html
upstream_qemu-kvm: needs-triage
dapper_qemu-kvm: DNE
hardy_qemu-kvm: DNE
lucid_qemu-kvm: released (0.12.3+noroms-0ubuntu9.9)
maverick_qemu-kvm: released (0.12.5+noroms-0ubuntu7.5)
natty_qemu-kvm: released (0.14.0+noroms-0ubuntu4.1)
devel_qemu-kvm: released (0.14.0+noroms-0ubuntu7)
