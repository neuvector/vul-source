Candidate: CVE-2024-21510
PublicDate: 2024-11-01 05:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-21510
 https://security.snyk.io/vuln/SNYK-RUBY-SINATRA-6483832
 https://github.com/sinatra/sinatra/pull/2053#issuecomment-2486996349
 https://github.com/rack/rack/commit/58eed3015d89249a3c48d144bbeabb01f69ea696
Description:
 Versions of the package sinatra from 0.0.0 are vulnerable to Reliance on
 Untrusted Inputs in a Security Decision via the X-Forwarded-Host (XFH)
 header. When making a request to a method with redirect applied, it is
 possible to trigger an Open Redirect Attack by inserting an arbitrary
 address into this header. If used for caching purposes, such as with
 servers like Nginx, or as a reverse proxy, without handling the
 X-Forwarded-Host header, attackers can potentially exploit Cache Poisoning
 or Routing-based SSRF.
Ubuntu-Description:
Notes:
 hlibk> The patch itself appears to be a security feature that enables
 hlibk> users to allow certain hosts in forwarded headers. The patch
 hlibk> utilizes a dependency called ruby-rack which does not contain the
 hlibk> implementation of RFC 7239 Forwarded header in versions of
 hlibk> ruby-rack below 3.0. This means that the fix appears to be partial
 hlibk> for those versions, and upstream has mentioned that they have no
 hlibk> plans of supporting any older releases. Additionally, on jammy and
 hlibk> below, the dependency appears to lack a feature that enables the
 hlibk> patch, which makes the patch not apply for those releases.
 mdeslaur> Since this introduces a new API to work-around the issue,
 mdeslaur> doesn't fix existing uses of ruby-sinatra, and is an intrusive
 mdeslaur> backport, we will not be fixing this CVE in Ubuntu stable
 mdeslaur> releases.
Mitigation:
Bugs:
 https://github.com/sinatra/sinatra/issues/2052
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1087290
Priority: medium
Discovered-by:
Assigned-to:
CVSS:

Patches_ruby-sinatra:
 upstream: https://github.com/sinatra/sinatra/pull/2053
 upstream: https://github.com/sinatra/sinatra/commit/cd3e00de20ddaff34ea30f7a74a7b9dad189d1d8
upstream_ruby-sinatra: released (4.1.0)
esm-apps/xenial_ruby-sinatra: ignored (see note)
esm-apps/bionic_ruby-sinatra: ignored (see note)
focal_ruby-sinatra: ignored (see note)
esm-apps/focal_ruby-sinatra: ignored (see note)
jammy_ruby-sinatra: ignored (see note)
esm-apps/jammy_ruby-sinatra: ignored (see note)
noble_ruby-sinatra: ignored (see note)
oracular_ruby-sinatra: ignored (see note)
devel_ruby-sinatra: ignored (see note)
