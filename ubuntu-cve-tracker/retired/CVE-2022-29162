PublicDateAtUSN: 2022-05-17 21:15:00 UTC
Candidate: CVE-2022-29162
PublicDate: 2022-05-17 21:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2022/05/12/1
 https://github.com/opencontainers/runc/commit/98fe566c527479195ce3c8167136d2a555fe6b65
 https://ubuntu.com/security/notices/USN-6088-2
 https://www.cve.org/CVERecord?id=CVE-2022-29162
Description:
 runc is a CLI tool for spawning and running containers on Linux according
 to the OCI specification. A bug was found in runc prior to version 1.1.2
 where `runc exec --cap` created processes with non-empty inheritable Linux
 process capabilities, creating an atypical Linux environment and enabling
 programs with inheritable file capabilities to elevate those capabilities
 to the permitted set during execve(2). This bug did not affect the
 container security sandbox as the inheritable set never contained more
 capabilities than were included in the container's bounding set. This bug
 has been fixed in runc 1.1.2. This fix changes `runc exec --cap` behavior
 such that the additional capabilities granted to the process being executed
 (as specified via `--cap` arguments) do not include inheritable
 capabilities. In addition, `runc spec` is changed to not set any
 inheritable capabilities in the created example OCI spec (`config.json`)
 file.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]
 github: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L [5.9 MEDIUM]


Patches_runc:
 upstream:  https://github.com/opencontainers/runc/commit/98fe566c527479195ce3c8167136d2a555fe6b65
upstream_runc: released (1.1.2)
trusty_runc: ignored (end of standard support)
xenial_runc: ignored (end of standard support)
esm-apps/xenial_runc: released (1.0.0~rc7+git20190403.029124da-0ubuntu1~16.04.4+esm4)
bionic_runc: ignored (end of standard support, was needed)
esm-apps/bionic_runc: not-affected (1.1.2-0ubuntu1)
focal_runc: released (1.1.2-0ubuntu1)
esm-infra/focal_runc: not-affected (1.1.2-0ubuntu1)
impish_runc: ignored (end of life)
jammy_runc: released (1.1.2-0ubuntu1)
kinetic_runc: released (1.1.2-0ubuntu1)
lunar_runc: released (1.1.2-0ubuntu1)
devel_runc: released (1.1.2-0ubuntu1)
