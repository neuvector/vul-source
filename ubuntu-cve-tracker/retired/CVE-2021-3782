PublicDateAtUSN: 2022-08-30 20:51:00 UTC
Candidate: CVE-2021-3782
PublicDate: 2022-09-23 16:15:00 UTC
References:
 https://access.redhat.com/security/cve/CVE-2021-3782
 https://ubuntu.com/security/notices/USN-5614-1
 https://ubuntu.com/security/notices/USN-5614-2
 https://www.cve.org/CVERecord?id=CVE-2021-3782
Description:
 An internal reference count is held on the buffer pool, incremented every
 time a new buffer is created from the pool. The reference count is
 maintained as an int; on LP64 systems this can cause the reference count to
 overflow if the client creates a large number of wl_shm buffer objects, or
 if it can coerce the server to create a large number of external references
 to the buffer storage. With the reference count overflowing, a
 use-after-free can be constructed on the wl_shm_pool tracking structure,
 where values may be incremented or decremented; it may also be possible to
 construct a limited oracle to leak 4 bytes of server-side memory to the
 attacking client at a time.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://gitlab.freedesktop.org/wayland/wayland/-/issues/224
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H [6.6 MEDIUM]


Patches_wayland:
 upstream: https://gitlab.freedesktop.org/wayland/wayland/-/commit/b19488c7154b902354cb26a27f11415d7799b0b2
upstream_wayland: needs-triage
esm-infra/xenial_wayland: released (1.12.0-1~ubuntu16.04.3+esm1)
trusty_wayland: ignored (end of standard support)
xenial_wayland: ignored (end of standard support)
bionic_wayland: released (1.16.0-1ubuntu1.1~18.04.4)
esm-infra/bionic_wayland: not-affected (1.16.0-1ubuntu1.1~18.04.4)
focal_wayland: released (1.18.0-1ubuntu0.1)
jammy_wayland: released (1.20.0-1ubuntu0.1)
kinetic_wayland: not-affected (1.21.0-1)
devel_wayland: not-affected (1.21.0-1)
