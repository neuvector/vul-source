Candidate: CVE-2023-22496
PublicDate: 2023-01-14 01:15:00 UTC
References:
 https://github.com/netdata/netdata/security/advisories/GHSA-xg38-3vmw-2978
 https://www.cve.org/CVERecord?id=CVE-2023-22496
Description:
 Netdata is an open source option for real-time infrastructure monitoring
 and troubleshooting. An attacker with the ability to establish a streaming
 connection can execute arbitrary commands on the targeted Netdata agent.
 When an alert is triggered, the function `health_alarm_execute` is called.
 This function performs different checks and then enqueues a command by
 calling `spawn_enq_cmd`. This command is populated with several arguments
 that are not sanitized. One of them is the `registry_hostname` of the node
 for which the alert is raised. By providing a specially crafted
 `registry_hostname` as part of the health data that is streamed to a
 Netdata (parent) agent, an attacker can execute arbitrary commands at the
 remote host as a side-effect of the raised alert. Note that the commands
 are executed as the user running the Netdata Agent. This user is usually
 named `netdata`. The ability to run arbitrary commands may allow an
 attacker to escalate privileges by escalating other vulnerabilities in the
 system, as that user. The problem has been fixed in: Netdata agent v1.37
 (stable) and Netdata agent v1.36.0-409 (nightly). As a workaround,
 streaming is not enabled by default. If you have previously enabled this,
 it can be disabled. Limiting access to the port on the recipient Agent to
 trusted child connections may mitigate the impact of this vulnerability.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]

Patches_netdata:
upstream_netdata: released (1.36.0)
trusty_netdata: ignored (end of standard support)
xenial_netdata: ignored (end of standard support)
bionic_netdata: ignored (end of standard support, was needs-triage)
esm-apps/bionic_netdata: not-affected (code not present)
focal_netdata: not-affected (code not present)
esm-apps/focal_netdata: not-affected (code not present)
jammy_netdata: not-affected (code not present)
esm-apps/jammy_netdata: not-affected (code not present)
kinetic_netdata: ignored (end of life, was needs-triage)
lunar_netdata: ignored (end of life, was needs-triage)
mantic_netdata: ignored (end of life, was needs-triage)
noble_netdata: not-affected
esm-apps/noble_netdata: not-affected
oracular_netdata: not-affected
devel_netdata: not-affected
