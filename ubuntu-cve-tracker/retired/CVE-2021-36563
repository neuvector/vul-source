PublicDateAtUSN: 2021-07-26 18:15:00 UTC
Candidate: CVE-2021-36563
PublicDate: 2021-07-26 18:15:00 UTC
References:
 https://checkmk.com/de/werk/12762
 https://github.com/Edgarloyola/CVE-2021-36563
 https://checkmk.com/de/werk/13148
 https://ubuntu.com/security/notices/USN-5527-1
 https://www.cve.org/CVERecord?id=CVE-2021-36563
 https://ubuntu.com/security/notices/USN-5527-2
Description:
 The CheckMK management web console (versions 1.5.0 to 2.0.0) does not
 sanitise user input in various parameters of the WATO module. This allows
 an attacker to open a backdoor on the device with HTML content and
 interpreted by the browser (such as JavaScript or other client-side
 scripts), the XSS payload will be triggered when the user accesses some
 specific sections of the application. In the same sense a very dangerous
 potential way would be when an attacker who has the monitor role (not
 administrator) manages to get a stored XSS to steal the secretAutomation
 (for the use of the API in administrator mode) and thus be able to create
 another administrator user who has high privileges on the CheckMK
 monitoring web console. Another way is that persistent XSS allows an
 attacker to modify the displayed content or change the victim's
 information. Successful exploitation requires access to the web management
 interface, either with valid credentials or with a hijacked session.
Ubuntu-Description:
Notes:
 0xnishit> fix: https://github.com/tribe29/checkmk/commit/821f99e7ca3dcb41131df25023390a71ef31ad1b
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N [5.4 MEDIUM]


Patches_check-mk:
upstream_check-mk: released (2.0.0p10)
trusty_check-mk: ignored (end of standard support)
trusty/esm_check-mk: DNE
esm-infra-legacy/trusty_check-mk: DNE
xenial_check-mk: ignored (end of standard support)
esm-apps/xenial_check-mk: released (1.2.6p12-1ubuntu0.16.04.1+esm1)
bionic_check-mk: released (1.2.8p16-1ubuntu0.2)
esm-apps/bionic_check-mk: released (1.2.8p16-1ubuntu0.2)
focal_check-mk: DNE
hirsute_check-mk: DNE
impish_check-mk: DNE
jammy_check-mk: DNE
devel_check-mk: DNE
