Candidate: CVE-2022-2566
PublicDate: 2022-09-23 12:15:00 UTC
References:
 https://bugzilla.redhat.com/show_bug.cgi?id=2126833
 https://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=6f53f0d09ea4c9c7f7354f018a87ef840315207d (n5.1.1)
 https://www.cve.org/CVERecord?id=CVE-2022-2566
Description:
 A heap out-of-bounds memory write exists in FFMPEG since version 5.1. The
 size calculation in `build_open_gop_key_points()` goes through all entries
 in the loop and adds `sc->ctts_data[i].count` to
 `sc->sample_offsets_count`. This can lead to an integer overflow resulting
 in a small allocation with `av_calloc()`. An attacker can cause remote code
 execution via a malicious mp4 file. We recommend upgrading past commit
 c953baa084607dd1d84c3bfcce3cf6a87c3e6e05
Ubuntu-Description:
Notes:
 ccdm94> vulnerability introduced by commit ab77b878f12. Affected version
 ccdm94> is version 5.1, when it includes the code from this commit.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H [7.8 HIGH]
 google: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H [9.0 CRITICAL]

Patches_ffmpeg:
 upstream: https://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=6f53f0d09ea4c9c7f7354f018a87ef840315207d
upstream_ffmpeg: released (7:5.1.1-1)
trusty_ffmpeg: ignored (end of standard support, was not-affected)
xenial_ffmpeg: ignored (end of standard support, was not-affected)
esm-apps/xenial_ffmpeg: not-affected (code not present)
bionic_ffmpeg: not-affected (code not present)
esm-apps/bionic_ffmpeg: not-affected (code not present)
focal_ffmpeg: not-affected (code not present)
esm-apps/focal_ffmpeg: not-affected (code not present)
jammy_ffmpeg: not-affected (code not present)
esm-apps/jammy_ffmpeg: not-affected (code not present)
kinetic_ffmpeg: not-affected (7:5.1.1-1ubuntu1)
devel_ffmpeg: not-affected (7:5.1.1-1ubuntu1)
