PublicDateAtUSN: 2023-10-11 12:15:00 UTC
Candidate: CVE-2023-44981
PublicDate: 2023-10-11 12:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2023/10/11/4
 https://github.com/apache/zookeeper/commit/e2070bed85d8b0c98a5a0045bf92421f473c412e (master)
 https://github.com/apache/zookeeper/commit/96b3172ca249a8580e9a315d589d319286cee4ee (branch-3.8)
 https://lists.apache.org/thread/wf0yrk84dg1942z1o74kd8nycg6pgm5b
 http://www.openwall.com/lists/oss-security/2023/10/11/4
 https://ubuntu.com/security/notices/USN-6559-1
 https://www.cve.org/CVERecord?id=CVE-2023-44981
Description:
 Authorization Bypass Through User-Controlled Key vulnerability in Apache
 ZooKeeper. If SASL Quorum Peer authentication is enabled in ZooKeeper
 (quorum.auth.enableSasl=true), the authorization is done by verifying that
 the instance part in SASL authentication ID is listed in zoo.cfg server
 list. The instance part in SASL auth ID is optional and if it's missing,
 like 'eve@EXAMPLE.COM', the authorization check will be skipped. As a
 result an arbitrary endpoint could join the cluster and begin propagating
 counterfeit changes to the leader, essentially giving it complete
 read-write access to the data tree. Quorum Peer authentication is not
 enabled by default. Users are recommended to upgrade to version 3.9.1,
 3.8.3, 3.7.2, which fixes the issue. Alternately ensure the ensemble
 election/quorum communication is protected by a firewall as this will
 mitigate the issue. See the documentation for more details on correct
 cluster administration.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by: Damien Diederen
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N [9.1 CRITICAL]

Patches_zookeeper:
upstream_zookeeper: released (3.7.2, 3.8.3, 3.9.1)
trusty_zookeeper: ignored (end of standard support)
trusty/esm_zookeeper: not-affected (code not present)
esm-infra-legacy/trusty_zookeeper: not-affected (code not present)
xenial_zookeeper: ignored (end of standard support)
esm-apps/xenial_zookeeper: not-affected (code not present)
bionic_zookeeper: ignored (end of standard support)
esm-apps/bionic_zookeeper: released (3.4.13-3ubuntu0.1~esm1)
focal_zookeeper: released (3.4.13-5ubuntu0.1)
esm-apps/focal_zookeeper: released (3.4.13-5ubuntu0.1)
jammy_zookeeper: released (3.4.13-6ubuntu4.1)
esm-apps/jammy_zookeeper: released (3.4.13-6ubuntu4.1)
lunar_zookeeper: released (3.8.0-10ubuntu0.1)
mantic_zookeeper: released (3.8.0-11ubuntu0.1)
devel_zookeeper: not-affected (3.9.1-1build1)
