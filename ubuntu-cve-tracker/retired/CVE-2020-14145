Candidate: CVE-2020-14145
PublicDate: 2020-06-29 18:15:00 UTC
References:
 https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-2-ausnutzung-eines-informationslecks-fuer-gezielte-mitm-angriffe-auf-ssh-clients/
 https://www.fzi.de/fileadmin/user_upload/2020-06-26-FSA-2020-2.pdf
 https://github.com/openssh/openssh-portable/compare/V_8_3_P1...V_8_4_P1
 https://ubuntu.com/security/notices/USN-6279-1
 https://www.cve.org/CVERecord?id=CVE-2020-14145
Description:
 The client side in OpenSSH 5.7 through 8.4 has an Observable Discrepancy
 leading to an information leak in the algorithm negotiation. This allows
 man-in-the-middle attackers to target initial connection attempts (where no
 host key for the server has been cached by the client). NOTE: some reports
 state that 8.5 and 8.6 are also affected.
Ubuntu-Description:
Notes:
 seth-arnold> openssh-ssh1 is provided for compatibility with old devices that
  cannot be upgraded to modern protocols. Thus we may not provide security
  support for this package if doing so would prevent access to equipment.
 mdeslaur> Per the advisory, "The developers of OpenSSH are not planning to
 mdeslaur> change the behavior of OpenSSH regarding this issue"
 mdeslaur> We will not be releasing updates for Ubuntu for this issue.
 mdeslaur>
 mdeslaur> On 2020-12-02, it was announced that a partial mitigation has
 mdeslaur> been commited by OpenSSH developers in 8.4p1 that improves this
 mdeslaur> issue in a very specific scenario, specifically when the client
 mdeslaur> has a host key that happens to match the first entry in the
 mdeslaur> preferred algorithm list:
 mdeslaur> https://www.openwall.com/lists/oss-security/2020/12/02/1
 mdeslaur>
 mdeslaur> The mitigation does not solve this vulnerability in most use
 mdeslaur> cases.
 mdeslaur>
 litios> OpenSSH cannot be fixed to fully mitigate this CVE as fixing
 litios> it would disable the reordering of host key algorithms, breaking
 litios> RFC 4253. The partial mitigation disables this reordering
 litios> only in a single specific situation. Marking as ignored.
 mdeslaur>
 mdeslaur> The upstream OpenSSH developers marked the bug associated with
 mdeslaur> this issue as "Won't Fix", stating "we consider the automatic
 mdeslaur> ordering of host key algorithms an important feature for
 mdeslaur> security. ... Disabling this feature wholesale would IMO
 mdeslaur> result in a net *loss* of security as it would force more
 mdeslaur> connections that already have learned a hostkey to accept a new
 mdeslaur> one of a different algorithm, thereby needlessly exposing them
 mdeslaur> to MITM risk."
 mdeslaur>
 mdeslaur> Jammy and later Ubuntu releases contain the OpenSSH version that
 mdeslaur> includes the mitigation. Focal and older Ubuntu releases have
 mdeslaur> been updated to include the mitigation in USN-6279-1.
 mdeslaur>
 mdeslaur> This issue only affects the OpenSSH client, not the server.
Mitigation:
Bugs:
 https://bugzilla.mindrot.org/show_bug.cgi?id=3313
 https://bugs.launchpad.net/ubuntu/+source/openssh/+bug/2030275
 https://bugs.launchpad.net/ubuntu/+source/openssh/+bug/2030275
 https://bugzilla.redhat.com/show_bug.cgi?id=1852930
 https://bugzilla.suse.com/show_bug.cgi?id=1173513
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N [5.9 MEDIUM]

Patches_openssh:
 upstream: https://anongit.mindrot.org/openssh.git/commit/?id=b3855ff053f5078ec3d3c653cdaedefaa5fc362d
upstream_openssh: ignored
precise/esm_openssh: ignored (end of life, was needed)
trusty_openssh: ignored (end of standard support)
trusty/esm_openssh: ignored (end of ESM support, was ignored [see notes])
esm-infra-legacy/trusty_openssh: ignored (see notes)
xenial_openssh: ignored (end of standard support, was needed)
esm-infra/xenial_openssh: ignored (see notes)
fips/xenial_openssh: ignored (see notes)
fips-updates/xenial_openssh: ignored (see notes)
bionic_openssh: ignored (end of standard support, was deferred)
esm-infra/bionic_openssh: ignored (see notes)
fips/bionic_openssh: ignored (see notes)
fips-updates/bionic_openssh: ignored (see notes)
eoan_openssh: ignored (end of life)
focal_openssh: ignored (end of standard support, was ignored [see notes])
esm-infra/focal_openssh: ignored (see notes)
fips/focal_openssh: ignored (see notes)
fips-updates/focal_openssh: ignored (see notes)
groovy_openssh: ignored (end of life)
hirsute_openssh: ignored (end of life)
impish_openssh: ignored (end of life)
jammy_openssh: ignored (see notes)
kinetic_openssh: ignored (end of life, was ignored [see notes])
lunar_openssh: ignored (end of life)
mantic_openssh: ignored (end of life, was ignored [see notes])
devel_openssh: ignored (see notes)

Patches_openssh-ssh1:
upstream_openssh-ssh1: ignored (frozen on openssh 7.5p)
precise/esm_openssh-ssh1: DNE
trusty_openssh-ssh1: DNE
trusty/esm_openssh-ssh1: DNE
esm-infra-legacy/trusty_openssh-ssh1: DNE
xenial_openssh-ssh1: DNE
bionic_openssh-ssh1: ignored (end of standard support, was deferred)
esm-apps/bionic_openssh-ssh1: ignored (see notes)
eoan_openssh-ssh1: ignored (end of life)
focal_openssh-ssh1: ignored (end of standard support, was ignored [see notes])
esm-apps/focal_openssh-ssh1: ignored (see notes)
groovy_openssh-ssh1: ignored (end of life)
hirsute_openssh-ssh1: ignored (end of life)
impish_openssh-ssh1: ignored (end of life)
jammy_openssh-ssh1: ignored (see notes)
esm-apps/jammy_openssh-ssh1: ignored (see notes)
kinetic_openssh-ssh1: ignored (end of life, was deferred)
lunar_openssh-ssh1: ignored (end of life, was deferred)
mantic_openssh-ssh1: ignored (end of life, was ignored [see notes])
devel_openssh-ssh1: ignored (see notes)
