PublicDateAtUSN: 2025-02-11
Candidate: CVE-2024-12797
PublicDate: 2025-02-11 16:15:00 UTC
CRD: 2025-02-11
References:
 https://www.cve.org/CVERecord?id=CVE-2024-12797
 https://openssl-library.org/news/secadv/20250211.txt
 https://ubuntu.com/security/notices/USN-7264-1
Description:
 Issue summary: Clients using RFC7250 Raw Public Keys (RPKs) to authenticate
 a
 server may fail to notice that the server was not authenticated, because
 handshakes don't abort as expected when the SSL_VERIFY_PEER verification
 mode
 is set.
 
 Impact summary: TLS and DTLS connections using raw public keys may be
 vulnerable to man-in-middle attacks when server authentication failure is
 not
 detected by clients.
 
 RPKs are disabled by default in both TLS clients and TLS servers.  The
 issue
 only arises when TLS clients explicitly enable RPK use by the server, and
 the
 server, likewise, enables sending of an RPK instead of an X.509 certificate
 chain.  The affected clients are those that then rely on the handshake to
 fail when the server's RPK fails to match one of the expected public keys,
 by setting the verification mode to SSL_VERIFY_PEER.
 
 Clients that enable server-side raw public keys can still find out that raw
 public key verification failed by calling SSL_get_verify_result(), and
 those
 that do, and take appropriate action, are not affected.  This issue was
 introduced in the initial implementation of RPK support in OpenSSL 3.2.
 
 The FIPS modules in 3.4, 3.3, 3.2, 3.1 and 3.0 are not affected by this
 issue.
Ubuntu-Description:
Notes:
 mdeslaur> 3.2.x+ only
 mdeslaur> introduced in RFC7250 support by this commit:
 mdeslaur> https://github.com/openssl/openssl/commit/3c95ef22df55cb2d9dc64ce1f3be6e5a8ee63206
Mitigation:
Bugs:
Priority: high
 OpenSSL developers have rated this of high severity
Discovered-by:
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L [6.3 MEDIUM]

Patches_openssl:
upstream_openssl: released (3.4.1,3.3.3,3.2.4)
esm-infra-legacy/trusty_openssl: not-affected (code not present)
esm-infra/xenial_openssl: not-affected (code not present)
fips-updates/xenial_openssl: not-affected (code not present)
fips/xenial_openssl: not-affected (code not present)
esm-infra/bionic_openssl: not-affected (code not present)
fips-updates/bionic_openssl: not-affected (code not present)
fips/bionic_openssl: not-affected (code not present)
focal_openssl: not-affected (code not present)
esm-infra/focal_openssl: not-affected (code not present)
fips-updates/focal_openssl: not-affected (code not present)
fips/focal_openssl: not-affected (code not present)
jammy_openssl: not-affected (code not present)
fips-preview/jammy_openssl: not-affected (code not present)
fips-updates/jammy_openssl: not-affected (code not present)
noble_openssl: not-affected (code not present)
oracular_openssl: released (3.3.1-2ubuntu2.1)
plucky_openssl: released (3.4.1-1ubuntu1)
devel_openssl: released (3.4.1-1ubuntu1)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
esm-infra/bionic_openssl1.0: not-affected (code not present)
focal_openssl1.0: DNE
esm-infra/focal_openssl1.0: DNE
jammy_openssl1.0: DNE
noble_openssl1.0: DNE
oracular_openssl1.0: DNE
plucky_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
esm-infra-legacy/trusty_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (OpenSSL 3.2+ only)
esm-apps/bionic_nodejs: not-affected (OpenSSL 3.2+ only)
focal_nodejs: not-affected (uses system openssl)
esm-apps/focal_nodejs: not-affected (OpenSSL 3.2+ only)
jammy_nodejs: not-affected (OpenSSL 3.2+ only)
esm-apps/jammy_nodejs: not-affected (OpenSSL 3.2+ only)
noble_nodejs: not-affected (uses system openssl)
esm-apps/noble_nodejs: not-affected (uses system openssl)
oracular_nodejs: not-affected (uses system openssl)
plucky_nodejs: not-affected (uses system openssl)
devel_nodejs: not-affected (uses system openssl)

Patches_edk2:
Priority_edk2: low
upstream_edk2: needs-triage
esm-apps/xenial_edk2: not-affected (OpenSSL 3.2+ only)
esm-apps/bionic_edk2: not-affected (OpenSSL 3.2+ only)
focal_edk2: not-affected (OpenSSL 3.2+ only)
esm-infra/focal_edk2: not-affected (OpenSSL 3.2+ only)
jammy_edk2: not-affected (OpenSSL 3.2+ only)
noble_edk2: not-affected (OpenSSL 3.2+ only)
oracular_edk2: not-affected (OpenSSL 3.2+ only)
plucky_edk2: not-affected (OpenSSL 3.2+ only)
devel_edk2: not-affected (OpenSSL 3.2+ only)
