PublicDateAtUSN: 2020-01-16 23:15:00 UTC
Candidate: CVE-2020-7039
PublicDate: 2020-01-16 23:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2020/01/16/2
 https://ubuntu.com/security/notices/USN-4283-1
 https://ubuntu.com/security/notices/USN-4632-1
 https://www.cve.org/CVERecord?id=CVE-2020-7039
 https://ubuntu.com/security/notices/USN-7094-1
Description:
 tcp_emu in tcp_subr.c in libslirp 4.1.0, as used in QEMU 4.2.0, mismanages
 memory, as demonstrated by IRC DCC commands in EMU_IRC. This can cause a
 heap-based buffer overflow or other out-of-bounds access which can lead to
 a DoS or potential execute arbitrary code.
Ubuntu-Description:
 It was discovered that the SLiRP networking implementation of the QEMU
 emulator did not properly manage memory under certain circumstances. An
 attacker could use this to cause a heap-based buffer overflow or other
 out-of-bounds access, which can lead to a denial of service (application
 crash) or potential execute arbitrary code.
Notes:
 mdeslaur> possible better approach would be to disable tcp_emu completely
 mdeslaur> https://gitlab.freedesktop.org/slirp/libslirp/commit/07c2a44b67e219ac14207f7a1b33704e1312cf91
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L [5.6 MEDIUM]

Patches_qemu-kvm:
upstream_qemu-kvm: needs-triage
precise/esm_qemu-kvm: ignored (end of life, was needs-triage)
trusty_qemu-kvm: DNE
trusty/esm_qemu-kvm: DNE
esm-infra-legacy/trusty_qemu-kvm: DNE
xenial_qemu-kvm: DNE
bionic_qemu-kvm: DNE
disco_qemu-kvm: DNE
eoan_qemu-kvm: DNE
focal_qemu-kvm: DNE
esm-infra/focal_qemu-kvm: DNE
groovy_qemu-kvm: DNE
hirsute_qemu-kvm: DNE
impish_qemu-kvm: DNE
jammy_qemu-kvm: DNE
kinetic_qemu-kvm: DNE
lunar_qemu-kvm: DNE
mantic_qemu-kvm: DNE
noble_qemu-kvm: DNE
oracular_qemu-kvm: DNE
devel_qemu-kvm: DNE

Patches_qemu:
upstream_qemu: released (1:4.2-1)
precise/esm_qemu: DNE
trusty_qemu: ignored (end of standard support)
trusty/esm_qemu: released (2.0.0+dfsg-2ubuntu1.47+esm4)
esm-infra-legacy/trusty_qemu: released (2.0.0+dfsg-2ubuntu1.47+esm4)
xenial_qemu: released (1:2.5+dfsg-5ubuntu10.43)
esm-infra/xenial_qemu: released (1:2.5+dfsg-5ubuntu10.43)
bionic_qemu: released (1:2.11+dfsg-1ubuntu7.23)
esm-infra/bionic_qemu: released (1:2.11+dfsg-1ubuntu7.23)
disco_qemu: ignored (end of life)
eoan_qemu: released (1:4.0+dfsg-0ubuntu9.4)
focal_qemu: not-affected (uses system libslirp)
esm-infra/focal_qemu: not-affected (uses system libslirp)
groovy_qemu: not-affected (uses system libslirp)
hirsute_qemu: not-affected (uses system libslirp)
impish_qemu: not-affected (uses system libslirp)
jammy_qemu: not-affected (uses system libslirp)
kinetic_qemu: not-affected (uses system libslirp)
lunar_qemu: not-affected (uses system libslirp)
mantic_qemu: not-affected (uses system libslirp)
noble_qemu: not-affected (uses system libslirp)
oracular_qemu: not-affected (uses system libslirp)
devel_qemu: not-affected (uses system libslirp)

Patches_libslirp:
 upstream: https://gitlab.freedesktop.org/slirp/libslirp/commit/2655fffed7a9e765bcb4701dd876e9dab975f289
 upstream: https://gitlab.freedesktop.org/slirp/libslirp/commit/ce131029d6d4a405cb7d3ac6716d03e58fb4a5d9
 upstream: https://gitlab.freedesktop.org/slirp/libslirp/commit/82ebe9c370a0e2970fb5695aa19aa5214a6a1c80
upstream_libslirp: released (4.1.0-2)
precise/esm_libslirp: DNE
trusty_libslirp: ignored (end of standard support)
trusty/esm_libslirp: DNE
esm-infra-legacy/trusty_libslirp: DNE
xenial_libslirp: DNE
bionic_libslirp: DNE
disco_libslirp: DNE
eoan_libslirp: DNE
focal_libslirp: not-affected (4.1.0-2)
esm-infra/focal_libslirp: not-affected (4.1.0-2)
groovy_libslirp: not-affected (4.1.0-2)
hirsute_libslirp: not-affected (4.1.0-2)
impish_libslirp: not-affected (4.1.0-2)
jammy_libslirp: not-affected (4.1.0-2)
kinetic_libslirp: not-affected (4.1.0-2)
lunar_libslirp: not-affected (4.1.0-2)
mantic_libslirp: not-affected (4.1.0-2)
noble_libslirp: not-affected (4.1.0-2)
oracular_libslirp: not-affected (4.1.0-2)
devel_libslirp: not-affected (4.1.0-2)

Patches_slirp:
upstream_slirp: needed
precise/esm_slirp: DNE
trusty_slirp: ignored (end of standard support)
trusty/esm_slirp: released (1:1.0.17-7+deb8u2build0.14.04.1+esm1)
esm-infra-legacy/trusty_slirp: released (1:1.0.17-7+deb8u2build0.14.04.1+esm1)
xenial_slirp: released (1:1.0.17-8ubuntu16.04.1)
esm-apps/xenial_slirp: released (1:1.0.17-8ubuntu16.04.1)
bionic_slirp: released (1:1.0.17-8ubuntu18.04.1)
esm-apps/bionic_slirp: released (1:1.0.17-8ubuntu18.04.1)
disco_slirp: ignored (end of life)
eoan_slirp: ignored (end of life)
focal_slirp: not-affected (1:1.0.17-10)
esm-apps/focal_slirp: not-affected (1:1.0.17-10)
groovy_slirp: not-affected (1:1.0.17-10)
hirsute_slirp: not-affected (1:1.0.17-10)
impish_slirp: not-affected (1:1.0.17-10)
jammy_slirp: not-affected (1:1.0.17-10)
esm-apps/jammy_slirp: not-affected (1:1.0.17-10)
kinetic_slirp: not-affected (1:1.0.17-10)
lunar_slirp: not-affected (1:1.0.17-10)
mantic_slirp: not-affected (1:1.0.17-10)
noble_slirp: not-affected (1:1.0.17-10)
esm-apps/noble_slirp: not-affected (1:1.0.17-10)
oracular_slirp: not-affected (1:1.0.17-10)
devel_slirp: not-affected (1:1.0.17-10)
