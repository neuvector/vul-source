Candidate: CVE-2018-12029
PublicDate: 2018-06-17 20:29:00 UTC
References:
 https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes/
 https://blog.phusion.nl/passenger-5-3-2
 https://pulsesecurity.co.nz/advisories/phusion-passenger-priv-esc
 https://www.cve.org/CVERecord?id=CVE-2018-12029
 https://ubuntu.com/security/notices/USN-5261-1
Description:
 A race condition in the nginx module in Phusion Passenger 3.x through 5.x
 before 5.3.2 allows local escalation of privileges when a non-standard
 passenger_instance_registry_dir with insufficiently strict permissions is
 configured. Replacing a file with a symlink after the file was created, but
 before it was chowned, leads to the target of the link being chowned via
 the path. Targeting sensitive files such as root's crontab file allows
 privilege escalation.
Ubuntu-Description:
Notes:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H [7.0 HIGH]


Patches_passenger:
 upstream: https://github.com/phusion/passenger/commit/207870f5b7f5cc240587ab0977d6046782ae1d86
upstream_passenger: released (5.0.30-1.1)
precise/esm_passenger: DNE
trusty_passenger: DNE
trusty/esm_passenger: DNE
esm-infra-legacy/trusty_passenger: DNE
xenial_passenger: ignored (end of standard support, was needs-triage)
esm-apps/xenial_passenger: released (5.0.27-2ubuntu0.1~esm1)
artful_passenger: ignored (end of life)
bionic_passenger: released (5.0.30-1+deb9u1build0.18.04.1)
esm-apps/bionic_passenger: released (5.0.30-1+deb9u1build0.18.04.1)
cosmic_passenger: released (5.0.30-1+deb9u1build0.18.10.1)
disco_passenger: released (5.0.30-1+deb9u1build0.19.04.1)
eoan_passenger: not-affected (5.0.30-1.1)
focal_passenger: not-affected (5.0.30-1.1)
esm-apps/focal_passenger: not-affected (5.0.30-1.1)
groovy_passenger: not-affected (5.0.30-1.1)
hirsute_passenger: not-affected (5.0.30-1.1)
impish_passenger: not-affected (5.0.30-1.1)
jammy_passenger: not-affected (5.0.30-1.1)
esm-apps/jammy_passenger: not-affected (5.0.30-1.1)
devel_passenger: not-affected (5.0.30-1.1)

Patches_ruby-passenger:
upstream_ruby-passenger: needs-triage
precise/esm_ruby-passenger: DNE
trusty_ruby-passenger: ignored (end of standard support)
trusty/esm_ruby-passenger: DNE (trusty was needs-triage)
esm-infra-legacy/trusty_ruby-passenger: DNE (trusty/esm was DNE [trusty was needs-triage])
xenial_ruby-passenger: DNE
artful_ruby-passenger: DNE
bionic_ruby-passenger: DNE
cosmic_ruby-passenger: DNE
disco_ruby-passenger: DNE
eoan_ruby-passenger: DNE
focal_ruby-passenger: DNE
groovy_ruby-passenger: DNE
hirsute_ruby-passenger: DNE
impish_ruby-passenger: DNE
jammy_ruby-passenger: DNE
devel_ruby-passenger: DNE
