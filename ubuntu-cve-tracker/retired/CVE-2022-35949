Candidate: CVE-2022-35949
PublicDate: 2022-08-12 23:15:00 UTC
References:
 https://github.com/nodejs/undici/security/advisories/GHSA-8qr4-xgw6-wmr3
 https://github.com/nodejs/undici/commit/124f7ebf705366b2e1844dff721928d270f87895 (v5.8.2)
 https://github.com/nodejs/undici/releases/tag/v5.8.2
 https://github.com/nodejs/undici/commit/124f7ebf705366b2e1844dff721928d270f87895
 https://www.cve.org/CVERecord?id=CVE-2022-35949
Description:
 undici is an HTTP/1.1 client, written from scratch for Node.js.`undici` is
 vulnerable to SSRF (Server-side Request Forgery) when an application takes
 in **user input** into the `path/pathname` option of `undici.request`. If a
 user specifies a URL such as `http://127.0.0.1` or `//127.0.0.1` ```js
 const undici = require("undici") undici.request({origin:
 "http://example.com", pathname: "//127.0.0.1"}) ``` Instead of processing
 the request as `http://example.org//127.0.0.1` (or
 `http://example.org/http://127.0.0.1` when `http://127.0.0.1 is used`), it
 actually processes the request as `http://127.0.0.1/` and sends it to
 `http://127.0.0.1`. If a developer passes in user input into `path`
 parameter of `undici.request`, it can result in an _SSRF_ as they will
 assume that the hostname cannot change, when in actual fact it can change
 because the specified path parameter is combined with the base URL. This
 issue was fixed in `undici@5.8.1`. The best workaround is to validate user
 input before passing it to the `undici.request` call.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N [5.3 MEDIUM]


Patches_node-undici:
 upstream: https://github.com/nodejs/undici/commit/124f7ebf705366b2e1844dff721928d270f87895
upstream_node-undici: released (5.8.2+dfsg1+~cs18.9.18.1-1)
trusty_node-undici: DNE
xenial_node-undici: DNE
bionic_node-undici: DNE
focal_node-undici: DNE
jammy_node-undici: DNE
kinetic_node-undici: not-affected (5.8.2+dfsg1+~cs18.9.18.1-1)
devel_node-undici: not-affected (5.8.2+dfsg1+~cs18.9.18.1-1)
