PublicDateAtUSN: 2023-06-19
Candidate: CVE-2023-3247
PublicDate: 2023-07-22 05:15:00 UTC
References:
 https://github.com/php/php-src/security/advisories/GHSA-76gg-c692-v2mw
 https://github.com/php/php-src/commit/ac4254ad764c70cb1f05c9270d8d12689fc3aeb6 (php-8.0.29)
 https://github.com/php/php-src/commit/32c7c433ac1983c4497349051681a4f361d3d33e (php-8.0.29)
 https://ubuntu.com/security/notices/USN-6199-1
 https://ubuntu.com/security/notices/USN-6199-2
 https://www.cve.org/CVERecord?id=CVE-2023-3247
Description:
 In PHP versions 8.0.* before 8.0.29, 8.1.* before 8.1.20, 8.2.* before
 8.2.7 when using SOAP HTTP Digest Authentication, random value generator
 was not checked for failure, and was using narrower range of values than it
 should have. In case of random generator failure, it could lead to a
 disclosure of 31 bits of uninitialized memory from the client to the
 server, and it also made easier to a malicious server to guess the client's
 nonce.
Ubuntu-Description:
Notes:
 sbeattie> PEAR issues should go against php-pear as of xenial
 rodrigo-zaiden> the method php_random_bytes_throw that is being used for
  nonce generation was added in php7.0 with CSPRNG API, so patching versions
  older than that is not feasible as it would would likely add other issues.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N [4.3 MEDIUM]
 php: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N [2.6 LOW]

Patches_php5:
upstream_php5: needs-triage
trusty_php5: ignored (end of standard support)
trusty/esm_php5: ignored (end of ESM support, was ignored [fix not applicable])
esm-infra-legacy/trusty_php5: ignored (fix not applicable)
xenial_php5: DNE
bionic_php5: DNE
focal_php5: DNE
jammy_php5: DNE
kinetic_php5: DNE
lunar_php5: DNE
mantic_php5: DNE
devel_php5: DNE

Patches_php7.0:
upstream_php7.0: needs-triage
trusty_php7.0: DNE
xenial_php7.0: ignored (end of standard support)
esm-infra/xenial_php7.0: released (7.0.33-0ubuntu0.16.04.16+esm7)
bionic_php7.0: DNE
focal_php7.0: DNE
jammy_php7.0: DNE
kinetic_php7.0: DNE
lunar_php7.0: DNE
mantic_php7.0: DNE
devel_php7.0: DNE

Patches_php7.2:
upstream_php7.2: needs-triage
trusty_php7.2: DNE
xenial_php7.2: DNE
bionic_php7.2: ignored (end of standard support)
esm-infra/bionic_php7.2: released (7.2.24-0ubuntu0.18.04.17+esm1)
focal_php7.2: DNE
jammy_php7.2: DNE
kinetic_php7.2: DNE
lunar_php7.2: DNE
mantic_php7.2: DNE
devel_php7.2: DNE

Patches_php7.4:
upstream_php7.4: needs-triage
trusty_php7.4: DNE
xenial_php7.4: DNE
bionic_php7.4: DNE
focal_php7.4: released (7.4.3-4ubuntu2.19)
jammy_php7.4: DNE
kinetic_php7.4: DNE
lunar_php7.4: DNE
mantic_php7.4: DNE
devel_php7.4: DNE

Patches_php8.1:
upstream_php8.1: released (8.1.20)
trusty_php8.1: DNE
xenial_php8.1: DNE
bionic_php8.1: DNE
focal_php8.1: DNE
jammy_php8.1: released (8.1.2-1ubuntu2.13)
kinetic_php8.1: released (8.1.7-1ubuntu3.5)
lunar_php8.1: released (8.1.12-1ubuntu4.2)
mantic_php8.1: DNE
devel_php8.1: DNE

Patches_php8.2:
upstream_php8.2: released (8.2.7-1)
trusty_php8.2: ignored (end of standard support)
xenial_php8.2: ignored (end of standard support)
bionic_php8.2: ignored (end of standard support)
focal_php8.2: DNE
jammy_php8.2: DNE
kinetic_php8.2: DNE
lunar_php8.2: DNE
mantic_php8.2: not-affected (8.2.7-1ubuntu1)
devel_php8.2: not-affected (8.2.7-1ubuntu1)
