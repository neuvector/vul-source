PublicDateAtUSN: 2022-03-17 13:15:00 UTC
Candidate: CVE-2022-24761
PublicDate: 2022-03-17 13:15:00 UTC
References:
 https://github.com/Pylons/waitress/security/advisories/GHSA-4f7p-27jc-3c36
 https://github.com/Pylons/waitress/commit/9e0b8c801e4d505c2ffc91b891af4ba48af715e0 (v2.1.1)
 https://github.com/Pylons/waitress/commit/9e0b8c801e4d505c2ffc91b891af4ba48af715e0
 https://github.com/Pylons/waitress/releases/tag/v2.1.1
 https://ubuntu.com/security/notices/USN-5364-1
 https://www.cve.org/CVERecord?id=CVE-2022-24761
Description:
 Waitress is a Web Server Gateway Interface server for Python 2 and 3. When
 using Waitress versions 2.1.0 and prior behind a proxy that does not
 properly validate the incoming HTTP request matches the RFC7230 standard,
 Waitress and the frontend proxy may disagree on where one request starts
 and where it ends. This would allow requests to be smuggled via the
 front-end proxy to waitress and later behavior. There are two classes of
 vulnerability that may lead to request smuggling that are addressed by this
 advisory: The use of Python's `int()` to parse strings into integers,
 leading to `+10` to be parsed as `10`, or `0x01` to be parsed as `1`, where
 as the standard specifies that the string should contain only digits or hex
 digits; and Waitress does not support chunk extensions, however it was
 discarding them without validating that they did not contain illegal
 characters. This vulnerability has been patched in Waitress 2.1.1. A
 workaround is available. When deploying a proxy in front of waitress,
 turning on any and all functionality to make sure that the request matches
 the RFC7230 standard. Certain proxy servers may not have this functionality
 though and users are encouraged to upgrade to the latest version of
 waitress instead.
Ubuntu-Description:
Notes:
 leosilva> there is no support for rfc7230 on bionic and old releases.
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1008013
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N [7.5 HIGH]


Patches_waitress:
upstream_waitress: needs-triage
esm-infra/xenial_waitress: not-affected (code not present)
trusty_waitress: ignored (end of standard support)
xenial_waitress: ignored (end of standard support)
bionic_waitress: not-affected (code not present)
esm-infra/bionic_waitress: not-affected (code not present)
focal_waitress: released (1.4.1-1ubuntu0.1)
impish_waitress: released (1.4.4-1.1ubuntu0.1)
jammy_waitress: released (1.4.4-1.1ubuntu1)
devel_waitress: released (1.4.4-1.1ubuntu1)
