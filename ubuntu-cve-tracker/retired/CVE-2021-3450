Candidate: CVE-2021-3450
CRD: 2021-03-25
PublicDate: 2021-03-25 15:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3450
 https://www.openssl.org/news/secadv/20210325.txt
Description:
 The X509_V_FLAG_X509_STRICT flag enables additional security checks of the
 certificates present in a certificate chain. It is not set by default.
 Starting from OpenSSL version 1.1.1h a check to disallow certificates in
 the chain that have explicitly encoded elliptic curve parameters was added
 as an additional strict check. An error in the implementation of this check
 meant that the result of a previous check to confirm that certificates in
 the chain are valid CA certificates was overwritten. This effectively
 bypasses the check that non-CA certificates must not be able to issue other
 certificates. If a "purpose" has been configured then there is a subsequent
 opportunity for checks that the certificate is a valid CA. All of the named
 "purpose" values implemented in libcrypto perform this check. Therefore,
 where a purpose is set the certificate chain will still be rejected even
 when the strict flag has been used. A purpose is set by default in libssl
 client and server certificate verification routines, but it can be
 overridden or removed by an application. In order to be affected, an
 application must explicitly set the X509_V_FLAG_X509_STRICT verification
 flag and either not set a purpose for the certificate verification or, in
 the case of TLS client or server applications, override the default
 purpose. OpenSSL versions 1.1.1h and newer are affected by this issue.
 Users of these versions should upgrade to OpenSSL 1.1.1k. OpenSSL 1.0.2 is
 not impacted by this issue. Fixed in OpenSSL 1.1.1k (Affected
 1.1.1h-1.1.1j).
Ubuntu-Description: 
Notes: 
 mdeslaur> only affects 1.1.1h and later
 mdeslaur> edk2 in Ubuntu contains an embedded OpenSSL earlier than 1.1.1h
Mitigation: 
Bugs: 
Priority: high
Discovered-by: Xiang Ding
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N [7.4 HIGH]

Patches_openssl:
upstream_openssl: needs-triage
precise/esm_openssl: not-affected
trusty_openssl: ignored (out of standard support)
trusty/esm_openssl: not-affected
xenial_openssl: not-affected (1.0.2g-1ubuntu4.19)
esm-infra/xenial_openssl: not-affected (1.0.2g-1ubuntu4.19)
bionic_openssl: not-affected (1.1.1-1ubuntu2.1~18.04.8)
focal_openssl: not-affected (1.1.1f-1ubuntu2.2)
groovy_openssl: not-affected (1.1.1f-1ubuntu4.2)
devel_openssl: released (1.1.1j-1ubuntu3)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
precise/esm_openssl1.0: DNE
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: not-affected (1.0.2n-1ubuntu5.6)
focal_openssl1.0: DNE
groovy_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
precise/esm_nodejs: DNE
trusty_nodejs: ignored (out of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
groovy_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
Priority_edk2: low
upstream_edk2: not-affected
precise/esm_edk2: DNE
trusty_edk2: ignored (out of standard support)
trusty/esm_edk2: DNE
xenial_edk2: not-affected
esm-apps/xenial_edk2: not-affected
bionic_edk2: not-affected
esm-apps/bionic_edk2: not-affected
focal_edk2: not-affected
groovy_edk2: not-affected
devel_edk2: not-affected
