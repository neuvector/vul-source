PublicDateAtUSN: 2020-12-08
Candidate: CVE-2020-1971
CRD: 2020-12-08
PublicDate: 2020-12-08 16:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1971
 https://www.openssl.org/news/secadv/20201208.txt
 https://ubuntu.com/security/notices/USN-4662-1
 https://ubuntu.com/security/notices/USN-4745-1
Description:
 The X.509 GeneralName type is a generic type for representing different
 types of names. One of those name types is known as EDIPartyName. OpenSSL
 provides a function GENERAL_NAME_cmp which compares different instances of
 a GENERAL_NAME to see if they are equal or not. This function behaves
 incorrectly when both GENERAL_NAMEs contain an EDIPARTYNAME. A NULL pointer
 dereference and a crash may occur leading to a possible denial of service
 attack. OpenSSL itself uses the GENERAL_NAME_cmp function for two purposes:
 1) Comparing CRL distribution point names between an available CRL and a
 CRL distribution point embedded in an X509 certificate 2) When verifying
 that a timestamp response token signer matches the timestamp authority name
 (exposed via the API functions TS_RESP_verify_response and
 TS_RESP_verify_token) If an attacker can control both items being compared
 then that attacker could trigger a crash. For example if the attacker can
 trick a client or server into checking a malicious certificate against a
 malicious CRL then this may occur. Note that some applications
 automatically download CRLs based on a URL embedded in a certificate. This
 checking happens prior to the signatures on the certificate and CRL being
 verified. OpenSSL's s_server, s_client and verify tools have support for
 the "-crl_download" option which implements automatic CRL downloading and
 this attack has been demonstrated to work against those tools. Note that an
 unrelated bug means that affected versions of OpenSSL cannot parse or
 construct correct encodings of EDIPARTYNAME. However it is possible to
 construct a malformed EDIPARTYNAME that OpenSSL's parser will accept and
 hence trigger this attack. All OpenSSL 1.1.1 and 1.0.2 versions are
 affected by this issue. Other OpenSSL releases are out of support and have
 not been checked. Fixed in OpenSSL 1.1.1i (Affected 1.1.1-1.1.1h). Fixed in
 OpenSSL 1.0.2x (Affected 1.0.2-1.0.2w).
Ubuntu-Description: 
Notes: 
 mdeslaur> edk2 doesn't use the OpenSSL GENERAL_NAME_cmp function, so it is
 mdeslaur> not vulnerable to this issue.
Mitigation: 
Bugs: 
Priority: high
Discovered-by: David Benjamin
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H [5.9 MEDIUM]

Patches_openssl:
upstream_openssl: needs-triage
precise/esm_openssl: released (1.0.1-4ubuntu5.45)
trusty_openssl: ignored (out of standard support)
trusty/esm_openssl: released (1.0.1f-1ubuntu2.27+esm2)
xenial_openssl: released (1.0.2g-1ubuntu4.18)
esm-infra/xenial_openssl: released (1.0.2g-1ubuntu4.18)
bionic_openssl: released (1.1.1-1ubuntu2.1~18.04.7)
esm-infra/bionic_openssl: released (1.1.1-1ubuntu2.1~18.04.7)
focal_openssl: released (1.1.1f-1ubuntu2.1)
groovy_openssl: released (1.1.1f-1ubuntu4.1)
devel_openssl: released (1.1.1f-1ubuntu5)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
precise/esm_openssl1.0: DNE
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: released (1.0.2n-1ubuntu5.5)
esm-infra/bionic_openssl1.0: released (1.0.2n-1ubuntu5.5)
focal_openssl1.0: DNE
groovy_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
precise/esm_nodejs: DNE
trusty_nodejs: ignored (out of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
groovy_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
Priority_edk2: low
upstream_edk2: not-affected
precise/esm_edk2: DNE
trusty_edk2: ignored (out of standard support)
trusty/esm_edk2: DNE
xenial_edk2: not-affected
esm-apps/xenial_edk2: not-affected
bionic_edk2: not-affected
esm-apps/bionic_edk2: not-affected
focal_edk2: not-affected
groovy_edk2: not-affected
devel_edk2: not-affected
