Candidate: CVE-2021-27851
PublicDate: 2021-04-26 16:15:00 UTC
References:
 https://issues.guix.gnu.org/47229
 https://git.savannah.gnu.org/cgit/guix.git/commit/?id=ec7fb669945bfb47c5e1fdf7de3a5d07f7002ccf
 https://guix.gnu.org/en/blog/2021/risk-of-local-privilege-escalation-via-guix-daemon/
 https://www.cve.org/CVERecord?id=CVE-2021-27851
Description:
 A security vulnerability that can lead to local privilege escalation has
 been found in ’guix-daemon’. It affects multi-user setups in which
 ’guix-daemon’ runs locally. The attack consists in having an unprivileged
 user spawn a build process, for instance with `guix build`, that makes its
 build directory world-writable. The user then creates a hardlink to a
 root-owned file such as /etc/shadow in that build directory. If the user
 passed the --keep-failed option and the build eventually fails, the daemon
 changes ownership of the whole build tree, including the hardlink, to the
 user. At that point, the user has write access to the target file. Versions
 after and including v0.11.0-3298-g2608e40988, and versions prior to
 v1.2.0-75109-g94f0312546 are vulnerable.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=985467
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N [5.5 MEDIUM]


Patches_guix:
upstream_guix: released (1.2.0-4)
precise/esm_guix: DNE
trusty_guix: ignored (end of standard support)
trusty/esm_guix: DNE
esm-infra-legacy/trusty_guix: DNE
xenial_guix: DNE
bionic_guix: DNE
focal_guix: DNE
esm-infra/focal_guix: DNE
groovy_guix: DNE
hirsute_guix: ignored (end of life)
impish_guix: ignored (end of life)
jammy_guix: needs-triage
esm-apps/jammy_guix: needs-triage
kinetic_guix: ignored (end of life, was needs-triage)
lunar_guix: not-affected (1.3.0-5)
mantic_guix: not-affected (1.3.0-5)
noble_guix: not-affected (1.3.0-5)
esm-apps/noble_guix: not-affected (1.3.0-5)
oracular_guix: not-affected (1.3.0-5)
plucky_guix: not-affected (1.3.0-5)
questing_guix: not-affected (1.3.0-5)
devel_guix: not-affected (1.3.0-5)
