PublicDateAtUSN: 2022-10-27
Candidate: CVE-2022-3437
PublicDate: 2023-01-12 15:15:00 UTC
References:
 https://www.samba.org/samba/security/CVE-2022-3437.html
 https://github.com/heimdal/heimdal/security/advisories/GHSA-45j3-5v39-rf9j
 https://ubuntu.com/security/notices/USN-5800-1
 https://ubuntu.com/security/notices/USN-5822-1
 https://ubuntu.com/security/notices/USN-5822-2
 https://ubuntu.com/security/notices/USN-5936-1
 https://www.cve.org/CVERecord?id=CVE-2022-3437
Description:
 A heap-based buffer overflow vulnerability was found in Samba within the
 GSSAPI unwrap_des() and unwrap_des3() routines of Heimdal. The DES and
 Triple-DES decryption routines in the Heimdal GSSAPI library allow a
 length-limited write buffer overflow on malloc() allocated memory when
 presented with a maliciously small packet. This flaw allows a remote user
 to send specially crafted malicious data to the application, possibly
 resulting in a denial of service (DoS) attack.
Ubuntu-Description:
Notes:
 mdeslaur> The focal samba update was temporarily reverted by USN 5822-2
 mdeslaur> because it introduced regressions. It was later updated again
 mdeslaur> with USN 5936-1.
 rodrigo-zaiden> heimdal patch f6edaafc introduced a new issue, assigned as
 rodrigo-zaiden> CVE-2022-45142.
Mitigation:
Bugs:
 https://bugzilla.samba.org/show_bug.cgi?id=15134
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1024187
Priority: medium
Discovered-by: Evgeny Legerov
Assigned-to: gianz
CVSS:
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L [4.3 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H [6.5 MEDIUM]

Patches_heimdal:
 upstream: https://github.com/heimdal/heimdal/commit/f6edaafcfefd843ca1b1a041f942a853d85ee7c3 (heimdal-7.7.1)
 upstream: https://github.com/heimdal/heimdal/commit/c9cc34334bd64b08fe91a2f720262462e9f6bb49 (heimdal-7.7.1)
 upstream: https://github.com/heimdal/heimdal/commit/a587a4bcb28d5b9047f332573b1e7c8f89ca3edd (heimdal-7.7.1)
 upstream: https://github.com/heimdal/heimdal/commit/c758910eaad3c0de2cfb68830a661c4739675a7d (heimdal-7.7.1)
 upstream: https://github.com/heimdal/heimdal/commit/414b2a77fd61c26d64562e3800dc5578d9d0f15d (heimdal-7.7.1)
 upstream: https://github.com/heimdal/heimdal/commit/be9bbd93ed8f204b4bc1b92d1bc3c16aac194696 (heimdal-7.7.1)
 upstream: https://github.com/heimdal/heimdal/commit/c8407ca079294d76a5ed140ba5b546f870d23ed2 (heimdal-7.7.1)
 upstream: https://github.com/heimdal/heimdal/commit/8fb508a25a6a47289c73e3f4339352a73a396eef (heimdal-7.7.1)
Tags_heimdal: universe-binary
upstream_heimdal: released (7.7.1, 7.8, 7.8.git20221115.a6cf945+dfsg-1)
esm-infra/xenial_heimdal: released (1.7~git20150920+dfsg-4ubuntu1.16.04.1+esm3)
trusty_heimdal: ignored (end of standard support)
xenial_heimdal: ignored (end of standard support)
bionic_heimdal: released (7.5.0+dfsg-1ubuntu0.3)
esm-infra/bionic_heimdal: not-affected (7.5.0+dfsg-1ubuntu0.3)
focal_heimdal: released (7.7.0+dfsg-1ubuntu1.3)
jammy_heimdal: needed
esm-apps/jammy_heimdal: needed
kinetic_heimdal: ignored (end of life, was needed)
lunar_heimdal: not-affected (7.8.git20221117.28daf24+dfsg-1ubuntu1)
mantic_heimdal: not-affected (7.8.git20221117.28daf24+dfsg-1ubuntu1)
noble_heimdal: not-affected (7.8.git20221117.28daf24+dfsg-1ubuntu1)
esm-apps/noble_heimdal: not-affected (7.8.git20221117.28daf24+dfsg-1ubuntu1)
oracular_heimdal: not-affected (7.8.git20221117.28daf24+dfsg-1ubuntu1)
plucky_heimdal: not-affected (7.8.git20221117.28daf24+dfsg-1ubuntu1)
devel_heimdal: not-affected (7.8.git20221117.28daf24+dfsg-1ubuntu1)
trusty/esm_heimdal: released (1.6~git20131207+dfsg-1ubuntu1.2+esm3)
esm-infra-legacy/trusty_heimdal: not-affected (1.6~git20131207+dfsg-1ubuntu1.2+esm3)

Patches_samba:
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=0eaa68d1935236c0a6188ba1ba078db507887e6c (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=c5dd87f488820e180649e6fd3597bce4ffa24fdc (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=03eefa45d38ca3eade2018767421bb60ba65d58b (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=e3c314ed69f99db1c797772fbda83820352d5387 (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=9ca9408c5edf807de9fba9f59eabd899c79458a9 (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=c944773adc421b3f85a8166fa2d9733e3e9a10c2 (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=e1c2e2836efaa895d817b5611bf908284c3d415d (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=de77f0159873fb0c569c02cee5aa492af8e3f461 (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=d16ac1f4057ec0c26768f04f00c512abf271be7f (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=22dd9072c9f964931db931ee0b638a9799e947ca (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=5c31d5beb3bed6b28c8d648d889c47e69c16cc8e (4.16.6)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=fe1204d9da2c6f761c4dc4421f67057b10eaf430 (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=a49a3ac8e082921c2793a073b5991c4693f167ab (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=310bffc085514f9ceba5b3501ddef15807c53809 (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=c22914f845b3eba1c9ad444333f3d044352b7e2c (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=5f6dbf2ab29bcd30c701cab3daecf5a6a53a44cd (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=9f6f1e01aca4f00a5d23127803c81939253e0577 (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=5a62eb5734d50fe556934aefa3bac5698372f00e (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=ebac8bf0478e19849f83af6d44b73d7ab3afd25b (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=1aca34515515f2cb00fbf5ad8b9212b319f01836 (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=77e0f2febaaf4d6e5e42f8e73a1f8f3c0e4a2985 (4.15.11)
 upstream: https://git.samba.org/?p=samba.git;a=commit;h=e9db03736007721e37c4fba847ce4aa0c4520924 (4.15.11)
upstream_samba: released (2:4.16.6+dfsg-1,4.15.11,4.16.6,4.17.2)
trusty_samba: ignored (end of standard support)
trusty/esm_samba: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_samba: needs-triage
xenial_samba: ignored (end of standard support)
esm-infra/xenial_samba: needs-triage
bionic_samba: ignored (end of standard support, was needed)
esm-infra/bionic_samba: needed
focal_samba: released (2:4.15.13+dfsg-0ubuntu0.20.04.1)
jammy_samba: released (2:4.15.13+dfsg-0ubuntu1)
kinetic_samba: released (2:4.16.8+dfsg-0ubuntu1)
lunar_samba: released (2:4.17.3+dfsg-3ubuntu1)
mantic_samba: released (2:4.17.3+dfsg-3ubuntu1)
noble_samba: released (2:4.17.3+dfsg-3ubuntu1)
oracular_samba: released (2:4.17.3+dfsg-3ubuntu1)
plucky_samba: released (2:4.17.3+dfsg-3ubuntu1)
devel_samba: released (2:4.17.3+dfsg-3ubuntu1)

