PublicDateAtUSN: 2017-06-09 16:29:00 UTC
Candidate: CVE-2017-9525
PublicDate: 2017-06-09 16:29:00 UTC
References:
 http://www.openwall.com/lists/oss-security/2017/06/08/3
 http://bugs.debian.org/864466
 https://ubuntu.com/security/notices/USN-5259-1
 https://ubuntu.com/security/notices/USN-5259-2
 https://ubuntu.com/security/notices/USN-5259-3
 https://www.cve.org/CVERecord?id=CVE-2017-9525
Description:
 In the cron package through 3.0pl1-128 on Debian, and through
 3.0pl1-128ubuntu2 on Ubuntu, the postinst maintainer script allows for
 group-crontab-to-root privilege escalation via symlink attacks against
 unsafe usage of the chown and chmod programs.
Ubuntu-Description:
Notes:
 jj> This appears to be mitigated by kernel symlink restrictions. The
 jj> crontabs dir has the sticky bit set
 jj>    drwx-wx--T root crontab crontabs
 jj> which means symlinks within the dir must have the same uid as the
 jj> target.
 jj> It is still possible that a cron package update could trigger this race.
 seth-arnold> I believe that actually _exploiting_ the bug requires
 seth-arnold> updating the cron package. So long as there's no updates for cron,
 seth-arnold> the vulnerable code doesn't run. So if we find a second bug in
 seth-arnold> cron then we really should fix the race condition at the same
 seth-arnold> time, but so long as we don't push a cron update, the vulnerable
 seth-arnold> code just plain doesn't run.
 seth-arnold> the patch just narrows the time window for the race condition.
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=864466
 https://bugs.launchpad.net/ubuntu/+source/cron/+bug/1971895 (regression)
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=892720 (regression)
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H [6.7 MEDIUM]

Patches_cron:
 upstream: https://salsa.debian.org/debian/cron/-/commit/a10ab4e346e941aaa92f4b671a96895392b917af
 upstream: https://salsa.debian.org/debian/cron/-/commit/230478512cc82d879d727f6dfc18040bdd48c9d9
upstream_cron: released (3.0pl1-129)
precise/esm_cron: ignored (end of life, was needed)
trusty_cron: ignored (end of standard support)
trusty/esm_cron: ignored (end of ESM support, was needed)
esm-infra-legacy/trusty_cron: needed
vivid/stable-phone-overlay_cron: ignored (end of life)
vivid/ubuntu-core_cron: ignored (end of life)
xenial_cron: ignored (end of standard support, was needed)
esm-infra/xenial_cron: released (3.0pl1-128ubuntu2+esm2)
yakkety_cron: ignored (end of life)
zesty_cron: ignored (end of life)
artful_cron: ignored (end of life)
bionic_cron: released (3.0pl1-128.1ubuntu1.2)
esm-infra/bionic_cron: not-affected (3.0pl1-128.1ubuntu1.2)
cosmic_cron: ignored (end of life)
disco_cron: ignored (end of life)
eoan_cron: not-affected (3.0pl1-134ubuntu1)
focal_cron: not-affected (3.0pl1-134ubuntu1)
esm-infra/focal_cron: not-affected (3.0pl1-134ubuntu1)
groovy_cron: not-affected (3.0pl1-134ubuntu1)
hirsute_cron: not-affected (3.0pl1-134ubuntu1)
impish_cron: not-affected (3.0pl1-134ubuntu1)
jammy_cron: not-affected (3.0pl1-134ubuntu1)
kinetic_cron: not-affected (3.0pl1-134ubuntu1)
lunar_cron: not-affected (3.0pl1-134ubuntu1)
mantic_cron: not-affected (3.0pl1-134ubuntu1)
noble_cron: not-affected (3.0pl1-134ubuntu1)
oracular_cron: not-affected (3.0pl1-134ubuntu1)
plucky_cron: not-affected (3.0pl1-134ubuntu1)
devel_cron: not-affected (3.0pl1-134ubuntu1)
