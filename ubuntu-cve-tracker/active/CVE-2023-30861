Candidate: CVE-2023-30861
PublicDate: 2023-05-02 18:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30861
 https://github.com/pallets/flask/security/advisories/GHSA-m2qf-hxjv-5gpq
 https://github.com/pallets/flask/commit/8646edca6f47e2cd57464081b3911218d4734f8d (2.2.5)
 https://github.com/pallets/flask/commit/8705dd39c4fa563ea0fe0bf84c85da8fcc98b88d (2.3.2)
 https://github.com/pallets/flask/commit/70f906c51ce49c485f1d355703e9cc3386b1cc2b
 https://github.com/pallets/flask/releases/tag/2.3.2
 https://github.com/pallets/flask/releases/tag/2.2.5
 https://github.com/pallets/flask/commit/afd63b16170b7c047f5758eb910c416511e9c965
Description:
 Flask is a lightweight WSGI web application framework. When all of the
 following conditions are met, a response containing data intended for one
 client may be cached and subsequently sent by the proxy to other clients.
 If the proxy also caches `Set-Cookie` headers, it may send one client's
 `session` cookie to other clients. The severity depends on the
 application's use of the session and the proxy's behavior regarding
 cookies. The risk depends on all these conditions being met. 1. The
 application must be hosted behind a caching proxy that does not strip
 cookies or ignore responses with cookies. 2. The application sets
 `session.permanent = True` 3. The application does not access or modify the
 session at any point during a request. 4. `SESSION_REFRESH_EACH_REQUEST`
 enabled (the default). 5. The application does not set a `Cache-Control`
 header to indicate that a page is private or should not be cached. This
 happens because vulnerable versions of Flask only set the `Vary: Cookie`
 header when the session is accessed or modified, not when it is refreshed
 (re-sent to update the expiration) without being accessed or modified. This
 issue has been fixed in versions 2.3.2 and 2.2.5.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1035670
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]

Patches_flask:
upstream_flask: needs-triage
trusty_flask: ignored (out of standard support)
xenial_flask: ignored (out of standard support)
esm-infra/xenial_flask: needs-triage
bionic_flask: needs-triage
focal_flask: needs-triage
jammy_flask: needs-triage
kinetic_flask: needs-triage
lunar_flask: needs-triage
devel_flask: needs-triage
