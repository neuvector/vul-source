PublicDateAtUSN: 2025-02-12 17:15:00 UTC
Candidate: CVE-2025-25184
PublicDate: 2025-02-12 17:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-25184
 https://github.com/rack/rack/security/advisories/GHSA-7g2v-jj9q-g3rg
 https://ubuntu.com/security/notices/USN-7366-1
Description:
 Rack provides an interface for developing web applications in Ruby. Prior
 to versions 2.2.11, 3.0.12, and 3.1.10, Rack::CommonLogger can be exploited
 by crafting input that includes newline characters to manipulate log
 entries. The supplied proof-of-concept demonstrates injecting malicious
 content into logs. When a user provides the authorization credentials via
 Rack::Auth::Basic, if success, the username will be put in
 env['REMOTE_USER'] and later be used by Rack::CommonLogger for logging
 purposes. The issue occurs when a server intentionally or unintentionally
 allows a user creation with the username contain CRLF and white space
 characters, or the server just want to log every login attempts. If an
 attacker enters a username with CRLF character, the logger will log the
 malicious username with CRLF characters into the logfile. Attackers can
 break log formats or insert fraudulent entries, potentially obscuring real
 activity or injecting malicious data into log files. Versions 2.2.11,
 3.0.12, and 3.1.10 contain a fix.
Ubuntu-Description:
Notes:
 mdeslaur> server must allow usernames with line breaks in them, and this
 mdeslaur> only allows an attacker to insert newlines into the log file
Mitigation:
Bugs:
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1098257
Priority: low
 Only allows inserting newlines into log file in certain circumstances
Discovered-by: Nhật Thái Đỗ
Assigned-to:
CVSS:

Patches_ruby-rack:
 upstream: https://github.com/rack/rack/commit/074ae244430cda05c27ca91cda699709cfb3ad8e
upstream_ruby-rack: released (2.2.11,3.0.12)
esm-infra-legacy/trusty_ruby-rack: released (1.5.2-3+deb8u3ubuntu1~esm9)
esm-apps/xenial_ruby-rack: released (1.6.4-3ubuntu0.2+esm7)
esm-apps/bionic_ruby-rack: released (1.6.4-4ubuntu0.2+esm7)
focal_ruby-rack: ignored (end of standard support, was needed)
esm-infra/focal_ruby-rack: DNE (focal was needed)
esm-apps/focal_ruby-rack: released (2.0.7-2ubuntu0.1+esm6)
jammy_ruby-rack: needed
esm-apps/jammy_ruby-rack: released (2.1.4-5ubuntu1.1+esm1)
noble_ruby-rack: released (2.2.7-1ubuntu0.2)
oracular_ruby-rack: released (2.2.7-1.1ubuntu0.1)
plucky_ruby-rack: needed
devel_ruby-rack: needed
