PublicDateAtUSN: 2025-05-29
Candidate: CVE-2025-5054
PublicDate: 2025-05-30 18:15:00 UTC
CRD: 2025-05-29
References:
 https://www.cve.org/CVERecord?id=CVE-2025-5054
 https://ubuntu.com/security/notices/USN-7545-1
Description:
 Race condition in Canonical apport up to and including 2.32.0 allows a
 local attacker to leak sensitive information via PID-reuse by leveraging
 namespaces.
 
 
 
 
 When handling a crash, the function `_check_global_pid_and_forward`, which
 detects if the crashing process resided in a container, was being called
 before `consistency_checks`, which attempts to detect if the crashing
 process had been replaced. Because of this, if a process crashed and was
 quickly replaced with a containerized one, apport could be made to forward
 the core dump to the container, potentially leaking sensitive information.
 `consistency_checks` is now being called before
 `_check_global_pid_and_forward`. Additionally, given that the PID-reuse
 race condition cannot be reliably detected from userspace alone, crashes
 are only forwarded to containers if the kernel provided a pidfd, or if the
 crashing process was unprivileged (i.e., if dump mode == 1).
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by: Qualys
Assigned-to: octagalland
CVSS:
 ubuntu: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N [4.7 MEDIUM]

Patches_apport:
upstream_apport: needs-triage
esm-infra-legacy/trusty_apport: not-affected (code not present)
esm-infra/xenial_apport: released (2.20.1-0ubuntu2.30+esm5)
esm-infra/bionic_apport: released (2.20.9-0ubuntu7.29+esm1)
focal_apport: released (2.20.11-0ubuntu27.28)
esm-infra/focal_apport: not-affected (2.20.11-0ubuntu27.28)
jammy_apport: released (2.20.11-0ubuntu82.7)
noble_apport: released (2.28.1-0ubuntu3.6)
oracular_apport: released (2.30.0-0ubuntu4.3)
plucky_apport: released (2.32.0-0ubuntu5.1)
devel_apport: needed
