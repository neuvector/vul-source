Candidate: CVE-2021-21392
PublicDate: 2021-04-12 22:15:00 UTC
References:
 https://github.com/matrix-org/synapse/security/advisories/GHSA-5wrh-4jwv-5w78
 https://github.com/matrix-org/synapse/pull/9240
 https://pypi.org/project/matrix-synapse/
 https://www.cve.org/CVERecord?id=CVE-2021-21392
Description:
 Synapse is a Matrix reference homeserver written in python (pypi package
 matrix-synapse). Matrix is an ecosystem for open federated Instant
 Messaging and VoIP. In Synapse before version 1.28.0 requests to user
 provided domains were not restricted to external IP addresses when
 transitional IPv6 addresses were used. Outbound requests to federation,
 identity servers, when calculating the key validity for third-party invite
 events, sending push notifications, and generating URL previews are
 affected. This could cause Synapse to make requests to internal
 infrastructure on dual-stack networks. See referenced GitHub security
 advisory for details and workarounds.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: 
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N [6.3 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N [6.3 MEDIUM]


Patches_matrix-synapse:
upstream_matrix-synapse: released (1.28.0-1)
precise/esm_matrix-synapse: DNE
trusty_matrix-synapse: ignored (end of standard support)
trusty/esm_matrix-synapse: DNE
esm-infra-legacy/trusty_matrix-synapse: DNE
xenial_matrix-synapse: DNE
bionic_matrix-synapse: ignored (end of standard support, was needed)
esm-apps/bionic_matrix-synapse: needed
focal_matrix-synapse: ignored (end of standard support, was needed)
esm-infra/focal_matrix-synapse: DNE (focal was needed)
esm-apps/focal_matrix-synapse: needed
groovy_matrix-synapse: ignored (end of life)
hirsute_matrix-synapse: ignored (end of life)
impish_matrix-synapse: ignored (end of life)
jammy_matrix-synapse: needed
esm-apps/jammy_matrix-synapse: needed
kinetic_matrix-synapse: ignored (end of life, was needed)
lunar_matrix-synapse: not-affected (1.64.0-3)
mantic_matrix-synapse: not-affected (1.64.0-3)
noble_matrix-synapse: not-affected (1.64.0-3)
esm-apps/noble_matrix-synapse: not-affected (1.64.0-3)
oracular_matrix-synapse: not-affected (1.64.0-3)
