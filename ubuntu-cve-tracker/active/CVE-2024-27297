Candidate: CVE-2024-27297
PublicDate: 2024-03-11 22:15:00 UTC
References:
 https://guix.gnu.org/en/blog/2024/fixed-output-derivation-sandbox-bypass-cve-2024-27297/
 https://github.com/NixOS/nix/security/advisories/GHSA-2ffj-w4mj-pg37
 https://github.com/NixOS/nix/commit/244f3eee0bbc7f11e9b383a15ed7368e2c4becc9
 https://github.com/NixOS/nix/commit/f8170ce9f119e5e6724eb81ff1b5a2d4c0024000
 https://hackmd.io/03UGerewRcy3db44JQoWvw
 https://www.cve.org/CVERecord?id=CVE-2024-27297
Description:
 Nix is a package manager for Linux and other Unix systems. A fixed-output
 derivations on Linux can send file descriptors to files in the Nix store to
 another program running on the host (or another fixed-output derivation)
 via Unix domain sockets in the abstract namespace. This allows to modify
 the output of the derivation, after Nix has registered the path as "valid"
 and immutable in the Nix database. In particular, this allows the output of
 fixed-output derivations to be modified from their expected content. This
 issue has been addressed in versions 2.3.18 2.18.2 2.19.4 and 2.20.5. Users
 are advised to upgrade. There are no known workarounds for this
 vulnerability.
Ubuntu-Description:
Notes:
 sbeattie> this CVE had been incorrectly triaged in Ubuntu as affecting
   the linux kernel; this has been corrected.
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1066113
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1066812
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:L [6.3 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N [5.9 MEDIUM]

Patches_guix:
upstream_guix: released (1.4.0-6)
focal_guix: DNE
esm-infra/focal_guix: DNE
jammy_guix: needs-triage
esm-apps/jammy_guix: needs-triage
mantic_guix: ignored (end of life, was needs-triage)
noble_guix: not-affected (1.4.0-6)
esm-apps/noble_guix: not-affected (1.4.0-6)
oracular_guix: not-affected (1.4.0-6)
plucky_guix: not-affected (1.4.0-6)
devel_guix: not-affected (1.4.0-6)

Patches_nix:
upstream_nix: released (2.22.1+dfsg-1)
focal_nix: DNE
esm-infra/focal_nix: DNE
jammy_nix: needed
esm-apps/jammy_nix: needed
mantic_nix: ignored (end of life, was needs-triage)
noble_nix: needed
esm-apps/noble_nix: needed
oracular_nix: needed
plucky_nix: not-affected (2.24.9+dfsg-2ubuntu2)
devel_nix: not-affected (2.24.9+dfsg-2ubuntu2)

