Candidate: CVE-2025-64517
PublicDate: 2025-11-12 22:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-64517
 https://github.com/trifectatechfoundation/sudo-rs/security/advisories/GHSA-q428-6v73-fc4q
 https://ubuntu.com/security/notices/USN-7867-1
Description:
 sudo-rs is a memory safe implementation of sudo and su written in Rust.
 With `Defaults targetpw` (or `Defaults rootpw`) enabled,  the password of
 the target account (or root account) instead of the invoking user is used
 for authentication. sudo-rs starting in version 0.2.5 and prior to version
 0.2.10 incorrectly recorded the invoking userâ€™s UID instead of the
 authenticated-as user's UID in the authentication timestamp. Any later
 `sudo` invocation on the same terminal while the timestamp was still valid
 would use that timestamp, potentially bypassing new authentication even if
 the policy would have required it. A highly-privileged user (able to run
 commands as other users, or as root, through sudo) who knows one password
 of an account they are allowed to run commands as, would be able to run
 commands as any other account the policy permits them to run commands for,
 even if they don't know the password for those accounts. A common instance
 of this would be that a user can still use their own password to run
 commands as root (the default behaviour of `sudo`), effectively negating
 the intended behaviour of the `targetpw` or `rootpw` options. Version
 0.2.10 contains a patch for the issue. Versions prior to 0.2.5 are not
 affected, since they do not offer `Defaults targetpw` or `Defaults rootpw`.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> Defaults targetpw or Defaults rootpw were added in 0.2.5,
  so versions prior to that are not affected.
 rodrigo-zaiden> USN-7867-1 references LP bug 2130623 but not the CVE
  because the CVE was assigned later than the package update publication,
  but it refers to the fix for this issue on questing.
Mitigation:
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/rust-sudo-rs/+bug/2130623
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N [4.4 MEDIUM]

Patches_rust-sudo-rs:
upstream_rust-sudo-rs: released (0.2.10-1)
jammy_rust-sudo-rs: DNE
noble_rust-sudo-rs: not-affected (code not present)
esm-apps/noble_rust-sudo-rs: not-affected (code not present)
plucky_rust-sudo-rs: not-affected (code not present)
questing_rust-sudo-rs: released (0.2.8-1ubuntu5.2)
devel_rust-sudo-rs: released (0.2.10-1ubuntu1)
