Candidate: CVE-2024-32462
PublicDate: 2024-04-18 18:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-32462
 https://www.openwall.com/lists/oss-security/2024/04/18/5
 https://github.com/flatpak/flatpak/security/advisories/GHSA-phv6-cpc2-2fgj
 https://github.com/flatpak/flatpak/commit/72016e3fce8fcbeab707daf4f1a02b931fcc004d
 https://github.com/flatpak/flatpak/commit/81abe2a37d363f5099c3d0bdcd0caad6efc5bf97
 https://github.com/flatpak/flatpak/commit/b7c1a558e58aaeb1d007d29529bbb270dc4ff11e
 https://github.com/flatpak/flatpak/commit/bbab7ed1e672356d1a78b422462b210e8e875931
Description:
 Flatpak is a system for building, distributing, and running sandboxed
 desktop applications on Linux. in versions before 1.10.9, 1.12.9, 1.14.6,
 and 1.15.8, a malicious or compromised Flatpak app could execute arbitrary
 code outside its sandbox. Normally, the `--command` argument of `flatpak
 run` expects to be given a command to run in the specified Flatpak app,
 optionally along with some arguments. However it is possible to instead
 pass `bwrap` arguments to `--command=`, such as `--bind`. It's possible to
 pass an arbitrary `commandline` to the portal interface
 `org.freedesktop.portal.Background.RequestBackground` from within a Flatpak
 app. When this is converted into a `--command` and arguments, it achieves
 the same effect of passing arguments directly to `bwrap`, and thus can be
 used for a sandbox escape. The solution is to pass the `--` argument to
 `bwrap`, which makes it stop processing options. This has been supported
 since bubblewrap 0.3.0. All supported versions of Flatpak require at least
 that version of bubblewrap. xdg-desktop-portal version 1.18.4 will mitigate
 this vulnerability by only allowing Flatpak apps to create .desktop files
 for commands that do not start with --. The vulnerability is patched in
 1.15.8, 1.10.9, 1.12.9, and 1.14.6.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/flatpak/+bug/2062406
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N [8.4 HIGH]

Patches_flatpak:
upstream_flatpak: released (1.14.6-1)
esm-apps/bionic_flatpak: needed
focal_flatpak: ignored (end of standard support, was needed)
esm-apps/focal_flatpak: needed
jammy_flatpak: needed
esm-apps/jammy_flatpak: needed
mantic_flatpak: ignored (end of life, was needed)
noble_flatpak: released (1.14.6-1)
esm-apps/noble_flatpak: released (1.14.6-1)
oracular_flatpak: released (1.14.6-1)
plucky_flatpak: released (1.14.6-1)
devel_flatpak: released (1.14.6-1)
