Candidate: CVE-2022-31116
PublicDate: 2022-07-05 18:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31116
 https://github.com/ultrajson/ultrajson/security/advisories/GHSA-wpqr-jcpx-745r
 https://github.com/ultrajson/ultrajson/commit/67ec07183342589d602e0fcf7bb1ff3e19272687 (5.4.0)
 https://github.com/ultrajson/ultrajson/commit/67ec07183342589d602e0fcf7bb1ff3e19272687
Description:
 UltraJSON is a fast JSON encoder and decoder written in pure C with
 bindings for Python 3.7+. Affected versions were found to improperly decode
 certain characters. JSON strings that contain escaped surrogate characters
 not part of a proper surrogate pair were decoded incorrectly. Besides
 corrupting strings, this allowed for potential key confusion and value
 overwriting in dictionaries. All users parsing JSON from untrusted sources
 are vulnerable. From version 5.4.0, UltraJSON decodes lone surrogates in
 the same way as the standard library's `json` module does, preserving them
 in the parsed output. Users are advised to upgrade. There are no known
 workarounds for this issue.
Ubuntu-Description:
Notes:
 ccdm94> the embedded ujson code in pandas, eventhough containing similar
 ccdm94> content as the upstream ujson code, seems to have diverged from the
 ccdm94> ujson upstream project (they have fully forked ujson), since pandas
 ccdm94> upstream is maintaining their own ujson bug fixes and changes without
 ccdm94> re-syncing with the ujson upstream project. There is no indication
 ccdm94> the ujson fork, as used in pandas, is vulnerable to the same issues
 ccdm94> as the upstream ujson code.
 ccdm94> 
 ccdm94> according to https://github.com/ultrajson/ultrajson/releases/tag/5.4.0,
 ccdm94> the commits that fix this issue are e0e5db9a46 and bc7bdff051. However,
 ccdm94> release 5.4.0 does include a few other commits which seem to be related
 ccdm94> to the above.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: allenpthuang
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]


Patches_ujson:
 upstream: https://github.com/ultrajson/ultrajson/commit/e0e5db9a46decfea1174217382486e06bbab4743
 upstream: https://github.com/ultrajson/ultrajson/commit/67ec07183342589d602e0fcf7bb1ff3e19272687
upstream_ujson: released (5.4.0) 
trusty_ujson: DNE
xenial_ujson: ignored (end of standard support, was needed) 
esm-apps/xenial_ujson: needs-triage
bionic_ujson: ignored (end of standard support, was needed)
esm-apps/bionic_ujson: needed
focal_ujson: needed
esm-apps/focal_ujson: needed
impish_ujson: ignored (end of life)
jammy_ujson: needed
esm-apps/jammy_ujson: needed
kinetic_ujson: not-affected (5.4.0-1)
lunar_ujson: not-affected (5.5.0-2)
mantic_ujson: not-affected (5.5.0-2)
devel_ujson: not-affected (5.5.0-2)

Patches_pandas:
upstream_pandas: needed
trusty/esm_pandas: needs-triage
trusty_pandas: ignored (end of standard support, was needs-triage)
xenial_pandas: ignored (end of standard support, was needs-triage)
esm-apps/xenial_pandas: needs-triage
bionic_pandas: ignored (end of standard support, was needs-triage)
esm-apps/bionic_pandas: needs-triage
focal_pandas: needs-triage
esm-apps/focal_pandas: needs-triage
impish_pandas: ignored (end of life)
jammy_pandas: needs-triage
esm-apps/jammy_pandas: needs-triage
kinetic_pandas: ignored (end of life, was needs-triage)
lunar_pandas: needs-triage
mantic_pandas: needs-triage
devel_pandas: needs-triage

Patches_collada2gltf:
upstream_collada2gltf: needs-triage
trusty_collada2gltf: DNE
xenial_collada2gltf: ignored (end of standard support, was needs-triage)
esm-apps/xenial_collada2gltf: needs-triage
bionic_collada2gltf: ignored (end of standard support, was needs-triage)
esm-apps/bionic_collada2gltf: needs-triage
focal_collada2gltf: DNE
impish_collada2gltf: ignored (end of life)
jammy_collada2gltf: needs-triage
esm-apps/jammy_collada2gltf: needs-triage
kinetic_collada2gltf: ignored (end of life, was needs-triage)
lunar_collada2gltf: needs-triage
mantic_collada2gltf: DNE
devel_collada2gltf: DNE
