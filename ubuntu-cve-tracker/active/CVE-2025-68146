Candidate: CVE-2025-68146
PublicDate: 2025-12-16 19:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-68146
 https://github.com/tox-dev/filelock/security/advisories/GHSA-w853-jp5j-5j7f
 https://github.com/tox-dev/filelock/pull/461
 https://github.com/tox-dev/filelock/commit/4724d7f8c3393ec1f048c93933e6e3e6ec321f0e
 https://github.com/tox-dev/filelock/releases/tag/3.20.1
Description:
 filelock is a platform-independent file lock for Python. In versions prior
 to 3.20.1, a Time-of-Check-Time-of-Use (TOCTOU) race condition allows local
 attackers to corrupt or truncate arbitrary user files through symlink
 attacks. The vulnerability exists in both Unix and Windows lock file
 creation where filelock checks if a file exists before opening it with
 O_TRUNC. An attacker can create a symlink pointing to a victim file in the
 time gap between the check and open, causing os.open() to follow the
 symlink and truncate the target file. All users of filelock on Unix, Linux,
 macOS, and Windows systems are impacted. The vulnerability cascades to
 dependent libraries. The attack requires local filesystem access and
 ability to create symlinks (standard user permissions on Unix; Developer
 Mode on Windows 10+). Exploitation succeeds within 1-3 attempts when lock
 file paths are predictable. The issue is fixed in version 3.20.1. If
 immediate upgrade is not possible, use SoftFileLock instead of
 UnixFileLock/WindowsFileLock (note: different locking semantics, may not be
 suitable for all use cases); ensure lock file directories have restrictive
 permissions (chmod 0700) to prevent untrusted users from creating symlinks;
 and/or monitor lock file directories for suspicious symlinks before running
 trusted applications. These workarounds provide only partial mitigation.
 The race condition remains exploitable. Upgrading to version 3.20.1 is
 strongly recommended.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:H [6.3 MEDIUM]

Patches_python-filelock:
upstream_python-filelock: needs-triage
esm-apps/bionic_python-filelock: needs-triage
esm-apps/focal_python-filelock: needs-triage
jammy_python-filelock: needs-triage
esm-apps/jammy_python-filelock: needs-triage
noble_python-filelock: needs-triage
esm-apps/noble_python-filelock: needs-triage
plucky_python-filelock: ignored (end of life, was needs-triage)
questing_python-filelock: needs-triage
devel_python-filelock: needs-triage
