Candidate: CVE-2022-31214
PublicDate: 2022-06-09 16:15:00 UTC
References:
 https://marc.info/?i=YqCar9IFTyPnq2o0@f195.suse.de
 https://www.cve.org/CVERecord?id=CVE-2022-31214
Description:
 A Privilege Context Switching issue was discovered in join.c in Firejail
 0.9.68. By crafting a bogus Firejail container that is accepted by the
 Firejail setuid-root program as a join target, a local attacker can enter
 an environment in which the Linux user namespace is still the initial user
 namespace, the NO_NEW_PRIVS prctl is not activated, and the entered mount
 namespace is under the attacker's control. In this way, the filesystem
 layout can be adjusted to gain root privileges through execution of
 available setuid-root binaries such as su or sudo.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://bugzilla.suse.com/show_bug.cgi?id=1199148
Priority: medium
Discovered-by: Matthias Gerstner
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_firejail:
 upstream: https://github.com/netblue30/firejail/commit/27cde3d7d1e4e16d4190932347c7151dc2a84c50
 upstream: https://github.com/netblue30/firejail/commit/dab835e7a0eb287822016f5ae4e87f46e1d363e7
 upstream: https://github.com/netblue30/firejail/commit/1884ea22a90d225950d81c804f1771b42ae55f54
upstream_firejail: needs-triage
bionic_firejail: ignored (end of standard support, was needs-triage)
esm-apps/xenial_firejail: needs-triage
esm-apps/bionic_firejail: needs-triage
focal_firejail: ignored (end of standard support, was needs-triage)
esm-infra/focal_firejail: DNE (focal was needs-triage)
esm-apps/focal_firejail: needs-triage
impish_firejail: ignored (end of life)
jammy_firejail: needs-triage
esm-apps/jammy_firejail: needs-triage
kinetic_firejail: ignored (end of life, was needs-triage)
lunar_firejail: ignored (end of life, was needs-triage)
mantic_firejail: ignored (end of life, was needs-triage)
noble_firejail: needs-triage
esm-apps/noble_firejail: needs-triage
oracular_firejail: needs-triage
plucky_firejail: needs-triage
devel_firejail: needs-triage
