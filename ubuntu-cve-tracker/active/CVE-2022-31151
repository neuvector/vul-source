Candidate: CVE-2022-31151
PublicDate: 2022-07-21 04:15:00 UTC
References:
 https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp
 https://github.com/nodejs/undici/issues/872
 https://hackerone.com/reports/1635514
 https://www.cve.org/CVERecord?id=CVE-2022-31151
Description:
 Authorization headers are cleared on cross-origin redirect. However, cookie
 headers which are sensitive headers and are official headers found in the
 spec, remain uncleared. There are active users using cookie headers in
 undici. This may lead to accidental leakage of cookie to a 3rd-party site
 or a malicious attacker who can control the redirection target (ie. an open
 redirector) to leak the cookie to the 3rd party site. This was patched in
 v5.7.1. By default, this vulnerability is not exploitable. Do not enable
 redirections, i.e. `maxRedirections: 0` (the default).
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N [3.7 LOW]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N [6.5 MEDIUM]


Patches_node-undici:
upstream_node-undici: needs-triage
trusty_node-undici: DNE
xenial_node-undici: DNE
kinetic_node-undici: ignored (end of life, was needs-triage)
lunar_node-undici: ignored (end of life, was needs-triage)
mantic_node-undici: ignored (end of life, was needs-triage)
noble_node-undici: needs-triage
esm-apps/noble_node-undici: needs-triage
oracular_node-undici: needs-triage
plucky_node-undici: needs-triage
devel_node-undici: needs-triage
bionic_node-undici: DNE
focal_node-undici: DNE
esm-infra/focal_node-undici: DNE
jammy_node-undici: DNE
