PublicDateAtUSN: 2024-05-14 15:11:00 UTC
Candidate: CVE-2024-27281
PublicDate: 2024-05-14 15:11:00 UTC
References:
 https://www.ruby-lang.org/en/news/2024/03/21/rce-rdoc-cve-2024-27281/
 https://www.cve.org/CVERecord?id=CVE-2024-27281
 https://ubuntu.com/security/notices/USN-6838-1
 https://ubuntu.com/security/notices/USN-6838-2
Description:
 An issue was discovered in RDoc 6.3.3 through 6.6.2, as distributed in Ruby
 3.x through 3.3.0. When parsing .rdoc_options (used for configuration in
 RDoc) as a YAML file, object injection and resultant remote code execution
 are possible because there are no restrictions on the classes that can be
 restored. (When loading the documentation cache, object injection and
 resultant remote code execution are also possible if there were a crafted
 cache.) The main fixed version is 6.6.3.1. For Ruby 3.0 users, a fixed
 version is rdoc 6.3.4.1. For Ruby 3.1 users, a fixed version is rdoc
 6.4.1.1. For Ruby 3.2 users, a fixed version is rdoc 6.5.1.1.
Ubuntu-Description:
Notes:
 mdeslaur> This also affects 2.x
Mitigation:
Bugs:
Priority: medium
Discovered-by: ooooooo_q
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L [4.5 MEDIUM]

Patches_ruby2.3:
upstream_ruby2.3: needs-triage
esm-infra/xenial_ruby2.3: released (2.3.1-2~ubuntu16.04.16+esm9)
focal_ruby2.3: DNE
esm-infra/focal_ruby2.3: DNE
jammy_ruby2.3: DNE
mantic_ruby2.3: DNE
noble_ruby2.3: DNE
oracular_ruby2.3: DNE
plucky_ruby2.3: DNE
devel_ruby2.3: DNE

Patches_ruby2.5:
upstream_ruby2.5: needs-triage
esm-infra/bionic_ruby2.5: released (2.5.1-1ubuntu1.16+esm3)
focal_ruby2.5: DNE
esm-infra/focal_ruby2.5: DNE
jammy_ruby2.5: DNE
mantic_ruby2.5: DNE
noble_ruby2.5: DNE
oracular_ruby2.5: DNE
plucky_ruby2.5: DNE
devel_ruby2.5: DNE

Patches_ruby2.7:
upstream_ruby2.7: needs-triage
focal_ruby2.7: released (2.7.0-5ubuntu1.13)
esm-infra/focal_ruby2.7: not-affected (2.7.0-5ubuntu1.13)
jammy_ruby2.7: DNE
mantic_ruby2.7: DNE
noble_ruby2.7: DNE
oracular_ruby2.7: DNE
plucky_ruby2.7: DNE
devel_ruby2.7: DNE

Patches_ruby3.0:
upstream_ruby3.0: needs-triage
focal_ruby3.0: DNE
esm-infra/focal_ruby3.0: DNE
jammy_ruby3.0: released (3.0.2-7ubuntu2.6)
mantic_ruby3.0: DNE
noble_ruby3.0: DNE
oracular_ruby3.0: DNE
plucky_ruby3.0: DNE
devel_ruby3.0: DNE

Patches_ruby3.1:
upstream_ruby3.1: needs-triage
focal_ruby3.1: DNE
esm-infra/focal_ruby3.1: DNE
jammy_ruby3.1: DNE
mantic_ruby3.1: released (3.1.2-7ubuntu3.2)
noble_ruby3.1: DNE
oracular_ruby3.1: DNE
plucky_ruby3.1: DNE
devel_ruby3.1: DNE

Patches_ruby3.2:
 upstream: https://github.com/ruby/rdoc/commit/32ff6ba0bebd8ea26f569da5fd23be2937f6a644 (6.3.4)
 upstream: https://github.com/ruby/rdoc/commit/60a6d74ebdbb7d585e379526e5639932fdca2904 (6.3.4)
 upstream: https://github.com/ruby/rdoc/commit/a5de13bf0f0c26f8e764e82b5bf4bf8bffc7198e (6.3.4.1)
 upstream: https://github.com/ruby/rdoc/commit/1254b0066f312ddbf7fae7a195e66ce5b3bc6656 (6.4.1)
 upstream: https://github.com/ruby/rdoc/commit/48617985e9fbc2825219d55f04e3e0e98d2923be (6.4.1.1)
 upstream: https://github.com/ruby/rdoc/commit/811f125a4a0cc968e3eb18e16ea6c1a3b49a11bf (6.5.1)
 upstream: https://github.com/ruby/rdoc/commit/d22ba930f1f611dda531dba04cd3d2531bb3f8a5 (6.5.1.1)
upstream_ruby3.2: needs-triage
trusty_ruby3.2: DNE
trusty/esm_ruby3.2: DNE
esm-infra-legacy/trusty_ruby3.2: DNE
xenial_ruby3.2: DNE
bionic_ruby3.2: DNE
focal_ruby3.2: DNE
esm-infra/focal_ruby3.2: DNE
jammy_ruby3.2: DNE
mantic_ruby3.2: DNE
noble_ruby3.2: released (3.2.3-1ubuntu0.24.04.1)
oracular_ruby3.2: DNE
plucky_ruby3.2: DNE
devel_ruby3.2: DNE

#Patches_ruby3.3:
#upstream_ruby3.3: needs-triage
#trusty_ruby3.3: DNE
#trusty/esm_ruby3.3: DNE
#xenial_ruby3.3: DNE
#bionic_ruby3.3: DNE
#focal_ruby3.3: DNE
#jammy_ruby3.3: DNE
#mantic_ruby3.3: DNE
#noble_ruby3.3: DNE
#oracular_ruby3.3: not-affected (3.3.1-3)
#plucky_ruby3.3: not-affected (3.3.1-3)
#devel_ruby3.3: not-affected (3.3.1-3)

Patches_jruby:
upstream_jruby: needs-triage
trusty/esm_jruby: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_jruby: needs-triage
esm-apps/xenial_jruby: needs-triage
esm-apps/bionic_jruby: needs-triage
focal_jruby: ignored (end of standard support, was needs-triage)
esm-apps/focal_jruby: needs-triage
jammy_jruby: DNE
mantic_jruby: ignored (end of life, was needs-triage)
noble_jruby: needs-triage
esm-apps/noble_jruby: needs-triage
oracular_jruby: needs-triage
plucky_jruby: needs-triage
devel_jruby: needs-triage
