PublicDateAtUSN: 2022-07-27
Candidate: CVE-2022-32746
CRD: 2022-07-27
PublicDate: 2022-08-25 18:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32746
 https://www.samba.org/samba/security/CVE-2022-32746.html
 https://ubuntu.com/security/notices/USN-5542-1
Description:
 A flaw was found in the Samba AD LDAP server. The AD DC database audit
 logging module can access LDAP message values freed by a preceding database
 module, resulting in a use-after-free issue. This issue is only possible
 when modifying certain privileged attributes, such as userAccountControl.
Ubuntu-Description: 
Notes: 
 mdeslaur> combined patches are in bug 15096
 mdeslaur> Fixing this in Ubuntu 18.04 LTS would require substantial
 mdeslaur> code backports. We will not be fixing this issue in Ubuntu 18.04
 mdeslaur> LTS. In environments where this is of concern, we recommend
 mdeslaur> updating to a more recent Ubuntu version, or disabling AD DC
 mdeslaur> database audit logging if this is not passible.
Mitigation: 
 Disabling AD DC database audit logging prevents the use-after-free from
 occurring, as that is the only component that will access the original
 message.
Bugs: 
 https://bugzilla.samba.org/show_bug.cgi?id=15009
 https://bugzilla.samba.org/show_bug.cgi?id=15096
 https://bugzilla.samba.org/show_bug.cgi?id=15109 (tracking bug)
Priority: medium
Discovered-by: Joseph Sutton and Andrew Bartlett
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L [5.4 MEDIUM]

Patches_ldb:
upstream_ldb: needs-triage
trusty/esm_ldb: needs-triage
esm-infra/xenial_ldb: needs-triage
bionic_ldb: ignored
esm-infra/bionic_ldb: ignored
focal_ldb: released (2:2.2.3-0ubuntu0.20.04.3)
impish_ldb: ignored (reached end-of-life)
jammy_ldb: released (2:2.4.4-0ubuntu0.1)
kinetic_ldb: DNE
lunar_ldb: DNE
devel_ldb: DNE

Patches_samba:
upstream_samba: needs-triage
trusty_samba: DNE
trusty/esm_samba: needs-triage
xenial_samba: DNE
esm-infra/xenial_samba: needs-triage
bionic_samba: ignored
esm-infra/bionic_samba: ignored
focal_samba: released (2:4.13.17~dfsg-0ubuntu1.20.04.1)
impish_samba: ignored (reached end-of-life)
jammy_samba: released (2:4.15.9+dfsg-0ubuntu0.2)
kinetic_samba: released (2:4.16.4+dfsg-2ubuntu1)
lunar_samba: released (2:4.16.4+dfsg-2ubuntu1)
devel_samba: released (2:4.16.4+dfsg-2ubuntu1)
