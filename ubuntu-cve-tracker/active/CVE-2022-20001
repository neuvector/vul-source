PublicDateAtUSN: 2022-03-14 19:15:00 UTC
Candidate: CVE-2022-20001
PublicDate: 2022-03-14 19:15:00 UTC
References:
 https://github.com/fish-shell/fish-shell/security/advisories/GHSA-pj5f-6vxj-f5mq
 https://github.com/fish-shell/fish-shell/pull/8589
 https://github.com/fish-shell/fish-shell/commit/37625053d424c1ab88de2b0c50c7fe71e1468e2c (3.4.0)
 https://github.com/fish-shell/fish-shell/releases/tag/3.4.0
 https://ubuntu.com/security/notices/USN-5367-1
 https://www.cve.org/CVERecord?id=CVE-2022-20001
Description:
 fish is a command line shell. fish version 3.1.0 through version 3.3.1 is
 vulnerable to arbitrary code execution. git repositories can contain
 per-repository configuration that change the behavior of git, including
 running arbitrary commands. When using the default configuration of fish,
 changing to a directory automatically runs `git` commands in order to
 display information about the current repository in the prompt. If an
 attacker can convince a user to change their current directory into one
 controlled by the attacker, such as on a shared file system or extracted
 archive, fish will run arbitrary commands under the attacker's control.
 This problem has been fixed in fish 3.4.0. Note that running git in these
 directories, including using the git tab completion, remains a potential
 trigger for this issue. As a workaround, remove the `fish_git_prompt`
 function from the prompt.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_fish:
 upstream: https://github.com/fish-shell/fish-shell/commit/37625053d424c1ab88de2b0c50c7fe71e1468e2c
upstream_fish: released (3.4.0)
trusty_fish: ignored (end of standard support, was not-affected)
xenial_fish: ignored (end of standard support)
esm-apps/xenial_fish: not-affected (code not present)
bionic_fish: not-affected (code not present)
esm-apps/bionic_fish: not-affected (code not present)
focal_fish: needed
esm-apps/focal_fish: released (3.1.0-1.2ubuntu0.1~esm1)
impish_fish: ignored (end of life)
jammy_fish: needed
esm-apps/jammy_fish: released (3.3.1+ds-3ubuntu0.1~esm1)
kinetic_fish: ignored (end of life, was needed)
lunar_fish: not-affected (3.5.1+ds-1)
mantic_fish: not-affected (3.5.1+ds-1)
noble_fish: not-affected (3.5.1+ds-1)
esm-apps/noble_fish: not-affected (3.5.1+ds-1)
oracular_fish: not-affected (3.5.1+ds-1)
plucky_fish: not-affected (3.5.1+ds-1)
devel_fish: not-affected (3.5.1+ds-1)
