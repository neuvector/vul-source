Candidate: CVE-2024-10041
PublicDate: 2024-10-23 14:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-10041
 https://access.redhat.com/security/cve/CVE-2024-10041
Description:
 A vulnerability was found in PAM. The secret information is stored in
 memory, where the attacker can trigger the victim program to execute by
 sending characters to its standard input (stdin). As this occurs, the
 attacker can train the branch predictor to execute an ROP chain
 speculatively. This flaw could result in leaked passwords, such as those
 found in /etc/shadow while performing authentications.
Ubuntu-Description:
Notes:
 mdeslaur> The upstream bug for this issue, #846, indicates that the fix
 mdeslaur> in pull 686, also listed below as the commit in 1.6.0, fixes
 mdeslaur> this issue.
 mdeslaur>
 mdeslaur> Fixing this CVE may require changes in apparmor policies, see:
 mdeslaur> https://salsa.debian.org/apparmor-team/apparmor/-/commit/243162ca2938b391724f547596787c7f77d1fc5f
 mdeslaur> https://bugzilla.opensuse.org/show_bug.cgi?id=1219139
 mdeslaur> https://gitlab.com/apparmor/apparmor/-/commit/243162ca2938b391724f547596787c7f77d1fc5f
 mdeslaur> https://gitlab.com/apparmor/apparmor/-/commit/0deda68bd8edb356228b420c6e0392922155a9fb
 mdeslaur> https://gitlab.com/apparmor/apparmor/-/commit/6f5a4219d737709278c1678f4865d24633059f7d
 mdeslaur> https://gitlab.com/apparmor/apparmor/-/commit/b6eb4620492f61bd57873145edc4b721cf7ca66c
 mdeslaur>
 mdeslaur> This fix will also possibly require changes in other
 mdeslaur> applications:
 mdeslaur> https://github.com/linux-pam/linux-pam/issues/874
 mdeslaur> https://github.com/linux-pam/linux-pam/issues/747
 mdeslaur>
 mdeslaur> The pam change required to fix this vulnerability fundamentally
 mdeslaur> changes how passwords are read from the shadow file. Instead of
 mdeslaur> being read by the pam module itself, the patch switches to using
 mdeslaur> the external unix-chkpwd helper.
 mdeslaur>
 mdeslaur> This change is very intrusive and is likely to cause regressions
 mdeslaur> in many environments, including those using custom AppArmor or
 mdeslaur> PAM configurations, and installations that have been hardened.
 mdeslaur>
 mdeslaur> Since this is a local attack that is mostly theoretical and
 mdeslaur> likely very difficult to perform successfully, and there are no
 mdeslaur> public reproducers for this issue, we will not be fixing this
 mdeslaur> issue in stable Ubuntu releases. Marking releases as ignored.
Mitigation:
Bugs:
 https://bugzilla.redhat.com/show_bug.cgi?id=2319212
 https://github.com/linux-pam/linux-pam/issues/846
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1086038
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 redhat: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N [4.7 MEDIUM]

Patches_pam:
 upstream: https://github.com/linux-pam/linux-pam/pull/686
 upstream: https://github.com/linux-pam/linux-pam/commit/b3020da7da384d769f27a8713257fbe1001878be (1.6.0)
 upstream: https://github.com/linux-pam/linux-pam/commit/b7b96362087414e52524d3d9d9b3faa21e1db620 (1.6.1, fix?)
upstream_pam: released (1.6.0)
esm-infra-legacy/trusty_pam: ignored
trusty/esm_pam: ignored (end of ESM support, was deferred [2025-04-24])
esm-infra/xenial_pam: ignored
esm-infra/bionic_pam: ignored
focal_pam: ignored (end of standard support, was needed)
esm-infra/focal_pam: ignored
jammy_pam: ignored
noble_pam: ignored
oracular_pam: ignored (end of life, was needed)
plucky_pam: ignored
devel_pam: released (1.7.0-5ubuntu1)
