PublicDateAtUSN: 2022-02-14 12:15:00 UTC
Candidate: CVE-2021-45444
PublicDate: 2022-02-14 12:15:00 UTC
References:
 https://sourceforge.net/p/zsh/code/ci/c187154f47697cdbf822c2f9d714d570ed4a0fd1/
 https://sourceforge.net/p/zsh/code/ci/fdb8b0ce6244ff26bf55e0fd825310a58d0d3156/
 https://sourceforge.net/p/zsh/code/ci/bdc4d70a7e033b754e68a8659a037ea0fc5f38de/
 https://ubuntu.com/security/notices/USN-5325-1
 https://www.cve.org/CVERecord?id=CVE-2021-45444
Description:
 In zsh before 5.8.1, an attacker can achieve code execution if they control
 a command output inside the prompt, as demonstrated by a %F argument. This
 occurs because of recursive PROMPT_SUBST expansion.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> The commits fdb8b0ce and bdc4d70a are related to a partial
  commit that can be used in case an user can't update to a
  patched version that contains c187154f commit.
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_zsh:
 upstream: https://sourceforge.net/p/zsh/code/ci/c187154f47697cdbf822c2f9d714d570ed4a0fd1/
upstream_zsh: released (5.8.1-1)
esm-infra/xenial_zsh: released (5.1.1-1ubuntu2.3+esm1)
trusty_zsh: ignored (end of standard support)
xenial_zsh: ignored (end of standard support)
bionic_zsh: released (5.4.2-3ubuntu3.2)
esm-infra/bionic_zsh: released (5.4.2-3ubuntu3.2)
focal_zsh: released (5.8-3ubuntu1.1)
esm-infra/focal_zsh: released (5.8-3ubuntu1.1)
impish_zsh: released (5.8-6ubuntu0.1)
jammy_zsh: needs-triage
kinetic_zsh: not-affected (5.8.1-1)
lunar_zsh: not-affected (5.8.1-1)
mantic_zsh: not-affected (5.8.1-1)
noble_zsh: not-affected (5.8.1-1)
oracular_zsh: not-affected (5.8.1-1)
plucky_zsh: not-affected (5.8.1-1)
devel_zsh: not-affected (5.8.1-1)
