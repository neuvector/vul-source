Candidate: CVE-2024-1635
PublicDate: 2024-02-19 22:15:00 UTC
References:
 https://access.redhat.com/security/cve/CVE-2024-1635
 https://bugzilla.redhat.com/show_bug.cgi?id=2264928
 https://www.cve.org/CVERecord?id=CVE-2024-1635
Description:
 A vulnerability was found in Undertow. This vulnerability impacts a server
 that supports the wildfly-http-client protocol. Whenever a malicious user
 opens and closes a connection with the HTTP port of the server and then
 closes the connection immediately, the server will end with both memory and
 open file limits exhausted at some point, depending on the amount of memory
 available. 
 
 At HTTP upgrade to remoting, the WriteTimeoutStreamSinkConduit leaks
 connections if RemotingConnection is closed by Remoting
 ServerConnectionOpenListener. Because the remoting connection originates in
 Undertow as part of the HTTP upgrade, there is an external layer to the
 remoting connection. This connection is unaware of the outermost layer when
 closing the connection during the connection opening procedure. Hence, the
 Undertow WriteTimeoutStreamSinkConduit is not notified of the closed
 connection in this scenario. Because WriteTimeoutStreamSinkConduit creates
 a timeout task, the whole dependency tree leaks via that task, which is
 added to XNIO WorkerThread. So, the workerThread points to the Undertow
 conduit, which contains the connections and causes the leak.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 redhat: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_undertow:
upstream_undertow: needs-triage
trusty_undertow: DNE
xenial_undertow: ignored (end of standard support)
esm-apps/xenial_undertow: needs-triage
bionic_undertow: ignored (end of standard support)
esm-apps/bionic_undertow: needs-triage
focal_undertow: ignored (end of standard support, was needs-triage)
esm-apps/focal_undertow: needs-triage
jammy_undertow: needs-triage
esm-apps/jammy_undertow: needs-triage
mantic_undertow: DNE
noble_undertow: needs-triage
esm-apps/noble_undertow: needs-triage
oracular_undertow: ignored (end of life, was needs-triage)
plucky_undertow: needs-triage
devel_undertow: needs-triage
