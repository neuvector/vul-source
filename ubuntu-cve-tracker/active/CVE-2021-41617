PublicDateAtUSN: 2021-09-26 19:15:00 UTC
Candidate: CVE-2021-41617
PublicDate: 2021-09-26 19:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2021/09/26/1
 https://www.openssh.com/txt/release-8.8
 https://www.openssh.com/security.html
 https://ubuntu.com/security/notices/USN-5666-1
 https://ubuntu.com/security/notices/USN-6565-1
 https://www.cve.org/CVERecord?id=CVE-2021-41617
Description:
 sshd in OpenSSH 6.2 through 8.x before 8.8, when certain non-default
 configurations are used, allows privilege escalation because supplemental
 groups are not initialized as expected. Helper programs for
 AuthorizedKeysCommand and AuthorizedPrincipalsCommand may run with
 privileges associated with group memberships of the sshd process, if the
 configuration specifies running the command as a different user.
Ubuntu-Description:
Notes:
 mdeslaur> openssh-ssh1 is only provided for compatibility with old devices
 mdeslaur> that cannot be upgraded to modern protocols. We will not be
 mdeslaur> providing any security support for the openssh-ssh1 package as
 mdeslaur> it is insecure and should be used in trusted environments only.
 mdeslaur>
 mdeslaur> Only applies to non-default configurations where
 mdeslaur> AuthorizedKeysCommand or AuthorizedPrincipalsCommand are used.
 sespiros> Cannot reproduce since sshd for all releases drops supplementary
 sespiros> groups early when it starts with setgroups(0, NULL).
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=995130
 https://bugzilla.suse.com/show_bug.cgi?id=1190975
Priority: low
 Cannot be reproduced on Ubuntu since sshd drops groups early
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H [7.0 HIGH]

Patches_openssh:
 upstream: https://github.com/openssh/openssh-portable/commit/f3cbe43e28fe71427d41cfe3a17125b972710455
 upstream: https://github.com/openssh/openssh-portable/commit/bf944e3794eff5413f2df1ef37cddf96918c6bde
upstream_openssh: released (8.8)
trusty_openssh: ignored (end of standard support)
trusty/esm_openssh: ignored (end of ESM support, was needed)
esm-infra-legacy/trusty_openssh: needed
xenial_openssh: ignored (end of standard support, was needed)
esm-infra/xenial_openssh: released (1:7.2p2-4ubuntu2.10+esm2)
fips/xenial_openssh: needed
fips-updates/xenial_openssh: released (1:7.2p2-4ubuntu2.fips.2.10.3)
bionic_openssh: ignored (end of standard support, was needed)
esm-infra/bionic_openssh: needed
fips/bionic_openssh: needed
fips-updates/bionic_openssh: needed
focal_openssh: released (1:8.2p1-4ubuntu0.11)
esm-infra/focal_openssh: released (1:8.2p1-4ubuntu0.11)
fips/focal_openssh: needed
fips-updates/focal_openssh: released (1:8.2p1-4ubuntu0.fips.0.11)
hirsute_openssh: ignored (end of life)
impish_openssh: ignored (end of life)
jammy_openssh: not-affected (1:8.9p1-3)
fips-preview/jammy_openssh: not-affected (1:8.9p1-3)
fips-updates/jammy_openssh: not-affected (1:8.9p1-3)
kinetic_openssh: not-affected (1:9.0p1-1ubuntu7)
lunar_openssh: not-affected (1:9.0p1-1ubuntu7)
mantic_openssh: not-affected (1:9.0p1-1ubuntu7)
noble_openssh: not-affected (1:9.0p1-1ubuntu7)
oracular_openssh: not-affected (1:9.0p1-1ubuntu7)
plucky_openssh: not-affected (1:9.0p1-1ubuntu7)
questing_openssh: not-affected (1:9.0p1-1ubuntu7)
devel_openssh: not-affected (1:9.0p1-1ubuntu7)

Patches_openssh-ssh1:
upstream_openssh-ssh1: ignored (frozen on openssh 7.5p)
trusty_openssh-ssh1: DNE
trusty/esm_openssh-ssh1: DNE
esm-infra-legacy/trusty_openssh-ssh1: DNE
xenial_openssh-ssh1: DNE
bionic_openssh-ssh1: ignored (end of standard support, was needed)
esm-apps/bionic_openssh-ssh1: ignored
focal_openssh-ssh1: ignored
esm-apps/focal_openssh-ssh1: ignored
hirsute_openssh-ssh1: ignored (end of life)
impish_openssh-ssh1: ignored (end of life)
jammy_openssh-ssh1: ignored
esm-apps/jammy_openssh-ssh1: ignored
kinetic_openssh-ssh1: ignored (end of life, was needed)
lunar_openssh-ssh1: ignored (end of life, was needed)
mantic_openssh-ssh1: ignored (end of life, was needed)
noble_openssh-ssh1: ignored
esm-apps/noble_openssh-ssh1: ignored
oracular_openssh-ssh1: ignored
plucky_openssh-ssh1: ignored
questing_openssh-ssh1: ignored
devel_openssh-ssh1: ignored
