Candidate: CVE-2023-37895
PublicDate: 2023-07-25 15:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2023/07/25/8
 https://lists.apache.org/list.html?users@jackrabbit.apache.org
 http://www.openwall.com/lists/oss-security/2023/07/25/8
 https://lists.apache.org/thread/j03b3qdhborc2jrhdc4d765d3jkh8bfw
 http://seclists.org/fulldisclosure/2023/Jul/43
 https://www.cve.org/CVERecord?id=CVE-2023-37895
Description:
 Java object deserialization issue in Jackrabbit webapp/standalone on all
 platforms allows attacker to remotely execute code via RMIVersions up to
 (including) 2.20.10 (stable branch) and 2.21.17 (unstable branch) use the
 component "commons-beanutils", which contains a class that can be used for
 remote code execution over RMI. Users are advised to immediately update to
 versions 2.20.11 or 2.21.18. Note that earlier stable branches (1.0.x ..
 2.18.x) have been EOLd already and do not receive updates anymore. In
 general, RMI support can expose vulnerabilities by the mere presence of an
 exploitable class on the classpath. Even if Jackrabbit itself does not
 contain any code known to be exploitable anymore, adding other components
 to your server can expose the same type of problem. We therefore recommend
 to disable RMI access altogether (see further below), and will discuss
 deprecating RMI support in future Jackrabbit releases. How to check whether
 RMI support is enabledRMI support can be over an RMI-specific TCP port, and
 over an HTTP binding. Both are by default enabled in Jackrabbit
 webapp/standalone. The native RMI protocol by default uses port 1099. To
 check whether it is enabled, tools like "netstat" can be used to check.
 RMI-over-HTTP in Jackrabbit by default uses the path "/rmi". So when
 running standalone on port 8080, check whether an HTTP GET request on
 localhost:8080/rmi returns 404 (not enabled) or 200 (enabled). Note that
 the HTTP path may be different when the webapp is deployed in a container
 as non-root context, in which case the prefix is under the user's control.
 Turning off RMIFind web.xml (either in JAR/WAR file or in unpacked web
 application folder), and remove the declaration and the mapping definition
 for the RemoteBindingServlet: <servlet> <servlet-name>RMI</servlet-name>
 <servlet-class>org.apache.jackrabbit.servlet.remote.RemoteBindingServlet</servlet-class>
 </servlet> <servlet-mapping> <servlet-name>RMI</servlet-name>
 <url-pattern>/rmi</url-pattern> </servlet-mapping> Find the
 bootstrap.properties file (in $REPOSITORY_HOME), and set rmi.enabled=false
 and also remove rmi.host rmi.port rmi.url-pattern If there is no file named
 bootstrap.properties in $REPOSITORY_HOME, it is located somewhere in the
 classpath. In this case, place a copy in $REPOSITORY_HOME and modify it as
 explained.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_jackrabbit:
upstream_jackrabbit: released (2.20.11-1)
trusty_jackrabbit: ignored (end of standard support)
trusty/esm_jackrabbit: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_jackrabbit: needs-triage
xenial_jackrabbit: ignored (end of standard support)
esm-apps/xenial_jackrabbit: needs-triage
bionic_jackrabbit: ignored (end of standard support)
esm-apps/bionic_jackrabbit: needs-triage
focal_jackrabbit: needs-triage
esm-apps/focal_jackrabbit: needs-triage
jammy_jackrabbit: needs-triage
esm-apps/jammy_jackrabbit: needs-triage
lunar_jackrabbit: ignored (end of life, was needs-triage)
mantic_jackrabbit: ignored (end of life, was needs-triage)
noble_jackrabbit: needs-triage
esm-apps/noble_jackrabbit: needs-triage
oracular_jackrabbit: not-affected (2.20.11-1)
plucky_jackrabbit: not-affected (2.20.11-1)
devel_jackrabbit: not-affected (2.20.11-1)
