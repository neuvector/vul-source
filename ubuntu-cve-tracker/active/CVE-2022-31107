Candidate: CVE-2022-31107
PublicDate: 2022-07-15 13:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2022-31107
Description:
 Grafana is an open-source platform for monitoring and observability. In
 versions 5.3 until 9.0.3, 8.5.9, 8.4.10, and 8.3.10, it is possible for a
 malicious user who has authorization to log into a Grafana instance via a
 configured OAuth IdP which provides a login name to take over the account
 of another user in that Grafana instance. This can occur when the malicious
 user is authorized to log in to Grafana via OAuth, the malicious user's
 external user id is not already associated with an account in Grafana, the
 malicious user's email address is not already associated with an account in
 Grafana, and the malicious user knows the Grafana username of the target
 user. If these conditions are met, the malicious user can set their
 username in the OAuth provider to that of the target user, then go through
 the OAuth flow to log in to Grafana. Due to the way that external and
 internal user accounts are linked together during login, if the conditions
 above are all met then the malicious user will be able to log in to the
 target user's Grafana account. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10
 contain a patch for this issue. As a workaround, concerned users can
 disable OAuth login to their Grafana instance, or ensure that all users
 authorized to log in via OAuth have a corresponding user account in Grafana
 linked to their email address.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L [7.1 HIGH]
 nvd: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H [7.5 HIGH]


Patches_grafana:
upstream_grafana: needs-triage
esm-apps/xenial_grafana: needs-triage
focal_grafana: DNE
jammy_grafana: DNE
mantic_grafana: DNE
noble_grafana: DNE
oracular_grafana: DNE
plucky_grafana: DNE
devel_grafana: DNE
