PublicDateAtUSN: 2022-10-11 15:15:00 UTC
Candidate: CVE-2022-3358
PublicDate: 2022-10-11 15:15:00 UTC
References:
 https://www.openssl.org/news/secadv/20221011.txt
 https://ubuntu.com/security/notices/USN-5710-1
 https://www.cve.org/CVERecord?id=CVE-2022-3358
Description:
 OpenSSL supports creating a custom cipher via the legacy
 EVP_CIPHER_meth_new() function and associated function calls. This function
 was deprecated in OpenSSL 3.0 and application authors are instead
 encouraged to use the new provider mechanism in order to implement custom
 ciphers. OpenSSL versions 3.0.0 to 3.0.5 incorrectly handle legacy custom
 ciphers passed to the EVP_EncryptInit_ex2(), EVP_DecryptInit_ex2() and
 EVP_CipherInit_ex2() functions (as well as other similarly named encryption
 and decryption initialisation functions). Instead of using the custom
 cipher directly it incorrectly tries to fetch an equivalent cipher from the
 available providers. An equivalent cipher is found based on the NID passed
 to EVP_CIPHER_meth_new(). This NID is supposed to represent the unique NID
 for a given cipher. However it is possible for an application to
 incorrectly pass NID_undef as this value in the call to
 EVP_CIPHER_meth_new(). When NID_undef is used in this way the OpenSSL
 encryption/decryption initialisation function will match the NULL cipher as
 being equivalent and will fetch this from the available providers. This
 will succeed if the default provider has been loaded (or if a third party
 provider has been loaded that offers this cipher). Using the NULL cipher
 means that the plaintext is emitted as the ciphertext. Applications are
 only affected by this issue if they call EVP_CIPHER_meth_new() using
 NID_undef and subsequently use it in a call to an encryption/decryption
 initialisation function. Applications that only use SSL/TLS are not
 impacted by this issue. Fixed in OpenSSL 3.0.6 (Affected 3.0.0-3.0.5).
Ubuntu-Description:
Notes:
 mdeslaur> 3.x only
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1021620
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]

Patches_openssl:
 upstream: https://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=5485c56679d7c49b96e8fc8ca708b0b7e7c03c4b
upstream_openssl: released (3.0.6)
esm-infra/xenial_openssl: not-affected (code not present)
trusty_openssl: ignored (end of standard support)
xenial_openssl: ignored (end of standard support)
bionic_openssl: not-affected (code not present)
esm-infra/bionic_openssl: not-affected (code not present)
focal_openssl: not-affected (code not present)
esm-infra/focal_openssl: not-affected (code not present)
jammy_openssl: released (3.0.2-0ubuntu1.7)
trusty/esm_openssl: not-affected (code not present)
esm-infra-legacy/trusty_openssl: not-affected (code not present)
fips/xenial_openssl: not-affected (code not present)
fips/bionic_openssl: not-affected (code not present)
fips/focal_openssl: not-affected (code not present)
fips-updates/xenial_openssl: not-affected (code not present)
fips-updates/bionic_openssl: not-affected (code not present)
fips-updates/focal_openssl: not-affected (code not present)
fips-preview/jammy_openssl: released (3.0.2-0ubuntu1.7+fips.1)
fips-updates/jammy_openssl: released (3.0.2-0ubuntu1.7+fips.1)
kinetic_openssl: released (3.0.5-2ubuntu2)
lunar_openssl: released (3.0.5-2ubuntu2)
mantic_openssl: released (3.0.5-2ubuntu2)
noble_openssl: released (3.0.5-2ubuntu2)
oracular_openssl: released (3.0.5-2ubuntu2)
plucky_openssl: released (3.0.5-2ubuntu2)
devel_openssl: released (3.0.5-2ubuntu2)

Patches_openssl1.0:
upstream_openssl1.0: not-affected (code not present)
trusty_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: not-affected (code not present)
esm-infra/bionic_openssl1.0: not-affected (code not present)
focal_openssl1.0: DNE
esm-infra/focal_openssl1.0: DNE
jammy_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
trusty_nodejs: ignored (end of standard support)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
jammy_nodejs: not-affected (uses openssl 1.1)
esm-apps/jammy_nodejs: not-affected (uses openssl 1.1)
trusty/esm_nodejs: not-affected (uses system openssl)
esm-infra-legacy/trusty_nodejs: not-affected (uses system openssl)
kinetic_nodejs: not-affected (uses system openssl1.1)
lunar_nodejs: not-affected (uses system openssl1.1)
mantic_nodejs: not-affected (uses system openssl1.1)
noble_nodejs: not-affected (uses system openssl1.1)
esm-apps/noble_nodejs: not-affected (uses system openssl1.1)
oracular_nodejs: not-affected (uses system openssl1.1)
plucky_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
upstream_edk2: needs-triage
trusty_edk2: ignored (end of standard support)
xenial_edk2: ignored (end of standard support)
esm-apps/xenial_edk2: needs-triage
bionic_edk2: not-affected (code not present)
esm-apps/bionic_edk2: not-affected (code not present)
focal_edk2: not-affected (code not present)
esm-infra/focal_edk2: not-affected (code not present)
jammy_edk2: not-affected (code not present)
kinetic_edk2: not-affected (code not present)
lunar_edk2: not-affected (code not present)
mantic_edk2: not-affected (code not present)
noble_edk2: not-affected (code not present)
oracular_edk2: not-affected (code not present)
plucky_edk2: not-affected (code not present)
devel_edk2: not-affected (code not present)
