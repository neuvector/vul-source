Candidate: CVE-2019-9858
PublicDate: 2019-05-29 17:29:00 UTC
References:
 https://ssd-disclosure.com/archives/3814/ssd-advisory-horde-groupware-webmail-authenticated-arbitrary-file-injection-to-rce
 https://github.com/horde/Form/commit/c916ba979ad1613d76a9407dd0b67968a9594c0e
 http://packetstormsecurity.com/files/152476/Horde-Form-Shell-Upload.html
 https://lists.debian.org/debian-lts-announce/2019/06/msg00007.html
 https://seclists.org/bugtraq/2019/Jun/31
 https://ssd-disclosure.com/?p=3814&preview=true
 https://www.debian.org/security/2019/dsa-4468
 https://www.cve.org/CVERecord?id=CVE-2019-9858
Description:
 Remote code execution was discovered in Horde Groupware Webmail 5.2.22 and
 5.2.17. Horde/Form/Type.php contains a vulnerable class that handles image
 upload in forms. When the Horde_Form_Type_image method onSubmit() is called
 on uploads, it invokes the functions getImage() and _getUpload(), which
 uses unsanitized user input as a path to save the image. The unsanitized
 POST parameter object[photo][img][file] is saved in the $upload[img][file]
 PHP variable, allowing an attacker to manipulate the $tmp_file passed to
 move_uploaded_file() to save the uploaded file. By setting the parameter to
 (for example) ../usr/share/horde/static/bd.php, one can write a PHP
 backdoor inside the web root. The static/ destination folder is a good
 candidate to drop the backdoor because it is always writable in Horde
 installations. (The unsanitized POST parameter went probably unnoticed
 because it's never submitted by the forms, which default to securely using
 a random path.)
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=930321
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]


Patches_php-horde-form:
upstream_php-horde-form: released (2.0.18-3.1)
precise/esm_php-horde-form: DNE
trusty_php-horde-form: ignored (end of standard support)
trusty/esm_php-horde-form: DNE
esm-infra-legacy/trusty_php-horde-form: DNE
xenial_php-horde-form: ignored (end of standard support, was needs-triage)
esm-apps/xenial_php-horde-form: needs-triage
bionic_php-horde-form: ignored (end of standard support, was needs-triage)
esm-apps/bionic_php-horde-form: needs-triage
eoan_php-horde-form: not-affected (2.0.18-3.1)
focal_php-horde-form: DNE
groovy_php-horde-form: DNE
hirsute_php-horde-form: DNE
impish_php-horde-form: DNE
jammy_php-horde-form: DNE
kinetic_php-horde-form: DNE
lunar_php-horde-form: DNE
mantic_php-horde-form: DNE
noble_php-horde-form: DNE
oracular_php-horde-form: DNE
plucky_php-horde-form: DNE
devel_php-horde-form: DNE
