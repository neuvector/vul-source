PublicDateAtUSN: 2025-04-06 20:15:00 UTC
Candidate: CVE-2025-31492
PublicDate: 2025-04-06 20:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-31492
 https://github.com/OpenIDC/mod_auth_openidc/commit/b59b8ad63411857090ba1088e23fe414c690c127
 https://github.com/OpenIDC/mod_auth_openidc/security/advisories/GHSA-59jp-rwph-878r
 https://ubuntu.com/security/notices/USN-7446-1
Description:
 mod_auth_openidc is an OpenID Certified authentication and authorization
 module for the Apache 2.x HTTP server that implements the OpenID Connect
 Relying Party functionality. Prior to 2.4.16.11, a bug in a
 mod_auth_openidc results in disclosure of protected content to
 unauthenticated users. The conditions for disclosure are an
 OIDCProviderAuthRequestMethod POST, a valid account, and there mustn't be
 any application-level gateway (or load balancer etc) protecting the server.
 When you request a protected resource, the response includes the HTTP
 status, the HTTP headers, the intended response (the self-submitting form),
 and the protected resource (with no headers). This is an example of a
 request for a protected resource, including all the data returned. In the
 case where mod_auth_openidc returns a form, it has to return OK from
 check_userid so as not to go down the error path in httpd. This means httpd
 will try to issue the protected resource. oidc_content_handler is called
 early, which has the opportunity to prevent the normal output being issued
 by httpd. oidc_content_handler has a number of checks for when it
 intervenes, but it doesn't check for this case, so the handler returns
 DECLINED. Consequently, httpd appends the protected content to the
 response. The issue has been patched in mod_auth_openidc versions >=
 2.4.16.11.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N [8.2 HIGH]

Patches_libapache2-mod-auth-openidc:
upstream_libapache2-mod-auth-openidc: released (2.4.16.11)
esm-apps/xenial_libapache2-mod-auth-openidc: not-affected (code not present)
esm-apps/bionic_libapache2-mod-auth-openidc: needed
focal_libapache2-mod-auth-openidc: ignored (end of standard support, was needed)
esm-apps/focal_libapache2-mod-auth-openidc: needed
jammy_libapache2-mod-auth-openidc: released (2.4.11-1ubuntu0.1)
esm-apps/jammy_libapache2-mod-auth-openidc: released (2.4.11-1ubuntu0.1)
noble_libapache2-mod-auth-openidc: released (2.4.15.1-1ubuntu0.1)
esm-apps/noble_libapache2-mod-auth-openidc: released (2.4.15.1-1ubuntu0.1)
oracular_libapache2-mod-auth-openidc: released (2.4.15.7-2ubuntu0.1)
plucky_libapache2-mod-auth-openidc: released (2.4.16.10-1ubuntu1)
devel_libapache2-mod-auth-openidc: needed
