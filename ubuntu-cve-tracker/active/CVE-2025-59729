Candidate: CVE-2025-59729
PublicDate: 2025-10-06 08:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-59729
 https://issuetracker.google.com/433513232
Description:
 When parsing the header for a DHAV file, there's an integer underflow in
 offset calculation that leads to reading the duration from before the start
 of the allocated buffer.
 
 If we load a DHAV file that is larger than MAX_DURATION_BUFFER_SIZE bytes
 (0x100000) for example 0x101000 bytes, then at [0] we have size = 0x101000.
 At [1] we have end_buffer_size = 0x100000, and at [2] we have
 end_buffer_pos = 0x1000.
 
 The loop then scans backwards through the buffer looking for the dhav tag;
 when it is found, we'll calculate end_pos based on a 32-bit offset read
 from the buffer.
 
 There is subsequently a check [3] that end_pos is within the section of the
 file that has been copied into end_buffer, but it only correctly handles
 the cases where end_pos is before the start of the file or after the
 section copied into end_buffer, and not the case where end_pos is within
 the the file, but before the section copied into end_buffer. If we provide
 such an offset, (end_pos - end_buffer_pos) can underflow, resulting in the
 subsequent access at [4] occurring before the beginning of the allocation.
 
 We recommend upgrading to version 8.0 or beyond.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> Google Big Sleep identifier: BIGSLEEP-433513232
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 google: CVSS:4.0/AV:A/AC:H/AT:P/PR:L/UI:P/VC:L/VI:H/VA:N/SC:L/SI:H/SA:N [5.7 MEDIUM]

Patches_ffmpeg:
 upstream: https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/33ae6cda71e6d34c9081a612abae00e2c7d39f72
upstream_ffmpeg: released (8.0)
esm-apps/xenial_ffmpeg: not-affected (code not present)
esm-apps/bionic_ffmpeg: not-affected (code not present)
esm-apps/focal_ffmpeg: not-affected (code not present)
jammy_ffmpeg: not-affected (code not present)
esm-apps/jammy_ffmpeg: not-affected (code not present)
noble_ffmpeg: not-affected (code not present)
esm-apps/noble_ffmpeg: not-affected (code not present)
plucky_ffmpeg: ignored (end of life, was needs-triage)
questing_ffmpeg: not-affected (code not present)
devel_ffmpeg: needed

Patches_libav:
upstream_libav: needs-triage
esm-infra-legacy/trusty_libav: needs-triage
jammy_libav: DNE
noble_libav: DNE
plucky_libav: DNE
questing_libav: DNE
devel_libav: DNE
