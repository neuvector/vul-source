Candidate: CVE-2021-39135
PublicDate: 2021-08-31 17:15:00 UTC
References:
 https://github.com/npm/arborist/security/advisories/GHSA-gmw6-94gg-2rc2
 https://www.npmjs.com/package/@npmcli/arborist
 https://www.cve.org/CVERecord?id=CVE-2021-39135
Description:
 `@npmcli/arborist`, the library that calculates dependency trees and
 manages the node_modules folder hierarchy for the npm command line
 interface, aims to guarantee that package dependency contracts will be met,
 and the extraction of package contents will always be performed into the
 expected folder. This is accomplished by extracting package contents into a
 project's `node_modules` folder. If the `node_modules` folder of the root
 project or any of its dependencies is somehow replaced with a symbolic
 link, it could allow Arborist to write package dependencies to any
 arbitrary location on the file system. Note that symbolic links contained
 within package artifact contents are filtered out, so another means of
 creating a `node_modules` symbolic link would have to be employed. 1. A
 `preinstall` script could replace `node_modules` with a symlink. (This is
 prevented by using `--ignore-scripts`.) 2. An attacker could supply the
 target with a git repository, instructing them to run `npm install
 --ignore-scripts` in the root. This may be successful, because `npm install
 --ignore-scripts` is typically not capable of making changes outside of the
 project directory, so it may be deemed safe. This is patched in
 @npmcli/arborist 2.8.2 which is included in npm v7.20.7 and above. For more
 information including workarounds please see the referenced
 GHSA-gmw6-94gg-2rc2.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=993405
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N [8.2 HIGH]
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_npm:
upstream_npm: released (v7.20.7)
trusty_npm: ignored (end of standard support)
trusty/esm_npm: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_npm: needs-triage
xenial_npm: ignored (end of standard support)
esm-apps/xenial_npm: needs-triage
bionic_npm: ignored (end of standard support, was needs-triage)
esm-apps/bionic_npm: needs-triage
focal_npm: needs-triage
esm-apps/focal_npm: needs-triage
hirsute_npm: ignored (end of life)
impish_npm: ignored (end of life)
jammy_npm: not-affected (8.5.1~ds-1)
esm-apps/jammy_npm: not-affected (8.5.1~ds-1)
kinetic_npm: ignored (end of life, was needs-triage)
lunar_npm: ignored (end of life, was needs-triage)
mantic_npm: ignored (end of life, was needs-triage)
noble_npm: not-affected (9.2.0~ds1-2)
esm-apps/noble_npm: not-affected (9.2.0~ds1-2)
oracular_npm: not-affected (9.2.0~ds1-3)
plucky_npm: not-affected (9.2.0~ds1-3)
devel_npm: not-affected (9.2.0~ds1-3)
