Candidate: CVE-2023-46841
PublicDate: 2024-03-20 11:15:00 UTC
References:
 https://xenbits.xen.org/xsa/advisory-451.html
 https://www.cve.org/CVERecord?id=CVE-2023-46841
Description:
 Recent x86 CPUs offer functionality named Control-flow Enforcement
 Technology (CET).  A sub-feature of this are Shadow Stacks (CET-SS).
 CET-SS is a hardware feature designed to protect against Return Oriented
 Programming attacks. When enabled, traditional stacks holding both data
 and return addresses are accompanied by so called "shadow stacks",
 holding little more than return addresses.  Shadow stacks aren't
 writable by normal instructions, and upon function returns their
 contents are used to check for possible manipulation of a return address
 coming from the traditional stack.
 
 In particular certain memory accesses need intercepting by Xen.  In
 various cases the necessary emulation involves kind of replaying of
 the instruction.  Such replaying typically involves filling and then
 invoking of a stub.  Such a replayed instruction may raise an
 exceptions, which is expected and dealt with accordingly.
 
 Unfortunately the interaction of both of the above wasn't right:
 Recovery involves removal of a call frame from the (traditional) stack.
 The counterpart of this operation for the shadow stack was missing.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H [6.5 MEDIUM]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: needs-triage
trusty_xen: ignored (end of standard support)
xenial_xen: ignored (end of standard support)
esm-infra/xenial_xen: needs-triage
bionic_xen: ignored (end of standard support)
esm-infra/bionic_xen: needs-triage
focal_xen: ignored (end of standard support, was needs-triage)
esm-apps/focal_xen: needs-triage
jammy_xen: needs-triage
esm-apps/jammy_xen: needs-triage
mantic_xen: ignored (end of life, was needs-triage)
noble_xen: needs-triage
esm-apps/noble_xen: needs-triage
oracular_xen: ignored (end of life, was needs-triage)
plucky_xen: needs-triage
devel_xen: needs-triage
