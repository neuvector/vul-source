Candidate: CVE-2022-31042
PublicDate: 2022-06-10 00:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31042
 https://github.com/guzzle/guzzle/security/advisories/GHSA-f2wf-25xc-69c9
 https://github.com/guzzle/guzzle/commit/e3ff079b22820c2029d4c2a87796b6a0b8716ad8 (7.4.4)
 https://github.com/guzzle/guzzle/commit/e3ff079b22820c2029d4c2a87796b6a0b8716ad8
 https://www.rfc-editor.org/rfc/rfc9110.html#name-redirection-3xx
Description:
 Guzzle is an open source PHP HTTP client. In affected versions the `Cookie`
 headers on requests are sensitive information. On making a request using
 the `https` scheme to a server which responds with a redirect to a URI with
 the `http` scheme, or on making a request to a server which responds with a
 redirect to a a URI to a different host, we should not forward the `Cookie`
 header on. Prior to this fix, only cookies that were managed by our cookie
 middleware would be safely removed, and any `Cookie` header manually added
 to the initial request would not be stripped. We now always strip it, and
 allow the cookie middleware to re-add any cookies that it deems should be
 there. Affected Guzzle 7 users should upgrade to Guzzle 7.4.4 as soon as
 possible. Affected users using any earlier series of Guzzle should upgrade
 to Guzzle 6.5.7 or 7.4.4. Users unable to upgrade may consider an
 alternative approach to use your own redirect middleware, rather than ours.
 If you do not require or expect redirects to be followed, one should simply
 disable redirects all together.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]


Patches_guzzle:
kinetic_guzzle: ignored (end of life, was needs-triage)
lunar_guzzle: needs-triage
mantic_guzzle: needs-triage
devel_guzzle: needs-triage
upstream_guzzle: needs-triage
