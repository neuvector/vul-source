Candidate: CVE-2022-24795
PublicDate: 2022-04-05 16:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24795
 https://github.com/brianmario/yajl-ruby/pull/211
 https://github.com/brianmario/yajl-ruby/security/advisories/GHSA-jj47-x69x-mxrm
Description:
 yajl-ruby is a C binding to the YAJL JSON parsing and generation library.
 The 1.x branch and the 2.x branch of `yajl` contain an integer overflow
 which leads to subsequent heap memory corruption when dealing with large
 (~2GB) inputs. The reallocation logic at `yajl_buf.c#L64` may result in the
 `need` 32bit integer wrapping to 0 when `need` approaches a value of
 0x80000000 (i.e. ~2GB of data), which results in a reallocation of
 buf->alloc into a small heap chunk. These integers are declared as `size_t`
 in the 2.x branch of `yajl`, which practically prevents the issue from
 triggering on 64bit platforms, however this does not preclude this issue
 triggering on 32bit builds on which `size_t` is a 32bit integer. Subsequent
 population of this under-allocated heap chunk is based on the original
 buffer size, leading to heap memory corruption. This vulnerability mostly
 impacts process availability. Maintainers believe exploitation for
 arbitrary code execution is unlikely. A patch is available and anticipated
 to be part of yajl-ruby version 1.4.2. As a workaround, avoid passing large
 inputs to YAJL.
Ubuntu-Description:
Notes:
 mdeslaur> CVE is assigned to yajl-ruby. There is an unofficial patch for
 mdeslaur> yajl which will abort() too, though that is likely hardening and
 mdeslaur> isn't part of this CVE.
 ccdm94> no upstream patch available as of 2023-06-07 for yajl. There is an
 ccdm94> open pull request for the unofficial patch, however, the fix proposed 
 ccdm94> by the patch is being further discussed on the comments of this pull
 ccdm94> request. The unofficial patch is being disputed by some, and new 
 ccdm94> patches have been proposed. More information at 
 ccdm94> https://github.com/lloyd/yajl/pull/240.
Mitigation:
Bugs:
 https://github.com/lloyd/yajl/issues/239
Priority: medium
Discovered-by:
Assigned-to: ccdm94
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]


Patches_argyll:
upstream_argyll: needs-triage
trusty_argyll: ignored (end of standard support)
xenial_argyll: ignored (end of standard support)
esm-apps/xenial_argyll: needs-triage
bionic_argyll: ignored (end of standard support, was needs-triage)
esm-apps/bionic_argyll: needs-triage
focal_argyll: needs-triage
esm-apps/focal_argyll: needs-triage
impish_argyll: ignored (end of life)
jammy_argyll: needs-triage
esm-apps/jammy_argyll: needs-triage
kinetic_argyll: needs-triage
lunar_argyll: needs-triage
devel_argyll: needs-triage

Patches_burp:
upstream_burp: needs-triage
trusty_burp: ignored (end of standard support)
xenial_burp: ignored (end of standard support)
esm-apps/xenial_burp: needs-triage
bionic_burp: ignored (end of standard support, was needs-triage)
esm-apps/bionic_burp: needs-triage
focal_burp: needs-triage
esm-apps/focal_burp: needs-triage
impish_burp: ignored (end of life)
jammy_burp: needs-triage
esm-apps/jammy_burp: needs-triage
kinetic_burp: needs-triage
lunar_burp: needs-triage
devel_burp: needs-triage

Patches_centreon-broker:
upstream_centreon-broker: needs-triage
trusty_centreon-broker: ignored (end of standard support)
xenial_centreon-broker: ignored (end of standard support)

Patches_collada2gltf:
upstream_collada2gltf: needs-triage
trusty_collada2gltf: ignored (end of standard support)
xenial_collada2gltf: ignored (end of standard support)
esm-apps/xenial_collada2gltf: needs-triage
bionic_collada2gltf: ignored (end of standard support, was needs-triage)
esm-apps/bionic_collada2gltf: needs-triage
impish_collada2gltf: ignored (end of life)
jammy_collada2gltf: needs-triage
esm-apps/jammy_collada2gltf: needs-triage
kinetic_collada2gltf: needs-triage
lunar_collada2gltf: needs-triage
devel_collada2gltf: needs-triage

Patches_icinga2:
upstream_icinga2: needs-triage
trusty_icinga2: ignored (end of standard support)
xenial_icinga2: ignored (end of standard support)
esm-apps/xenial_icinga2: needs-triage
bionic_icinga2: ignored (end of standard support, was needs-triage)
esm-apps/bionic_icinga2: needs-triage
focal_icinga2: needs-triage
esm-apps/focal_icinga2: needs-triage
impish_icinga2: ignored (end of life)
jammy_icinga2: needs-triage
esm-apps/jammy_icinga2: needs-triage
kinetic_icinga2: needs-triage
lunar_icinga2: needs-triage
devel_icinga2: needs-triage

Patches_libbson:
upstream_libbson: needs-triage
trusty_libbson: ignored (end of standard support)
xenial_libbson: ignored (end of standard support)
esm-apps/xenial_libbson: needs-triage
bionic_libbson: ignored (end of standard support, was needs-triage)
esm-apps/bionic_libbson: needs-triage

Patches_lnav:
upstream_lnav: needs-triage
trusty_lnav: ignored (end of standard support)
xenial_lnav: ignored (end of standard support)
esm-apps/xenial_lnav: needs-triage
bionic_lnav: ignored (end of standard support, was needs-triage)
esm-apps/bionic_lnav: needs-triage
focal_lnav: needs-triage
esm-apps/focal_lnav: needs-triage
impish_lnav: ignored (end of life)
jammy_lnav: needs-triage
esm-apps/jammy_lnav: needs-triage
kinetic_lnav: needs-triage
lunar_lnav: needs-triage
devel_lnav: needs-triage

Patches_php-mongodb:
upstream_php-mongodb: needs-triage
trusty_php-mongodb: ignored (end of standard support)
xenial_php-mongodb: ignored (end of standard support)
esm-apps/xenial_php-mongodb: needs-triage
bionic_php-mongodb: ignored (end of standard support, was needs-triage)
esm-apps/bionic_php-mongodb: needs-triage
focal_php-mongodb: needs-triage
esm-apps/focal_php-mongodb: needs-triage
impish_php-mongodb: ignored (end of life)
jammy_php-mongodb: needs-triage
esm-apps/jammy_php-mongodb: needs-triage
kinetic_php-mongodb: needs-triage
lunar_php-mongodb: needs-triage
devel_php-mongodb: needs-triage

Patches_r-cran-jsonlite:
upstream_r-cran-jsonlite: needs-triage
trusty_r-cran-jsonlite: ignored (end of standard support)
xenial_r-cran-jsonlite: ignored (end of standard support)
esm-apps/xenial_r-cran-jsonlite: needs-triage
bionic_r-cran-jsonlite: ignored (end of standard support, was needs-triage)
esm-apps/bionic_r-cran-jsonlite: needs-triage
focal_r-cran-jsonlite: needs-triage
esm-apps/focal_r-cran-jsonlite: needs-triage
impish_r-cran-jsonlite: ignored (end of life)
jammy_r-cran-jsonlite: needs-triage
esm-apps/jammy_r-cran-jsonlite: needs-triage
kinetic_r-cran-jsonlite: needs-triage
lunar_r-cran-jsonlite: needs-triage
devel_r-cran-jsonlite: needs-triage

Patches_ruby-yajl:
 upstream: https://github.com/brianmario/yajl-ruby/commit/7168bd79b888900aa94523301126f968a93eb3a6
upstream_ruby-yajl: needs-triage
trusty_ruby-yajl: ignored (end of standard support)
xenial_ruby-yajl: ignored (end of standard support)
esm-apps/xenial_ruby-yajl: needs-triage
bionic_ruby-yajl: ignored (end of standard support, was needs-triage)
esm-apps/bionic_ruby-yajl: needs-triage
focal_ruby-yajl: needs-triage
esm-apps/focal_ruby-yajl: needs-triage
impish_ruby-yajl: ignored (end of life)
jammy_ruby-yajl: needs-triage
esm-apps/jammy_ruby-yajl: needs-triage
kinetic_ruby-yajl: needs-triage
lunar_ruby-yajl: needs-triage
devel_ruby-yajl: needs-triage

Patches_tulip:
upstream_tulip: needs-triage
trusty_tulip: ignored (end of standard support)
xenial_tulip: ignored (end of standard support)
esm-apps/xenial_tulip: needs-triage
impish_tulip: ignored (end of life)
jammy_tulip: needs-triage
esm-apps/jammy_tulip: needs-triage
kinetic_tulip: needs-triage
lunar_tulip: needs-triage
devel_tulip: needs-triage

Patches_yajl:
 other: https://github.com/ppisar/yajl/commit/23cea2d7677e396efed78bbf1bf153961fab6bad
Priority_yajl: low
upstream_yajl: released (2.1.0-3+deb10u2)
trusty/esm_yajl: needed
esm-infra/xenial_yajl: needed
trusty_yajl: ignored (end of standard support)
xenial_yajl: ignored (end of standard support)
bionic_yajl: ignored (end of standard support, was needed)
esm-infra/bionic_yajl: needed
focal_yajl: needed
impish_yajl: ignored (end of life)
jammy_yajl: needed
kinetic_yajl: needed
lunar_yajl: needed
devel_yajl: needed
