Candidate: CVE-2025-24294
PublicDate: 2025-07-12 04:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-24294
 https://www.ruby-lang.org/en/news/2025/07/08/dos-resolv-cve-2025-24294/
Description:
 The attack vector is a potential Denial of Service (DoS). The vulnerability
 is caused by an insufficient check on the length of a decompressed domain
 name within a DNS packet.
 
 An attacker can craft a malicious DNS packet containing a highly compressed
 domain name. When the resolv library parses such a packet, the name
 decompression process consumes a large amount of CPU resources, as the
 library does not limit the resulting length of the name.
 
 This resource consumption can cause the application thread to become
 unresponsive, resulting in a Denial of Service condition.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> CVE affects 'resolv' gem, which is bundled with ruby.
 mdeslaur> versions are:
 mdeslaur> Ruby 3.2 series: resolv version 0.2.2 and earlier
 mdeslaur> Ruby 3.3 series: resolv version 0.3.0
 mdeslaur> Ruby 3.4 series: resolv version 0.6.1 and earlier
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: 0xnishit
CVSS:
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_ruby2.3:
upstream_ruby2.3: needs-triage
esm-infra/xenial_ruby2.3: needs-triage
jammy_ruby2.3: DNE
noble_ruby2.3: DNE
plucky_ruby2.3: DNE
devel_ruby2.3: DNE

Patches_ruby2.5:
upstream_ruby2.5: needs-triage
esm-infra/bionic_ruby2.5: needs-triage
jammy_ruby2.5: DNE
noble_ruby2.5: DNE
plucky_ruby2.5: DNE
devel_ruby2.5: DNE

Patches_ruby2.7:
upstream_ruby2.7: needs-triage
esm-infra/focal_ruby2.7: needs-triage
jammy_ruby2.7: DNE
noble_ruby2.7: DNE
plucky_ruby2.7: DNE
devel_ruby2.7: DNE

Patches_ruby3.0:
 upstream: https://github.com/ruby/resolv/commit/cde34cac9d87c37b33c19eede3ed49ac3f465a18 (v0.2.3)
upstream_ruby3.0: needs-triage
jammy_ruby3.0: needs-triage
noble_ruby3.0: DNE
plucky_ruby3.0: DNE
devel_ruby3.0: DNE

Patches_ruby3.2:
 upstream: https://github.com/ruby/resolv/commit/cde34cac9d87c37b33c19eede3ed49ac3f465a18 (v0.2.3)
upstream_ruby3.2: released (3.2.9)
jammy_ruby3.2: DNE
noble_ruby3.2: needs-triage
plucky_ruby3.2: DNE
devel_ruby3.2: DNE

Patches_ruby3.3:
 usptream: https://github.com/ruby/ruby/commit/9aa0300db2cd2514ca55c1f66022610ee8c3ca1f (main)
 upstream: https://github.com/ruby/ruby/commit/111a49e77e4b05a21bb37942ea2cfc254daa8d92 (3.3)
 upstream: https://github.com/ruby/resolv/commit/24ed513f028d8e5c76310fcdecf07f79eb721a32 (v0.3.1)
upstream_ruby3.3: released (3.3.9)
jammy_ruby3.3: DNE
noble_ruby3.3: DNE
plucky_ruby3.3: needs-triage
devel_ruby3.3: needs-triage

Patches_jruby:
upstream_jruby: needs-triage
esm-infra-legacy/trusty_jruby: needs-triage
esm-apps/xenial_jruby: needs-triage
esm-apps/bionic_jruby: needs-triage
esm-apps/focal_jruby: needs-triage
jammy_jruby: DNE
noble_jruby: needs-triage
esm-apps/noble_jruby: needs-triage
plucky_jruby: needs-triage
devel_jruby: needs-triage

Patches_rubygems:
 upstream: https://github.com/ruby/resolv/commit/4c2f71b5e80826506f78417d85b38481c058fb25 (v0.6.2)
upstream_rubygems: needs-triage
jammy_rubygems: not-affected (code not present)
noble_rubygems: not-affected (code not present)
plucky_rubygems: needed
devel_rubygems: needed
