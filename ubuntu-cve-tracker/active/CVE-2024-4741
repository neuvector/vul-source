PublicDateAtUSN: 2024-05-28
Candidate: CVE-2024-4741
PublicDate: 2024-11-13 11:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-4741
 https://www.openssl.org/news/secadv/20240528.txt
 https://ubuntu.com/security/notices/USN-6937-1
Description:
 Issue summary: Calling the OpenSSL API function SSL_free_buffers may cause
 memory to be accessed that was previously freed in some situations
 
 Impact summary: A use after free can have a range of potential consequences
 such
 as the corruption of valid data, crashes or execution of arbitrary code.
 However, only applications that directly call the SSL_free_buffers function
 are
 affected by this issue. Applications that do not call this function are not
 vulnerable. Our investigations indicate that this function is rarely used
 by
 applications.
 
 The SSL_free_buffers function is used to free the internal OpenSSL buffer
 used
 when processing an incoming record from the network. The call is only
 expected
 to succeed if the buffer is not currently in use. However, two scenarios
 have
 been identified where the buffer is freed even when still in use.
 
 The first scenario occurs where a record header has been received from the
 network and processed by OpenSSL, but the full record body has not yet
 arrived.
 In this case calling SSL_free_buffers will succeed even though a record has
 only
 been partially processed and the buffer is still in use.
 
 The second scenario occurs where a full record containing application data
 has
 been received and processed by OpenSSL but the application has only read
 part of
 this data. Again a call to SSL_free_buffers will succeed even though the
 buffer
 is still in use.
 
 While these scenarios could occur accidentally during normal operation a
 malicious attacker could attempt to engineer a stituation where this
 occurs.
 We are not aware of this issue being actively exploited.
 
 The FIPS modules in 3.3, 3.2, 3.1 and 3.0 are not affected by this issue.
Ubuntu-Description:
Notes:
 mdeslaur> 1.0.2 is not affected, 1.1.1, and 3.x are affected
Mitigation:
Bugs:
Priority: low
 Upstream OpenSSL developers have rated this as being a low severity issue
Discovered-by: William Ahern
Assigned-to:
CVSS:

Patches_openssl:
 upstream: https://github.com/openssl/openssl/commit/b3f0eb0a295f58f16ba43ba99dad70d4ee5c437d (3.0.x)
 upstream: https://github.com/openssl/openssl/commit/c88c3de51020c37e8706bf7a682a162593053aac (3.2.x)
upstream_openssl: needs-triage
trusty/esm_openssl: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_openssl: needs-triage
esm-infra/xenial_openssl: needs-triage
fips-updates/xenial_openssl: needs-triage
fips/xenial_openssl: needs-triage
esm-infra/bionic_openssl: needs-triage
fips-updates/bionic_openssl: needs-triage
fips/bionic_openssl: needs-triage
focal_openssl: released (1.1.1f-1ubuntu2.23)
fips-updates/focal_openssl: released (1.1.1f-1ubuntu2.fips.23)
fips/focal_openssl: needed
jammy_openssl: released (3.0.2-0ubuntu1.17)
fips-preview/jammy_openssl: needed
fips-updates/jammy_openssl: released (3.0.2-0ubuntu1.17+Fips1)
mantic_openssl: ignored (end of life, was needed)
noble_openssl: released (3.0.13-0ubuntu3.2)
oracular_openssl: released (3.2.2-1ubuntu1)
plucky_openssl: released (3.2.2-1ubuntu1)
devel_openssl: released (3.2.2-1ubuntu1)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
esm-infra/bionic_openssl1.0: not-affected (1.0.2 not affected)
focal_openssl1.0: DNE
jammy_openssl1.0: DNE
mantic_openssl1.0: DNE
noble_openssl1.0: DNE
oracular_openssl1.0: DNE
plucky_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
trusty/esm_nodejs: not-affected (uses system openssl)
esm-infra-legacy/trusty_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: needs-triage
esm-apps/bionic_nodejs: needs-triage
focal_nodejs: not-affected (uses system openssl)
esm-apps/focal_nodejs: needs-triage
jammy_nodejs: needed
esm-apps/jammy_nodejs: needs-triage
mantic_nodejs: not-affected (uses system openssl)
noble_nodejs: not-affected (uses system openssl)
esm-apps/noble_nodejs: not-affected (uses system openssl)
oracular_nodejs: not-affected (uses system openssl)
plucky_nodejs: not-affected (uses system openssl)
devel_nodejs: not-affected (uses system openssl)

Patches_edk2:
upstream_edk2: needs-triage
esm-apps/xenial_edk2: needs-triage
esm-apps/bionic_edk2: needs-triage
focal_edk2: needed
jammy_edk2: needed
mantic_edk2: ignored (end of life, was needed)
noble_edk2: needed
oracular_edk2: needed
plucky_edk2: needed
devel_edk2: needed
