Candidate: CVE-2025-46734
PublicDate: 2025-05-05 20:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-46734
 https://github.com/thephpleague/commonmark/commit/f0d626cf05ad3e99e6db26ebcb9091b6cd1cd89b
 https://github.com/thephpleague/commonmark/security/advisories/GHSA-3527-qv2q-pfvx
Description:
 league/commonmark is a PHP Markdown parser. A cross-site scripting (XSS)
 vulnerability in the Attributes extension of the league/commonmark library
 (versions 1.5.0 through 2.6.x) allows remote attackers to insert malicious
 JavaScript calls into HTML. The league/commonmark library provides
 configuration options such as `html_input: 'strip'` and
 `allow_unsafe_links: false` to mitigate cross-site scripting (XSS) attacks
 by stripping raw HTML and disallowing unsafe links. However, when the
 Attributes Extension is enabled, it introduces a way for users to inject
 arbitrary HTML attributes into elements via Markdown syntax using curly
 braces. Version 2.7.0 contains three changes to prevent this XSS attack
 vector: All attributes starting with `on` are considered unsafe and blocked
 by default; support for an explicit allowlist of allowed HTML attributes;
 and manually-added `href` and `src` attributes now respect the existing
 `allow_unsafe_links` configuration option. If upgrading is not feasible,
 please consider disabling the `AttributesExtension` for untrusted users
 and/or filtering the rendered HTML through a library like HTMLPurifier.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N [6.4 MEDIUM]

Patches_php-league-commonmark:
upstream_php-league-commonmark: needs-triage
focal_php-league-commonmark: ignored (end of standard support, was needs-triage)
esm-apps/focal_php-league-commonmark: needs-triage
jammy_php-league-commonmark: needs-triage
esm-apps/jammy_php-league-commonmark: needs-triage
noble_php-league-commonmark: needs-triage
esm-apps/noble_php-league-commonmark: needs-triage
oracular_php-league-commonmark: ignored (end of life, was needs-triage)
plucky_php-league-commonmark: needs-triage
questing_php-league-commonmark: needs-triage
devel_php-league-commonmark: needs-triage
