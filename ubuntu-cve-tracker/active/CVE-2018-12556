Candidate: CVE-2018-12556
PublicDate: 2019-05-16 17:29:00 UTC
References:
 http://packetstormsecurity.com/files/152703/Johnny-You-Are-Fired.html
 http://seclists.org/fulldisclosure/2019/Apr/38
 https://github.com/RUB-NDS/Johnny-You-Are-Fired
 https://github.com/RUB-NDS/Johnny-You-Are-Fired/blob/master/paper/johnny-fired.pdf
 https://github.com/yarnpkg/website/commits/master
 https://www.openwall.com/lists/oss-security/2019/04/30/4
 https://neopg.io/blog/yarn-signature-bypass/
 https://www.cve.org/CVERecord?id=CVE-2018-12556
Description:
 The signature verification routine in install.sh in yarnpkg/website through
 2018-06-05 only verifies that the yarn release is signed by any (arbitrary)
 key in the local keyring of the user, and does not pin the signature to the
 yarn release key, which allows remote attackers to sign tampered yarn
 release packages with their own key.
Ubuntu-Description:
Notes:
 seth-arnold> It appears this is about the install.sh that is run via a
  curl url | bash - auto-updated mechanism inside the program. It looks
  like it tries to determine if it was installed via deb and if so, runs:
  sudo apt-get update && sudo apt-get install yarn
 seth-arnold> So it's possible the unsafe mechanism isn't used in our packages.
 seth-arnold> It's also possible this is seriously unsafe.
Bugs:
Priority: medium
Discovered-by: Marcus Brinkmann
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N [5.9 MEDIUM]


Patches_node-yarnpkg:
upstream_node-yarnpkg: needs-triage
precise/esm_node-yarnpkg: DNE
trusty_node-yarnpkg: ignored (end of standard support)
trusty/esm_node-yarnpkg: DNE
esm-infra-legacy/trusty_node-yarnpkg: DNE
xenial_node-yarnpkg: DNE
bionic_node-yarnpkg: DNE
cosmic_node-yarnpkg: DNE
disco_node-yarnpkg: ignored (end of life)
eoan_node-yarnpkg: ignored (end of life)
focal_node-yarnpkg: ignored (end of standard support, was needs-triage)
esm-apps/focal_node-yarnpkg: needs-triage
groovy_node-yarnpkg: ignored (end of life)
hirsute_node-yarnpkg: ignored (end of life)
impish_node-yarnpkg: ignored (end of life)
jammy_node-yarnpkg: needs-triage
esm-apps/jammy_node-yarnpkg: needs-triage
kinetic_node-yarnpkg: ignored (end of life, was needs-triage)
lunar_node-yarnpkg: ignored (end of life, was needs-triage)
mantic_node-yarnpkg: ignored (end of life, was needs-triage)
noble_node-yarnpkg: needs-triage
esm-apps/noble_node-yarnpkg: needs-triage
oracular_node-yarnpkg: ignored (end of life, was needs-triage)
plucky_node-yarnpkg: needs-triage
questing_node-yarnpkg: needs-triage
devel_node-yarnpkg: needs-triage
