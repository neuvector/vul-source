PublicDateAtUSN: 2024-08-24
Candidate: CVE-2024-23185
PublicDate: 2024-09-10 15:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-23185
 https://www.openwall.com/lists/oss-security/2024/08/15/4
 https://ubuntu.com/security/notices/USN-6982-1
 https://ubuntu.com/security/notices/USN-7013-1
Description:
 Very large headers can cause resource exhaustion when parsing message. The
 message-parser normally reads reasonably sized chunks of the message.
 However, when it feeds them to message-header-parser, it starts building up
 "full_value" buffer out of the smaller chunks. The full_value buffer has no
 size limit, so large headers can cause large memory usage. It doesn't
 matter whether it's a single long header line, or a single header split
 into multiple lines. This bug exists in all Dovecot versions. Incoming
 mails typically have some size limits set by MTA, so even largest possible
 header size may still fit into Dovecot's vsz_limit. So attackers probably
 can't DoS a victim user this way. A user could APPEND larger mails though,
 allowing them to DoS themselves (although maybe cause some memory issues
 for the backend in general). One can implement restrictions on headers on
 MTA component preceding Dovecot. No publicly available exploits are known.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1078877
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 open-xchange: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_dovecot:
 upstream: https://github.com/dovecot/core/commit/f020e139c519121d9630a966310ea8e100ee33b7 (2.3.21.1)
 upstream: https://github.com/dovecot/core/commit/ce88c33abc37e408592eff70aeefa28f803effb9 (2.3.21.1)
upstream_dovecot: released (1:2.3.21.1+dfsg1-1)
esm-infra-legacy/trusty_dovecot: needs-triage
trusty/esm_dovecot: ignored (end of ESM support, was needs-triage)
esm-infra/xenial_dovecot: needs-triage
esm-infra/bionic_dovecot: needs-triage
focal_dovecot: released (1:2.3.7.2-1ubuntu3.7)
esm-infra/focal_dovecot: released (1:2.3.7.2-1ubuntu3.7)
jammy_dovecot: released (1:2.3.16+dfsg1-3ubuntu2.4)
noble_dovecot: released (1:2.3.21+dfsg1-2ubuntu6)
oracular_dovecot: released (1:2.3.21.1+dfsg1-1ubuntu1)
plucky_dovecot: released (1:2.3.21.1+dfsg1-1ubuntu1)
devel_dovecot: released (1:2.3.21.1+dfsg1-1ubuntu1)
