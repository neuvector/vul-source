Candidate: CVE-2025-61770
PublicDate: 2025-10-07 15:16:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-61770
 https://github.com/rack/rack/security/advisories/GHSA-p543-xpfm-54cp
Description:
 Rack is a modular Ruby web server interface. In versions prior to 2.2.19,
 3.1.17, and 3.2.2, `Rack::Multipart::Parser` buffers the entire multipart
 preamble (bytes before the first boundary) in memory without any size
 limit. A client can send a large preamble followed by a valid boundary,
 causing significant memory use and potential process termination due to
 out-of-memory (OOM) conditions. Remote attackers can trigger large
 transient memory spikes by including a long preamble in multipart/form-data
 requests. The impact scales with allowed request sizes and concurrency,
 potentially causing worker crashes or severe slowdown due to garbage
 collection. Versions 2.2.19, 3.1.17, and 3.2.2 enforce a preamble size
 limit (e.g., 16 KiB) or discard preamble data entirely. Workarounds include
 limiting total request body size at the proxy or web server level and
 monitoring memory and set per-process limits to prevent OOM conditions.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_ruby-rack:
 upstream: https://github.com/rack/rack/commit/589127f4ac8b5cf11cf88fb0cd116ffed4d2181e (v3.2.2)
 upstream: https://github.com/rack/rack/commit/e08f78c656c9394d6737c022bde087e0f33336fd (v3.1.17)
 upstream: https://github.com/rack/rack/commit/d869fed663b113b95a74ad53e1b5cae6ab31f29e (v2.2.19)
upstream_ruby-rack: needs-triage
esm-infra-legacy/trusty_ruby-rack: needs-triage
esm-apps/xenial_ruby-rack: needs-triage
esm-apps/bionic_ruby-rack: needs-triage
esm-apps/focal_ruby-rack: needs-triage
jammy_ruby-rack: needs-triage
esm-apps/jammy_ruby-rack: needs-triage
noble_ruby-rack: needs-triage
plucky_ruby-rack: needs-triage
questing_ruby-rack: needs-triage
devel_ruby-rack: needs-triage
