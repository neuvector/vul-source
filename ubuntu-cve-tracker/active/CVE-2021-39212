PublicDateAtUSN: 2021-09-13 18:15:00 UTC
Candidate: CVE-2021-39212
PublicDate: 2021-09-13 18:15:00 UTC
References:
 https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-qvhr-jj4p-j2qr
 https://ubuntu.com/security/notices/USN-5736-1
 https://ubuntu.com/security/notices/USN-5736-2
 https://ubuntu.com/security/notices/USN-6200-1
 https://www.cve.org/CVERecord?id=CVE-2021-39212
Description:
 ImageMagick is free software delivered as a ready-to-run binary
 distribution or as source code that you may use, copy, modify, and
 distribute in both open and proprietary applications. In affected versions
 and in certain cases, Postscript files could be read and written when
 specifically excluded by a `module` policy in `policy.xml`. ex. <policy
 domain="module" rights="none" pattern="PS" />. The issue has been resolved
 in ImageMagick 7.1.0-7 and in 6.9.12-22. Fortunately, in the wild, few
 users utilize the `module` policy and instead use the `coder` policy that
 is also our workaround recommendation: <policy domain="coder" rights="none"
 pattern="{PS,EPI,EPS,EPSF,EPSI}" />.
Ubuntu-Description:
Notes:
 rayveldkamp> imagemagick is in universe from focal onwards
 mdeslaur> packages in Ubuntu use the coder policy to exclude postscript
 mdeslaur> files, not the module policy
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N [3.6 LOW]


Patches_imagemagick:
 upstream: https://github.com/ImageMagick/ImageMagick/commit/01faddbe2711a4156180c4a92837e2f23683cc68
 upstream: https://github.com/ImageMagick/ImageMagick/commit/35893e7cad78ce461fcaffa56076c11700ba5e4e
 upstream: https://github.com/ImageMagick/ImageMagick6/commit/428e68597fa904d0bdc133d878e12acd7dc60fa3
 upstream: https://github.com/ImageMagick/ImageMagick6/commit/69ea5587de17ef89476be47a3cb7f855c0355a74
upstream_imagemagick: needs-triage
trusty_imagemagick: ignored (end of standard support)
xenial_imagemagick: ignored (end of standard support)
esm-infra/xenial_imagemagick: not-affected (code not present)
trusty/esm_imagemagick: not-affected (code not present)
esm-infra-legacy/trusty_imagemagick: not-affected (code not present)
bionic_imagemagick: not-affected (code not present)
esm-infra/bionic_imagemagick: not-affected (code not present)
focal_imagemagick: released (8:6.9.10.23+dfsg-2.1ubuntu11.9)
esm-apps/focal_imagemagick: released (8:6.9.10.23+dfsg-2.1ubuntu11.9)
hirsute_imagemagick: ignored (end of life)
impish_imagemagick: ignored (end of life)
jammy_imagemagick: needed
esm-apps/jammy_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu0.22.04.3+esm1)
kinetic_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu0.22.10.1)
lunar_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu1)
mantic_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu1)
noble_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu1)
esm-apps/noble_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu1)
oracular_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu1)
plucky_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu1)
devel_imagemagick: released (8:6.9.11.60+dfsg-1.3ubuntu1)
