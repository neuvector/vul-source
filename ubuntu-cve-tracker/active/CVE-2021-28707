Candidate: CVE-2021-28707
PublicDate: 2021-11-24 01:15:00 UTC
References:
 https://xenbits.xen.org/xsa/advisory-388.html
 https://www.cve.org/CVERecord?id=CVE-2021-28707
Description:
 PoD operations on misaligned GFNs T[his CNA information record relates to
 multiple CVEs; the text explains which aspects/vulnerabilities correspond
 to which CVE.] x86 HVM and PVH guests may be started in populate-on-demand
 (PoD) mode, to provide a way for them to later easily have more memory
 assigned. Guests are permitted to control certain P2M aspects of individual
 pages via hypercalls. These hypercalls may act on ranges of pages specified
 via page orders (resulting in a power-of-2 number of pages). The
 implementation of some of these hypercalls for PoD does not enforce the
 base page frame number to be suitably aligned for the specified order, yet
 some code involved in PoD handling actually makes such an assumption. These
 operations are XENMEM_decrease_reservation (CVE-2021-28704) and
 XENMEM_populate_physmap (CVE-2021-28707), the latter usable only by domains
 controlling the guest, i.e. a de-privileged qemu or a stub domain. (Patch
 1, combining the fix to both these two issues.) In addition handling of
 XENMEM_decrease_reservation can also trigger a host crash when the
 specified page order is neither 4k nor 2M nor 1G (CVE-2021-28708, patch 2).
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H [8.8 HIGH]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: needs-triage
trusty_xen: ignored (end of standard support)
trusty/esm_xen: DNE
esm-infra-legacy/trusty_xen: DNE
xenial_xen: ignored (end of standard support, was needs-triage)
esm-infra/xenial_xen: needs-triage
bionic_xen: ignored (end of standard support, was needs-triage)
esm-infra/bionic_xen: needs-triage
focal_xen: needs-triage
esm-apps/focal_xen: needs-triage
hirsute_xen: ignored (end of life)
impish_xen: ignored (end of life)
jammy_xen: needs-triage
esm-apps/jammy_xen: needs-triage
kinetic_xen: ignored (end of life, was needs-triage)
lunar_xen: ignored (end of life, was needs-triage)
mantic_xen: ignored (end of life, was needs-triage)
noble_xen: needs-triage
esm-apps/noble_xen: needs-triage
oracular_xen: needs-triage
plucky_xen: needs-triage
devel_xen: needs-triage

