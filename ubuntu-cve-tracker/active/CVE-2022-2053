Candidate: CVE-2022-2053
PublicDate: 2022-08-05 16:15:00 UTC
References:
 https://bugzilla.redhat.com/show_bug.cgi?id=2095862
 https://www.cve.org/CVERecord?id=CVE-2022-2053
Description:
 When a POST request comes through AJP and the request exceeds the
 max-post-size limit (maxEntitySize), Undertow's AjpServerRequestConduit
 implementation closes a connection without sending any response to the
 client/proxy. This behavior results in that a front-end proxy marking the
 backend worker (application server) as an error state and not forward
 requests to the worker for a while. In mod_cluster, this continues until
 the next STATUS request (10 seconds intervals) from the application server
 updates the server state. So, in the worst case, it can result in "All
 workers are in error state" and mod_cluster responds "503 Service
 Unavailable" for a while (up to 10 seconds). In mod_proxy_balancer, it does
 not forward requests to the worker until the "retry" timeout passes.
 However, luckily, mod_proxy_balancer has "forcerecovery" setting (On by
 default; this parameter can force the immediate recovery of all workers
 without considering the retry parameter of the workers if all workers of a
 balancer are in error state.). So, unlike mod_cluster, mod_proxy_balancer
 does not result in responding "503 Service Unavailable". An attacker could
 use this behavior to send a malicious request and trigger server errors,
 resulting in DoS (denial of service). This flaw was fixed in Undertow
 2.2.19.Final, Undertow 2.3.0.Alpha2.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]


Patches_undertow:
upstream_undertow: needs-triage
bionic_undertow: ignored (end of standard support, was needs-triage)
esm-apps/xenial_undertow: needs-triage
esm-apps/bionic_undertow: needs-triage
focal_undertow: needs-triage
esm-apps/focal_undertow: needs-triage
impish_undertow: ignored (end of life)
jammy_undertow: needs-triage
esm-apps/jammy_undertow: needs-triage
kinetic_undertow: ignored (end of life, was needs-triage)
lunar_undertow: DNE
mantic_undertow: DNE
noble_undertow: needs-triage
esm-apps/noble_undertow: needs-triage
oracular_undertow: needs-triage
plucky_undertow: needs-triage
devel_undertow: needs-triage
