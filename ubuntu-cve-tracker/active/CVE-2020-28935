PublicDateAtUSN: 2020-12-07 22:15:00 UTC
Candidate: CVE-2020-28935
PublicDate: 2020-12-07 22:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28935
 https://www.nlnetlabs.nl/downloads/nsd/CVE-2020-28935.txt
 https://ubuntu.com/security/notices/USN-4938-1
Description:
 NLnet Labs Unbound, up to and including version 1.12.0, and NLnet Labs NSD,
 up to and including version 4.3.3, contain a local vulnerability that would
 allow for a local symlink attack. When writing the PID file, Unbound and
 NSD create the file if it is not there, or open an existing file for
 writing. In case the file was already present, they would follow symlinks
 if the file happened to be a symlink instead of a regular file. An
 additional chown of the file would then take place after it was written,
 making the user Unbound/NSD is supposed to run as the new owner of the
 file. If an attacker has local access to the user Unbound/NSD runs as, she
 could create a symlink in place of the PID file pointing to a file that she
 would like to erase. If then Unbound/NSD is killed and the PID file is not
 cleared, upon restarting with root privileges, Unbound/NSD will rewrite any
 file pointed at by the symlink. This is a local vulnerability that could
 create a Denial of Service of the system Unbound/NSD is running on. It
 requires an attacker having access to the limited permission user
 Unbound/NSD runs as and point through the symlink to a critical file on the
 system.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://github.com/NLnetLabs/unbound/issues/303
Priority: low
Discovered-by: Mason Loring Bliss
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H [5.5 MEDIUM]


Patches_unbound:
 upstream: https://github.com/NLnetLabs/unbound/commit/ad387832979b6ce4c93f64fe706301cd7d034e87
upstream_unbound: needs-triage
precise/esm_unbound: DNE
trusty_unbound: ignored (out of standard support)
trusty/esm_unbound: needed
xenial_unbound: ignored (end of standard support, was needs-triage)
esm-infra/xenial_unbound: needed
bionic_unbound: released (1.6.7-1ubuntu2.4)
focal_unbound: released (1.9.4-2ubuntu1.2)
groovy_unbound: ignored (reached end-of-life)
hirsute_unbound: not-affected (1.13.1-1)
impish_unbound: not-affected (1.13.1-1)
jammy_unbound: not-affected (1.13.1-1)
kinetic_unbound: not-affected (1.13.1-1)
lunar_unbound: not-affected (1.13.1-1)
devel_unbound: not-affected (1.13.1-1)
