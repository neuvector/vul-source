PublicDateAtUSN: 2025-12-05 17:16:00 UTC
Candidate: CVE-2025-66471
PublicDate: 2025-12-05 17:16:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-66471
 https://www.openwall.com/lists/oss-security/2025/12/05/4
 https://github.com/urllib3/urllib3/security/advisories/GHSA-2xpw-w6gg-jr37
 https://ubuntu.com/security/notices/USN-7927-1
Description:
 urllib3 is a user-friendly HTTP client library for Python. Starting in
 version 1.0 and prior to 2.6.0, the Streaming API improperly handles highly
 compressed data. urllib3's streaming API is designed for the efficient
 handling of large HTTP responses by reading the content in chunks, rather
 than loading the entire response body into memory at once. When streaming a
 compressed response, urllib3 can perform decoding or decompression based on
 the HTTP Content-Encoding header (e.g., gzip, deflate, br, or zstd). The
 library must read compressed data from the network and decompress it until
 the requested chunk size is met. Any resulting decompressed data that
 exceeds the requested amount is held in an internal buffer for the next
 read operation. The decompression logic could cause urllib3 to fully decode
 a small amount of highly compressed data in a single operation. This can
 result in excessive resource consumption (high CPU usage and massive memory
 allocation for the decompressed data.
Ubuntu-Description:
Notes:
 mdeslaur> On focal and earlier, the python-pip package bundles
 mdeslaur> python-urllib3 binaries when built. After updating
 mdeslaur> python-urllib3, a no-change rebuild of python-pip is required.
 mdeslaur> On jammy and later, python-urllib3 is bundled in the python-pip
 mdeslaur> package and needs to be patched.
 mdeslaur>
 mdeslaur> The fix for this issue may need a newer brotli 1.2.0 dependency,
 mdeslaur> need to validate.
 mdeslaur> See:
 mdeslaur> https://github.com/google/brotli/commit/eb3a31e2d356d5a633de995afe7fe60e590a26d8
 mdeslaur> https://github.com/google/brotli/commit/28ce91caf605ac5481e9ca69131a28e1087574b7
 mdeslaur> https://github.com/google/brotli/commit/ef8922cee72a1c0b0c35ed109ae9d2d637177bfe
 hlibk> The patches fix an issue decompressing highly compressed data in
  multiple encodings. In order for the fix to be applied to the brotli
  encoding, brotli 1.2.0 has to be installed which adds the optional
  output_buffer_limit option to avoid these attacks. With the patches,
  urllib3 will display a warning if brotli is used without brotli version
  1.2.0.
 hlibk>
 hlibk> On jammy and below, the changes are too intrusive and may introduce
  regressions.
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1122029
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:H [8.9 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_python-urllib3:
 upstream: https://github.com/urllib3/urllib3/commit/c19571de34c47de3a766541b041637ba5f716ed7
upstream_python-urllib3: needs-triage
esm-infra-legacy/trusty_python-urllib3: ignored (changes too intrusive)
esm-infra/xenial_python-urllib3: ignored (changes too intrusive)
esm-infra/bionic_python-urllib3: ignored (changes too intrusive)
esm-infra/focal_python-urllib3: ignored (changes too intrusive)
jammy_python-urllib3: ignored (changes too intrusive)
noble_python-urllib3: released (2.0.7-1ubuntu0.3)
plucky_python-urllib3: released (2.3.0-2ubuntu0.2)
questing_python-urllib3: released (2.3.0-3ubuntu0.1)
devel_python-urllib3: released (2.5.0-1ubuntu1)

Patches_python-pip:
upstream_python-pip: needs-triage
esm-infra-legacy/trusty_python-pip: ignored (changes too intrusive)
esm-apps/xenial_python-pip: ignored (changes too intrusive)
esm-apps/bionic_python-pip: ignored (changes too intrusive)
esm-apps/focal_python-pip: ignored (changes too intrusive)
jammy_python-pip: ignored (changes too intrusive)
esm-apps/jammy_python-pip: needed
noble_python-pip: needed
esm-apps/noble_python-pip: needed
plucky_python-pip: needed
questing_python-pip: needed
devel_python-pip: needed
