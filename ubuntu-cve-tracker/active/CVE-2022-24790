PublicDateAtUSN: 2022-03-30 22:15:00 UTC
Candidate: CVE-2022-24790
PublicDate: 2022-03-30 22:15:00 UTC
References:
 https://github.com/puma/puma/commit/5bb7d202e24dec00a898dca4aa11db391d7787a5
 https://github.com/puma/puma/security/advisories/GHSA-h99w-9q5r-gjq9
 https://ubuntu.com/security/notices/USN-6682-1
 https://www.cve.org/CVERecord?id=CVE-2022-24790
Description:
 Puma is a simple, fast, multi-threaded, parallel HTTP 1.1 server for
 Ruby/Rack applications. When using Puma behind a proxy that does not
 properly validate that the incoming HTTP request matches the RFC7230
 standard, Puma and the frontend proxy may disagree on where a request
 starts and ends. This would allow requests to be smuggled via the front-end
 proxy to Puma. The vulnerability has been fixed in 5.6.4 and 4.3.12. Users
 are advised to upgrade as soon as possible. Workaround: when deploying a
 proxy in front of Puma, turning on any and all functionality to make sure
 that the request matches the RFC7230 standard.
Ubuntu-Description:
Notes:
 alexmurray> for focal the patch needs to be backported manually along with
  the fix for CVE-2020-11076
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N [9.1 CRITICAL]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N [7.5 HIGH]


Patches_puma:
 upstream: https://github.com/puma/puma/commit/5bb7d202e24dec00a898dca4aa11db391d7787a5
upstream_puma: needs-triage
trusty_puma: ignored (end of standard support)
xenial_puma: ignored (end of standard support)
focal_puma: ignored (end of standard support, was needed)
esm-infra/focal_puma: DNE (focal was needed)
esm-apps/focal_puma: released (3.12.4-1ubuntu2+esm1)
impish_puma: ignored (end of life)
jammy_puma: needed
esm-apps/jammy_puma: released (5.5.2-2ubuntu2+esm1)
kinetic_puma: ignored (end of life, was needed)
lunar_puma: not-affected (5.6.5-3ubuntu1)
mantic_puma: not-affected (5.6.5-3ubuntu1)
noble_puma: not-affected (5.6.5-3ubuntu1)
oracular_puma: not-affected (5.6.5-3ubuntu1)
plucky_puma: not-affected (5.6.5-3ubuntu1)
devel_puma: not-affected (5.6.5-3ubuntu1)
