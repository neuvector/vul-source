PublicDateAtUSN: 2024-06-16 13:15:00 UTC
Candidate: CVE-2024-38440
PublicDate: 2024-06-16 13:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-38440
 https://github.com/Netatalk/netatalk/pull/1158
 https://ubuntu.com/security/notices/USN-7347-1
Description:
 Netatalk 3.2.0 has an off-by-one error, and resultant heap-based buffer
 overflow and segmentation violation, because of incorrectly using
 FPLoginExt in BN_bin2bn in etc/uams/uams_dhx_pam.c. The original issue 1097
 report stated: 'The latest version of Netatalk (v3.2.0) contains a security
 vulnerability. This vulnerability arises due to a lack of validation for
 the length field after parsing user-provided data, leading to an
 out-of-bounds heap write of one byte (\0). Under specific configurations,
 this can result in reading metadata of the next heap block, potentially
 causing a Denial of Service (DoS) under certain heap layouts or with ASAN
 enabled. ... The vulnerability is located in the FPLoginExt operation of
 Netatalk, in the BN_bin2bn function found in /etc/uams/uams_dhx_pam.c ...
 if (!(bn = BN_bin2bn((unsigned char *)ibuf, KEYSIZE, NULL))) ... threads
 ... [#0] Id 1, Name: "afpd", stopped 0x7ffff4304e58 in ?? (), reason:
 SIGSEGV ... [#0] 0x7ffff4304e58 mov BYTE PTR [r14+0x8], 0x0 ... mov rdx,
 QWORD PTR [rsp+0x18] ... afp_login_ext(obj=<optimized out>,
 ibuf=0x62d000010424 "", ibuflen=0xffffffffffff0015, rbuf=<optimized out>,
 rbuflen=<optimized out>) ... afp_over_dsi(obj=0x5555556154c0 <obj>).'
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:

Patches_netatalk:
upstream_netatalk: released (3.2.1)
trusty/esm_netatalk: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_netatalk: released (2.2.2-1ubuntu2.2+esm2)
esm-apps/xenial_netatalk: released (2.2.5-1ubuntu0.2+esm2)
esm-apps/bionic_netatalk: released (2.2.6-1ubuntu0.18.04.2+esm2)
focal_netatalk: released (3.1.12~ds-4ubuntu0.20.04.4)
esm-apps/focal_netatalk: not-affected (3.1.12~ds-4ubuntu0.20.04.4)
jammy_netatalk: released (3.1.12~ds-9ubuntu0.22.04.4)
esm-apps/jammy_netatalk: not-affected (3.1.12~ds-9ubuntu0.22.04.4)
mantic_netatalk: ignored (end of life, was needs-triage)
noble_netatalk: needed
esm-apps/noble_netatalk: released (3.1.18~ds-1ubuntu0.1~esm1)
oracular_netatalk: not-affected (3.2.9~ds-1)
plucky_netatalk: not-affected
devel_netatalk: not-affected
