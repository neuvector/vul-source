Candidate: CVE-2023-50291
PublicDate: 2024-02-09 18:15:00 UTC
References:
 https://solr.apache.org/security.html#cve-2023-50291-apache-solr-can-leak-certain-passwords-due-to-system-property-redaction-logic-inconsistencies
 https://www.openwall.com/lists/oss-security/2024/02/09/4
 https://www.cve.org/CVERecord?id=CVE-2023-50291
Description:
 Insufficiently Protected Credentials vulnerability in Apache Solr. This
 issue affects Apache Solr: from 6.0.0 through 8.11.2, from 9.0.0 before
 9.3.0. One of the two endpoints that publishes the Solr process' Java
 system properties, /admin/info/properties, was only setup to hide system
 properties that had "password" contained in the name. There are a number of
 sensitive system properties, such as "basicauth" and "aws.secretKey" do not
 contain "password", thus their values were published via the
 "/admin/info/properties" endpoint. This endpoint populates the list of
 System Properties on the home screen of the Solr Admin page, making the
 exposed credentials visible in the UI. This /admin/info/properties endpoint
 is protected under the "config-read" permission. Therefore, Solr Clouds
 with Authorization enabled will only be vulnerable through logged-in users
 that have the "config-read" permission. Users are recommended to upgrade to
 version 9.3.0 or 8.11.3, which fixes the issue. A single option now
 controls hiding Java system property for all endpoints,
 "-Dsolr.hiddenSysProps". By default all known sensitive properties are
 hidden (including "-Dbasicauth"), as well as any property with a name
 containing "secret" or "password". Users who cannot upgrade can also use
 the following Java system property to fix the issue:
 '-Dsolr.redaction.system.pattern=.*(password|secret|basicauth).*'
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]


Patches_lucene-solr:
upstream_lucene-solr: needs-triage
trusty_lucene-solr: ignored (end of standard support)
trusty/esm_lucene-solr: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_lucene-solr: needs-triage
xenial_lucene-solr: ignored (end of standard support)
esm-apps/xenial_lucene-solr: needs-triage
bionic_lucene-solr: ignored (end of standard support)
esm-apps/bionic_lucene-solr: needs-triage
focal_lucene-solr: ignored (end of standard support, was needs-triage)
esm-apps/focal_lucene-solr: needs-triage
jammy_lucene-solr: needs-triage
esm-apps/jammy_lucene-solr: needs-triage
mantic_lucene-solr: ignored (end of life, was needs-triage)
noble_lucene-solr: needs-triage
esm-apps/noble_lucene-solr: needs-triage
oracular_lucene-solr: ignored (end of life, was needs-triage)
plucky_lucene-solr: needs-triage
devel_lucene-solr: needs-triage
