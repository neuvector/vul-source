Candidate: CVE-2021-20316
PublicDate: 2022-08-23 16:15:00 UTC
References:
 https://www.samba.org/samba/security/CVE-2021-20316.html
 https://www.cve.org/CVERecord?id=CVE-2021-20316
Description:
 A flaw was found in the way Samba handled file/directory metadata. This
 flaw allows an authenticated attacker with permissions to read or modify
 share metadata, to perform this operation outside of the share.
Ubuntu-Description:
Notes:
 mdeslaur> per upstream, fixing this required a whole rewrite of the VFS
 mdeslaur> layer and there is no reasonable way to fix this in older
 mdeslaur> versions. Marking this CVE as ignored for older releases.
Mitigation:
 This issue can be mitigated by disabling SMB1, which is the default
 configuration in Samba 4.11 and above. In environments where SMB1 cannot
 be disabled, symlink support can be disabled with unix extensions = no.
Bugs:
 https://bugzilla.samba.org/show_bug.cgi?id=14842
Priority: medium
Discovered-by: Michael Hanselmann
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N [6.8 MEDIUM]


Patches_samba:
upstream_samba: released (4.15.0)
trusty/esm_samba: ignored (end of ESM support, was needed)
esm-infra-legacy/trusty_samba: needed
esm-infra/xenial_samba: needed
trusty_samba: ignored (end of standard support)
xenial_samba: ignored (end of standard support)
bionic_samba: ignored
esm-infra/bionic_samba: ignored
focal_samba: ignored
hirsute_samba: ignored
impish_samba: ignored
jammy_samba: ignored
kinetic_samba: ignored
lunar_samba: not-affected (2:4.16.4+dfsg-2ubuntu1)
mantic_samba: not-affected (2:4.16.4+dfsg-2ubuntu1)
noble_samba: not-affected (2:4.16.4+dfsg-2ubuntu1)
oracular_samba: not-affected (2:4.16.4+dfsg-2ubuntu1)
plucky_samba: not-affected (2:4.16.4+dfsg-2ubuntu1)
devel_samba: not-affected (2:4.16.4+dfsg-2ubuntu1)
