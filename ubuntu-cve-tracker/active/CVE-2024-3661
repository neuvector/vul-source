Candidate: CVE-2024-3661
PublicDate: 2024-05-06 19:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-3661
 https://datatracker.ietf.org/doc/html/rfc2131#section-7
 https://datatracker.ietf.org/doc/html/rfc3442#section-7
 https://tunnelvisionbug.com/
 https://www.leviathansecurity.com/research/tunnelvision
 https://news.ycombinator.com/item?id=40279632
 https://arstechnica.com/security/2024/05/novel-attack-against-virtually-all-vpn-apps-neuters-their-entire-purpose/
 https://krebsonsecurity.com/2024/05/why-your-vpn-may-not-be-as-secure-as-it-claims/
 https://issuetracker.google.com/issues/263721377
 https://mullvad.net/en/blog/evaluating-the-impact-of-tunnelvision
 https://www.zscaler.com/blogs/security-research/cve-2024-3661-k-tunnelvision-exposes-vpn-bypass-vulnerability
 https://lowendtalk.com/discussion/188857/a-rogue-dhcp-server-within-your-network-can-and-will-hijack-your-vpn-traffic
 https://news.ycombinator.com/item?id=40284111
 https://www.agwa.name/blog/post/hardening_openvpn_for_def_con
Description:
 DHCP can add routes to a clientâ€™s routing table via the classless static
 route option (121). VPN-based security solutions that rely on routes to
 redirect traffic can be forced to leak traffic over the physical interface.
 An attacker on the same local network can read, disrupt, or possibly modify
 network traffic that was expected to be protected by the VPN.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> other VPN softwares may be affected.
 rodrigo-zaiden> as of 2024-05-08, there isn't vpn providers reports
 mdeslaur> This issue is actually in the way DHCP clients handle the route
 mdeslaur> option. There is no clear solution to this issue as of
 mdeslaur> 2024-05-14, marking all packages are deferred for now.
Mitigation:
Bugs:
Priority: high
 An attacker on the same local network can read, disrupt, or possibly modify network traffic that was expected to be protected by the VPN.
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L [7.6 HIGH]

Patches_connman:
upstream_connman: needs-triage
esm-apps/xenial_connman: deferred
esm-apps/bionic_connman: deferred
focal_connman: deferred
esm-apps/focal_connman: deferred
jammy_connman: deferred
esm-apps/jammy_connman: deferred
mantic_connman: ignored (end of life, was deferred)
noble_connman: deferred
esm-apps/noble_connman: deferred
oracular_connman: deferred
plucky_connman: deferred
devel_connman: deferred

Patches_gadmin-openvpn-client:
upstream_gadmin-openvpn-client: needs-triage
esm-apps/xenial_gadmin-openvpn-client: deferred
esm-apps/bionic_gadmin-openvpn-client: deferred
focal_gadmin-openvpn-client: deferred
esm-apps/focal_gadmin-openvpn-client: deferred
jammy_gadmin-openvpn-client: DNE
mantic_gadmin-openvpn-client: DNE
noble_gadmin-openvpn-client: DNE
oracular_gadmin-openvpn-client: DNE
plucky_gadmin-openvpn-client: DNE
devel_gadmin-openvpn-client: DNE

Patches_gadmin-openvpn-server:
upstream_gadmin-openvpn-server: needs-triage
esm-apps/xenial_gadmin-openvpn-server: deferred
esm-apps/bionic_gadmin-openvpn-server: deferred
focal_gadmin-openvpn-server: deferred
esm-apps/focal_gadmin-openvpn-server: deferred
jammy_gadmin-openvpn-server: DNE
mantic_gadmin-openvpn-server: DNE
noble_gadmin-openvpn-server: DNE
oracular_gadmin-openvpn-server: DNE
plucky_gadmin-openvpn-server: DNE
devel_gadmin-openvpn-server: DNE

Patches_golang-github-apparentlymart-go-openvpn-mgmt:
upstream_golang-github-apparentlymart-go-openvpn-mgmt: needs-triage
focal_golang-github-apparentlymart-go-openvpn-mgmt: deferred
esm-apps/focal_golang-github-apparentlymart-go-openvpn-mgmt: deferred
jammy_golang-github-apparentlymart-go-openvpn-mgmt: deferred
esm-apps/jammy_golang-github-apparentlymart-go-openvpn-mgmt: deferred
mantic_golang-github-apparentlymart-go-openvpn-mgmt: ignored (end of life, was deferred)
noble_golang-github-apparentlymart-go-openvpn-mgmt: deferred
esm-apps/noble_golang-github-apparentlymart-go-openvpn-mgmt: deferred
oracular_golang-github-apparentlymart-go-openvpn-mgmt: deferred
plucky_golang-github-apparentlymart-go-openvpn-mgmt: deferred
devel_golang-github-apparentlymart-go-openvpn-mgmt: deferred

Patches_kvpnc:
upstream_kvpnc: needs-triage
esm-apps/xenial_kvpnc: deferred
esm-apps/bionic_kvpnc: deferred
focal_kvpnc: DNE
jammy_kvpnc: DNE
mantic_kvpnc: DNE
noble_kvpnc: DNE
oracular_kvpnc: DNE
plucky_kvpnc: DNE
devel_kvpnc: DNE

Patches_libreswan:
upstream_libreswan: needs-triage
esm-apps/bionic_libreswan: deferred
focal_libreswan: deferred
esm-apps/focal_libreswan: deferred
jammy_libreswan: deferred
esm-apps/jammy_libreswan: deferred
mantic_libreswan: ignored (end of life, was deferred)
noble_libreswan: deferred
esm-apps/noble_libreswan: deferred
oracular_libreswan: deferred
plucky_libreswan: deferred
devel_libreswan: deferred

Patches_mozillavpn:
upstream_mozillavpn: needs-triage
focal_mozillavpn: DNE
jammy_mozillavpn: deferred
esm-apps/jammy_mozillavpn: deferred
mantic_mozillavpn: DNE
noble_mozillavpn: DNE
oracular_mozillavpn: DNE
plucky_mozillavpn: DNE
devel_mozillavpn: DNE

Patches_n2n:
upstream_n2n: needs-triage
esm-apps/xenial_n2n: deferred
esm-apps/bionic_n2n: deferred
focal_n2n: deferred
esm-apps/focal_n2n: deferred
jammy_n2n: deferred
esm-apps/jammy_n2n: deferred
mantic_n2n: ignored (end of life, was deferred)
noble_n2n: deferred
esm-apps/noble_n2n: deferred
oracular_n2n: deferred
plucky_n2n: deferred
devel_n2n: deferred

Patches_network-manager-fortisslvpn:
upstream_network-manager-fortisslvpn: needs-triage
esm-apps/bionic_network-manager-fortisslvpn: deferred
focal_network-manager-fortisslvpn: deferred
esm-apps/focal_network-manager-fortisslvpn: deferred
jammy_network-manager-fortisslvpn: deferred
esm-apps/jammy_network-manager-fortisslvpn: deferred
mantic_network-manager-fortisslvpn: ignored (end of life, was deferred)
noble_network-manager-fortisslvpn: deferred
esm-apps/noble_network-manager-fortisslvpn: deferred
oracular_network-manager-fortisslvpn: deferred
plucky_network-manager-fortisslvpn: deferred
devel_network-manager-fortisslvpn: deferred

Patches_network-manager-iodine:
upstream_network-manager-iodine: needs-triage
esm-apps/xenial_network-manager-iodine: deferred
esm-apps/bionic_network-manager-iodine: deferred
focal_network-manager-iodine: deferred
esm-apps/focal_network-manager-iodine: deferred
jammy_network-manager-iodine: deferred
esm-apps/jammy_network-manager-iodine: deferred
mantic_network-manager-iodine: ignored (end of life, was deferred)
noble_network-manager-iodine: deferred
esm-apps/noble_network-manager-iodine: deferred
oracular_network-manager-iodine: deferred
plucky_network-manager-iodine: deferred
devel_network-manager-iodine: deferred

Patches_network-manager-l2tp:
upstream_network-manager-l2tp: needs-triage
esm-apps/bionic_network-manager-l2tp: deferred
focal_network-manager-l2tp: deferred
esm-apps/focal_network-manager-l2tp: deferred
jammy_network-manager-l2tp: deferred
esm-apps/jammy_network-manager-l2tp: deferred
mantic_network-manager-l2tp: ignored (end of life, was deferred)
noble_network-manager-l2tp: deferred
esm-apps/noble_network-manager-l2tp: deferred
oracular_network-manager-l2tp: deferred
plucky_network-manager-l2tp: deferred
devel_network-manager-l2tp: deferred

Patches_network-manager-openconnect:
upstream_network-manager-openconnect: needs-triage
esm-apps/xenial_network-manager-openconnect: deferred
esm-apps/bionic_network-manager-openconnect: deferred
focal_network-manager-openconnect: deferred
esm-apps/focal_network-manager-openconnect: deferred
jammy_network-manager-openconnect: deferred
esm-apps/jammy_network-manager-openconnect: deferred
mantic_network-manager-openconnect: ignored (end of life, was deferred)
noble_network-manager-openconnect: deferred
esm-apps/noble_network-manager-openconnect: deferred
oracular_network-manager-openconnect: deferred
plucky_network-manager-openconnect: deferred
devel_network-manager-openconnect: deferred

Patches_network-manager-openvpn:
upstream_network-manager-openvpn: needs-triage
esm-apps/xenial_network-manager-openvpn: deferred
esm-infra/bionic_network-manager-openvpn: deferred
focal_network-manager-openvpn: deferred
jammy_network-manager-openvpn: deferred
mantic_network-manager-openvpn: ignored (end of life, was deferred)
noble_network-manager-openvpn: deferred
oracular_network-manager-openvpn: deferred
plucky_network-manager-openvpn: deferred
devel_network-manager-openvpn: deferred

Patches_network-manager-pptp:
upstream_network-manager-pptp: needs-triage
esm-infra/xenial_network-manager-pptp: deferred
esm-infra/bionic_network-manager-pptp: deferred
focal_network-manager-pptp: deferred
jammy_network-manager-pptp: deferred
mantic_network-manager-pptp: ignored (end of life, was deferred)
noble_network-manager-pptp: deferred
oracular_network-manager-pptp: deferred
plucky_network-manager-pptp: deferred
devel_network-manager-pptp: deferred

Patches_network-manager-sstp:
upstream_network-manager-sstp: DNE
focal_network-manager-sstp: DNE
jammy_network-manager-sstp: deferred
esm-apps/jammy_network-manager-sstp: deferred
mantic_network-manager-sstp: ignored (end of life, was deferred)
noble_network-manager-sstp: deferred
esm-apps/noble_network-manager-sstp: deferred
oracular_network-manager-sstp: deferred
plucky_network-manager-sstp: deferred
devel_network-manager-sstp: deferred

Patches_network-manager-strongswan:
upstream_network-manager-strongswan: needs-triage
esm-apps/xenial_network-manager-strongswan: deferred
esm-apps/bionic_network-manager-strongswan: deferred
focal_network-manager-strongswan: deferred
esm-apps/focal_network-manager-strongswan: deferred
jammy_network-manager-strongswan: deferred
esm-apps/jammy_network-manager-strongswan: deferred
mantic_network-manager-strongswan: ignored (end of life, was deferred)
noble_network-manager-strongswan: deferred
esm-apps/noble_network-manager-strongswan: deferred
oracular_network-manager-strongswan: deferred
plucky_network-manager-strongswan: deferred
devel_network-manager-strongswan: deferred

Patches_network-manager-vpnc:
upstream_network-manager-vpnc: needs-triage
esm-apps/xenial_network-manager-vpnc: deferred
esm-apps/bionic_network-manager-vpnc: deferred
focal_network-manager-vpnc: deferred
esm-apps/focal_network-manager-vpnc: deferred
jammy_network-manager-vpnc: deferred
esm-apps/jammy_network-manager-vpnc: deferred
mantic_network-manager-vpnc: ignored (end of life, was deferred)
noble_network-manager-vpnc: deferred
esm-apps/noble_network-manager-vpnc: deferred
oracular_network-manager-vpnc: deferred
plucky_network-manager-vpnc: deferred
devel_network-manager-vpnc: deferred

Patches_openconnect:
upstream_openconnect: needs-triage
esm-apps/xenial_openconnect: deferred
esm-apps/bionic_openconnect: deferred
focal_openconnect: deferred
esm-apps/focal_openconnect: deferred
jammy_openconnect: deferred
esm-apps/jammy_openconnect: deferred
mantic_openconnect: ignored (end of life, was deferred)
noble_openconnect: deferred
esm-apps/noble_openconnect: deferred
oracular_openconnect: deferred
plucky_openconnect: deferred
devel_openconnect: deferred

Patches_openfortivpn:
upstream_openfortivpn: needs-triage
esm-apps/bionic_openfortivpn: deferred
focal_openfortivpn: deferred
esm-apps/focal_openfortivpn: deferred
jammy_openfortivpn: deferred
esm-apps/jammy_openfortivpn: deferred
mantic_openfortivpn: ignored (end of life, was deferred)
noble_openfortivpn: deferred
esm-apps/noble_openfortivpn: deferred
oracular_openfortivpn: deferred
plucky_openfortivpn: deferred
devel_openfortivpn: deferred

Patches_openvpn:
upstream_openvpn: needs-triage
trusty/esm_openvpn: ignored (end of ESM support, was deferred)
esm-infra-legacy/trusty_openvpn: deferred
esm-infra/xenial_openvpn: deferred
esm-infra/bionic_openvpn: deferred
focal_openvpn: deferred
jammy_openvpn: deferred
mantic_openvpn: ignored (end of life, was deferred)
noble_openvpn: deferred
oracular_openvpn: deferred
plucky_openvpn: deferred
devel_openvpn: deferred

Patches_pptp-linux:
upstream_pptp-linux: needs-triage
esm-infra/xenial_pptp-linux: deferred
esm-infra/bionic_pptp-linux: deferred
focal_pptp-linux: deferred
jammy_pptp-linux: deferred
mantic_pptp-linux: ignored (end of life, was deferred)
noble_pptp-linux: deferred
oracular_pptp-linux: deferred
plucky_pptp-linux: deferred
devel_pptp-linux: deferred

Patches_pptpd:
upstream_pptpd: needs-triage
trusty/esm_pptpd: ignored (end of ESM support, was deferred)
esm-infra-legacy/trusty_pptpd: deferred
esm-infra/xenial_pptpd: deferred
esm-infra/bionic_pptpd: deferred
focal_pptpd: deferred
jammy_pptpd: deferred
mantic_pptpd: ignored (end of life, was deferred)
noble_pptpd: DNE
oracular_pptpd: DNE
plucky_pptpd: DNE
devel_pptpd: DNE

Patches_quicktun:
upstream_quicktun: needs-triage
esm-apps/bionic_quicktun: deferred
focal_quicktun: deferred
esm-apps/focal_quicktun: deferred
jammy_quicktun: deferred
esm-apps/jammy_quicktun: deferred
mantic_quicktun: ignored (end of life, was deferred)
noble_quicktun: deferred
esm-apps/noble_quicktun: deferred
oracular_quicktun: deferred
plucky_quicktun: deferred
devel_quicktun: deferred

Patches_riseup-vpn:
upstream_riseup-vpn: needs-triage
focal_riseup-vpn: DNE
jammy_riseup-vpn: DNE
mantic_riseup-vpn: ignored (end of life, was deferred)
noble_riseup-vpn: deferred
esm-apps/noble_riseup-vpn: deferred
oracular_riseup-vpn: deferred
plucky_riseup-vpn: deferred
devel_riseup-vpn: deferred

Patches_softether-vpn:
upstream_softether-vpn: needs-triage
focal_softether-vpn: DNE
jammy_softether-vpn: deferred
esm-apps/jammy_softether-vpn: deferred
mantic_softether-vpn: ignored (end of life, was deferred)
noble_softether-vpn: deferred
esm-apps/noble_softether-vpn: deferred
oracular_softether-vpn: deferred
plucky_softether-vpn: deferred
devel_softether-vpn: deferred

Patches_sshuttle:
upstream_sshuttle: needs-triage
esm-apps/xenial_sshuttle: deferred
esm-apps/bionic_sshuttle: deferred
focal_sshuttle: deferred
esm-apps/focal_sshuttle: deferred
jammy_sshuttle: deferred
esm-apps/jammy_sshuttle: deferred
mantic_sshuttle: ignored (end of life, was deferred)
noble_sshuttle: deferred
esm-apps/noble_sshuttle: deferred
oracular_sshuttle: deferred
plucky_sshuttle: deferred
devel_sshuttle: deferred

Patches_tinc:
upstream_tinc: needs-triage
esm-apps/xenial_tinc: deferred
esm-apps/bionic_tinc: deferred
focal_tinc: deferred
esm-apps/focal_tinc: deferred
jammy_tinc: deferred
esm-apps/jammy_tinc: deferred
mantic_tinc: ignored (end of life, was deferred)
noble_tinc: deferred
esm-apps/noble_tinc: deferred
oracular_tinc: deferred
plucky_tinc: deferred
devel_tinc: deferred

Patches_vpnc:
upstream_vpnc: needs-triage
esm-apps/xenial_vpnc: deferred
esm-apps/bionic_vpnc: deferred
focal_vpnc: deferred
esm-apps/focal_vpnc: deferred
jammy_vpnc: deferred
esm-apps/jammy_vpnc: deferred
mantic_vpnc: ignored (end of life, was deferred)
noble_vpnc: deferred
esm-apps/noble_vpnc: deferred
oracular_vpnc: deferred
plucky_vpnc: deferred
devel_vpnc: deferred

Patches_wireguard:
upstream_wireguard: needs-triage
esm-apps/xenial_wireguard: deferred
esm-apps/bionic_wireguard: deferred
focal_wireguard: deferred
esm-apps/focal_wireguard: deferred
jammy_wireguard: deferred
mantic_wireguard: ignored (end of life, was deferred)
noble_wireguard: deferred
oracular_wireguard: deferred
plucky_wireguard: deferred
devel_wireguard: deferred
