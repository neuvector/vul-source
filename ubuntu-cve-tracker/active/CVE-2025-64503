PublicDateAtUSN: 2025-11-12
Candidate: CVE-2025-64503
PublicDate: 2025-11-12 22:15:00 UTC
CRD: 2025-11-12
References:
 https://www.cve.org/CVERecord?id=CVE-2025-64503
 https://www.openwall.com/lists/oss-security/2025/11/12/2
 https://github.com/OpenPrinting/cups-filters/security/advisories/GHSA-893j-2wr2-wrh9
 https://ubuntu.com/security/notices/USN-7877-1
Description:
 cups-filters contains backends, filters, and other software required to get
 the cups printing service working on operating systems other than macos. In
 cups-filters prior to 1.28.18, by crafting a PDF file with a large
 `MediaBox` value, an attacker can cause CUPS-Filter 1.xâ€™s `pdftoraster`
 tool to write beyond the bounds of an array. First, a PDF with a large
 `MediaBox` width value causes `header.cupsWidth` to become large.  Next,
 the calculation of `bytesPerLine = (header.cupsBitsPerPixel *
 header.cupsWidth + 7) / 8` overflows, resulting in a small value. Then,
 `lineBuf` is allocated with the small `bytesPerLine` size. Finally,
 `convertLineChunked` calls `writePixel8`, which attempts to write to
 `lineBuf` outside of its buffer size (out of bounds write). In
 libcupsfilters, the maintainers found the same `bytesPerLine`
 multiplication without overflow check, but the provided test case does not
 cause an overflow there, because the values are different. Commit
 50d94ca0f2fa6177613c97c59791bde568631865 contains a patch, which is
 incorporated into cups-filters version 1.28.18.
Ubuntu-Description:
Notes:
 mdeslaur> filename changed from pdftoraster.cxx to pdftoraster.c in
 mdeslaur> newer versions
 mdeslaur> In cups-filters 2.x, this is just a wrapper
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L [4.0 MEDIUM]

Patches_cups-filters:
 upstream: https://github.com/OpenPrinting/cups-filters/commit/50d94ca0f2fa6177613c97c59791bde568631865
upstream_cups-filters: needs-triage
esm-infra/xenial_cups-filters: needs-triage
esm-infra/bionic_cups-filters: needs-triage
esm-infra/focal_cups-filters: needs-triage
jammy_cups-filters: needs-triage
noble_cups-filters: not-affected (code not present)
plucky_cups-filters: not-affected (code not present)
questing_cups-filters: not-affected (code not present)
devel_cups-filters: not-affected (code not present)

Patches_libcupsfilters:
 upstream: https://github.com/OpenPrinting/libcupsfilters/commit/fd01543f372ca3ba1f1c27bd3427110fa0094e3f
upstream_libcupsfilters: needs-triage
jammy_libcupsfilters: DNE
noble_libcupsfilters: released (2.0.0-0ubuntu7.2)
plucky_libcupsfilters: released (2.1.1-0ubuntu2.1)
questing_libcupsfilters: released (2.1.1-0ubuntu3.1)
devel_libcupsfilters: pending (2.1.1-0ubuntu4)
