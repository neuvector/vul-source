Candidate: CVE-2024-45818
PublicDate: 2024-12-19 12:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-45818
 https://xenbits.xen.org/xsa/advisory-463.html
Description:
 The hypervisor contains code to accelerate VGA memory accesses for HVM
 guests, when the (virtual) VGA is in "standard" mode.  Locking involved
 there has an unusual discipline, leaving a lock acquired past the
 return from the function that acquired it.  This behavior results in a
 problem when emulating an instruction with two memory accesses, both of
 which touch VGA memory (plus some further constraints which aren't
 relevant here).  When emulating the 2nd access, the lock that is already
 being held would be attempted to be re-acquired, resulting in a
 deadlock.
 
 This deadlock was already found when the code was first introduced, but
 was analysed incorrectly and the fix was incomplete.  Analysis in light
 of the new finding cannot find a way to make the existing locking
 discipline work.
 
 In staging, this logic has all been removed because it was discovered
 to be accidentally disabled since Xen 4.7.  Therefore, we are fixing the
 locking problem by backporting the removal of most of the feature.  Note
 that even with the feature disabled, the lock would still be acquired
 for any accesses to the VGA MMIO region.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N [6.5 MEDIUM]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: needs-triage
esm-infra/xenial_xen: needs-triage
esm-infra/bionic_xen: needs-triage
focal_xen: ignored (end of standard support, was needs-triage)
esm-apps/focal_xen: needs-triage
jammy_xen: needs-triage
esm-apps/jammy_xen: needs-triage
noble_xen: needs-triage
esm-apps/noble_xen: needs-triage
oracular_xen: ignored (end of life, was needs-triage)
plucky_xen: needs-triage
devel_xen: needs-triage
