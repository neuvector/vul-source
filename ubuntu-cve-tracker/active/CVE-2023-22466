Candidate: CVE-2023-22466
PublicDate: 2023-01-04 22:15:00 UTC
References:
 https://github.com/tokio-rs/tokio/pull/5336
 https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createnamedpipea#pipe_reject_remote_clients
 https://github.com/tokio-rs/tokio/security/advisories/GHSA-7rrj-xr53-82p7
 https://github.com/tokio-rs/tokio/releases/tag/tokio-1.23.1
 https://www.cve.org/CVERecord?id=CVE-2023-22466
Description:
 Tokio is a runtime for writing applications with Rust. Starting with
 version 1.7.0 and prior to versions 1.18.4, 1.20.3, and 1.23.1, when
 configuring a Windows named pipe server, setting `pipe_mode` will reset
 `reject_remote_clients` to `false`. If the application has previously
 configured `reject_remote_clients` to `true`, this effectively undoes the
 configuration. Remote clients may only access the named pipe if the named
 pipe's associated path is accessible via a publicly shared folder (SMB).
 Versions 1.23.1, 1.20.3, and 1.18.4 have been patched. The fix will also be
 present in all releases starting from version 1.24.0. Named pipes were
 introduced to Tokio in version 1.7.0, so releases older than 1.7.0 are not
 affected. As a workaround, ensure that `pipe_mode` is set first after
 initializing a `ServerOptions`.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L [5.4 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N [5.4 MEDIUM]

Patches_rust-tokio:
upstream_rust-tokio: needs-triage
trusty_rust-tokio: ignored (end of standard support)
xenial_rust-tokio: ignored (end of standard support)
bionic_rust-tokio: DNE
focal_rust-tokio: not-affected (0.1.14-2build1)
esm-apps/focal_rust-tokio: not-affected (0.1.14-2build1)
jammy_rust-tokio: needs-triage
esm-apps/jammy_rust-tokio: needs-triage
kinetic_rust-tokio: ignored (end of life, was needs-triage)
lunar_rust-tokio: ignored (end of life, was needs-triage)
mantic_rust-tokio: ignored (end of life, was needs-triage)
noble_rust-tokio: not-affected (1.35.1-1)
esm-apps/noble_rust-tokio: not-affected (1.35.1-1)
oracular_rust-tokio: not-affected (1.39.3-3)
plucky_rust-tokio: not-affected (1.39.3-3)
devel_rust-tokio: not-affected (1.39.3-3)
