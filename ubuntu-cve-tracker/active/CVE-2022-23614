PublicDateAtUSN: 2022-02-04 23:15:00 UTC
Candidate: CVE-2022-23614
PublicDate: 2022-02-04 23:15:00 UTC
References:
 https://github.com/twigphp/Twig/commit/2eb33080558611201b55079d07ac88f207b466d5
 https://github.com/twigphp/Twig/commit/22b9dc3c03ee66d7e21d9ed2ca76052b134cb9e9
 https://github.com/twigphp/Twig/security/advisories/GHSA-5mv2-rx3q-4w2v
 https://ubuntu.com/security/notices/USN-5947-1
 https://www.cve.org/CVERecord?id=CVE-2022-23614
Description:
 Twig is an open source template language for PHP. When in a sandbox mode,
 the `arrow` parameter of the `sort` filter must be a closure to avoid
 attackers being able to run arbitrary PHP functions. In affected versions
 this constraint was not properly enforced and could lead to code injection
 of arbitrary PHP code. Patched versions now disallow calling non Closure in
 the `sort` filter as is the case for some other filters. Users are advised
 to upgrade.
Ubuntu-Description:
Notes:
 ccdm94> advisory mentions that all versions greater than 2.0.0 and less than
 ccdm94> 2.14.11 are affected, however, there is no 'arrow' parameter implemented
 ccdm94> in bionic's version of Twig. As per commit 330024b6, support for the 
 ccdm94> 'arrow' function was only added in Twig 2.12.
Mitigation:
Bugs:
Priority: medium
Discovered-by: Marlon Starkloff
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]


Patches_php-twig:
 upstream: https://github.com/twigphp/Twig/commit/22b9dc3c03ee66d7e21d9ed2ca76052b134cb9e9 (2.x)
 upstream: https://github.com/twigphp/Twig/commit/9e5ca747b6e4015e39df032f00e86200b6916bc7 (3.x)
upstream_php-twig: released (2.14.11, 3.3.8)
trusty_php-twig: ignored (end of standard support)
xenial_php-twig: ignored (end of standard support)
bionic_php-twig: DNE
focal_php-twig: needed
esm-apps/focal_php-twig: released (2.12.5-1ubuntu0.1~esm1)
jammy_php-twig: not-affected (3.3.8-2ubuntu4)
esm-apps/jammy_php-twig: not-affected (3.3.8-2ubuntu4)
kinetic_php-twig: not-affected (3.4.2-1)
lunar_php-twig: not-affected (3.4.2-1)
mantic_php-twig: not-affected (3.4.2-1)
noble_php-twig: not-affected (3.4.2-1)
esm-apps/noble_php-twig: not-affected (3.4.2-1)
oracular_php-twig: not-affected (3.4.2-1)
plucky_php-twig: not-affected (3.4.2-1)
devel_php-twig: not-affected (3.4.2-1)

Patches_twig:
 upstream: https://github.com/twigphp/Twig/commit/22b9dc3c03ee66d7e21d9ed2ca76052b134cb9e9 (2.x)
 upstream: https://github.com/twigphp/Twig/commit/9e5ca747b6e4015e39df032f00e86200b6916bc7 (3.x)
upstream_twig: released (2.14.11, 3.3.8)
trusty_twig: ignored (end of standard support)
xenial_twig: ignored (end of standard support)
esm-apps/xenial_twig: not-affected (code not present)
bionic_twig: not-affected (code not present)
esm-apps/bionic_twig: not-affected (code not present)
