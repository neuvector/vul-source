Candidate: CVE-2021-43816
PublicDate: 2022-01-05 19:15:00 UTC
References:
 https://github.com/containerd/containerd/security/advisories/GHSA-mvff-h3cj-wj9c
 https://github.com/dweomer/containerd/commit/f7f08f0e34fb97392b0d382e58916d6865100299
 https://www.cve.org/CVERecord?id=CVE-2021-43816
Description:
 containerd is an open source container runtime. On installations using
 SELinux, such as EL8 (CentOS, RHEL), Fedora, or SUSE MicroOS, with
 containerd since v1.5.0-beta.0 as the backing container runtime interface
 (CRI), an unprivileged pod scheduled to the node may bind mount, via
 hostPath volume, any privileged, regular file on disk for complete
 read/write access (sans delete). Such is achieved by placing the
 in-container location of the hostPath volume mount at either `/etc/hosts`,
 `/etc/hostname`, or `/etc/resolv.conf`. These locations are being relabeled
 indiscriminately to match the container process-label which effectively
 elevates permissions for savvy containers that would not normally be able
 to access privileged host files. This issue has been resolved in version
 1.5.9. Users are advised to upgrade as soon as possible.
Ubuntu-Description:
Notes:
 alexmurray| This vulnerability is specific to when using containerd with
  SELinux, whilst SELinux is supported on Ubuntu it is not enabled by
  default. Hence setting the priority of this CVE to low.
Mitigation:
Bugs:
 https://github.com/containerd/containerd/issues/6194
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H [9.1 CRITICAL]


Patches_containerd:
 upstream: https://github.com/containerd/containerd/commit/a731039238c62be081eb8c31525b988415745eea
 upstream: https://github.com/containerd/containerd/commit/9b0303913fcfa297f984d954c718541cf474107b
upstream_containerd: released (1.5.9~ds1-1)
trusty_containerd: ignored (end of standard support)
xenial_containerd: ignored (end of standard support)
esm-apps/xenial_containerd: needed
bionic_containerd: released (1.5.9-0ubuntu1~18.04.1)
esm-apps/bionic_containerd: not-affected (1.5.9-0ubuntu1~18.04.1)
focal_containerd: released (1.5.9-0ubuntu1~20.04.4)
hirsute_containerd: ignored (end of life)
impish_containerd: released (1.5.9-0ubuntu1~21.10.3)
jammy_containerd: released (1.5.9-0ubuntu1)
kinetic_containerd: released (1.5.9-0ubuntu1)
lunar_containerd: released (1.5.9-0ubuntu1)
mantic_containerd: released (1.5.9-0ubuntu1)
noble_containerd: released (1.5.9-0ubuntu1)
esm-apps/noble_containerd: not-affected (1.5.9-0ubuntu1)
oracular_containerd: released (1.5.9-0ubuntu1)
plucky_containerd: released (1.5.9-0ubuntu1)
devel_containerd: released (1.5.9-0ubuntu1)
