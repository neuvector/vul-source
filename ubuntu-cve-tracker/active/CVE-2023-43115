Candidate: CVE-2023-43115
PublicDate: 2023-09-18 08:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43115
 https://ghostscript.com/
Description:
 In Artifex Ghostscript through 10.01.2, gdevijs.c in GhostPDL can lead to
 remote code execution via crafted PostScript documents because they can
 switch to the IJS device, or change the IjsServer parameter, after SAFER
 has been activated. NOTE: it is a documented risk that the IJS server can
 be specified on a gs command line (the IJS device inherently must execute a
 command to start the IJS server).
Ubuntu-Description:
Notes:
 rodrigo-zaiden> the risk of having programs being executed with IJS server
  is documented in the start of the devices/gdevijs.c	source file and in
  the online documentation:
   https://ghostscript.readthedocs.io/en/gs10.02.0/Devices.html#ijs-inkjet-and-other-raster-devices
  "Note also that if -dSAFER is not specified, itâ€™s possible for PostScript
  code to set this parameter, so it can cause arbitrary code to be executed."
 rodrigo-zaiden> the commit that fixes this issue makes it clear that there
  is no way to properly validate it. what the fix does is to provide a minimal
  guard based on file opening path validation. it will prevent PostScript
  programs switching to the IJS device after SAFER has been activated.
 rodrigo-zaiden> file opening path validation was added in version 9.28,
  with commmit 9de16a6637b73e35f79d2d622de403b24e6502f2, so in Ubuntu it
  is applicable starting from focal, for previous versions, the remediation
  is not applicable.
 rodrigo-zaiden> applying file opening path validation for older versions
  sounds risky and could possible bring other problems.
Mitigation:
Bugs:
 https://bugs.ghostscript.com/show_bug.cgi?id=707051
Priority: medium
Discovered-by:
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_ghostscript:
 upstream: https://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=e59216049cac290fb437a04c4f41ea46826cfba5
upstream_ghostscript: released (10.02.0~dfsg-1, 10.02.0)
trusty_ghostscript: ignored (end of standard support)
xenial_ghostscript: ignored (end of standard support)
esm-infra/xenial_ghostscript: ignored (patch not applicable)
bionic_ghostscript: ignored (end of standard support)
esm-infra/bionic_ghostscript: ignored (patch not applicable)
focal_ghostscript: needed
jammy_ghostscript: needed
lunar_ghostscript: needed
devel_ghostscript: needed
