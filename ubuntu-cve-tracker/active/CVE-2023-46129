Candidate: CVE-2023-46129
PublicDate: 2023-10-31 00:15:00 UTC
References:
 https://advisories.nats.io/CVE/secnote-2023-02.txt
 https://github.com/nats-io/nkeys/security/advisories/GHSA-mr45-rx8q-wcm9
 https://www.cve.org/CVERecord?id=CVE-2023-46129
Description:
 NATS.io is a high performance open source pub-sub distributed communication
 technology, built for the cloud, on-premise, IoT, and edge computing. The
 cryptographic key handling library, nkeys, recently gained support for
 encryption, not just for signing/authentication. This is used in
 nats-server 2.10 (Sep 2023) and newer for authentication callouts. In nkeys
 versions 0.4.0 through 0.4.5, corresponding with NATS server versions
 2.10.0 through 2.10.3, the nkeys library's `xkeys` encryption handling
 logic mistakenly passed an array by value into an internal function, where
 the function mutated that buffer to populate the encryption key to use. As
 a result, all encryption was actually to an all-zeros key. This affects
 encryption only, not signing. FIXME: FILL IN IMPACT ON NATS-SERVER AUTH
 CALLOUT SECURITY. nkeys Go library 0.4.6, corresponding with NATS Server
 2.10.4, has a patch for this issue. No known workarounds are available. For
 any application handling auth callouts in Go, if using the nkeys library,
 update the dependency, recompile and deploy that in lockstep.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1055010
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1055011
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]

Patches_golang-github-nats-io-nkeys:
upstream_golang-github-nats-io-nkeys: needs-triage
trusty_golang-github-nats-io-nkeys: ignored (end of standard support)
xenial_golang-github-nats-io-nkeys: ignored (end of standard support)
bionic_golang-github-nats-io-nkeys: ignored (end of standard support)
focal_golang-github-nats-io-nkeys: ignored (end of standard support, was needs-triage)
esm-apps/focal_golang-github-nats-io-nkeys: needs-triage
jammy_golang-github-nats-io-nkeys: needs-triage
esm-apps/jammy_golang-github-nats-io-nkeys: needs-triage
lunar_golang-github-nats-io-nkeys: ignored (end of life, was needs-triage)
mantic_golang-github-nats-io-nkeys: ignored (end of life, was needs-triage)
noble_golang-github-nats-io-nkeys: needs-triage
esm-apps/noble_golang-github-nats-io-nkeys: needs-triage
oracular_golang-github-nats-io-nkeys: needs-triage
plucky_golang-github-nats-io-nkeys: needs-triage
devel_golang-github-nats-io-nkeys: needs-triage

Patches_nats-server:
upstream_nats-server: needs-triage
trusty_nats-server: ignored (end of standard support)
xenial_nats-server: ignored (end of standard support)
bionic_nats-server: ignored (end of standard support)
focal_nats-server: DNE
esm-infra/focal_nats-server: DNE
jammy_nats-server: DNE
lunar_nats-server: ignored (end of life, was needs-triage)
mantic_nats-server: ignored (end of life, was needs-triage)
noble_nats-server: needs-triage
esm-apps/noble_nats-server: needs-triage
oracular_nats-server: needs-triage
plucky_nats-server: needs-triage
devel_nats-server: needs-triage
