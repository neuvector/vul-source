PublicDateAtUSN: 2023-09-18 17:15:00 UTC
Candidate: CVE-2023-4806
PublicDate: 2023-09-18 17:15:00 UTC
References:
 https://ubuntu.com/security/notices/USN-6541-1
 https://ubuntu.com/security/notices/USN-6541-2
 https://www.cve.org/CVERecord?id=CVE-2023-4806
Description:
 A flaw was found in glibc. In an extremely rare situation, the getaddrinfo
 function may access memory that has been freed, resulting in an application
 crash. This issue is only exploitable when a NSS module implements only the
 _nss_*_gethostbyname2_r and _nss_*_getcanonname_r hooks without
 implementing the _nss_*_gethostbyname3_r hook. The resolved name should
 return a large number of IPv6 and IPv4, and the call to the getaddrinfo
 function should have the AF_INET6 address family with AI_CANONNAME, AI_ALL
 and AI_V4MAPPED as flags.
Ubuntu-Description:
Notes:
 mdeslaur> This is only an issue when using an NSS module with a very
 mdeslaur> specific behaviour. There are no known NSS modules which are
 mdeslaur> implemented this way.
 mdeslaur>
 mdeslaur> The fix for this issue introduced a leak, identified as
 mdeslaur> CVE-2023-5156 which was later fixed with a subsequent commit.
 mdeslaur>
 mdeslaur> Older releases require backporting a dozen refactoring commits.
 ccdm94> One of the refactoring commits needed to fix this issue is also
 ccdm94> the fix for CVE-2023-4813.
Mitigation:
Bugs:
 https://sourceware.org/bugzilla/show_bug.cgi?id=30843
Priority: low
 No known NSS modules expose the vulnerability
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H [5.9 MEDIUM]

Patches_glibc:
 upstream: https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=973fe93a5675c42798b2161c6f29c01b0e243994 (2.39)
 upstream: https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=00ae4f10b504bc4564e9f22f00907093f1ab9338 (2.38)
 upstream: https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=6529a7466c935f36e9006b854d6f4e1d4876f942 (2.37)
 upstream: https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=a9728f798ec7f05454c95637ee6581afaa9b487d (2.36)
 upstream: https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=e3ccb230a961b4797510e6a1f5f21fd9021853e7 (2.35)
 upstream: https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=e09ee267c03e3150c2c9ba28625ab130705a485e (2.34)
upstream_glibc: needs-triage
trusty_glibc: ignored (end of standard support)
xenial_glibc: ignored (end of standard support)
esm-infra/xenial_glibc: released (2.23-0ubuntu11.3+esm5)
bionic_glibc: ignored (end of standard support)
esm-infra/bionic_glibc: released (2.27-3ubuntu1.6+esm1)
focal_glibc: released (2.31-0ubuntu9.14)
jammy_glibc: released (2.35-0ubuntu3.5)
lunar_glibc: released (2.37-0ubuntu2.2)
mantic_glibc: released (2.38-1ubuntu5)
noble_glibc: released (2.38-1ubuntu5)
oracular_glibc: released (2.38-1ubuntu5)
plucky_glibc: released (2.38-1ubuntu5)
devel_glibc: released (2.38-1ubuntu5)

Patches_eglibc:
upstream_eglibc: needs-triage
trusty_eglibc: ignored (end of standard support)
trusty/esm_eglibc: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_eglibc: needs-triage
xenial_eglibc: DNE
bionic_eglibc: DNE
focal_eglibc: DNE
jammy_eglibc: DNE
lunar_eglibc: DNE
mantic_eglibc: DNE
noble_eglibc: DNE
oracular_eglibc: DNE
plucky_eglibc: DNE
devel_eglibc: DNE
