Candidate: CVE-2021-20230
PublicDate: 2021-02-23 17:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20230
 https://github.com/mtrojnar/stunnel/commit/ebad9ddc4efb2635f37174c9d800d06206f1edf9
 https://bugzilla.redhat.com/show_bug.cgi?id=1925226
 https://bugzilla.suse.com/show_bug.cgi?id=1177580
Description:
 A flaw was found in stunnel before 5.57, where it improperly validates
 client certificates when it is configured to use both redirect and
 verifyChain options. This flaw allows an attacker with a certificate signed
 by a Certificate Authority, which is not the one accepted by the stunnel
 server, to access the tunneled service instead of being redirected to the
 address specified in the redirect option. The highest threat from this
 vulnerability is to confidentiality.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> the fix for this CVE can be found in src/verify.c from the
 rodrigo-zaiden> upstream commit ebad9ddc.
 rodrigo-zaiden> verifyChain was added in version 5.34 (commit 8c43d2af),
 rodrigo-zaiden> so releases earlier than bionic are not affected.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [7.5 HIGH]


Patches_stunnel4:
 upstream: https://github.com/mtrojnar/stunnel/commit/ebad9ddc4efb2635f37174c9d800d06206f1edf9
upstream_stunnel4: released (5.57)
precise/esm_stunnel4: DNE
trusty_stunnel4: ignored (out of standard support)
trusty/esm_stunnel4: not-affected (code not present)
xenial_stunnel4: ignored (end of standard support, was needs-triage)
esm-apps/xenial_stunnel4: not-affected (code not present)
bionic_stunnel4: needed
esm-apps/bionic_stunnel4: needed
focal_stunnel4: needed
esm-apps/focal_stunnel4: needed
groovy_stunnel4: ignored (reached end-of-life)
hirsute_stunnel4: ignored (reached end-of-life)
impish_stunnel4: ignored (reached end-of-life)
jammy_stunnel4: not-affected (3:5.63-1build1)
esm-apps/jammy_stunnel4: not-affected (3:5.63-1build1)
kinetic_stunnel4: not-affected (3:5.63-1ubuntu1)
lunar_stunnel4: not-affected (3:5.63-1ubuntu1)
devel_stunnel4: not-affected (3:5.63-1ubuntu1)
