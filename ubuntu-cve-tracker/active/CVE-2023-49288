PublicDateAtUSN: 2023-12-04 23:15:00 UTC
Candidate: CVE-2023-49288
PublicDate: 2023-12-04 23:15:00 UTC
References:
 https://github.com/squid-cache/squid/security/advisories/GHSA-rj5h-46j6-q2g5
 https://megamansec.github.io/Squid-Security-Audit/trace-uaf.html
 https://ubuntu.com/security/notices/USN-6728-1
 https://ubuntu.com/security/notices/USN-6728-2
 https://www.cve.org/CVERecord?id=CVE-2023-49288
 https://ubuntu.com/security/notices/USN-6728-3
Description:
 Squid is a caching proxy for the Web supporting HTTP, HTTPS, FTP, and more.
 Affected versions of squid are subject to a a Use-After-Free bug which can
 lead to a Denial of Service attack via collapsed forwarding. All versions
 of Squid from 3.5 up to and including 5.9 configured with
 "collapsed_forwarding on" are vulnerable. Configurations with
 "collapsed_forwarding off" or without a "collapsed_forwarding" directive
 are not vulnerable. This bug is fixed by Squid version 6.0.1. Users are
 advised to upgrade. Users unable to upgrade should remove all
 collapsed_forwarding lines from their squid.conf.
Ubuntu-Description:
Notes:
 mdeslaur> need to identify commit in 6.0.1...perhaps this one?
 mdeslaur> https://github.com/squid-cache/squid/commit/836d3c0b158f6e7bc795d1e6d881c873d98728e8
 mdeslaur> or https://github.com/squid-cache/squid/commit/9358e99f998ace9c4c7a21d510432dde5b7f9cca
 mdeslaur>
 mdeslaur> While this is fixed by a yet unidentified commit in 6.0.1, I
 mdeslaur> believe it is also fixed in a different way by the refactoring
 mdeslaur> in the commit to fix CVE-2023-5824. The issue no longer
 mdeslaur> reproduces with the fix for CVE-2023-5824 applied.
 mdeslaur> Ubuntu 20.04 LTS was patched in USN-6728-1, but the fix
 mdeslaur> introduced crashes and was backed out in USN-6728-2.
Mitigation:
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/squid/+bug/2060880 (regression)
Priority: medium
Discovered-by: Joshua Rogers
Assigned-to: nickgalanis
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H [8.6 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_squid:
upstream_squid: released (6.1-1)
trusty_squid: ignored (end of standard support)
xenial_squid: ignored (end of standard support)
bionic_squid: ignored (end of standard support)
focal_squid: released (4.10-1ubuntu1.12)
jammy_squid: released (5.7-0ubuntu0.22.04.4)
lunar_squid: ignored (end of life, was deferred [2024-01-26])
mantic_squid: not-affected (6.1-2ubuntu1.1)
noble_squid: not-affected
oracular_squid: not-affected
plucky_squid: not-affected
devel_squid: not-affected

Patches_squid3:
upstream_squid3: needs-triage
trusty_squid3: ignored (end of standard support)
xenial_squid3: ignored (end of standard support)
esm-infra/xenial_squid3: needed
bionic_squid3: ignored (end of standard support)
esm-infra/bionic_squid3: needed
focal_squid3: DNE
jammy_squid3: DNE
lunar_squid3: DNE
mantic_squid3: DNE
noble_squid3: DNE
oracular_squid3: DNE
plucky_squid3: DNE
devel_squid3: DNE
