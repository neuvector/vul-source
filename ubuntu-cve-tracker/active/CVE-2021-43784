PublicDateAtUSN: 2021-12-06 18:15:00 UTC
Candidate: CVE-2021-43784
PublicDate: 2021-12-06 18:15:00 UTC
References:
 https://github.com/opencontainers/runc/security/advisories/GHSA-v95c-p5hm-xq8f
 https://www.openwall.com/lists/oss-security/2021/12/06/1
 https://ubuntu.com/security/notices/USN-6088-2
 https://www.cve.org/CVERecord?id=CVE-2021-43784
Description:
 runc is a CLI tool for spawning and running containers on Linux according
 to the OCI specification. In runc, netlink is used internally as a
 serialization system for specifying the relevant container configuration to
 the `C` portion of the code (responsible for the based namespace setup of
 containers). In all versions of runc prior to 1.0.3, the encoder did not
 handle the possibility of an integer overflow in the 16-bit length field
 for the byte array attribute type, meaning that a large enough malicious
 byte array attribute could result in the length overflowing and the
 attribute contents being parsed as netlink messages for container
 configuration. This vulnerability requires the attacker to have some
 control over the configuration of the container and would allow the
 attacker to bypass the namespace restrictions of the container by simply
 adding their own netlink payload which disables all namespaces. The main
 users impacted are those who allow untrusted images with untrusted
 configurations to run on their machines (such as with shared cloud
 infrastructure). runc version 1.0.3 contains a fix for this bug. As a
 workaround, one may try disallowing untrusted namespace paths from your
 container. It should be noted that untrusted namespace paths would allow
 the attacker to disable namespace protections entirely even in the absence
 of this bug.
Ubuntu-Description:
Notes:
 alexmurray| The original advisory notes this is likely not exploitable on runc
  versions < 1.0.3 so I have assigned this a low priority.
Mitigation:
Bugs:
Priority: low
Discovered-by: Felix Wilhelm
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L [5.0 MEDIUM]


Patches_runc:
 upstream: https://github.com/opencontainers/runc/commit/d72d057ba794164c3cce9451a00b72a78b25e1ae
upstream_runc: released (1.0.3)
trusty_runc: ignored (end of standard support)
xenial_runc: ignored (end of standard support)
esm-apps/xenial_runc: released (1.0.0~rc7+git20190403.029124da-0ubuntu1~16.04.4+esm4)
bionic_runc: ignored (end of standard support, was needed)
esm-apps/bionic_runc: needed
focal_runc: not-affected (1.0.3-0)
hirsute_runc: ignored (end of life)
impish_runc: ignored (end of life)
jammy_runc: not-affected (1.0.3-0)
kinetic_runc: not-affected (1.0.3-0)
lunar_runc: not-affected (1.0.3-0)
mantic_runc: not-affected (1.0.3-0)
noble_runc: not-affected (1.0.3-0)
esm-apps/noble_runc: not-affected (1.0.3-0)
oracular_runc: not-affected (1.0.3-0)
plucky_runc: not-affected (1.0.3-0)
devel_runc: not-affected (1.0.3-0)
