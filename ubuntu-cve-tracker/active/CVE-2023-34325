Candidate: CVE-2023-34325
PublicDate: 2024-01-05 17:15:00 UTC
References:
 https://xenbits.xen.org/xsa/advisory-443.html
 https://www.cve.org/CVERecord?id=CVE-2023-34325
Description:
 [This CNA information record relates to multiple CVEs; the text explains
 which aspects/vulnerabilities correspond to which CVE.] libfsimage contains
 parsing code for several filesystems, most of them based on grub-legacy
 code. libfsimage is used by pygrub to inspect guest disks. Pygrub runs as
 the same user as the toolstack (root in a priviledged domain). At least one
 issue has been reported to the Xen Security Team that allows an attacker to
 trigger a stack buffer overflow in libfsimage. After further analisys the
 Xen Security Team is no longer confident in the suitability of libfsimage
 when run against guest controlled input with super user priviledges. In
 order to not affect current deployments that rely on pygrub patches are
 provided in the resolution section of the advisory that allow running
 pygrub in deprivileged mode. CVE-2023-4949 refers to the original issue in
 the upstream grub project ("An attacker with local access to a system
 (either through a disk or external drive) can present a modified XFS
 partition to grub-legacy in such a way to exploit a memory corruption in
 grubâ€™s XFS file system implementation.") CVE-2023-34325 refers specifically
 to the vulnerabilities in Xen's copy of libfsimage, which is decended from
 a very old version of grub.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: needs-triage
trusty_xen: ignored (end of standard support)
xenial_xen: ignored (end of standard support)
esm-infra/xenial_xen: needs-triage
bionic_xen: ignored (end of standard support)
esm-infra/bionic_xen: needs-triage
focal_xen: ignored (end of standard support, was needs-triage)
esm-infra/focal_xen: DNE (focal was needs-triage)
esm-apps/focal_xen: needs-triage
jammy_xen: needs-triage
esm-apps/jammy_xen: needs-triage
lunar_xen: ignored (end of life, was needs-triage)
mantic_xen: ignored (end of life, was needs-triage)
noble_xen: needs-triage
esm-apps/noble_xen: needs-triage
oracular_xen: needs-triage
plucky_xen: needs-triage
devel_xen: needs-triage
