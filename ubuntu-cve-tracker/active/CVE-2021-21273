Candidate: CVE-2021-21273
PublicDate: 2021-02-26 18:15:00 UTC
References:
 https://github.com/matrix-org/synapse/security/advisories/GHSA-v936-j8gp-9q3p
 https://github.com/matrix-org/synapse/commit/30fba6210834a4ecd91badf0c8f3eb278b72e746
 https://github.com/matrix-org/synapse/pull/8821
 https://github.com/matrix-org/synapse/releases/tag/v1.25.0
 https://www.cve.org/CVERecord?id=CVE-2021-21273
Description:
 Synapse is a Matrix reference homeserver written in python (pypi package
 matrix-synapse). Matrix is an ecosystem for open federated Instant
 Messaging and VoIP. In Synapse before version 1.25.0, requests to user
 provided domains were not restricted to external IP addresses when
 calculating the key validity for third-party invite events and sending push
 notifications. This could cause Synapse to make requests to internal
 infrastructure. The type of request was not controlled by the user,
 although limited modification of request bodies was possible. For the most
 thorough protection server administrators should remove the deprecated
 `federation_ip_range_blacklist` from their settings after upgrading to
 Synapse v1.25.0 which will result in Synapse using the improved default IP
 address restrictions. See the new `ip_range_blacklist` and
 `ip_range_whitelist` settings if more specific control is necessary.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: 
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N [6.1 MEDIUM]


Patches_matrix-synapse:
upstream_matrix-synapse: released (1.25.0-1)
precise/esm_matrix-synapse: DNE
trusty_matrix-synapse: ignored (end of standard support)
trusty/esm_matrix-synapse: DNE
esm-infra-legacy/trusty_matrix-synapse: DNE
xenial_matrix-synapse: DNE
bionic_matrix-synapse: ignored (end of standard support, was needs-triage)
esm-apps/bionic_matrix-synapse: needs-triage
focal_matrix-synapse: needs-triage
esm-apps/focal_matrix-synapse: needs-triage
groovy_matrix-synapse: ignored (end of life)
hirsute_matrix-synapse: not-affected (1.26.0-3)
impish_matrix-synapse: not-affected (1.26.0-3)
jammy_matrix-synapse: not-affected (1.26.0-3)
esm-apps/jammy_matrix-synapse: not-affected (1.26.0-3)
kinetic_matrix-synapse: not-affected (1.26.0-3)
lunar_matrix-synapse: not-affected (1.26.0-3)
mantic_matrix-synapse: not-affected (1.26.0-3)
noble_matrix-synapse: not-affected (1.26.0-3)
esm-apps/noble_matrix-synapse: not-affected (1.26.0-3)
oracular_matrix-synapse: not-affected (1.26.0-3)
