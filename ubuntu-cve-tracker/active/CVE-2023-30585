Candidate: CVE-2023-30585
PublicDate: 2023-11-28 02:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30585
 https://nodejs.org/en/blog/vulnerability/june-2023-security-releases#privilege-escalation-via-malicious-registry-key-manipulation-during-nodejs-installer-repair-process-medium-cve-2023-30585
Description:
 A vulnerability has been identified in the Node.js (.msi version)
 installation process, specifically affecting Windows users who install
 Node.js using the .msi installer. This vulnerability emerges during the
 repair operation, where the "msiexec.exe" process, running under the NT
 AUTHORITY\SYSTEM context, attempts to read the %USERPROFILE% environment
 variable from the current user's registry. The issue arises when the path
 referenced by the %USERPROFILE% environment variable does not exist. In
 such cases, the "msiexec.exe" process attempts to create the specified path
 in an unsafe manner, potentially leading to the creation of arbitrary
 folders in arbitrary locations. The severity of this vulnerability is
 heightened by the fact that the %USERPROFILE% environment variable in the
 Windows registry can be modified by standard (or "non-privileged") users.
 Consequently, unprivileged actors, including malicious entities or trojans,
 can manipulate the environment variable key to deceive the privileged
 "msiexec.exe" process. This manipulation can result in the creation of
 folders in unintended and potentially malicious locations. It is important
 to note that this vulnerability is specific to Windows users who install
 Node.js using the .msi installer. Users who opt for other installation
 methods are not affected by this particular issue.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N [7.5 HIGH]

Patches_nodejs:
upstream_nodejs: not-affected (debian: Only affects installation process on Windows)
trusty_nodejs: ignored (end of standard support)
trusty/esm_nodejs: needs-triage
xenial_nodejs: ignored (end of standard support)
esm-apps/xenial_nodejs: needs-triage
bionic_nodejs: ignored (end of standard support)
esm-apps/bionic_nodejs: needs-triage
focal_nodejs: needs-triage
esm-apps/focal_nodejs: needs-triage
jammy_nodejs: needs-triage
esm-apps/jammy_nodejs: needs-triage
kinetic_nodejs: ignored (end of life, was needs-triage)
lunar_nodejs: needs-triage
mantic_nodejs: needs-triage
devel_nodejs: needs-triage
