Candidate: CVE-2021-3882
PublicDate: 2021-10-14 09:15:00 UTC
References:
 https://huntr.dev/bounties/7061d97a-98a5-495a-8ba0-3a4c66091e9d/
 https://ledgersmb.org/content/security-advisory-cve-2021-3882-non-secure-session-cookie
 https://huntr.dev/bounties/7061d97a-98a5-495a-8ba0-3a4c66091e9d
 https://github.com/ledgersmb/ledgersmb/commit/c242f5a2abf4b99b0da205473cbba034f306bfe2
 https://ledgersmb.org/cve-2021-3882-sensitive-non-secure-cookie
 https://www.cve.org/CVERecord?id=CVE-2021-3882
Description:
 LedgerSMB does not set the 'Secure' attribute on the session authorization
 cookie when the client uses HTTPS and the LedgerSMB server is behind a
 reverse proxy. By tricking a user to use an unencrypted connection (HTTP),
 an attacker may be able to obtain the authentication data by capturing
 network traffic. LedgerSMB 1.8 and newer switched from Basic authentication
 to using cookie authentication with encrypted cookies. Although an attacker
 can't access the information inside the cookie, nor the password of the
 user, possession of the cookie is enough to access the application as the
 user from which the cookie has been obtained. In order for the attacker to
 obtain the cookie, first of all the server must be configured to respond to
 unencrypted requests, the attacker must be suitably positioned to eavesdrop
 on the network traffic between the client and the server *and* the user
 must be tricked into using unencrypted HTTP traffic. Proper audit control
 and separation of duties limit Integrity impact of the attack vector. Users
 of LedgerSMB 1.8 are urged to upgrade to known-fixed versions. Users of
 LedgerSMB 1.7 or 1.9 are unaffected by this vulnerability and don't need to
 take action. As a workaround, users may configure their Apache or Nginx
 reverse proxy to add the Secure attribute at the network boundary instead
 of relying on LedgerSMB. For Apache, please refer to the 'Header always
 edit' configuration command in the mod_headers module. For Nginx, please
 refer to the 'proxy_cookie_flags' configuration command.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 huntr.dev: CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:N [5.9 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N [6.8 MEDIUM]


Patches_ledgersmb:
upstream_ledgersmb: not-affected (debian: Vulnerable code introduced later)
trusty_ledgersmb: ignored (end of standard support)
xenial_ledgersmb: ignored (end of standard support)
esm-apps/xenial_ledgersmb: needed
bionic_ledgersmb: not-affected (code not present)
esm-apps/bionic_ledgersmb: not-affected (code not present)
focal_ledgersmb: ignored (end of standard support, was needed)
esm-apps/focal_ledgersmb: needed
hirsute_ledgersmb: ignored (end of life)
impish_ledgersmb: ignored (end of life)
jammy_ledgersmb: needed
esm-apps/jammy_ledgersmb: needed
kinetic_ledgersmb: ignored (end of life, was needs-triage)
lunar_ledgersmb: ignored (end of life, was needs-triage)
mantic_ledgersmb: ignored (end of life, was needs-triage)
noble_ledgersmb: needed
esm-apps/noble_ledgersmb: needed
oracular_ledgersmb: needed
plucky_ledgersmb: needed
devel_ledgersmb: needed
