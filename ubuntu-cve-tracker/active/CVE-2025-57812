PublicDateAtUSN: 2025-11-12
Candidate: CVE-2025-57812
PublicDate: 2025-11-12 19:15:00 UTC
CRD: 2025-11-12
References:
 https://www.cve.org/CVERecord?id=CVE-2025-57812
 https://www.openwall.com/lists/oss-security/2025/11/12/1
 https://github.com/OpenPrinting/libcupsfilters/security/advisories/GHSA-jpxg-qc2c-hgv4
 https://github.com/OpenPrinting/libcupsfilters/security/advisories/GHSA-rc6w-jmvv-v7gx
 https://github.com/OpenPrinting/libcupsfilters/security/advisories/GHSA-fmvr-45mx-43c6
 https://ubuntu.com/security/notices/USN-7877-1
 https://ubuntu.com/security/notices/USN-7878-1
Description:
 CUPS is a standards-based, open-source printing system, and
 `libcupsfilters` contains the code of the filters of the former
 `cups-filters` package as library functions to be used for the data format
 conversion tasks needed in Printer Applications. In CUPS-Filters versions
 up to and including 1.28.17 and libscupsfilters versions 2.0.0 through
 2.1.1, CUPS-Filters's `imagetoraster` filter has an out of bounds
 read/write vulnerability in the processing of TIFF image files.  While the
 pixel buffer is allocated with the number of pixels times a pre-calculated
 bytes-per-pixel value, the function which processes these pixels is called
 with a size of the number of pixels times 3.  When suitable inputs are
 passed, the bytes-per-pixel value can be set to 1 and bytes outside of the
 buffer bounds get processed. In order to trigger the bug, an attacker must
 issue a print job with a crafted TIFF file, and pass appropriate print job
 options to control the bytes-per-pixel value of the output format. They
 must choose a printer configuration under which the `imagetoraster` filter
 or its C-function equivalent `cfFilterImageToRaster()` gets invoked. The
 vulnerability exists in both CUPS-Filters 1.x and the successor library
 libcupsfilters (CUPS-Filters 2.x). In CUPS-Filters 2.x, the vulnerable
 function is `_cfImageReadTIFF() in libcupsfilters`. When this function is
 invoked as part of `cfFilterImageToRaster()`, the caller passes a
 look-up-table during whose processing the out of bounds memory access
 happens. In CUPS-Filters 1.x, the equivalent functions are all found in the
 cups-filters repository, which is not split into subprojects yet, and the
 vulnerable code is in `_cupsImageReadTIFF()`, which is called through
 `cupsImageOpen()` from the `imagetoraster` tool. A patch is available in
 commit b69dfacec7f176281782e2f7ac44f04bf9633cfa.
Ubuntu-Description:
Notes:
 mdeslaur> code moved from cups-filters to libcupsfilters in 2.x
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N [3.7 LOW]

Patches_cups-filters:
 upstream: https://github.com/OpenPrinting/cups-filters/commit/5122052dd8f06949242099401c59f6c3b14e61c3
 upstream: https://github.com/OpenPrinting/cups-filters/commit/cb927006747b797aa9163cd0cbd41b9bbdf05db0
 upstream: https://github.com/OpenPrinting/cups-filters/commit/719c557c9a29db32b855e6e108d7f4e7c5397613
 upstream: https://github.com/OpenPrinting/cups-filters/commit/7bd588a1fc5c99ac0b1951beb1b54b438137a7b5
 upstream: https://github.com/OpenPrinting/cups-filters/commit/5e5f1c5d46a043c57cbbe6e043aa95896d9c40fa
upstream_cups-filters: needs-triage
esm-infra/xenial_cups-filters: released (1.8.3-2ubuntu3.5+esm3)
esm-infra/bionic_cups-filters: released (1.20.2-0ubuntu3.3+esm2)
esm-infra/focal_cups-filters: released (1.27.4-1ubuntu0.4+esm1)
jammy_cups-filters: released (1.28.15-0ubuntu1.5)
noble_cups-filters: not-affected (code not present)
plucky_cups-filters: not-affected (code not present)
questing_cups-filters: not-affected (code not present)
devel_cups-filters: not-affected (code not present)

Patches_libcupsfilters:
 upstream: https://github.com/OpenPrinting/libcupsfilters/commit/b69dfacec7f176281782e2f7ac44f04bf9633cfa
upstream_libcupsfilters: needs-triage
jammy_libcupsfilters: DNE
noble_libcupsfilters: released (2.0.0-0ubuntu7.2)
plucky_libcupsfilters: released (2.1.1-0ubuntu2.1)
questing_libcupsfilters: released (2.1.1-0ubuntu3.1)
devel_libcupsfilters: pending (2.1.1-0ubuntu4)
