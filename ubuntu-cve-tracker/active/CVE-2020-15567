PublicDateAtUSN: 2020-07-07 13:15:00 UTC
Candidate: CVE-2020-15567
PublicDate: 2020-07-07 13:15:00 UTC
References:
 https://xenbits.xen.org/xsa/advisory-328.html
 http://www.openwall.com/lists/oss-security/2020/07/07/6
 http://xenbits.xen.org/xsa/advisory-328.html
 https://ubuntu.com/security/notices/USN-5617-1
 https://www.cve.org/CVERecord?id=CVE-2020-15567
Description:
 An issue was discovered in Xen through 4.13.x, allowing Intel guest OS
 users to gain privileges or cause a denial of service because of non-atomic
 modification of a live EPT PTE. When mapping guest EPT (nested paging)
 tables, Xen would in some circumstances use a series of non-atomic bitfield
 writes. Depending on the compiler version and optimisation flags, Xen might
 expose a dangerous partially written PTE to the hardware, which an attacker
 might be able to race to exploit. A guest administrator or perhaps even an
 unprivileged guest user might be able to cause denial of service, data
 corruption, or privilege escalation. Only systems using Intel CPUs are
 vulnerable. Systems using AMD CPUs, and Arm systems, are not vulnerable.
 Only systems using nested paging (hap, aka nested paging, aka in this case
 Intel EPT) are vulnerable. Only HVM and PVH guests can exploit the
 vulnerability. The presence and scope of the vulnerability depends on the
 precise optimisations performed by the compiler used to build Xen. If the
 compiler generates (a) a single 64-bit write, or (b) a series of
 read-modify-write operations in the same order as the source code, the
 hypervisor is not vulnerable. For example, in one test build using GCC 8.3
 with normal settings, the compiler generated multiple (unlocked)
 read-modify-write operations in source-code order, which did not constitute
 a vulnerability. We have not been able to survey compilers; consequently we
 cannot say which compiler(s) might produce vulnerable code (with which
 code-generation options). The source code clearly violates the C rules, and
 thus should be considered vulnerable.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H [7.8 HIGH]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: needs-triage
precise/esm_xen: DNE
trusty_xen: ignored (end of standard support)
trusty/esm_xen: DNE
esm-infra-legacy/trusty_xen: DNE
xenial_xen: ignored (end of standard support, was needs-triage)
esm-infra/xenial_xen: needs-triage
bionic_xen: ignored (end of standard support, was needed)
esm-infra/bionic_xen: needed
eoan_xen: ignored (end of life)
focal_xen: released (4.11.3+24-g14b62ab3e5-1ubuntu2.3)
esm-apps/focal_xen: released (4.11.3+24-g14b62ab3e5-1ubuntu2.3)
groovy_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
hirsute_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
impish_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
jammy_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
esm-apps/jammy_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
kinetic_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
lunar_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
mantic_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
noble_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
esm-apps/noble_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
oracular_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
plucky_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
questing_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
devel_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)

