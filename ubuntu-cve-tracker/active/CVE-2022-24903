PublicDateAtUSN: 2022-05-05
Candidate: CVE-2022-24903
CRD: 2022-05-05
PublicDate: 2022-05-06 00:15:00 UTC
References: 
 https://ubuntu.com/security/notices/USN-5404-1
 https://ubuntu.com/security/notices/USN-5404-2
 https://www.cve.org/CVERecord?id=CVE-2022-24903
Description:
 Rsyslog is a rocket-fast system for log processing. Modules for TCP syslog
 reception have a potential heap buffer overflow when octet-counted framing
 is used. This can result in a segfault or some other malfunction. As of our
 understanding, this vulnerability can not be used for remote code
 execution. But there may still be a slight chance for experts to do that.
 The bug occurs when the octet count is read. While there is a check for the
 maximum number of octets, digits are written to a heap buffer even when the
 octet count is over the maximum, This can be used to overrun the memory
 buffer. However, once the sequence of digits stop, no additional characters
 can be added to the buffer. In our opinion, this makes remote exploits
 impossible or at least highly complex. Octet-counted framing is one of two
 potential framing modes. It is relatively uncommon, but enabled by default
 on receivers. Modules `imtcp`, `imptcp`, `imgssapi`, and `imhttp` are used
 for regular syslog message reception. It is best practice not to directly
 expose them to the public. When this practice is followed, the risk is
 considerably lower. Module `imdiag` is a diagnostics module primarily
 intended for testbench runs. We do not expect it to be present on any
 production installation. Octet-counted framing is not very common. Usually,
 it needs to be specifically enabled at senders. If users do not need it,
 they can turn it off for the most important modules. This will mitigate the
 vulnerability.
Ubuntu-Description: 
Notes: 
Mitigation: 
Bugs: 
Priority: medium
Discovered-by: Pieter Agten
Assigned-to: 
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]


Patches_rsyslog:
upstream_rsyslog: released (8.2204.1-1)
trusty/esm_rsyslog: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_rsyslog: needs-triage
esm-infra/xenial_rsyslog: released (8.16.0-1ubuntu3.1+esm2)
bionic_rsyslog: released (8.32.0-1ubuntu4.2)
esm-infra/bionic_rsyslog: not-affected (8.32.0-1ubuntu4.2)
focal_rsyslog: released (8.2001.0-1ubuntu1.3)
esm-infra/focal_rsyslog: not-affected (8.2001.0-1ubuntu1.3)
impish_rsyslog: released (8.2102.0-2ubuntu2.2)
jammy_rsyslog: released (8.2112.0-2ubuntu2.2)
kinetic_rsyslog: released (8.2204.0-1ubuntu1)
lunar_rsyslog: released (8.2204.0-1ubuntu1)
mantic_rsyslog: released (8.2204.0-1ubuntu1)
noble_rsyslog: released (8.2204.0-1ubuntu1)
oracular_rsyslog: released (8.2204.0-1ubuntu1)
plucky_rsyslog: released (8.2204.0-1ubuntu1)
devel_rsyslog: released (8.2204.0-1ubuntu1)
