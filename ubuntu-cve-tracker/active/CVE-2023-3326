Candidate: CVE-2023-3326
PublicDate: 2023-06-22 17:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3326
 https://security.FreeBSD.org/advisories/FreeBSD-SA-23:04.pam_krb5.asc
 https://seclists.org/oss-sec/2023/q2/245
Description:
 pam_krb5 authenticates a user by essentially running kinit with the
 password, getting a ticket-granting ticket (tgt) from the Kerberos KDC (Key
 Distribution Center) over the network, as a way to verify the password.
 However, if a keytab is not provisioned on the system, pam_krb5 has no way
 to validate the response from the KDC, and essentially trusts the tgt
 provided over the network as being valid. In a non-default FreeBSD
 installation that leverages pam_krb5 for authentication and does not have a
 keytab provisioned, an attacker that is able to control both the password
 and the KDC responses can return a valid tgt, allowing authentication to
 occur for any user on the system.
Ubuntu-Description:
Notes:
 mdeslaur> per the comments on the oss-sec post, "pam_krb5 and sssd-krb5
 mdeslaur> are both affected by the same attack, but they have always been
 mdeslaur> _documented_ to be affected". See the "verify_ap_req_nofail"
 mdeslaur> option in the man page.
 mdeslaur>
 mdeslaur> Deferring this CVE to see if a fix will be available, or if
 mdeslaur> this isn't something that will ever get a fix because it works
 mdeslaur> as documented.
Mitigation:
 Per the documentation, set verify_ap_req_nofail to true in the
 [libdefaults] section of /etc/krb5.conf.
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_libpam-krb5:
upstream_libpam-krb5: needs-triage
trusty_libpam-krb5: ignored (end of standard support)
trusty/esm_libpam-krb5: deferred (2023-06-23)
xenial_libpam-krb5: ignored (end of standard support)
esm-infra/xenial_libpam-krb5: deferred (2023-06-23)
bionic_libpam-krb5: ignored (end of standard support)
esm-infra/bionic_libpam-krb5: deferred (2023-06-23)
focal_libpam-krb5: deferred (2023-06-23)
jammy_libpam-krb5: deferred (2023-06-23)
kinetic_libpam-krb5: deferred (2023-06-23)
lunar_libpam-krb5: deferred (2023-06-23)
devel_libpam-krb5: deferred (2023-06-23)

Patches_sssd:
upstream_sssd: needs-triage
trusty_sssd: ignored (end of standard support)
xenial_sssd: ignored (end of standard support)
esm-infra/xenial_sssd: deferred (2023-06-23)
bionic_sssd: ignored (end of standard support)
esm-infra/bionic_sssd: deferred (2023-06-23)
focal_sssd: deferred (2023-06-23)
jammy_sssd: deferred (2023-06-23)
kinetic_sssd: deferred (2023-06-23)
lunar_sssd: deferred (2023-06-23)
devel_sssd: deferred (2023-06-23)
