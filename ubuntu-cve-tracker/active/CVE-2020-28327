Candidate: CVE-2020-28327
PublicDate: 2020-11-06 19:15:00 UTC
References:
 http://downloads.asterisk.org/pub/security/AST-2020-001.html
 https://www.openwall.com/lists/oss-security/2020/11/06/1
 https://www.cve.org/CVERecord?id=CVE-2020-28327
Description:
 A res_pjsip_session crash was discovered in Asterisk Open Source 13.x
 before 13.37.1, 16.x before 16.14.1, 17.x before 17.8.1, and 18.x before
 18.0.1. and Certified Asterisk before 16.8-cert5. Upon receiving a new SIP
 Invite, Asterisk did not return the created dialog locked or referenced.
 This caused a gap between the creation of the dialog object, and its next
 use by the thread that created it. Depending on some off-nominal
 circumstances and timing, it was possible for another thread to free said
 dialog in this gap. Asterisk could then crash when the dialog object, or
 any of its dependent objects, were dereferenced or accessed next by the
 initial-creation thread. Note, however, that this crash can only occur when
 using a connection-oriented protocol (e.g., TCP or TLS, but not UDP) for
 SIP transport. Also, the remote client must be authenticated, or Asterisk
 must be configured for anonymous calling.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H [5.3 MEDIUM]


Patches_asterisk:
 upstream: http://downloads.asterisk.org/pub/security/AST-2020-001-13.diff
 upstream: http://downloads.asterisk.org/pub/security/AST-2020-001-16.diff
upstream_asterisk: released (1:16.15.0~dfsg-1)
precise/esm_asterisk: DNE
trusty_asterisk: ignored (end of standard support)
trusty/esm_asterisk: DNE
esm-infra-legacy/trusty_asterisk: DNE
xenial_asterisk: ignored (end of standard support, was needed)
esm-apps/xenial_asterisk: needed
bionic_asterisk: ignored (end of standard support, was needed)
esm-apps/bionic_asterisk: needed
focal_asterisk: ignored (end of standard support, was needed)
esm-infra/focal_asterisk: DNE (focal was needed)
esm-apps/focal_asterisk: needed
groovy_asterisk: ignored (end of life)
hirsute_asterisk: not-affected (1:16.15.0~dfsg-1)
impish_asterisk: not-affected (1:16.15.0~dfsg-1)
jammy_asterisk: not-affected (1:16.15.0~dfsg-1)
esm-apps/jammy_asterisk: not-affected (1:16.15.0~dfsg-1)
kinetic_asterisk: not-affected (1:16.15.0~dfsg-1)
lunar_asterisk: not-affected (1:16.15.0~dfsg-1)
mantic_asterisk: not-affected (1:16.15.0~dfsg-1)
noble_asterisk: not-affected (1:16.15.0~dfsg-1)
esm-apps/noble_asterisk: not-affected (1:16.15.0~dfsg-1)
oracular_asterisk: not-affected (1:16.15.0~dfsg-1)
plucky_asterisk: not-affected (1:16.15.0~dfsg-1)
devel_asterisk: not-affected (1:16.15.0~dfsg-1)
