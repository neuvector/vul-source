Candidate: CVE-2019-19577
PublicDate: 2019-12-11 18:16:00 UTC
References:
 https://xenbits.xen.org/xsa/advisory-311.html
 https://www.cve.org/CVERecord?id=CVE-2019-19577
Description:
 An issue was discovered in Xen through 4.12.x allowing x86 AMD HVM guest OS
 users to cause a denial of service or possibly gain privileges by
 triggering data-structure access during pagetable-height updates. When
 running on AMD systems with an IOMMU, Xen attempted to dynamically adapt
 the number of levels of pagetables (the pagetable height) in the IOMMU
 according to the guest's address space size. The code to select and update
 the height had several bugs. Notably, the update was done without taking a
 lock which is necessary for safe operation. A malicious guest administrator
 can cause Xen to access data structures while they are being modified,
 causing Xen to crash. Privilege escalation is thought to be very difficult
 but cannot be ruled out. Additionally, there is a potential memory leak of
 4kb per guest boot, under memory pressure. Only Xen on AMD CPUs is
 vulnerable. Xen running on Intel CPUs is not vulnerable. ARM systems are
 not vulnerable. Only systems where guests are given direct access to
 physical devices are vulnerable. Systems which do not use PCI pass-through
 are not vulnerable. Only HVM guests can exploit the vulnerability. PV and
 PVH guests cannot. All versions of Xen with IOMMU support are vulnerable.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:P/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H [7.2 HIGH]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: needs-triage
precise/esm_xen: DNE
trusty_xen: ignored (end of standard support)
trusty/esm_xen: DNE
esm-infra-legacy/trusty_xen: DNE
xenial_xen: ignored (end of standard support, was needs-triage)
esm-infra/xenial_xen: needs-triage
bionic_xen: ignored (end of standard support, was needs-triage)
esm-infra/bionic_xen: needs-triage
disco_xen: ignored (end of life)
eoan_xen: ignored (end of life)
focal_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
esm-apps/focal_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
groovy_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
hirsute_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
impish_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
jammy_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
esm-apps/jammy_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
kinetic_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
lunar_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
mantic_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
noble_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
esm-apps/noble_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
oracular_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
plucky_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
devel_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)

