PublicDateAtUSN: 2023-03-29 17:15:00 UTC
Candidate: CVE-2022-48434
PublicDate: 2023-03-29 17:15:00 UTC
References:
 https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/cc867f2c09d2b69cee8a0eccd62aff002cbbfe11 (n6.1-dev)
 https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/35aa7e70e7ec350319e7634a30d8d8aa1e6ecdda (n5.1.2)
 https://wrv.github.io/h26forge.pdf
 https://news.ycombinator.com/item?id=35356201
 https://ubuntu.com/security/notices/USN-6449-1
 https://www.cve.org/CVERecord?id=CVE-2022-48434
Description:
 libavcodec/pthread_frame.c in FFmpeg before 5.1.2, as used in VLC and other
 products, leaves stale hwaccel state in worker threads, which allows
 attackers to trigger a use-after-free and execute arbitrary code in some
 circumstances (e.g., hardware re-initialization upon a mid-video SPS change
 when Direct3D11 is used).
Ubuntu-Description:
Notes:
 ccdm94> As of 2023-04-26 there is no public reproducer available for this issue,
 ccdm94> so there is no way to confirm through vulnerability testing that Xenial
 ccdm94> and Bionic are vulnerable to this issue.
 ccdm94> 
 ccdm94> Xenial's version of FFmpeg is 2.8. Upstream has only provided patches
 ccdm94> for versions 4.4.x, 5.0.x and 5.1.x. Considering that the code for
 ccdm94> pthread_frame.c (file altered by the patch) and for FFmpeg has changed
 ccdm94> significantly from version 2.8 to version 4.4.3, applying the 4.4.3
 ccdm94> patch is very likely to introduce security issues and regressions.
 ccdm94> Because of the very intrusive nature of the backport, Xenial and Bionic
 ccdm94> (at version 3.4) will not be patched for this issue, and will therefore
 ccdm94> be marked as ignored.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: nickgalanis
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]

Patches_ffmpeg:
 upstream: https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/d4b7b3c03ee2baf0166ce49dff17ec9beff684db (4.4.x)
 upstream: https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/3bc28e9d1ab33627cea3c632dd6b0c33e22e93ba (5.0.x)
 upstream: https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/35aa7e70e7ec350319e7634a30d8d8aa1e6ecdda (5.1.x)
 upstream: https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/cc867f2c09d2b69cee8a0eccd62aff002cbbfe11 (n6.1-dev)
upstream_ffmpeg: released (7:5.1.2-1, 5.1.2, 5.0.1, 4.4.3)
trusty_ffmpeg: ignored (end of standard support)
esm-apps/xenial_ffmpeg: ignored (see notes)
xenial_ffmpeg: ignored (end of standard support, was needed)
bionic_ffmpeg: ignored (end of standard support, was needed)
esm-apps/bionic_ffmpeg: released (7:3.4.11-0ubuntu0.1+esm3)
esm-apps/focal_ffmpeg: released (7:4.2.7-0ubuntu0.1+esm3)
focal_ffmpeg: needed
esm-apps/jammy_ffmpeg: released (7:4.4.2-0ubuntu0.22.04.1+esm2)
jammy_ffmpeg: needed
kinetic_ffmpeg: ignored (end of life, was needed)
lunar_ffmpeg: not-affected (7:5.1.2-3ubuntu1)
mantic_ffmpeg: not-affected (7:5.1.2-3ubuntu1)
noble_ffmpeg: not-affected (7:5.1.2-3ubuntu1)
esm-apps/noble_ffmpeg: not-affected (7:5.1.2-3ubuntu1)
oracular_ffmpeg: not-affected (7:5.1.2-3ubuntu1)
plucky_ffmpeg: not-affected (7:5.1.2-3ubuntu1)
devel_ffmpeg: not-affected (7:5.1.2-3ubuntu1)
