Candidate: CVE-2021-43860
PublicDate: 2022-01-12 22:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43860
 https://github.com/flatpak/flatpak/security/advisories/GHSA-qpjc-vq3c-572j
 https://github.com/flatpak/flatpak/releases/tag/1.12.3
 https://github.com/flatpak/flatpak/releases/tag/1.10.6
Description:
 Flatpak is a Linux application sandboxing and distribution framework. Prior
 to versions 1.12.3 and 1.10.6, Flatpak doesn't properly validate that the
 permissions displayed to the user for an app at install time match the
 actual permissions granted to the app at runtime, in the case that there's
 a null byte in the metadata file of an app. Therefore apps can grant
 themselves permissions without the consent of the user. Flatpak shows
 permissions to the user during install by reading them from the
 "xa.metadata" key in the commit metadata. This cannot contain a null
 terminator, because it is an untrusted GVariant. Flatpak compares these
 permissions to the *actual* metadata, from the "metadata" file to ensure it
 wasn't lied to. However, the actual metadata contents are loaded in several
 places where they are read as simple C-style strings. That means that, if
 the metadata file includes a null terminator, only the content of the file
 from *before* the terminator gets compared to xa.metadata. Thus, any
 permissions that appear in the metadata file after a null terminator are
 applied at runtime but not shown to the user. So maliciously crafted apps
 can give themselves hidden permissions. Users who have Flatpaks installed
 from untrusted sources are at risk in case the Flatpak has a maliciously
 crafted metadata file, either initially or in an update. This issue is
 patched in versions 1.12.3 and 1.10.6. As a workaround, users can manually
 check the permissions of installed apps by checking the metadata file or
 the xa.metadata key on the commit metadata.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/flatpak/+bug/1957716
Priority: medium
Discovered-by: Ryan Gonzalez
Assigned-to: alexmurray
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H [8.6 HIGH]


Patches_flatpak:
 upstream: https://github.com/flatpak/flatpak/commit/ba818f504c926baaf6e362be8159cfacf994310e
 upstream: https://github.com/flatpak/flatpak/commit/d9a8f9d8ccc0b7c1135d0ecde006a75d25f66aee
 upstream: https://github.com/flatpak/flatpak/commit/93357d357119093804df05acc32ff335839c6451
 upstream: https://github.com/flatpak/flatpak/commit/65cbfac982cb1c83993a9e19aa424daee8e9f042
 upstream: https://github.com/flatpak/flatpak/commit/54ec1a482dfc668127eaae57f135e6a8e0bc52da
upstream_flatpak: released (1.12.3-1)
trusty_flatpak: ignored (out of standard support)
xenial_flatpak: ignored (out of standard support)
bionic_flatpak: ignored (end of standard support, was needs-triage)
esm-apps/bionic_flatpak: needs-triage
focal_flatpak: needs-triage
esm-apps/focal_flatpak: needs-triage
hirsute_flatpak: ignored (reached end-of-life)
impish_flatpak: ignored (reached end-of-life)
jammy_flatpak: needs-triage
esm-apps/jammy_flatpak: needs-triage
kinetic_flatpak: needs-triage
lunar_flatpak: not-affected (1.14.0-2)
devel_flatpak: not-affected (1.14.0-2)
