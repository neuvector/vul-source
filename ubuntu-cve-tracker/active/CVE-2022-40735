PublicDateAtUSN: 2022-11-14 23:15:00 UTC
Candidate: CVE-2022-40735
PublicDate: 2022-11-14 23:15:00 UTC
References:
 https://github.com/mozilla/ssl-config-generator/issues/162
 https://link.springer.com/content/pdf/10.1007/3-540-68339-9_29.pdf
 https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf
 https://www.researchgate.net/profile/Anton-Stiglic-2/publication/2401745_Security_Issues_in_the_Diffie-Hellman_Key_Agreement_Protocol/links/546c144f0cf20dedafd53e7e/Security-Issues-in-the-Diffie-Hellman-Key-Agreement-Protocol.pdf
 https://gist.github.com/c0r0n3r/9455ddcab985c50fd1912eabf26e058b
 https://www.rfc-editor.org/rfc/rfc4419
 https://www.rfc-editor.org/rfc/rfc7919#section-5.2
 https://www.rfc-editor.org/rfc/rfc3526
 https://raw.githubusercontent.com/CVEProject/cvelist/9d7fbbcabd3f44cfedc9e8807757d31ece85a2c6/2022/40xxx/CVE-2022-40735.json
 https://www.rfc-editor.org/rfc/rfc5114#section-4
 https://github.com/openssl/openssl/pull/18480
 https://ieeexplore.ieee.org/document/10374117
 https://www.cve.org/CVERecord?id=CVE-2022-40735
 https://ubuntu.com/security/notices/USN-6854-1
Description:
 The Diffie-Hellman Key Agreement Protocol allows use of long exponents that
 arguably make certain calculations unnecessarily expensive, because the
 1996 van Oorschot and Wiener paper found that "(appropriately) short
 exponents" can be used when there are adequate subgroup constraints, and
 these short exponents can lead to less expensive calculations than for long
 exponents. This issue is different from CVE-2002-20001 because it is based
 on an observation about exponent size, rather than an observation about
 numbers that are not public keys. The specific situations in which
 calculation expense would constitute a server-side vulnerability depend on
 the protocol (e.g., TLS, SSH, or IKE) and the DHE implementation details.
 In general, there might be an availability concern because of server-side
 resource consumption from DHE modular-exponentiation calculations. Finally,
 it is possible for an attacker to exploit this vulnerability and
 CVE-2002-20001 together.
Ubuntu-Description:
 It was discovered that OpenSSL failed to choose an appropriately short
 private key size when computing shared-secrets in the Diffie-Hellman Key
 Agreement Protocol. A remote attacker could possibly use this issue to
 cause OpenSSL to consume resources, resulting in a denial of service.
Notes:
 alexmurray> It would appear upstream openssl fixed this in 3.1.0 via
  https://github.com/openssl/openssl/pull/18480
 mdeslaur> This was backported to 3.0.6 via
  https://github.com/openssl/openssl/pull/18793
 mdeslaur> doesn't affect 1.x
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: alexmurray
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_openssl:
 upstream: https://github.com/openssl/openssl/commit/8ed6ddcaa559b7b04202c15ea3a95ee0b05caeba (3.0)
 upstream: https://github.com/openssl/openssl/commit/c9bdbc12ac7343992ba249e11d2bda3338469a97 (3.0)
 upstream: https://github.com/openssl/openssl/commit/5eac066bef0c23bb74255423d335e634e4deb8d5 (3.0)
 upstream: https://github.com/openssl/openssl/commit/ce4579adf94d5f26e566a1e04c8a52ec5943cdd0 (3.0)
upstream_openssl: released (3.0.6)
trusty_openssl: ignored (end of standard support)
trusty/esm_openssl: not-affected (3.x only)
esm-infra-legacy/trusty_openssl: not-affected (3.x only)
xenial_openssl: ignored (end of standard support)
esm-infra/xenial_openssl: not-affected (3.x only)
fips-updates/xenial_openssl: not-affected (3.x only)
fips/xenial_openssl: not-affected (3.x only)
bionic_openssl: ignored (end of standard support, was needs-triage)
esm-infra/bionic_openssl: not-affected (3.x only)
fips-updates/bionic_openssl: not-affected (3.x only)
fips-updates/focal_openssl: not-affected (1.1.1f-1ubuntu2.22)
fips/bionic_openssl: not-affected (3.x only)
fips/focal_openssl: not-affected (1.1.1f-1ubuntu2.22)
focal_openssl: not-affected (1.1.1f-1ubuntu2.22)
esm-infra/focal_openssl: not-affected (1.1.1f-1ubuntu2.22)
jammy_openssl: released (3.0.2-0ubuntu1.16)
fips-preview/jammy_openssl: needed
fips-updates/jammy_openssl: released (3.0.2-0ubuntu1.16+Fips1)
kinetic_openssl: ignored (end of life, was needs-triage)
lunar_openssl: ignored (end of life, was needs-triage)
mantic_openssl: not-affected (3.0.10-1ubuntu2.3)
noble_openssl: not-affected (3.0.13-0ubuntu3)
oracular_openssl: not-affected (3.0.13-0ubuntu3)
plucky_openssl: not-affected (3.0.13-0ubuntu3)
devel_openssl: not-affected (3.0.13-0ubuntu3)

Patches_openssl1.0:
upstream_openssl1.0: needed
trusty_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: ignored (end of standard support, was needs-triage)
esm-infra/bionic_openssl1.0: not-affected (3.x only)
focal_openssl1.0: DNE
esm-infra/focal_openssl1.0: DNE
jammy_openssl1.0: DNE
kinetic_openssl1.0: DNE
lunar_openssl1.0: DNE
mantic_openssl1.0: DNE
noble_openssl1.0: DNE
oracular_openssl1.0: DNE
plucky_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
trusty_nodejs: ignored (end of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
esm-infra-legacy/trusty_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl)
esm-apps/focal_nodejs: not-affected (uses system openssl)
jammy_nodejs: needed
esm-apps/jammy_nodejs: needed
kinetic_nodejs: not-affected (uses system openssl)
lunar_nodejs: not-affected (uses system openssl)
mantic_nodejs: not-affected (uses system openssl)
noble_nodejs: not-affected (uses system openssl)
esm-apps/noble_nodejs: not-affected (uses system openssl)
oracular_nodejs: not-affected (uses system openssl)
plucky_nodejs: not-affected (uses system openssl)
devel_nodejs: not-affected (uses system openssl)

Patches_edk2:
upstream_edk2: needs-triage
trusty_edk2: ignored (end of standard support)
xenial_edk2: ignored (end of standard support)
esm-apps/xenial_edk2: not-affected (3.x only)
bionic_edk2: ignored (end of standard support, was needs-triage)
esm-apps/bionic_edk2: not-affected (3.x only)
focal_edk2: not-affected (3.x only)
esm-infra/focal_edk2: not-affected (3.x only)
jammy_edk2: not-affected (3.x only)
kinetic_edk2: ignored (end of life, was needs-triage)
lunar_edk2: ignored (end of life, was deferred)
mantic_edk2: not-affected (3.x only)
noble_edk2: not-affected (contains 3.0.9)
oracular_edk2: not-affected (contains 3.0.9)
plucky_edk2: not-affected (contains 3.0.9)
devel_edk2: not-affected (contains 3.0.9)
