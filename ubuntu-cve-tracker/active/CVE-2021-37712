Candidate: CVE-2021-37712
PublicDate: 2021-08-31 17:15:00 UTC
References:
 https://github.com/npm/node-tar/security/advisories/GHSA-qq89-hq3f-393p
 https://www.npmjs.com/package/tar
 https://www.cve.org/CVERecord?id=CVE-2021-37712
Description:
 The npm package "tar" (aka node-tar) before versions 4.4.18, 5.0.10, and
 6.1.9 has an arbitrary file creation/overwrite and arbitrary code execution
 vulnerability. node-tar aims to guarantee that any file whose location
 would be modified by a symbolic link is not extracted. This is, in part,
 achieved by ensuring that extracted directories are not symlinks.
 Additionally, in order to prevent unnecessary stat calls to determine
 whether a given path is a directory, paths are cached when directories are
 created. This logic was insufficient when extracting tar files that
 contained both a directory and a symlink with names containing unicode
 values that normalized to the same value. Additionally, on Windows systems,
 long path portions would resolve to the same file system entities as their
 8.3 "short path" counterparts. A specially crafted tar archive could thus
 include a directory with one form of the path, followed by a symbolic link
 with a different string that resolves to the same file system entity,
 followed by a file using the first form. By first creating a directory, and
 then replacing that directory with a symlink that had a different apparent
 name that resolved to the same entry in the filesystem, it was thus
 possible to bypass node-tar symlink checks on directories, essentially
 allowing an untrusted tar file to symlink into an arbitrary location and
 subsequently extracting arbitrary files into that location, thus allowing
 arbitrary file creation and overwrite. These issues were addressed in
 releases 4.4.18, 5.0.10 and 6.1.9. The v3 branch of node-tar has been
 deprecated and did not receive patches for these issues. If you are still
 using a v3 release we recommend you update to a more recent version of
 node-tar. If this is not possible, a workaround is available in the
 referenced GHSA-qq89-hq3f-393p.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N [8.2 HIGH]
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H [8.6 HIGH]


Patches_node-tar:
upstream_node-tar: needs-triage
trusty_node-tar: ignored (end of standard support)
trusty/esm_node-tar: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_node-tar: needs-triage
xenial_node-tar: ignored (end of standard support)
esm-apps/xenial_node-tar: needs-triage
bionic_node-tar: ignored (end of standard support, was needs-triage)
esm-apps/bionic_node-tar: needs-triage
focal_node-tar: ignored (end of standard support, was needs-triage)
esm-apps/focal_node-tar: needs-triage
hirsute_node-tar: ignored (end of life)
impish_node-tar: ignored (end of life)
jammy_node-tar: needs-triage
esm-apps/jammy_node-tar: needs-triage
kinetic_node-tar: ignored (end of life, was needs-triage)
lunar_node-tar: ignored (end of life, was needs-triage)
mantic_node-tar: ignored (end of life, was needs-triage)
noble_node-tar: needs-triage
esm-apps/noble_node-tar: needs-triage
oracular_node-tar: needs-triage
plucky_node-tar: needs-triage
devel_node-tar: needs-triage
