PublicDateAtUSN: 2024-05-06 15:15:00 UTC
Candidate: CVE-2024-34064
PublicDate: 2024-05-06 15:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-34064
 https://github.com/pallets/jinja/security/advisories/GHSA-h75v-3vvj-5mfj
 https://github.com/pallets/jinja/commit/0668239dc6b44ef38e7a6c9f91f312fd4ca581cb
 https://ubuntu.com/security/notices/USN-6787-1
Description:
 Jinja is an extensible templating engine. The `xmlattr` filter in affected
 versions of Jinja accepts keys containing non-attribute characters.
 XML/HTML attributes cannot contain spaces, `/`, `>`, or `=`, as each would
 then be interpreted as starting a separate attribute. If an application
 accepts keys (as opposed to only values) as user input, and renders these
 in pages that other users see as well, an attacker could use this to inject
 other attributes and perform XSS. The fix for CVE-2024-22195 only addressed
 spaces but not other characters. Accepting keys as user input is now
 explicitly considered an unintended use case of the `xmlattr` filter, and
 code that does so without otherwise validating the input should be flagged
 as insecure, regardless of Jinja version. Accepting _values_ as user input
 continues to be safe. This vulnerability is fixed in 3.1.4.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: nickgalanis
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N [5.4 MEDIUM]
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N [5.4 MEDIUM]

Patches_jinja2:
upstream_jinja2: released (3.1.4)
trusty/esm_jinja2: released (2.7.2-2ubuntu0.1~esm3)
esm-infra-legacy/trusty_jinja2: not-affected (2.7.2-2ubuntu0.1~esm3)
esm-infra/xenial_jinja2: released (2.8-1ubuntu0.1+esm3)
esm-infra/bionic_jinja2: released (2.10-1ubuntu0.18.04.1+esm2)
focal_jinja2: released (2.10.1-2ubuntu0.3)
jammy_jinja2: released (3.0.3-1ubuntu0.2)
mantic_jinja2: released (3.1.2-1ubuntu0.23.10.2)
noble_jinja2: released (3.1.2-1ubuntu1.1)
oracular_jinja2: released (3.1.3-1ubuntu1)
plucky_jinja2: released (3.1.3-1ubuntu1)
devel_jinja2: released (3.1.3-1ubuntu1)
