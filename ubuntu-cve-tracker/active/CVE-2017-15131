Candidate: CVE-2017-15131
PublicDate: 2018-01-09 21:29:00 UTC
References:
 http://bugs.freedesktop.org/show_bug.cgi?id=102303
 https://bugzilla.redhat.com/show_bug.cgi?id=1412762
 https://www.cve.org/CVERecord?id=CVE-2017-15131
Description:
 It was found that system umask policy is not being honored when creating
 XDG user directories, since Xsession sources xdg-user-dirs.sh before
 setting umask policy. This only affects xdg-user-dirs before 0.15.5 as
 shipped with Red Hat Enterprise Linux.
Ubuntu-Description:
Notes:
 seth-arnold> This feels like a fundamental misunderstanding of Unix model to
  assume that every task run on behalf of a user will be started as a child
  process of bash or sh run as an interactive or login shell.
 seth-arnold> Environments that want a specific umask set for users should use
  the pam_umask(8) module as part of the login process.
 seth-arnold> Environments that need a specific umask set for compliance reasons
  should investigate the feasibility of preparing a single-purpose LSM or
  seccomp jail interface of some sort.
 rodrigo-zaiden> pam_umask is being used to set umask when an interactive
  session is started, so Ubuntu is not affected by this CVE.
Bugs:
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_xdg-user-dirs:
upstream_xdg-user-dirs: not-affected (Red Hat specific)
precise/esm_xdg-user-dirs: DNE
trusty_xdg-user-dirs: ignored (end of standard support)
trusty/esm_xdg-user-dirs: DNE (trusty was needs-triage)
esm-infra-legacy/trusty_xdg-user-dirs: DNE (trusty/esm was DNE [trusty was needs-triage])
xenial_xdg-user-dirs: ignored (end of standard support, was needed)
esm-infra/xenial_xdg-user-dirs: not-affected
zesty_xdg-user-dirs: ignored (end of life)
artful_xdg-user-dirs: ignored (end of life)
bionic_xdg-user-dirs: not-affected
esm-infra/bionic_xdg-user-dirs: not-affected
cosmic_xdg-user-dirs: ignored (end of life)
disco_xdg-user-dirs: ignored (end of life)
eoan_xdg-user-dirs: ignored (end of life)
focal_xdg-user-dirs: not-affected
groovy_xdg-user-dirs: ignored (end of life)
hirsute_xdg-user-dirs: ignored (end of life)
impish_xdg-user-dirs: not-affected
jammy_xdg-user-dirs: needs-triage
kinetic_xdg-user-dirs: not-affected
lunar_xdg-user-dirs: not-affected
mantic_xdg-user-dirs: not-affected
noble_xdg-user-dirs: not-affected
oracular_xdg-user-dirs: not-affected
plucky_xdg-user-dirs: not-affected
devel_xdg-user-dirs: not-affected
