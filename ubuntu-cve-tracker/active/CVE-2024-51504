Candidate: CVE-2024-51504
PublicDate: 2024-11-07 10:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-51504
 https://lists.apache.org/thread/b3qrmpkto5r6989qr61fw9y2x646kqlh
Description:
 When using IPAuthenticationProvider in ZooKeeper Admin Server there is a
 possibility of Authentication Bypass by Spoofing -- this only impacts IP
 based authentication implemented in ZooKeeper Admin Server. Default
 configuration of client's IP address detection in IPAuthenticationProvider,
 which uses HTTP request headers, is weak and allows an attacker to bypass
 authentication via spoofing client's IP address in request headers. Default
 configuration honors X-Forwarded-For HTTP header to read client's IP
 address. X-Forwarded-For request header is mainly used by proxy servers to
 identify the client and can be easily spoofed by an attacker pretending
 that the request comes from a different IP address. Admin Server commands,
 such as snapshot and restore arbitrarily can be executed on successful
 exploitation which could potentially lead to information leakage or service
 availability issues. Users are recommended to upgrade to version 3.9.3,
 which fixes this issue.
Ubuntu-Description:
Notes:
 ej7367> Affects 3.9.x before 3.9.3
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H [9.1 CRITICAL]

Patches_zookeeper:
 upstream: https://github.com/apache/zookeeper/commit/bd5be58c562ce992de8af43cdef0bdb34261a525
 upstream: https://github.com/apache/zookeeper/commit/67037ad9087b4e554f77427e88d40df1eb19d6d3
upstream_zookeeper: released (3.9.3)
esm-infra-legacy/trusty_zookeeper: not-affected (3.4.5+dfsg-1ubuntu0.1~esm3)
trusty/esm_zookeeper: ignored (end of ESM support, was needs-triage)
esm-apps/xenial_zookeeper: not-affected (3.4.8-1ubuntu0.1~esm2)
esm-apps/bionic_zookeeper: not-affected (3.4.13-3ubuntu0.1~esm1)
focal_zookeeper: ignored (end of standard support, was needs-triage)
esm-apps/focal_zookeeper: not-affected (3.4.13-5ubuntu0.1)
jammy_zookeeper: not-affected (3.4.13-6ubuntu4.1)
esm-apps/jammy_zookeeper: not-affected (3.4.13-6ubuntu4.1)
noble_zookeeper: needed
esm-apps/noble_zookeeper: needed
oracular_zookeeper: ignored (end of life, was needs-triage)
plucky_zookeeper: not-affected (3.9.3-1build1)
devel_zookeeper: not-affected (3.9.3-1build2)
