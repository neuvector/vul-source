Candidate: CVE-2025-43857
PublicDate: 2025-04-28 16:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-43857
 https://github.com/ruby/net-imap/security/advisories/GHSA-j3g3-5qv5-52mj
Description:
 Net::IMAP implements Internet Message Access Protocol (IMAP) client
 functionality in Ruby. Prior to versions 0.5.7, 0.4.20, 0.3.9, and 0.2.5,
 there is a possibility for denial of service by memory exhaustion when
 net-imap reads server responses. At any time while the client is connected,
 a malicious server can send can send a "literal" byte count, which is
 automatically read by the client's receiver thread. The response reader
 immediately allocates memory for the number of bytes indicated by the
 server response. This should not be an issue when securely connecting to
 trusted IMAP servers that are well-behaved. It can affect insecure
 connections and buggy, untrusted, or compromised servers (for example,
 connecting to a user supplied hostname). This issue has been patched in
 versions 0.5.7, 0.4.20, 0.3.9, and 0.2.5.
Ubuntu-Description:
Notes:
 mdeslaur> ruby3.0 contains net-imap 0.1.1
 mdeslaur> ruby3.2 contains net-imap 0.3.4.1
 mdeslaur> ruby3.3 contains net-imap 0.4.9.1
 mdeslaur>
 mdeslaur> This fix introduces a new max_response_size to the API, but does
 mdeslaur> not set a limited default to remain backwards compatible. Adding
 mdeslaur> the upstream fix to stable releases will not result in this CVE
 mdeslaur> being mitigated without individual applications using the API to
 mdeslaur> be modified to use the new parameter. In addition, there are
 mdeslaur> still other ways a malicious server could cause memory
 mdeslaur> consumption on clients.
 mdeslaur>
 mdeslaur> Since this issue is only a memory consumption issue when
 mdeslaur> connecting to untrusted servers via IMAP, and since the upstream
 mdeslaur> fix doesn't actually change behaviour and would also require
 mdeslaur> software using net-imap to use the new option, marking this
 mdeslaur> CVE as being low priority.
Mitigation:
Bugs:
Priority: low
 Only a memory consumption issue when connecting to untrusted IMAP servers
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]
 github: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X [6.0 MEDIUM]

Patches_ruby2.3:
upstream_ruby2.3: not-affected (code not present)
esm-infra/xenial_ruby2.3: not-affected (code not present)
focal_ruby2.3: DNE
esm-infra/focal_ruby2.3: DNE
jammy_ruby2.3: DNE
noble_ruby2.3: DNE
oracular_ruby2.3: DNE
plucky_ruby2.3: DNE
devel_ruby2.3: DNE

Patches_ruby2.5:
upstream_ruby2.5: needs-triage
esm-infra/bionic_ruby2.5: needs-triage
focal_ruby2.5: DNE
esm-infra/focal_ruby2.5: DNE
jammy_ruby2.5: DNE
noble_ruby2.5: DNE
oracular_ruby2.5: DNE
plucky_ruby2.5: DNE
devel_ruby2.5: DNE

Patches_ruby2.7:
upstream_ruby2.7: needs-triage
focal_ruby2.7: ignored (end of standard support, was needs-triage)
esm-infra/focal_ruby2.7: needs-triage
jammy_ruby2.7: DNE
noble_ruby2.7: DNE
oracular_ruby2.7: DNE
plucky_ruby2.7: DNE
devel_ruby2.7: DNE

Patches_ruby3.0:
 upstream: https://github.com/ruby/net-imap/pull/447 (0.2)
upstream_ruby3.0: needs-triage
focal_ruby3.0: DNE
esm-infra/focal_ruby3.0: DNE
jammy_ruby3.0: needs-triage
noble_ruby3.0: DNE
oracular_ruby3.0: DNE
plucky_ruby3.0: DNE
devel_ruby3.0: DNE

Patches_ruby3.2:
 upstream: https://github.com/ruby/net-imap/pull/446
upstream_ruby3.2: needs-triage
focal_ruby3.2: DNE
esm-infra/focal_ruby3.2: DNE
jammy_ruby3.2: DNE
noble_ruby3.2: needs-triage
oracular_ruby3.2: DNE
plucky_ruby3.2: DNE
devel_ruby3.2: DNE

Patches_ruby3.3:
 upstream: https://github.com/ruby/net-imap/pull/445
upstream_ruby3.3: needs-triage
focal_ruby3.3: DNE
esm-infra/focal_ruby3.3: DNE
jammy_ruby3.3: DNE
noble_ruby3.3: DNE
oracular_ruby3.3: needs-triage
plucky_ruby3.3: needs-triage
devel_ruby3.3: needs-triage

Patches_jruby:
upstream_jruby: needs-triage
esm-infra-legacy/trusty_jruby: needs-triage
esm-apps/xenial_jruby: needs-triage
esm-apps/bionic_jruby: needs-triage
focal_jruby: ignored (end of standard support, was needs-triage)
esm-apps/focal_jruby: needs-triage
jammy_jruby: DNE
noble_jruby: needs-triage
esm-apps/noble_jruby: needs-triage
oracular_jruby: needs-triage
plucky_jruby: needs-triage
devel_jruby: needs-triage
