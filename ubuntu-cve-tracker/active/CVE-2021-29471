Candidate: CVE-2021-29471
PublicDate: 2021-05-11 15:15:00 UTC
References:
 https://github.com/matrix-org/synapse/security/advisories/GHSA-x345-32rc-8h85
 https://github.com/matrix-org/synapse/commit/03318a766cac9f8b053db2214d9c332a977d226c (v1.33.2)
 https://github.com/matrix-org/synapse/releases/tag/v1.33.2
 https://www.cve.org/CVERecord?id=CVE-2021-29471
Description:
 Synapse is a Matrix reference homeserver written in python (pypi package
 matrix-synapse). Matrix is an ecosystem for open federated Instant
 Messaging and VoIP. In Synapse before version 1.33.2 "Push rules" can
 specify conditions under which they will match, including `event_match`,
 which matches event content against a pattern including wildcards. Certain
 patterns can cause very poor performance in the matching engine, leading to
 a denial-of-service when processing moderate length events. The issue is
 patched in version 1.33.2. A potential workaround might be to prevent users
 from making custom push rules, by blocking such requests at a
 reverse-proxy.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: 
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L [5.3 MEDIUM]


Patches_matrix-synapse:
 upstream: https://github.com/matrix-org/synapse/commit/03318a766cac9f8b053db2214d9c332a977d226c
upstream_matrix-synapse: released (1.33.2-1)
precise/esm_matrix-synapse: DNE
trusty_matrix-synapse: ignored (end of standard support)
trusty/esm_matrix-synapse: DNE
esm-infra-legacy/trusty_matrix-synapse: DNE
xenial_matrix-synapse: ignored (end of standard support)
bionic_matrix-synapse: ignored (end of standard support, was needed)
esm-apps/bionic_matrix-synapse: needed
focal_matrix-synapse: needed
esm-apps/focal_matrix-synapse: needed
groovy_matrix-synapse: ignored (end of life)
hirsute_matrix-synapse: ignored (end of life)
impish_matrix-synapse: ignored (end of life)
jammy_matrix-synapse: needed
esm-apps/jammy_matrix-synapse: needed
kinetic_matrix-synapse: ignored (end of life, was needed)
lunar_matrix-synapse: not-affected (1.64.0-3)
mantic_matrix-synapse: not-affected (1.64.0-3)
noble_matrix-synapse: not-affected (1.64.0-3)
esm-apps/noble_matrix-synapse: not-affected (1.64.0-3)
oracular_matrix-synapse: not-affected (1.64.0-3)
