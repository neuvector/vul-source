Candidate: CVE-2022-31108
PublicDate: 2022-06-28 19:15:00 UTC
References:
 https://github.com/mermaid-js/mermaid/security/advisories/GHSA-x3vm-38hw-55wf
 https://github.com/mermaid-js/mermaid/commit/0ae1bdb61adff1cd485caff8c62ec6b8ac57b225
 https://www.cve.org/CVERecord?id=CVE-2022-31108
Description:
 Mermaid is a JavaScript based diagramming and charting tool that uses
 Markdown-inspired text definitions and a renderer to create and modify
 complex diagrams. An attacker is able to inject arbitrary `CSS` into the
 generated graph allowing them to change the styling of elements outside of
 the generated graph, and potentially exfiltrate sensitive information by
 using specially crafted `CSS` selectors. The following example shows how an
 attacker can exfiltrate the contents of an input field by bruteforcing the
 `value` attribute one character at a time. Whenever there is an actual
 match, an `http` request will be made by the browser in order to "load" a
 background image that will let an attacker know what's the value of the
 character. This issue may lead to `Information Disclosure` via CSS
 selectors and functions able to generate HTTP requests. This also allows an
 attacker to change the document in ways which may lead a user to perform
 unintended actions, such as clicking on a link, etc. This issue has been
 resolved in version 9.1.3. Users are advised to upgrade. Users unable to
 upgrade should ensure that user input is adequately escaped before
 embedding it in CSS blocks.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N [4.1 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N [6.1 MEDIUM]


Patches_node-mermaid:
 upstream: https://github.com/mermaid-js/mermaid/commit/0ae1bdb61adff1cd485caff8c62ec6b8ac57b225
upstream_node-mermaid: released (9.1.3)
trusty_node-mermaid: DNE
xenial_node-mermaid: DNE
bionic_node-mermaid: DNE
focal_node-mermaid: DNE
esm-infra/focal_node-mermaid: DNE
impish_node-mermaid: ignored (end of life)
jammy_node-mermaid: needs-triage
esm-apps/jammy_node-mermaid: needs-triage
kinetic_node-mermaid: ignored (end of life, was needs-triage)
lunar_node-mermaid: DNE
mantic_node-mermaid: DNE
noble_node-mermaid: DNE
oracular_node-mermaid: DNE
plucky_node-mermaid: DNE
questing_node-mermaid: DNE
devel_node-mermaid: DNE
