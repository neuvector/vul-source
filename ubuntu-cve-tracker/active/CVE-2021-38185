PublicDateAtUSN: 2021-08-08 00:15:00 UTC
Candidate: CVE-2021-38185
PublicDate: 2021-08-08 00:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38185
 https://github.com/fangqyi/cpiopwn
 https://lists.gnu.org/archive/html/bug-cpio/2021-08/msg00000.html
 https://lists.gnu.org/archive/html/bug-cpio/2021-08/msg00002.html
 https://ubuntu.com/security/notices/USN-5064-1
 https://ubuntu.com/security/notices/USN-5064-2
Description:
 GNU cpio through 2.13 allows attackers to execute arbitrary code via a
 crafted pattern file, because of a dstring.c ds_fgetstr integer overflow
 that triggers an out-of-bounds heap write. NOTE: it is unclear whether
 there are common cases where the pattern file, associated with the -E
 option, is untrusted data.
Ubuntu-Description:
Notes:
 mdeslaur> second commit fixes a regression. There seems to still be a
 mdeslaur> regression even with the second commit as it is causing the
 mdeslaur> kernel to FTBFS.
 mdeslaur> Also see debian bugs for regressions.
 mdeslaur> the third commit likely fixes the kernel regressions
Mitigation:
Bugs:
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=992098
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=992192
Priority: medium
Discovered-by: Maverick Chung and Qiaoyi Fang
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_cpio:
 upstream: https://git.savannah.gnu.org/cgit/cpio.git/commit/?id=dd96882877721703e19272fe25034560b794061b
 upstream: https://git.savannah.gnu.org/cgit/cpio.git/commit/?id=dfc801c44a93bed7b3951905b188823d6a0432c8
 upstream: https://git.savannah.gnu.org/cgit/cpio.git/commit/?id=236684f6deb3178043fe72a8e2faca538fa2aae1
upstream_cpio: released (2.13+dfsg-5)
trusty_cpio: ignored (end of standard support)
trusty/esm_cpio: needed
xenial_cpio: ignored (end of standard support)
esm-infra/xenial_cpio: released (2.11+dfsg-5ubuntu1.1+esm1)
bionic_cpio: released (2.12+dfsg-6ubuntu0.18.04.4)
esm-infra/bionic_cpio: released (2.12+dfsg-6ubuntu0.18.04.4)
focal_cpio: released (2.13+dfsg-2ubuntu0.3)
hirsute_cpio: released (2.13+dfsg-4ubuntu0.3)
impish_cpio: released (2.13+dfsg-4ubuntu4)
jammy_cpio: released (2.13+dfsg-4ubuntu4)
kinetic_cpio: released (2.13+dfsg-4ubuntu4)
lunar_cpio: released (2.13+dfsg-4ubuntu4)
devel_cpio: released (2.13+dfsg-4ubuntu4)
