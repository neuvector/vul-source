Candidate: CVE-2025-59840
PublicDate: 2025-11-13 20:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-59840
 https://github.com/vega/vega/security/advisories/GHSA-7f2v-3qq3-vvjf
Description:
 Vega is a visualization grammar, a declarative format for creating, saving,
 and sharing interactive visualization designs. In Vega prior to version
 6.2.0, applications meeting 2 conditions are at risk of arbitrary
 JavaScript code execution, even if "safe mode" expressionInterpreter is
 used. They are vulnerable if they use `vega` in an application that
 attaches `vega` library and a `vega.View` instance similar to the Vega
 Editor to the global `window` and if they allow user-defined Vega `JSON`
 definitions (vs JSON that was is only provided through source code).
 Patches are available in the following Vega applications. If using the
 latest Vega line (6.x), upgrade to `vega` `6.2.0` / `vega-expression`
 `6.1.0` / `vega-interpreter`  `2.2.1` (if using AST evaluator mode). If
 using Vega in a non-ESM environment, upgrade to `vega-expression` `5.2.1` /
 `1.2.1` (if using AST evaluator mode). Some workarounds are available. Do
 not attach `vega` View instances to global variables, and do not attach
 `vega` to the global window. These practices of attaching the vega library
 and View instances may be convenient for debugging, but should not be used
 in production or in any situation where vega/vega-lite definitions could be
 provided by untrusted parties.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1125183
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N [8.1 HIGH]

Patches_vega.js:
upstream_vega.js: needs-triage
jammy_vega.js: DNE
noble_vega.js: needs-triage
esm-apps/noble_vega.js: needs-triage
plucky_vega.js: ignored (end of life, was needs-triage)
questing_vega.js: needs-triage
devel_vega.js: needs-triage
