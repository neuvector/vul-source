Candidate: CVE-2024-23944
PublicDate: 2024-03-15 11:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2024/03/14/2
 https://lists.apache.org/thread/96s5nqssj03rznz9hv58txdb2k1lr79k
 https://www.cve.org/CVERecord?id=CVE-2024-23944
Description:
 Information disclosure in persistent watchers handling in Apache ZooKeeper
 due to missing ACL check. It allows an attacker to monitor child znodes by
 attaching a persistent watcher (addWatch command) to a parent which the
 attacker has already access to. ZooKeeper server doesn't do ACL check when
 the persistent watcher is triggered and as a consequence, the full path of
 znodes that a watch event gets triggered upon is exposed to the owner of
 the watcher. It's important to note that only the path is exposed by this
 vulnerability, not the data of znode, but since znode path can contain
 sensitive information like user name or login ID, this issue is potentially
 critical.
 
 Users are recommended to upgrade to version 3.9.2, 3.8.4 which fixes the
 issue.
Ubuntu-Description:
Notes:
 ej7367> Affects 3.9.0 through 3.9.1, 3.8.0 through 3.8.3, and 3.6.0 through
 ej7367> 3.7.2
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1066947
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L [5.3 MEDIUM]

Patches_zookeeper:
 upstream: https://github.com/apache/zookeeper/commit/65b91d2d9a56157285c2a86b106e67c26520b01d
 upstream: https://github.com/apache/zookeeper/commit/daf7cfd04005cff1a4f7cab5ab13d41db88d0cd8
upstream_zookeeper: released (3.9.2, 3.8.4)
trusty/esm_zookeeper: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_zookeeper: not-affected (3.4.5+dfsg-1ubuntu0.1~esm3)
esm-apps/xenial_zookeeper: not-affected (3.4.8-1ubuntu0.1~esm2)
esm-apps/bionic_zookeeper: not-affected (3.4.13-3ubuntu0.1~esm1)
focal_zookeeper: ignored (end of standard support, was needs-triage)
esm-apps/focal_zookeeper: not-affected (3.4.13-5ubuntu0.1)
jammy_zookeeper: not-affected (3.4.13-6ubuntu4.1)
esm-apps/jammy_zookeeper: not-affected (3.4.13-6ubuntu4.1)
mantic_zookeeper: ignored (end of life, was needs-triage)
noble_zookeeper: needed
esm-apps/noble_zookeeper: needed
oracular_zookeeper: ignored (end of life, was needs-triage)
plucky_zookeeper: not-affected (3.9.3-1build1)
questing_zookeeper: not-affected (3.9.3-1build2)
devel_zookeeper: not-affected (3.9.3-1build2)
