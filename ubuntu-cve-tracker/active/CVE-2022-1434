PublicDateAtUSN: 2022-05-03
Candidate: CVE-2022-1434
PublicDate: 2022-05-03 16:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1434
 https://mta.openssl.org/pipermail/openssl-announce/2022-May/000224.html
 https://ubuntu.com/security/notices/USN-5402-1
Description:
 The OpenSSL 3.0 implementation of the RC4-MD5 ciphersuite incorrectly uses
 the AAD data as the MAC key. This makes the MAC key trivially predictable.
 An attacker could exploit this issue by performing a man-in-the-middle
 attack to modify data being sent from one endpoint to an OpenSSL 3.0
 recipient such that the modified data would still pass the MAC integrity
 check. Note that data sent from an OpenSSL 3.0 endpoint to a non-OpenSSL
 3.0 endpoint will always be rejected by the recipient and the connection
 will fail at that point. Many application protocols require data to be sent
 from the client to the server first. Therefore, in such a case, only an
 OpenSSL 3.0 server would be impacted when talking to a non-OpenSSL 3.0
 client. If both endpoints are OpenSSL 3.0 then the attacker could modify
 data being sent in both directions. In this case both clients and servers
 could be affected, regardless of the application protocol. Note that in the
 absence of an attacker this bug means that an OpenSSL 3.0 endpoint
 communicating with a non-OpenSSL 3.0 endpoint will fail to complete the
 handshake when using this ciphersuite. The confidentiality of data is not
 impacted by this issue, i.e. an attacker cannot decrypt data that has been
 encrypted using this ciphersuite - they can only modify it. In order for
 this attack to work both endpoints must legitimately negotiate the RC4-MD5
 ciphersuite. This ciphersuite is not compiled by default in OpenSSL 3.0,
 and is not available within the default provider or the default ciphersuite
 list. This ciphersuite will never be used if TLSv1.3 has been negotiated.
 In order for an OpenSSL 3.0 endpoint to use this ciphersuite the following
 must have occurred: 1) OpenSSL must have been compiled with the
 (non-default) compile time option enable-weak-ssl-ciphers 2) OpenSSL must
 have had the legacy provider explicitly loaded (either through application
 code or via configuration) 3) The ciphersuite must have been explicitly
 added to the ciphersuite list 4) The libssl security level must have been
 set to 0 (default is 1) 5) A version of SSL/TLS below TLSv1.3 must have
 been negotiated 6) Both endpoints must negotiate the RC4-MD5 ciphersuite in
 preference to any others that both endpoints have in common Fixed in
 OpenSSL 3.0.3 (Affected 3.0.0,3.0.1,3.0.2).
Ubuntu-Description: 
Notes: 
 mdeslaur> OpenSSL v3.x only
Mitigation: 
Bugs: 
Priority: low
Discovered-by: Tom Colley
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N [5.9 MEDIUM]


Patches_openssl:
 upstream: https://git.openssl.org/?p=openssl.git;a=commit;h=7d56a74a96828985db7354a55227a511615f732b
upstream_openssl: released (3.0.3)
trusty/esm_openssl: not-affected (v3.x only)
esm-infra/xenial_openssl: not-affected (v3.x only)
fips/xenial_openssl: needs-triage
fips-updates/xenial_openssl: needs-triage
bionic_openssl: not-affected (v3.x only)
fips/bionic_openssl: needs-triage
fips-updates/bionic_openssl: needs-triage
focal_openssl: not-affected (v3.x only)
fips/focal_openssl: needs-triage
fips-updates/focal_openssl: needs-triage
impish_openssl: not-affected (v3.x only)
jammy_openssl: released (3.0.2-0ubuntu1.1)
kinetic_openssl: released (3.0.2-0ubuntu2)
lunar_openssl: released (3.0.2-0ubuntu2)
devel_openssl: released (3.0.2-0ubuntu2)

Patches_openssl1.0:
upstream_openssl1.0: needs-triage
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: not-affected
focal_openssl1.0: DNE
impish_openssl1.0: DNE
jammy_openssl1.0: DNE
kinetic_openssl1.0: DNE
lunar_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
trusty_nodejs: ignored (out of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
impish_nodejs: not-affected (uses system openssl1.1)
jammy_nodejs: not-affected (uses openssl 1.1)
esm-apps/jammy_nodejs: not-affected (uses openssl 1.1)
kinetic_nodejs: not-affected (uses system openssl1.1)
lunar_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
upstream_edk2: needs-triage
trusty_edk2: ignored (out of standard support)
trusty/esm_edk2: DNE
xenial_edk2: ignored (end of standard support)
esm-apps/xenial_edk2: needed
bionic_edk2: not-affected
esm-apps/bionic_edk2: not-affected
focal_edk2: not-affected
impish_edk2: not-affected
jammy_edk2: not-affected
kinetic_edk2: not-affected
lunar_edk2: not-affected
devel_edk2: not-affected
