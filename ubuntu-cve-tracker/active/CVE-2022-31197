Candidate: CVE-2022-31197
PublicDate: 2022-08-03 19:15:00 UTC
References:
 https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-r38f-c4h4-hqq2
 https://github.com/pgjdbc/pgjdbc/commit/739e599d52ad80f8dcd6efedc6157859b1a9d637 (REL42.4.1-rc1)
 https://github.com/pgjdbc/pgjdbc/commit/739e599d52ad80f8dcd6efedc6157859b1a9d637
 https://www.cve.org/CVERecord?id=CVE-2022-31197
Description:
 PostgreSQL JDBC Driver (PgJDBC for short) allows Java programs to connect
 to a PostgreSQL database using standard, database independent Java code.
 The PGJDBC implementation of the `java.sql.ResultRow.refreshRow()` method
 is not performing escaping of column names so a malicious column name that
 contains a statement terminator, e.g. `;`, could lead to SQL injection.
 This could lead to executing additional SQL commands as the application's
 JDBC user. User applications that do not invoke the
 `ResultSet.refreshRow()` method are not impacted. User application that do
 invoke that method are impacted if the underlying database that they are
 querying via their JDBC application may be under the control of an
 attacker. The attack requires the attacker to trick the user into executing
 SQL against a table name who's column names would contain the malicious SQL
 and subsequently invoke the `refreshRow()` method on the ResultSet. Note
 that the application's JDBC user and the schema owner need not be the same.
 A JDBC application that executes as a privileged user querying database
 schemas owned by potentially malicious less-privileged users would be
 vulnerable. In that situation it may be possible for the malicious user to
 craft a schema that causes the application to execute commands as the
 privileged user. Patched versions will be released as `42.2.26` and
 `42.4.1`. Users are advised to upgrade. There are no known workarounds for
 this issue.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1016662
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H [7.1 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H [8.0 HIGH]


Patches_libpgjava:
upstream_libpgjava: needs-triage
trusty/esm_libpgjava: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_libpgjava: needs-triage
trusty_libpgjava: ignored (end of standard support)
xenial_libpgjava: ignored (end of standard support)
esm-apps/xenial_libpgjava: needs-triage
bionic_libpgjava: ignored (end of standard support, was needs-triage)
esm-apps/bionic_libpgjava: needs-triage
focal_libpgjava: ignored (end of standard support, was needs-triage)
esm-apps/focal_libpgjava: needs-triage
jammy_libpgjava: needs-triage
esm-apps/jammy_libpgjava: needs-triage
kinetic_libpgjava: ignored (end of life, was needs-triage)
lunar_libpgjava: ignored (end of life, was needs-triage)
mantic_libpgjava: ignored (end of life, was needs-triage)
noble_libpgjava: needs-triage
esm-apps/noble_libpgjava: needs-triage
oracular_libpgjava: ignored (end of life, was needs-triage)
plucky_libpgjava: needs-triage
questing_libpgjava: needs-triage
devel_libpgjava: needs-triage
