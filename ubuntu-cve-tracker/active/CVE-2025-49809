Candidate: CVE-2025-49809
PublicDate: 2025-07-04 13:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-49809
 https://github.com/traviscross/mtr/blob/master/SECURITY
Description:
 mtr through 0.95, in certain privileged contexts, mishandles execution of a
 program specified by the MTR_PACKET environment variable. NOTE: mtr on
 macOS may often have Sudo rules, as an indirect consequence of Homebrew not
 installing setuid binaries.
Ubuntu-Description:
Notes:
 mdeslaur> This issue only affects deployments where an unprivileged user
 mdeslaur> can only run mtr though a specialized sudo configuration. While
 mdeslaur> this is a common scenario on macOS, it is unlikely to be a
 mdeslaur> common scenario on Ubuntu.
 mdeslaur> The patch allows creating a file called
 mdeslaur> /etc/mtr.is.run.under.sudo to disable the MTR_PACKET environment
 mdeslaur> variable from being used, so the patch alone will not fix
 mdeslaur> existing sudo configurations.
 mdeslaur> In addition, the default Ubuntu sudoers file already resets the
 mdeslaur> environment with the env_reset option, so this is unlikely to be
 mdeslaur> an issue in practice. Marking priority as low.
Mitigation:
Bugs:
 https://github.com/Homebrew/homebrew-core/issues/35085
Priority: low
 Requires bad sudo configuration
Discovered-by:
Assigned-to:
CVSS:
 mitre: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H [7.8 HIGH]

Patches_mtr:
 upstream: https://github.com/traviscross/mtr/commit/5226f105f087c29d3cfad9f28000e7536af91ac6
upstream_mtr: needs-triage
esm-infra-legacy/trusty_mtr: needs-triage
esm-infra/xenial_mtr: needs-triage
esm-infra/bionic_mtr: needs-triage
esm-infra/focal_mtr: needs-triage
jammy_mtr: needs-triage
noble_mtr: needs-triage
oracular_mtr: ignored (end of life, was needs-triage)
plucky_mtr: needs-triage
questing_mtr: needs-triage
devel_mtr: needs-triage
