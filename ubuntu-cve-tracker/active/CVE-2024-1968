PublicDateAtUSN: 2024-05-20 08:15:00 UTC
Candidate: CVE-2024-1968
PublicDate: 2024-05-20 08:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-1968
 https://huntr.com/bounties/27f6a021-a891-446a-ada5-0226d619dd1a
 https://github.com/scrapy/scrapy/commit/1d0502f25bbe55a22899af915623fda1aaeb9dd8
 https://ubuntu.com/security/notices/USN-7476-1
Description:
 In scrapy/scrapy, an issue was identified where the Authorization header is
 not removed during redirects that only change the scheme (e.g., HTTPS to
 HTTP) but remain within the same domain. This behavior contravenes the
 Fetch standard, which mandates the removal of Authorization headers in
 cross-origin requests when the scheme, host, or port changes. Consequently,
 when a redirect downgrades from HTTPS to HTTP, the Authorization header may
 be inadvertently exposed in plaintext, leading to potential sensitive
 information disclosure to unauthorized actors. The flaw is located in the
 _build_redirect_request function of the redirect middleware.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:

Patches_python-scrapy:
upstream_python-scrapy: released (2.11.2)
esm-apps/xenial_python-scrapy: ignored (changes too intrusive)
esm-apps/bionic_python-scrapy: released (1.5.0-1ubuntu0.1~esm1)
focal_python-scrapy: needed
esm-apps/focal_python-scrapy: released (1.7.3-1ubuntu0.1~esm1)
jammy_python-scrapy: needed
esm-apps/jammy_python-scrapy: released (2.5.1-2ubuntu0.1~esm1)
mantic_python-scrapy: ignored (end of life, was needs-triage)
noble_python-scrapy: needed
esm-apps/noble_python-scrapy: released (2.11.1-1ubuntu0.1~esm2)
oracular_python-scrapy: not-affected (2.11.2-1)
plucky_python-scrapy: not-affected (2.12.0-2)
devel_python-scrapy: not-affected (2.12.0-2)
