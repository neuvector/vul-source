Candidate: CVE-2024-22423
PublicDate: 2024-04-09 18:15:00 UTC
References:
 https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p
 https://github.com/yt-dlp/yt-dlp/releases/tag/2024.04.09
 https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg
 https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e
 https://github.com/yt-dlp/yt-dlp/commit/ff07792676f404ffff6ee61b5638c9dc1a33a37a
 https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11
 https://www.cve.org/CVERecord?id=CVE-2024-22423
Description:
 yt-dlp is a youtube-dl fork with additional features and fixes. The patch
 that addressed CVE-2023-40581 attempted to prevent RCE when using `--exec`
 with `%q` by replacing double quotes with two double quotes. However, this
 escaping is not sufficient, and still allows expansion of environment
 variables. Support for output template expansion in `--exec`, along with
 this vulnerable behavior, was added to `yt-dlp` in version 2021.04.11.
 yt-dlp version 2024.04.09 fixes this issue by properly escaping `%`. It
 replaces them with `%%cd:~,%`, a variable that expands to nothing, leaving
 only the leading percent. It is recommended to upgrade yt-dlp to version
 2024.04.09 as soon as possible. Also, always be careful when using
 `--exec`, because while this specific vulnerability has been patched, using
 unvalidated input in shell commands is inherently dangerous. For Windows
 users who are not able to upgrade, avoid using any output template
 expansion in `--exec` other than `{}` (filepath); if expansion in `--exec`
 is needed, verify the fields you are using do not contain `"`, `|` or `&`;
 and/or instead of using `--exec`, write the info json and load the fields
 from it instead.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H [8.3 HIGH]

Patches_yt-dlp:
upstream_yt-dlp: not-affected (debian: Windows-specific)
focal_yt-dlp: DNE
esm-infra/focal_yt-dlp: DNE
jammy_yt-dlp: needs-triage
esm-apps/jammy_yt-dlp: needs-triage
mantic_yt-dlp: ignored (end of life, was needs-triage)
noble_yt-dlp: needs-triage
esm-apps/noble_yt-dlp: needs-triage
oracular_yt-dlp: ignored (end of life, was needs-triage)
plucky_yt-dlp: needs-triage
questing_yt-dlp: needs-triage
devel_yt-dlp: needs-triage
