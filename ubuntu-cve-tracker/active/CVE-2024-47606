PublicDateAtUSN: 2024-12-12
Candidate: CVE-2024-47606
PublicDate: 2024-12-12 02:03:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-47606
 https://gstreamer.freedesktop.org/security/sa-2024-0014.html
 https://securitylab.github.com/advisories/GHSL-2024-166_Gstreamer/
 https://ubuntu.com/security/notices/USN-7174-1
 https://ubuntu.com/security/notices/USN-7176-1
Description:
 GStreamer is a library for constructing graphs of media-handling
 components. An integer underflow has been detected in the function
 qtdemux_parse_theora_extension within qtdemux.c. The vulnerability occurs
 due to an underflow of the gint size variable, which causes size to hold a
 large unintended value when cast to an unsigned integer. This 32-bit
 negative value is then cast to a 64-bit unsigned integer
 (0xfffffffffffffffa) in a subsequent call to gst_buffer_new_and_alloc. The
 function gst_buffer_new_allocate then attempts to allocate memory,
 eventually calling _sysmem_new_block. The function _sysmem_new_block adds
 alignment and header size to the (unsigned) size, causing the overflow of
 the 'slice_size' variable. As a result, only 0x89 bytes are allocated,
 despite the large input size. When the following memcpy call occurs in
 gst_buffer_fill, the data from the input file will overwrite the content of
 the GstMapInfo info structure. Finally, during the call to
 gst_memory_unmap, the overwritten memory may cause a function pointer
 hijack, as the mem->allocator->mem_unmap_full function is called with a
 corrupted pointer. This function pointer overwrite could allow an attacker
 to alter the execution flow of the program, leading to arbitrary code
 execution. This vulnerability is fixed in 1.24.10.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3851
Priority: medium
Discovered-by: Antonio Morales
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_gst-plugins-good0.10:
upstream_gst-plugins-good0.10: needs-triage
esm-apps/xenial_gst-plugins-good0.10: needs-triage
focal_gst-plugins-good0.10: DNE
jammy_gst-plugins-good0.10: DNE
noble_gst-plugins-good0.10: DNE
oracular_gst-plugins-good0.10: DNE
plucky_gst-plugins-good0.10: DNE
devel_gst-plugins-good0.10: DNE

Patches_gst-plugins-good1.0:
 upstream: https://gitlab.freedesktop.org/gstreamer/gstreamer/-/merge_requests/8032.patch
 upstream: https://gitlab.freedesktop.org/gstreamer/gstreamer/-/commit/f8e398c46fc074f266edb3f20479c0ca31b52448
 upstream: https://gitlab.freedesktop.org/gstreamer/gstreamer/-/commit/2d7a11f5e6be5c323b2fed8158bc9df37752e495 (1.24.10)
upstream_gst-plugins-good1.0: released (1.24.10-1)
esm-infra/xenial_gst-plugins-good1.0: needs-triage
esm-infra/bionic_gst-plugins-good1.0: needs-triage
focal_gst-plugins-good1.0: released (1.16.3-0ubuntu1.3)
jammy_gst-plugins-good1.0: released (1.20.3-0ubuntu1.3)
noble_gst-plugins-good1.0: released (1.24.2-1ubuntu1.1)
oracular_gst-plugins-good1.0: released (1.24.8-1ubuntu1.1)
plucky_gst-plugins-good1.0: not-affected (1.24.10-1ubuntu1)
devel_gst-plugins-good1.0: not-affected (1.24.10-1ubuntu1)

Patches_gstreamer0.10:
upstream_gstreamer0.10: needs-triage
esm-infra-legacy/trusty_gstreamer0.10: needs-triage
trusty/esm_gstreamer0.10: ignored (end of ESM support, was needs-triage)
esm-apps/xenial_gstreamer0.10: needs-triage
focal_gstreamer0.10: DNE
jammy_gstreamer0.10: DNE
noble_gstreamer0.10: DNE
oracular_gstreamer0.10: DNE
plucky_gstreamer0.10: DNE
devel_gstreamer0.10: DNE

Patches_gstreamer1.0:
 upstream: https://gitlab.freedesktop.org/gstreamer/gstreamer/-/merge_requests/8032.patch
 upstream: https://gitlab.freedesktop.org/gstreamer/gstreamer/-/commit/f1cdc6f24340f6cce4cc7020628002f5c70dd6c7
 upstream: https://gitlab.freedesktop.org/gstreamer/gstreamer/-/commit/72af11b248b4cb60d3dfe4e9459eec0d20052c9b (1.24.10)
upstream_gstreamer1.0: released (1.24.10-1)
esm-infra/xenial_gstreamer1.0: needs-triage
esm-infra/bionic_gstreamer1.0: needs-triage
focal_gstreamer1.0: released (1.16.3-0ubuntu1.2)
jammy_gstreamer1.0: released (1.20.3-0ubuntu1.1)
noble_gstreamer1.0: released (1.24.2-1ubuntu0.1)
oracular_gstreamer1.0: released (1.24.8-1ubuntu0.1)
plucky_gstreamer1.0: not-affected (1.24.10-2)
devel_gstreamer1.0: not-affected (1.24.10-2)
