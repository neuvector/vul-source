PublicDateAtUSN: 2020-07-07 13:15:00 UTC
Candidate: CVE-2020-15565
PublicDate: 2020-07-07 13:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15565
 https://xenbits.xen.org/xsa/advisory-321.html
 http://www.openwall.com/lists/oss-security/2020/07/07/4
 http://xenbits.xen.org/xsa/advisory-321.html
 https://ubuntu.com/security/notices/USN-5617-1
Description:
 An issue was discovered in Xen through 4.13.x, allowing x86 Intel HVM guest
 OS users to cause a host OS denial of service or possibly gain privileges
 because of insufficient cache write-back under VT-d. When page tables are
 shared between IOMMU and CPU, changes to them require flushing of both
 TLBs. Furthermore, IOMMUs may be non-coherent, and hence prior to flushing
 IOMMU TLBs, a CPU cache also needs writing back to memory after changes
 were made. Such writing back of cached data was missing in particular when
 splitting large page mappings into smaller granularity ones. A malicious
 guest may be able to retain read/write DMA access to frames returned to
 Xen's free pool, and later reused for another purpose. Host crashes
 (leading to a Denial of Service) and privilege escalation cannot be ruled
 out. Xen versions from at least 3.2 onwards are affected. Only x86 Intel
 systems are affected. x86 AMD as well as Arm systems are not affected. Only
 x86 HVM guests using hardware assisted paging (HAP), having a passed
 through PCI device assigned, and having page table sharing enabled can
 leverage the vulnerability. Note that page table sharing will be enabled
 (by default) only if Xen considers IOMMU and CPU large page size support
 compatible.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H [8.8 HIGH]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: needs-triage
precise/esm_xen: DNE
trusty_xen: ignored (out of standard support)
trusty/esm_xen: DNE
xenial_xen: ignored (end of standard support, was needs-triage)
esm-infra/xenial_xen: needed
bionic_xen: ignored (end of standard support, was needed)
esm-infra/bionic_xen: needed
eoan_xen: ignored (reached end-of-life)
focal_xen: released (4.11.3+24-g14b62ab3e5-1ubuntu2.3)
esm-apps/focal_xen: released (4.11.3+24-g14b62ab3e5-1ubuntu2.3)
groovy_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
hirsute_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
impish_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
jammy_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
esm-apps/jammy_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
kinetic_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
lunar_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)
devel_xen: not-affected (4.11.4+24-gddaaccbbab-1ubuntu2)

