PublicDateAtUSN: 2018-06-08
Candidate: CVE-2018-12020
PublicDate: 2018-06-08 21:29:00 UTC
References:
 https://dev.gnupg.org/T4012
 https://lists.gnupg.org/pipermail/gnupg-announce/2018q2/000425.html
 https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=210e402acd3e284b32db1901e43bf1470e659e49 (STABLE-BRANCH-2-2)
 https://git.gnupg.org/cgi-bin/gitweb.cgi?p=gnupg.git;a=commit;h=2326851c60793653069494379b16d84e4c10a0ac (STABLE-BRANCH-1-4)
 https://ubuntu.com/security/notices/USN-3675-1
 https://sourceforge.net/p/enigmail/forum/announce/thread/b948279f/
 https://neopg.io/blog/gpg-signature-spoof/
 https://ubuntu.com/security/notices/USN-3675-2
 https://ubuntu.com/security/notices/USN-3675-3
 https://ubuntu.com/security/notices/USN-3964-1
 https://ubuntu.com/security/notices/USN-4839-1
 https://www.cve.org/CVERecord?id=CVE-2018-12020
Description:
 mainproc.c in GnuPG before 2.2.8 mishandles the original filename during
 decryption and verification actions, which allows remote attackers to spoof
 the output that GnuPG sends on file descriptor 2 to other programs that use
 the "--status-fd 2" option. For example, the OpenPGP data might represent
 an original filename that contains line feed characters in conjunction with
 GOODSIG or VALIDSIG status codes.
Ubuntu-Description:
 Marcus Brinkmann discovered that GnuPG before 2.2.8 improperly handled certain
 command line parameters. A remote attacker could use this to spoof the output
 of GnuPG and cause unsigned e-mail to appear signed.
Notes:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=901088
Priority: medium
Discovered-by: Marcus Brinkmann
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N [7.5 HIGH]

Patches_gnupg:
upstream_gnupg: released (1.4.18-7+deb8u5)
precise/esm_gnupg: not-affected (1.4.11-3ubuntu2.11)
trusty_gnupg: released (1.4.16-1ubuntu2.5)
trusty/esm_gnupg: not-affected (1.4.16-1ubuntu2.5)
esm-infra-legacy/trusty_gnupg: not-affected (1.4.16-1ubuntu2.5)
xenial_gnupg: released (1.4.20-1ubuntu3.2)
esm-infra/xenial_gnupg: not-affected (1.4.20-1ubuntu3.2)
artful_gnupg: DNE
bionic_gnupg: DNE
cosmic_gnupg: DNE
disco_gnupg: DNE
eoan_gnupg: DNE
focal_gnupg: DNE
groovy_gnupg: DNE
hirsute_gnupg: DNE
impish_gnupg: DNE
jammy_gnupg: DNE
kinetic_gnupg: DNE
lunar_gnupg: DNE
mantic_gnupg: DNE
noble_gnupg: DNE
oracular_gnupg: DNE
plucky_gnupg: DNE
devel_gnupg: DNE

Patches_gnupg2:
upstream_gnupg2: released (2.2.8-1)
precise/esm_gnupg2: DNE
trusty_gnupg2: released (2.0.22-3ubuntu1.4)
trusty/esm_gnupg2: DNE (trusty was released [2.0.22-3ubuntu1.4])
esm-infra-legacy/trusty_gnupg2: DNE (trusty/esm was DNE [trusty was released [2.0.22-3ubuntu1.4]])
xenial_gnupg2: released (2.1.11-6ubuntu2.1)
esm-infra/xenial_gnupg2: not-affected (2.1.11-6ubuntu2.1)
artful_gnupg2: released (2.1.15-1ubuntu8.1)
bionic_gnupg2: released (2.2.4-1ubuntu1.1)
esm-infra/bionic_gnupg2: not-affected (2.2.4-1ubuntu1.1)
cosmic_gnupg2: released (2.2.8-1ubuntu1)
disco_gnupg2: released (2.2.8-1ubuntu1)
eoan_gnupg2: released (2.2.8-1ubuntu1)
focal_gnupg2: released (2.2.8-1ubuntu1)
groovy_gnupg2: released (2.2.8-1ubuntu1)
hirsute_gnupg2: released (2.2.8-1ubuntu1)
impish_gnupg2: released (2.2.8-1ubuntu1)
jammy_gnupg2: released (2.2.8-1ubuntu1)
kinetic_gnupg2: released (2.2.8-1ubuntu1)
lunar_gnupg2: released (2.2.8-1ubuntu1)
mantic_gnupg2: released (2.2.8-1ubuntu1)
noble_gnupg2: released (2.2.8-1ubuntu1)
oracular_gnupg2: released (2.2.8-1ubuntu1)
plucky_gnupg2: released (2.2.8-1ubuntu1)
devel_gnupg2: released (2.2.8-1ubuntu1)

Patches_gnupg1:
upstream_gnupg1: released (1.4.22-5)
precise/esm_gnupg1: DNE
trusty_gnupg1: DNE
trusty/esm_gnupg1: DNE
esm-infra-legacy/trusty_gnupg1: DNE
xenial_gnupg1: DNE
artful_gnupg1: ignored (end of life)
bionic_gnupg1: ignored (end of standard support, was needed)
esm-apps/bionic_gnupg1: needed
cosmic_gnupg1: ignored (end of life)
disco_gnupg1: ignored (end of life)
eoan_gnupg1: not-affected (1.4.22-5)
focal_gnupg1: not-affected (1.4.22-5)
esm-apps/focal_gnupg1: not-affected (1.4.22-5)
groovy_gnupg1: not-affected (1.4.22-5)
hirsute_gnupg1: not-affected (1.4.22-5)
impish_gnupg1: not-affected (1.4.22-5)
jammy_gnupg1: not-affected (1.4.22-5)
esm-apps/jammy_gnupg1: not-affected (1.4.22-5)
kinetic_gnupg1: not-affected (1.4.22-5)
lunar_gnupg1: not-affected (1.4.22-5)
mantic_gnupg1: not-affected (1.4.22-5)
noble_gnupg1: not-affected (1.4.22-5)
esm-apps/noble_gnupg1: not-affected (1.4.22-5)
oracular_gnupg1: not-affected (1.4.22-5)
plucky_gnupg1: not-affected (1.4.22-5)
devel_gnupg1: not-affected (1.4.22-5)

Patches_enigmail:
upstream_enigmail: released (2.0.7)
precise/esm_enigmail: DNE
trusty_enigmail: ignored (end of standard support)
trusty/esm_enigmail: DNE (trusty was needed)
esm-infra-legacy/trusty_enigmail: DNE (trusty/esm was DNE [trusty was needed])
xenial_enigmail: ignored (end of standard support, was needed)
esm-apps/xenial_enigmail: needed
artful_enigmail: ignored (end of life)
bionic_enigmail: ignored (end of standard support, was needed)
esm-apps/bionic_enigmail: needed
cosmic_enigmail: ignored (end of life)
disco_enigmail: ignored (end of life)
eoan_enigmail: ignored (end of life)
focal_enigmail: needed
esm-apps/focal_enigmail: needed
groovy_enigmail: ignored (end of life)
hirsute_enigmail: ignored (end of life)
impish_enigmail: ignored (end of life)
jammy_enigmail: needed
esm-apps/jammy_enigmail: needed
kinetic_enigmail: ignored (end of life, was needed)
lunar_enigmail: not-affected (2:2.2.4-0.3)
mantic_enigmail: not-affected (2:2.2.4-0.3)
noble_enigmail: DNE
oracular_enigmail: DNE
plucky_enigmail: DNE
devel_enigmail: DNE

Patches_python-gnupg:
upstream_python-gnupg: released (0.4.3-1)
precise/esm_python-gnupg: DNE
trusty_python-gnupg: ignored (end of standard support)
trusty/esm_python-gnupg: released (0.3.6-1ubuntu0.1~esm1)
esm-infra-legacy/trusty_python-gnupg: not-affected (0.3.6-1ubuntu0.1~esm1)
xenial_python-gnupg: ignored (end of standard support, was needed)
esm-apps/xenial_python-gnupg: released (0.3.8-2ubuntu0.1~esm1)
artful_python-gnupg: ignored (end of life)
bionic_python-gnupg: released (0.4.1-1ubuntu1.18.04.1)
esm-apps/bionic_python-gnupg: released (0.4.1-1ubuntu1.18.04.1)
cosmic_python-gnupg: released (0.4.1-1ubuntu1.18.10.1)
disco_python-gnupg: not-affected (0.4.3-1ubuntu1)
eoan_python-gnupg: not-affected (0.4.3-1ubuntu1)
focal_python-gnupg: not-affected (0.4.3-1ubuntu1)
esm-apps/focal_python-gnupg: not-affected (0.4.3-1ubuntu1)
groovy_python-gnupg: not-affected (0.4.3-1ubuntu1)
hirsute_python-gnupg: not-affected (0.4.3-1ubuntu1)
impish_python-gnupg: not-affected (0.4.3-1ubuntu1)
jammy_python-gnupg: not-affected (0.4.3-1ubuntu1)
esm-apps/jammy_python-gnupg: not-affected (0.4.3-1ubuntu1)
kinetic_python-gnupg: not-affected (0.4.3-1ubuntu1)
lunar_python-gnupg: not-affected (0.4.3-1ubuntu1)
mantic_python-gnupg: not-affected (0.4.3-1ubuntu1)
noble_python-gnupg: not-affected (0.4.3-1ubuntu1)
esm-apps/noble_python-gnupg: not-affected (0.4.3-1ubuntu1)
oracular_python-gnupg: not-affected (0.4.3-1ubuntu1)
plucky_python-gnupg: not-affected (0.4.3-1ubuntu1)
devel_python-gnupg: not-affected (0.4.3-1ubuntu1)
