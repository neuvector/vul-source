Candidate: CVE-2023-28115
PublicDate: 2023-03-17 22:15:00 UTC
References:
 https://github.com/KnpLabs/snappy/security/advisories/GHSA-gq6w-q6wh-jggc
 https://github.com/KnpLabs/snappy/pull/469
 https://github.com/KnpLabs/snappy/commit/1ee6360cbdbea5d09705909a150df7963a88efd6 (v1.4.2)
 https://www.cve.org/CVERecord?id=CVE-2023-28115
Description:
 Snappy is a PHP library allowing thumbnail, snapshot or PDF generation from
 a url or a html page. Prior to version 1.4.2, Snappy is vulnerable to PHAR
 deserialization due to a lack of checking on the protocol before passing it
 into the `file_exists()` function. If an attacker can upload files of any
 type to the server he can pass in the phar:// protocol to unserialize the
 uploaded file and instantiate arbitrary PHP objects. This can lead to
 remote code execution especially when snappy is used with frameworks with
 documented POP chains like Laravel/Symfony vulnerable developer code. If a
 user can control the output file from the `generateFromHtml()` function, it
 will invoke deserialization. This vulnerability is capable of remote code
 execution if Snappy is used with frameworks or developer code with
 vulnerable POP chains. It has been fixed in version 1.4.2.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_civicrm:
upstream_civicrm: needs-triage
trusty_civicrm: ignored (end of standard support)
xenial_civicrm: ignored (end of standard support)
bionic_civicrm: ignored (end of standard support, was needs-triage)
focal_civicrm: ignored (end of standard support, was needs-triage)
jammy_civicrm: needs-triage
kinetic_civicrm: ignored (end of life, was needs-triage)
esm-apps/xenial_civicrm: needs-triage
esm-apps/bionic_civicrm: needs-triage
esm-apps/focal_civicrm: needs-triage
esm-apps/jammy_civicrm: needs-triage
lunar_civicrm: DNE
mantic_civicrm: DNE
noble_civicrm: DNE
oracular_civicrm: DNE
plucky_civicrm: DNE
devel_civicrm: DNE
