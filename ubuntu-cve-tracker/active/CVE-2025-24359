Candidate: CVE-2025-24359
PublicDate: 2025-01-24 17:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-24359
 https://github.com/lmfit/asteval/security/advisories/GHSA-3wwr-3g9f-9gc7
 https://github.com/lmfit/asteval/blob/cfb57f0beebe0dc0520a1fbabc35e66060c7ea71/asteval/asteval.py#L507
 https://lucumr.pocoo.org/2016/12/29/careful-with-str-format
Description:
 ASTEVAL is an evaluator of Python expressions and statements. Prior to
 version 1.0.6, if an attacker can control the input to the `asteval`
 library, they can bypass asteval's restrictions and execute arbitrary
 Python code in the context of the application using the library. The
 vulnerability is rooted in how `asteval` performs handling of
 `FormattedValue` AST nodes. In particular, the `on_formattedvalue` value
 uses the dangerous format method of the str class. The code allows an
 attacker to manipulate the value of the string used in the dangerous call
 `fmt.format(__fstring__=val)`. This vulnerability can be exploited to
 access protected attributes by intentionally triggering an `AttributeError`
 exception. The attacker can then catch the exception and use its `obj`
 attribute to gain arbitrary access to sensitive or protected object
 properties. Version 1.0.6 fixes this issue.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [8.4 HIGH]

Patches_python-asteval:
upstream_python-asteval: released (1.0.6)
focal_python-asteval: ignored (end of standard support, was needs-triage)
esm-apps/focal_python-asteval: needs-triage
jammy_python-asteval: needs-triage
esm-apps/jammy_python-asteval: needs-triage
noble_python-asteval: needs-triage
esm-apps/noble_python-asteval: needs-triage
oracular_python-asteval: ignored (end of life, was needs-triage)
plucky_python-asteval: not-affected (1.0.6-2)
questing_python-asteval: not-affected (1.0.6-2)
devel_python-asteval: not-affected (1.0.6-2)
