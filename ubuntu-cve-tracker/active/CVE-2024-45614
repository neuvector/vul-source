PublicDateAtUSN: 2024-09-20
Candidate: CVE-2024-45614
PublicDate: 2024-09-19 23:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-45614
 https://github.com/puma/puma/security/advisories/GHSA-9hf4-67fc-4vf4
 https://nginx.org/en/docs/http/ngx_http_core_module.html#underscores_in_headers
 https://ubuntu.com/security/notices/USN-7031-1
 https://ubuntu.com/security/notices/USN-7031-2
Description:
 Puma is a Ruby/Rack web server built for parallelism. In affected versions
 clients could clobber values set by intermediate proxies (such as
 X-Forwarded-For) by providing a underscore version of the same header
 (X-Forwarded_For). Any users relying on proxy set variables is affected.
 v6.4.3/v5.6.9 now discards any headers using underscores if the
 non-underscore version also exists. Effectively, allowing the proxy defined
 headers to always win. Users are advised to upgrade. Nginx has a
 underscores_in_headers configuration variable to discard these headers at
 the proxy level as a mitigation. Any users that are implicitly trusting the
 proxy defined headers for security should immediately cease doing so until
 upgraded to the fixed versions.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:N [5.4 MEDIUM]


Patches_puma:
 upstream: https://github.com/puma/puma/commit/cac3fd18cf29ed43719ff5d52d9cfec215f0a043
upstream_puma: released (6.4.3)
focal_puma: needed
esm-apps/focal_puma: released (3.12.4-1ubuntu2+esm2)
jammy_puma: needed
esm-apps/jammy_puma: released (5.5.2-2ubuntu2+esm2)
noble_puma: released (6.4.2-4ubuntu4.3)
oracular_puma: released (6.4.2-5ubuntu4)
plucky_puma: released (6.4.2-5ubuntu4)
devel_puma: released (6.4.2-5ubuntu4)
