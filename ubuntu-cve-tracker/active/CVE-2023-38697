Candidate: CVE-2023-38697
PublicDate: 2023-08-04 18:15:00 UTC
References:
 https://github.com/socketry/protocol-http1/pull/20
 https://www.rfc-editor.org/rfc/rfc9112#name-chunked-transfer-coding
 https://github.com/socketry/protocol-http1/security/advisories/GHSA-6jwc-qr2q-7xwj
 https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd (v0.15.1)
 https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd
 https://www.cve.org/CVERecord?id=CVE-2023-38697
Description:
 protocol-http1 provides a low-level implementation of the HTTP/1 protocol.
 RFC 9112 Section 7.1 defined the format of chunk size, chunk data and chunk
 extension. The value of Content-Length header should be a string of 0-9
 digits, the chunk size should be a string of hex digits and should split
 from chunk data using CRLF, and the chunk extension shouldn't contain any
 invisible character. However, Falcon has following behaviors while disobey
 the corresponding RFCs: accepting Content-Length header values that have
 `+` prefix, accepting Content-Length header values that written in
 hexadecimal with `0x` prefix, accepting `0x` and `+` prefixed chunk size,
 and accepting LF in chunk extension. This behavior can lead to desync when
 forwarding through multiple HTTP parsers, potentially results in HTTP
 request smuggling and firewall bypassing. This issue is fixed in
 `protocol-http1` v0.15.1. There are no known workarounds.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N [5.8 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N [5.3 MEDIUM]

Patches_ruby-protocol-http1:
upstream_ruby-protocol-http1: needs-triage
trusty_ruby-protocol-http1: ignored (end of standard support)
xenial_ruby-protocol-http1: ignored (end of standard support)
bionic_ruby-protocol-http1: ignored (end of standard support)
focal_ruby-protocol-http1: DNE
esm-infra/focal_ruby-protocol-http1: DNE
jammy_ruby-protocol-http1: needed
esm-apps/jammy_ruby-protocol-http1: needed
lunar_ruby-protocol-http1: ignored (end of life, was needed)
mantic_ruby-protocol-http1: ignored (end of life, was needs-triage)
noble_ruby-protocol-http1: needs-triage
esm-apps/noble_ruby-protocol-http1: needs-triage
oracular_ruby-protocol-http1: ignored (end of life, was needs-triage)
plucky_ruby-protocol-http1: needs-triage
devel_ruby-protocol-http1: needs-triage
