Candidate: CVE-2021-23240
PublicDate: 2021-01-12 09:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2021/01/11/2
 https://www.sudo.ws/alerts/sudoedit_selinux.html
 https://www.cve.org/CVERecord?id=CVE-2021-23240
Description:
 selinux_edit_copy_tfiles in sudoedit in Sudo before 1.9.5 allows a local
 unprivileged user to gain file ownership and escalate privileges by
 replacing a temporary file with a symlink to an arbitrary file target. This
 affects SELinux RBAC support in permissive mode. Machines without SELinux
 are not vulnerable.
Ubuntu-Description:
Notes:
 sbeattie> selinux is not the default MAC in Ubuntu, though users can
   boot into it.
 rodrigo-zaiden> fs.protected_symlinks is '1' by default in Ubuntu,
   and if not changed, can prevent this issue from being exploited.
 rodrigo-zaiden> 
 rodrigo-zaiden> There are backports available for version
   1.8 but not straightforward for 1.8.16 (xenial baseline). Some of
   the selinux specific code that needs to be patched was added later
   in time and it seems to me that the backports for 1.8 are based on
   1.8.32. So, in xenial, a fix would be very intrusive and likely
   to introduce a regression.
 rodrigo-zaiden> The reproducer in sudo.ws reference does not reproduce
   in xenial.
 rodrigo-zaiden> The fact that the reproducer does not reproduce, that
   the kernel hardening fs.protected_symlinks is '1' by default (with
   no clear reason to be turned off to '0'), that there is a very low
   possibility to have Ubuntu running selinux without a working policy
   and, mainly, that the risky of regression is high, we are marking
   this CVE as ignored for xenial.
Mitigation:
Bugs:
Priority: negligible
Discovered-by: Matthias Gerstner
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_sudo:
 upstream: https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a
 upstream: https://www.sudo.ws/repos/sudo/rev/b5d5bd506487
 upstream: https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)
 upstream: https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)
upstream_sudo: released (1.9.5)
precise/esm_sudo: ignored (end of life, was needs-triage)
trusty_sudo: ignored (end of standard support)
trusty/esm_sudo: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_sudo: needs-triage
xenial_sudo: ignored (end of standard support, was needs-triage)
esm-infra/xenial_sudo: ignored
bionic_sudo: ignored (end of standard support, was needs-triage)
esm-infra/bionic_sudo: needs-triage
focal_sudo: ignored (end of standard support, was needs-triage)
esm-infra/focal_sudo: needs-triage
groovy_sudo: ignored (end of life)
hirsute_sudo: ignored (end of life)
impish_sudo: not-affected (1.9.5p2-3ubuntu1)
jammy_sudo: not-affected (1.9.9-1ubuntu2)
kinetic_sudo: not-affected (1.9.9-1ubuntu2)
lunar_sudo: not-affected (1.9.9-1ubuntu2)
mantic_sudo: not-affected (1.9.9-1ubuntu2)
noble_sudo: not-affected (1.9.9-1ubuntu2)
oracular_sudo: not-affected (1.9.9-1ubuntu2)
plucky_sudo: not-affected (1.9.9-1ubuntu2)
questing_sudo: not-affected (1.9.9-1ubuntu2)
devel_sudo: not-affected (1.9.9-1ubuntu2)
