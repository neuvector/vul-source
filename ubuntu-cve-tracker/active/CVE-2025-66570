PublicDateAtUSN: 2025-12-05 19:15:00 UTC
Candidate: CVE-2025-66570
PublicDate: 2025-12-05 19:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-66570
 https://github.com/yhirose/cpp-httplib/security/advisories/GHSA-xm2j-vfr9-mg9m
 https://github.com/yhirose/cpp-httplib/commit/ac9ebb0ee333ce8bf13523f487bdfad9518a2aff
 https://ubuntu.com/security/notices/USN-7962-1
Description:
 cpp-httplib is a C++11 single-file header-only cross platform HTTP/HTTPS
 library. Prior to 0.27.0, a vulnerability allows attacker-controlled HTTP
 headers to influence server-visible metadata, logging, and authorization
 decisions. An attacker can inject headers named REMOTE_ADDR, REMOTE_PORT,
 LOCAL_ADDR, LOCAL_PORT that are parsed into the request header multimap via
 read_headers() in httplib.h (headers.emplace), then the server later
 appends its own internal metadata using the same header names in
 Server::process_request without erasing duplicates. Because
 Request::get_header_value returns the first entry for a header key (id ==
 0) and the client-supplied headers are parsed before server-inserted
 headers, downstream code that uses these header names may inadvertently use
 attacker-controlled values. Affected files/locations: cpp-httplib/httplib.h
 (read_headers, Server::process_request, Request::get_header_value,
 get_header_value_u64) and cpp-httplib/docker/main.cc (get_client_ip,
 nginx_access_logger, nginx_error_logger). Attack surface:
 attacker-controlled HTTP headers in incoming requests flow into the
 Request.headers multimap and into logging code that reads forwarded
 headers, enabling IP spoofing, log poisoning, and authorization bypass via
 header shadowing. This vulnerability is fixed in 0.27.0.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1122027
Priority: high
 remote auth bypass, log injection
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N [10.0 CRITICAL]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]

Patches_cpp-httplib:
upstream_cpp-httplib: released (0.27.0)
jammy_cpp-httplib: needed
esm-apps/jammy_cpp-httplib: released (0.10.3+ds-1ubuntu0.1~esm1)
noble_cpp-httplib: needed
esm-apps/noble_cpp-httplib: released (0.14.3+ds-1.1ubuntu0.1~esm1)
plucky_cpp-httplib: released (0.18.7-1ubuntu0.25.04.1)
questing_cpp-httplib: released (0.18.7-1ubuntu0.25.10.1)
devel_cpp-httplib: needed
