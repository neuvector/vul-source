PublicDateAtUSN: 2019-10-07 16:15:00 UTC
Candidate: CVE-2019-17042
PublicDate: 2019-10-07 16:15:00 UTC
References:
 https://github.com/rsyslog/rsyslog/pull/3883
 https://ubuntu.com/security/notices/USN-5419-1
 https://www.cve.org/CVERecord?id=CVE-2019-17042
Description:
 An issue was discovered in Rsyslog v8.1908.0.
 contrib/pmcisconames/pmcisconames.c has a heap overflow in the parser for
 Cisco log messages. The parser tries to locate a log message delimiter (in
 this case, a space or a colon), but fails to account for strings that do
 not satisfy this constraint. If the string does not match, then the
 variable lenMsg will reach the value zero and will skip the sanity check
 that detects invalid log messages. The message will then be considered
 valid, and the parser will eat up the nonexistent colon delimiter. In doing
 so, it will decrement lenMsg, a signed integer, whose value was zero and
 now becomes minus one. The following step in the parser is to shift left
 the contents of the message. To do this, it will call memmove with the
 right pointers to the target and destination strings, but the lenMsg will
 now be interpreted as a huge value, causing a heap overflow.
Ubuntu-Description:
Notes:
 mdeslaur> requires pmcisconames module to be loaded, which is not
 mdeslaur> enabled in the default configuration
Mitigation:
Bugs:
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=942065
Priority: low
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]


Patches_rsyslog:
upstream_rsyslog: released (8.1910.0-1)
precise/esm_rsyslog: ignored (end of life, was needs-triage)
trusty_rsyslog: ignored (end of standard support)
trusty/esm_rsyslog: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_rsyslog: needs-triage
xenial_rsyslog: ignored (end of standard support, was needed)
esm-infra/xenial_rsyslog: released (8.16.0-1ubuntu3.1+esm1)
bionic_rsyslog: ignored (end of standard support, was needed)
esm-infra/bionic_rsyslog: needed
disco_rsyslog: ignored (end of life)
eoan_rsyslog: ignored (end of life)
focal_rsyslog: not-affected (8.2001.0-1ubuntu1)
esm-infra/focal_rsyslog: not-affected (8.2001.0-1ubuntu1)
groovy_rsyslog: not-affected (8.2001.0-1ubuntu1)
hirsute_rsyslog: not-affected (8.2001.0-1ubuntu1)
impish_rsyslog: not-affected (8.2001.0-1ubuntu1)
jammy_rsyslog: not-affected (8.2001.0-1ubuntu1)
kinetic_rsyslog: not-affected (8.2001.0-1ubuntu1)
lunar_rsyslog: not-affected (8.2001.0-1ubuntu1)
mantic_rsyslog: not-affected (8.2001.0-1ubuntu1)
noble_rsyslog: not-affected (8.2001.0-1ubuntu1)
oracular_rsyslog: not-affected (8.2001.0-1ubuntu1)
plucky_rsyslog: not-affected (8.2001.0-1ubuntu1)
questing_rsyslog: not-affected (8.2001.0-1ubuntu1)
devel_rsyslog: not-affected (8.2001.0-1ubuntu1)
