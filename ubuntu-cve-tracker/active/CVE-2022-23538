Candidate: CVE-2022-23538
PublicDate: 2023-01-17 21:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23538
 https://github.com/sylabs/scs-library-client/commit/68ac4cab5cda0afd8758ff5b5e2e57be6a22fcfa
 https://github.com/sylabs/scs-library-client/commit/b5db2aacba6bf1231f42dd475cc32e6355ab47b2
 https://github.com/sylabs/scs-library-client/commit/eebd7caaab310b1fa803e55b8fc1acd9dcd2d00c
 https://github.com/sylabs/scs-library-client/security/advisories/GHSA-7p8m-22h4-9pj7
Description:
 github.com/sylabs/scs-library-client is the Go client for the Singularity
 Container Services (SCS) Container Library Service. When the
 scs-library-client is used to pull a container image, with authentication,
 the HTTP Authorization header sent by the client to the library service may
 be incorrectly leaked to an S3 backing storage provider. This occurs in a
 specific flow, where the library service redirects the client to a backing
 S3 storage server, to perform a multi-part concurrent download. Depending
 on site configuration, the S3 service may be provided by a third party. An
 attacker with access to the S3 service may be able to extract user
 credentials, allowing them to impersonate the user. The vulnerable
 multi-part concurrent download flow, with redirect to S3, is only used when
 communicating with a Singularity Enterprise 1.x installation, or third
 party server implementing this flow. Interaction with Singularity
 Enterprise 2.x, and Singularity Container Services (cloud.sylabs.io), does
 not trigger the vulnerable flow. We encourage all users to update. Users
 who interact with a Singularity Enterprise 1.x installation, using a 3rd
 party S3 storage service, are advised to revoke and recreate their
 authentication tokens within Singularity Enterprise. There is no workaround
 available at this time.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> singularity-container includes scs-library-client code
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N [7.6 HIGH]

Patches_singularity-container:
upstream_singularity-container: needs-triage
trusty_singularity-container: ignored (out of standard support)
xenial_singularity-container: ignored (out of standard support)
bionic_singularity-container: ignored (end of standard support, was needs-triage)
esm-apps/bionic_singularity-container: needs-triage
focal_singularity-container: DNE
jammy_singularity-container: DNE
kinetic_singularity-container: DNE
