PublicDateAtUSN: 2023-12-18 15:00:00 UTC
Candidate: CVE-2023-48795
PublicDate: 2023-12-18 16:15:00 UTC
CRD: 2023-12-18 15:00:00 UTC
References:
 https://terrapin-attack.com/
 https://www.openwall.com/lists/oss-security/2023/12/18/3
 https://github.com/ronf/asyncssh/security/advisories/GHSA-hfmc-7525-mj55
 https://ubuntu.com/security/notices/USN-6560-1
 https://ubuntu.com/security/notices/USN-6561-1
 https://ubuntu.com/security/notices/USN-6560-2
 https://ubuntu.com/security/notices/USN-6585-1
 https://ubuntu.com/security/notices/USN-6589-1
 https://ubuntu.com/security/notices/USN-6598-1
 https://www.cve.org/CVERecord?id=CVE-2023-48795
 https://ubuntu.com/security/notices/USN-6738-1
 https://ubuntu.com/security/notices/USN-7051-1
 https://ubuntu.com/security/notices/USN-7297-1
 https://ubuntu.com/security/notices/USN-7292-1
Description:
 The SSH transport protocol with certain OpenSSH extensions, found in
 OpenSSH before 9.6 and other products, allows remote attackers to bypass
 integrity checks such that some packets are omitted (from the extension
 negotiation message), and a client and server may consequently end up with
 a connection for which some security features have been downgraded or
 disabled, aka a Terrapin attack. This occurs because the SSH Binary Packet
 Protocol (BPP), implemented by these extensions, mishandles the handshake
 phase and mishandles use of sequence numbers. For example, there is an
 effective attack against SSH's use of ChaCha20-Poly1305 (and CBC with
 Encrypt-then-MAC). The bypass occurs in chacha20-poly1305@openssh.com and
 (if CBC is used) the -etm@openssh.com MAC algorithms. This also affects
 Maverick Synergy Java SSH API before 3.1.0-SNAPSHOT, Dropbear through
 2022.83, Ssh before 5.1.1 in Erlang/OTP, PuTTY before 0.80, AsyncSSH before
 2.14.2, golang.org/x/crypto before 0.17.0, libssh before 0.10.6, libssh2
 through 1.11.0, Thorn Tech SFTP Gateway before 3.4.6, Tera Term before 5.1,
 Paramiko before 3.4.0, jsch before 0.2.15, SFTPGo before 2.5.6, Netgate
 pfSense Plus through 23.09.1, Netgate pfSense CE through 2.7.2, HPN-SSH
 through 18.2.0, ProFTPD before 1.3.8b (and before 1.3.9rc2), ORYX
 CycloneSSH before 2.3.4, NetSarang XShell 7 before Build 0144, CrushFTP
 before 10.6.0, ConnectBot SSH library before 2.2.22, Apache MINA sshd
 through 2.11.0, sshj through 0.37.0, TinySSH through 20230101, trilead-ssh2
 6401, LANCOM LCOS and LANconfig, FileZilla before 3.66.4, Nova before 11.8,
 PKIX-SSH before 14.4, SecureCRT before 9.4.3, Transmit5 before 5.10.4,
 Win32-OpenSSH before 9.5.0.0p1-Beta, WinSCP before 6.2.2, Bitvise SSH
 Server before 9.32, Bitvise SSH Client before 9.33, KiTTY through
 0.76.1.13, the net-ssh gem 7.2.0 for Ruby, the mscdex ssh2 module before
 1.15.0 for Node.js, the thrussh library before 0.35.1 for Rust, and the
 Russh crate before 0.40.2 for Rust.
Ubuntu-Description:
Notes:
 mdeslaur> Per upstream openssh developers:
  While cryptographically novel, the security impact of this attack
  is fortunately very limited as it only allows deletion of
  consecutive messages, and deleting most messages at this stage of
  the protocol prevents user user authentication from proceeding and
  results in a stuck connection.
  The most serious identified impact is that it lets a MITM to
  delete the SSH2_MSG_EXT_INFO message sent before authentication
  starts, allowing the attacker to disable a subset of the keystroke
  timing obfuscation features introduced in OpenSSH 9.5. There is no
  other discernable impact to session secrecy or session integrity.
 mdeslaur> snapd aonly uses the terminal sub-package, not the ssh
 mdeslaur> part of golang-go.crypto, so it is not vulnerable
 sbeattie> putty fixes include some refactoring commits that are used
  by the added strict kex mode support
 mdeslaur> openssh-ssh1 is only provided for compatibility with old devices
 mdeslaur> that cannot be upgraded to modern protocols. We will not be
 mdeslaur> providing any security support for the openssh-ssh1 package as
 mdeslaur> it is insecure and should be used in trusted environments only.
 jdstrand> snapd contains an embedded copy of golang-go.crypto
 jdstrand> lxd in 18.04 LTS and earlier contains an embedded copy of
 jdstrand> golang-go.crypto
 sbeattie> proftpd-dfsg contains an ssh implementation in mod-sftp
  (distributed in proftpd-mod-crypto/proftpd-basic)
 mdeslaur> per Debian, libssh2 older than mantic isn't vulnerable as it
 mdeslaur> doesn't support ChaCha20-Poly1305 and CBC-EtM.
 ccdm94> libssh will be marked as not affected for bionic and earlier as per
 ccdm94> the above note. ChaCha20-Poly1305 and CBC-EtM are present only in
 ccdm94> libssh 0.8.0 (released 2018-08-10. Bionic is version 0.8.0, but
 ccdm94> based on commit 94fa1e38, which was released 2017-08-25) and later.
 ccdm94> Patches provided by upstream do not apply cleanly to versions in
 ccdm94> bionic and earlier as several functionalities are not present in
 ccdm94> these versions of the code (making backports a more likely to
 ccdm94> introduce regressions) further supporting the defined not affected
 ccdm94> status.
Mitigation:
Bugs:
 https://github.com/golang/go/issues/64784
 https://github.com/paramiko/paramiko/issues/2337
 https://github.com/libssh2/libssh2/issues/1290
Priority: medium
Discovered-by: Fabian Bäumer, Marcus Brinkmann, Jörg Schwenk
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N [5.9 MEDIUM]

Patches_openssh:
 upstream: https://github.com/openssh/openssh-portable/commit/1edb00c58f8a6875fad6a497aa2bacf37f9e6cd5
upstream_openssh: released (1:9.5p1-1)
trusty_openssh: ignored (end of standard support)
trusty/esm_openssh: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_openssh: needs-triage
xenial_openssh: ignored (end of standard support)
esm-infra/xenial_openssh: released (1:7.2p2-4ubuntu2.10+esm5)
fips-updates/xenial_openssh: released (1:7.2p2-4ubuntu2.fips.2.10.5)
fips/xenial_openssh: needed
bionic_openssh: ignored (end of standard support)
esm-infra/bionic_openssh: released (1:7.6p1-4ubuntu0.7+esm3)
fips-updates/bionic_openssh: released (1:7.9p1-10~ubuntu18.04.fips.0.9)
fips/bionic_openssh: needed
focal_openssh: released (1:8.2p1-4ubuntu0.10)
esm-infra/focal_openssh: released (1:8.2p1-4ubuntu0.10)
fips-updates/focal_openssh: released (1:8.2p1-4ubuntu0.fips.0.10)
fips/focal_openssh: needed
jammy_openssh: released (1:8.9p1-3ubuntu0.5)
fips-preview/jammy_openssh: released (1:8.9p1-3ubuntu0.5)
fips-updates/jammy_openssh: released (1:8.9p1-3ubuntu0.5)
lunar_openssh: released (1:9.0p1-1ubuntu8.6)
mantic_openssh: released (1:9.3p1-1ubuntu3.1)
noble_openssh: released (1:9.6p1-3ubuntu1)
oracular_openssh: released (1:9.6p1-3ubuntu1)
plucky_openssh: released (1:9.6p1-3ubuntu1)
devel_openssh: released (1:9.6p1-3ubuntu1)

Patches_dropbear:
 upstream: https://github.com/mkj/dropbear/commit/6e43be5c7b99dbee49dc72b6f989f29fdd7e9356
upstream_dropbear: needs-triage
trusty_dropbear: ignored (end of standard support)
xenial_dropbear: ignored (end of standard support)
esm-apps/xenial_dropbear: needs-triage
bionic_dropbear: ignored (end of standard support)
esm-apps/bionic_dropbear: released (2017.75-3ubuntu0.1~esm1)
focal_dropbear: ignored (end of standard support, was needed)
esm-apps/focal_dropbear: released (2019.78-2ubuntu0.1~esm1)
jammy_dropbear: released (2020.81-5ubuntu0.1)
esm-apps/jammy_dropbear: released (2020.81-5ubuntu0.1)
lunar_dropbear: ignored (end of life, was needs-triage)
mantic_dropbear: ignored (end of life, was needs-triage)
noble_dropbear: needs-triage
esm-apps/noble_dropbear: needs-triage
oracular_dropbear: ignored (end of life, was needs-triage)
plucky_dropbear: needs-triage
devel_dropbear: needs-triage

Patches_golang-go.crypto:
 upstream: https://github.com/golang/crypto/commit/9d2ee975ef9fe627bf0a6f01c1f69e8ef1d4f05d
upstream_golang-go.crypto: needs-triage
trusty_golang-go.crypto: ignored (end of standard support)
xenial_golang-go.crypto: ignored (end of standard support)
esm-infra/xenial_golang-go.crypto: needs-triage
bionic_golang-go.crypto: ignored (end of standard support)
esm-apps/bionic_golang-go.crypto: needs-triage
focal_golang-go.crypto: ignored (end of standard support, was needs-triage)
esm-apps/focal_golang-go.crypto: needs-triage
jammy_golang-go.crypto: needs-triage
esm-apps/jammy_golang-go.crypto: needs-triage
lunar_golang-go.crypto: ignored (end of life, was needs-triage)
mantic_golang-go.crypto: ignored (end of life, was needs-triage)
noble_golang-go.crypto: needs-triage
esm-apps/noble_golang-go.crypto: needs-triage
oracular_golang-go.crypto: ignored (end of life, was needs-triage)
plucky_golang-go.crypto: needs-triage
devel_golang-go.crypto: needs-triage

Patches_snapd:
 upstream: https://github.com/snapcore/snapd/pull/14143
upstream_snapd: needs-triage
snap_snapd: not-affected (code not present)
trusty_snapd: ignored (end of standard support)
xenial_snapd: ignored (end of standard support)
esm-infra/xenial_snapd: not-affected (code not present)
bionic_snapd: ignored (end of standard support)
esm-infra/bionic_snapd: not-affected (code not present)
focal_snapd: not-affected (code not present)
esm-infra/focal_snapd: not-affected (code not present)
jammy_snapd: not-affected (code not present)
lunar_snapd: ignored (end of life, was needs-triage)
mantic_snapd: ignored (end of life, was needs-triage)
noble_snapd: not-affected (code not present)
oracular_snapd: not-affected (code not present)
plucky_snapd: not-affected (code not present)
devel_snapd: not-affected (code not present)

Patches_lxd:
upstream_lxd: needs-triage
trusty_lxd: DNE
xenial_lxd: ignored (end of standard support)
esm-infra/xenial_lxd: released (2.0.11-0ubuntu1~16.04.4+esm1)
bionic_lxd: ignored (end of standard support)
esm-infra/bionic_lxd: released (3.0.3-0ubuntu1~18.04.2+esm1)
focal_lxd: not-affected (code-not-present)
esm-apps/focal_lxd: not-affected (code-not-present)
jammy_lxd: DNE
lunar_lxd: DNE
mantic_lxd: DNE
noble_lxd: DNE
oracular_lxd: DNE
plucky_lxd: DNE
devel_lxd: DNE

Patches_libssh:
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/4cef5e965a46e9271aed62631b152e4bd23c1e3c
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/0870c8db28be9eb457ee3d4f9a168959d9507efd
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/5846e57538c750c5ce67df887d09fa99861c79c6
 upstream: https://gitlab.com/libssh/libssh-mirror/-/commit/89df759200d31fc79fbbe213d8eda0d329eebf6d
upstream_libssh: released (0.10.6-1)
trusty_libssh: ignored (end of standard support)
xenial_libssh: ignored (end of standard support)
esm-infra/xenial_libssh: not-affected (code not present)
bionic_libssh: ignored (end of standard support)
esm-infra/bionic_libssh: not-affected (code not present)
focal_libssh: released (0.9.3-2ubuntu2.4)
esm-infra/focal_libssh: released (0.9.3-2ubuntu2.4)
jammy_libssh: released (0.9.6-2ubuntu0.22.04.2)
lunar_libssh: released (0.10.4-2ubuntu0.2)
mantic_libssh: released (0.10.5-3ubuntu1.1)
noble_libssh: not-affected (0.10.6-2)
oracular_libssh: not-affected (0.10.6-2)
plucky_libssh: not-affected (0.10.6-2)
devel_libssh: not-affected (0.10.6-2)

Patches_libssh2:
 upstream: https://github.com/libssh2/libssh2/commit/d34d9258b8420b19ec3f97b4cc5bf7aa7d98e35a
 upstream: https://github.com/libssh2/libssh2/pull/1291
upstream_libssh2: released (1.11.0-4)
trusty_libssh2: ignored (end of standard support)
trusty/esm_libssh2: not-affected
esm-infra-legacy/trusty_libssh2: not-affected
xenial_libssh2: ignored (end of standard support)
esm-apps/xenial_libssh2: not-affected
bionic_libssh2: ignored (end of standard support)
esm-apps/bionic_libssh2: not-affected
focal_libssh2: not-affected (1.8.0-2.1ubuntu0.1)
esm-apps/focal_libssh2: not-affected (1.8.0-2.1ubuntu0.1)
jammy_libssh2: not-affected (1.10.0-3)
esm-apps/jammy_libssh2: not-affected (1.10.0-3)
lunar_libssh2: not-affected (1.10.0-3)
mantic_libssh2: released (1.11.0-2ubuntu0.1)
noble_libssh2: not-affected (1.11.0-4)
oracular_libssh2: not-affected (1.11.0-4)
plucky_libssh2: not-affected (1.11.0-4)
devel_libssh2: not-affected (1.11.0-4)

Patches_openssh-ssh1:
upstream_openssh-ssh1: ignored (frozen on openssh 7.5p)
trusty_openssh-ssh1: DNE
xenial_openssh-ssh1: DNE
bionic_openssh-ssh1: ignored (end of standard support)
esm-apps/bionic_openssh-ssh1: ignored
focal_openssh-ssh1: ignored
esm-apps/focal_openssh-ssh1: ignored
jammy_openssh-ssh1: ignored
esm-apps/jammy_openssh-ssh1: ignored
lunar_openssh-ssh1: ignored (end of life, was needs-triage)
mantic_openssh-ssh1: ignored (end of life, was needs-triage)
noble_openssh-ssh1: ignored
esm-apps/noble_openssh-ssh1: ignored
oracular_openssh-ssh1: ignored
plucky_openssh-ssh1: ignored
devel_openssh-ssh1: ignored

Patches_paramiko:
 upstream: https://github.com/paramiko/paramiko/commit/be3ffc18cc466e0b0a877d716721353c12561bcc
 upstream: https://github.com/paramiko/paramiko/commit/4c7f0410c533cdf0df2890512237961f934f5ab9 (changelog)
 upstream: https://github.com/paramiko/paramiko/commit/773a174fb1e40e1d18dbe2625e16337ea401119e
 upstream: https://github.com/paramiko/paramiko/commit/c32be441a5ff0dc4914b22d6d1efa392aebe862f (not required)
 upstream: https://github.com/paramiko/paramiko/commit/f4dedacb9040d27d9844f51c81c28e0247d3e4a3
 upstream: https://github.com/paramiko/paramiko/commit/73f079f5a4bbba7f3048dadbe05b24242206745e (changelog)
 upstream: https://github.com/paramiko/paramiko/commit/75e311d3c0845a316b6e7b3fae2488d86ad5a270
 upstream: https://github.com/paramiko/paramiko/commit/fa46de7feeeb8a01dc471581a0258252ce4f2db6
 upstream: https://github.com/paramiko/paramiko/commit/8dcb237f0ee095b1d8b26765c3d41d0ab6963be9 (test suite fix)
 upstream: https://github.com/paramiko/paramiko/commit/58785d29c47570fa700e096d16b9a0d3a6069048 (changelog)
 upstream: https://github.com/paramiko/paramiko/commit/96db1e2be856eac66631761bae41167a1ebd2b4e
 upstream: https://github.com/paramiko/paramiko/commit/33508c920309860c4a775be70f209c2a400e18ec
 upstream: https://github.com/paramiko/paramiko/commit/30b447b911c39460bbef5e7834e339c43a251316 (lint)
 upstream: https://github.com/paramiko/paramiko/commit/3e4bdf998f5b1508322234a527e8fa432220368b (changelog)
upstream_paramiko: needs-triage
trusty_paramiko: ignored (end of standard support)
trusty/esm_paramiko: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_paramiko: needs-triage
xenial_paramiko: ignored (end of standard support)
esm-infra/xenial_paramiko: needs-triage
bionic_paramiko: ignored (end of standard support)
esm-infra/bionic_paramiko: needs-triage
focal_paramiko: released (2.6.0-2ubuntu0.3)
esm-infra/focal_paramiko: released (2.6.0-2ubuntu0.3)
jammy_paramiko: released (2.9.3-0ubuntu1.2)
lunar_paramiko: ignored (end of life)
mantic_paramiko: released (2.12.0-2ubuntu1.23.10.2)
noble_paramiko: released (2.12.0-2ubuntu4)
oracular_paramiko: released (2.12.0-2ubuntu4)
plucky_paramiko: released (2.12.0-2ubuntu4)
devel_paramiko: released (2.12.0-2ubuntu4)

Patches_putty:
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=9e099151574885f3c717ac10a633a9218db8e7bb
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=f2e7086902b3605c96e54ef9c956ca7ab000010e
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=9fcbb86f715bc03e58921482efe663aa0c662d62
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=244be5412728a7334a2d457fbac4e0a2597165e5
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=58fc33a155ad496bdcf380fa6193302240a15ae9
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=0b00e4ce26d89cd010e31e66fd02ac77cb982367
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=fdc891d17063ab26cf68c74245ab1fd9771556cb
 upstream: https://git.tartarus.org/?p=simon/putty.git;a=commit;h=b80a41d386dbfa1b095c17bd2ed001477f302d46
upstream_putty: released (0.80-1)
trusty_putty: ignored (end of standard support)
xenial_putty: ignored (end of standard support)
esm-apps/xenial_putty: needs-triage
bionic_putty: ignored (end of standard support)
esm-apps/bionic_putty: needs-triage
focal_putty: ignored (end of standard support, was needs-triage)
esm-apps/focal_putty: needs-triage
jammy_putty: needs-triage
esm-apps/jammy_putty: needs-triage
lunar_putty: ignored (end of life, was needs-triage)
mantic_putty: ignored (end of life, was needs-triage)
noble_putty: needs-triage
esm-apps/noble_putty: needs-triage
oracular_putty: not-affected (0.81-1)
plucky_putty: not-affected (0.81-1)
devel_putty: not-affected (0.81-1)

Patches_proftpd-dfsg:
upstream_proftpd-dfsg: needs-triage
trusty_proftpd-dfsg: ignored (end of standard support)
xenial_proftpd-dfsg: ignored (end of standard support)
esm-apps/xenial_proftpd-dfsg: needs-triage
bionic_proftpd-dfsg: ignored (end of standard support)
esm-apps/bionic_proftpd-dfsg: needs-triage
focal_proftpd-dfsg: released (1.3.6c-2ubuntu0.1)
esm-apps/focal_proftpd-dfsg: released (1.3.6c-2ubuntu0.1)
jammy_proftpd-dfsg: not-affected (1.3.7c+dfsg-1build1)
esm-apps/jammy_proftpd-dfsg: not-affected (1.3.7c+dfsg-1build1)
lunar_proftpd-dfsg: ignored (end of life, was needs-triage)
mantic_proftpd-dfsg: ignored (end of life, was needs-triage)
noble_proftpd-dfsg: not-affected (1.3.8.b+dfsg-1build3)
esm-apps/noble_proftpd-dfsg: not-affected (1.3.8.b+dfsg-1build3)
oracular_proftpd-dfsg: released (1.3.8.b+dfsg-2ubuntu1.24.10.1)
plucky_proftpd-dfsg: needs-triage
devel_proftpd-dfsg: needs-triage

Patches_python-asyncssh:
 upstream: https://github.com/ronf/asyncssh/commit/0bc73254f41acb140187e0c89606311f88de5b7b
upstream_python-asyncssh: released (2.14.2)
trusty_python-asyncssh: DNE
xenial_python-asyncssh: ignored (end of standard support)
esm-apps/xenial_python-asyncssh: ignored (changes too intrusive)
bionic_python-asyncssh: ignored (end of standard support)
esm-apps/bionic_python-asyncssh: ignored (changes too intrusive)
focal_python-asyncssh: released (1.12.2-1ubuntu0.1)
esm-apps/focal_python-asyncssh: released (1.12.2-1ubuntu0.1)
jammy_python-asyncssh: needed
esm-apps/jammy_python-asyncssh: released (2.5.0-1ubuntu0.1~esm1)
lunar_python-asyncssh: ignored (end of life, was needs-triage)
mantic_python-asyncssh: ignored (end of life, was needs-triage)
noble_python-asyncssh: released (2.10.1-2ubuntu0.1)
esm-apps/noble_python-asyncssh: released (2.10.1-2ubuntu0.1)
oracular_python-asyncssh: released (2.10.1-2ubuntu1)
plucky_python-asyncssh: released (2.10.1-2ubuntu1)
devel_python-asyncssh: released (2.10.1-2ubuntu1)

Patches_filezilla:
upstream_filezilla: released (3.66.4.)
trusty_filezilla: ignored (end of standard support)
trusty/esm_filezilla: DNE
esm-infra-legacy/trusty_filezilla: DNE
xenial_filezilla: ignored (end of standard support)
esm-apps/xenial_filezilla: not-affected (code not present)
bionic_filezilla: ignored (end of standard support)
esm-apps/bionic_filezilla: not-affected (code not present)
focal_filezilla: released (3.46.3-1ubuntu0.1)
esm-apps/focal_filezilla: released (3.46.3-1ubuntu0.1)
jammy_filezilla: released (3.58.0-1ubuntu0.1)
esm-apps/jammy_filezilla: released (3.58.0-1ubuntu0.1)
lunar_filezilla: ignored (end of life, was needed)
mantic_filezilla: released (3.65.0-3ubuntu0.1)
noble_filezilla: released (3.66.4-1)
esm-apps/noble_filezilla: released (3.66.4-1)
oracular_filezilla: released (3.66.4-1)
plucky_filezilla: released (3.66.4-1)
devel_filezilla: released (3.66.4-1)
