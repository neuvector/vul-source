Candidate: CVE-2019-18421
PublicDate: 2019-10-31 14:15:00 UTC
References:
 https://xenbits.xen.org/xsa/advisory-299.html
 http://www.openwall.com/lists/oss-security/2019/10/31/3
 http://xenbits.xen.org/xsa/advisory-299.html
 https://www.cve.org/CVERecord?id=CVE-2019-18421
Description:
 An issue was discovered in Xen through 4.12.x allowing x86 PV guest OS
 users to gain host OS privileges by leveraging race conditions in pagetable
 promotion and demotion operations. There are issues with restartable PV
 type change operations. To avoid using shadow pagetables for PV guests, Xen
 exposes the actual hardware pagetables to the guest. In order to prevent
 the guest from modifying these page tables directly, Xen keeps track of how
 pages are used using a type system; pages must be "promoted" before being
 used as a pagetable, and "demoted" before being used for any other type.
 Xen also allows for "recursive" promotions: i.e., an operating system
 promoting a page to an L4 pagetable may end up causing pages to be promoted
 to L3s, which may in turn cause pages to be promoted to L2s, and so on.
 These operations may take an arbitrarily large amount of time, and so must
 be re-startable. Unfortunately, making recursive pagetable promotion and
 demotion operations restartable is incredibly complicated, and the code
 contains several races which, if triggered, can cause Xen to drop or retain
 extra type counts, potentially allowing guests to get write access to
 in-use pagetables. A malicious PV guest administrator may be able to
 escalate their privilege to that of the host. All x86 systems with
 untrusted PV guests are vulnerable. HVM and PVH guests cannot exercise this
 vulnerability.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H [7.5 HIGH]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: needs-triage
precise/esm_xen: DNE
trusty_xen: ignored (end of standard support)
trusty/esm_xen: DNE
esm-infra-legacy/trusty_xen: DNE
xenial_xen: ignored (end of standard support, was needs-triage)
esm-infra/xenial_xen: needed
bionic_xen: ignored (end of standard support, was needed)
esm-infra/bionic_xen: needed
disco_xen: ignored (end of life)
eoan_xen: ignored (end of life)
focal_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
esm-infra/focal_xen: DNE (focal was not-affected [4.11.3+24-g14b62ab3e5-1ubuntu1])
esm-apps/focal_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
groovy_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
hirsute_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
impish_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
jammy_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
esm-apps/jammy_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
kinetic_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
lunar_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
mantic_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
noble_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
esm-apps/noble_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
oracular_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
plucky_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)
devel_xen: not-affected (4.11.3+24-g14b62ab3e5-1ubuntu1)

