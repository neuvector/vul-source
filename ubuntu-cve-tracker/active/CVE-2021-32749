PublicDateAtUSN: 2021-07-16 18:15:00 UTC
Candidate: CVE-2021-32749
PublicDate: 2021-07-16 18:15:00 UTC
References:
 https://github.com/fail2ban/fail2ban/security/advisories/GHSA-m985-3f3v-cwmm
 https://github.com/fail2ban/fail2ban/commit/2ed414ed09b3bb4c478abc9366a1ff22024a33c9 (0.9)
 https://github.com/fail2ban/fail2ban/commit/410a6ce5c80dd981c22752da034f2529b5eee844 (0.10, 0.11, 1.0)
 https://github.com/fail2ban/fail2ban/commit/410a6ce5c80dd981c22752da034f2529b5eee844
 https://github.com/fail2ban/fail2ban/commit/2ed414ed09b3bb4c478abc9366a1ff22024a33c9
 https://ubuntu.com/security/notices/USN-5232-1
 https://www.cve.org/CVERecord?id=CVE-2021-32749
Description:
 fail2ban is a daemon to ban hosts that cause multiple authentication
 errors. In versions 0.9.7 and prior, 0.10.0 through 0.10.6, and 0.11.0
 through 0.11.2, there is a vulnerability that leads to possible remote code
 execution in the mailing action mail-whois. Command `mail` from mailutils
 package used in mail actions like `mail-whois` can execute command if
 unescaped sequences (`\n~`) are available in "foreign" input (for instance
 in whois output). To exploit the vulnerability, an attacker would need to
 insert malicious characters into the response sent by the whois server,
 either via a MITM attack or by taking over a whois server. The issue is
 patched in versions 0.10.7 and 0.11.3. As a workaround, one may avoid the
 usage of action `mail-whois` or patch the vulnerability manually.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/fail2ban/+bug/1939870
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N [6.1 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]


Patches_fail2ban:
upstream_fail2ban: released (0.11.2-2)
trusty_fail2ban: ignored (end of standard support)
trusty/esm_fail2ban: released (0.8.11-1ubuntu0.1~esm1)
esm-infra-legacy/trusty_fail2ban: not-affected (0.8.11-1ubuntu0.1~esm1)
xenial_fail2ban: ignored (end of standard support)
esm-apps/xenial_fail2ban: released (0.9.3-1ubuntu0.1~esm1)
bionic_fail2ban: ignored (end of standard support, was needed)
esm-apps/bionic_fail2ban: released (0.10.2-2ubuntu0.1~esm1)
focal_fail2ban: needed
esm-apps/focal_fail2ban: released (0.11.1-1ubuntu0.1~esm1)
groovy_fail2ban: ignored (end of life)
hirsute_fail2ban: ignored (end of life)
impish_fail2ban: not-affected (0.11.2-2)
jammy_fail2ban: not-affected (0.11.2-2)
esm-apps/jammy_fail2ban: not-affected (0.11.2-2)
kinetic_fail2ban: not-affected (0.11.2-2)
lunar_fail2ban: not-affected (0.11.2-2)
mantic_fail2ban: not-affected (0.11.2-2)
noble_fail2ban: not-affected (0.11.2-2)
esm-apps/noble_fail2ban: not-affected (0.11.2-2)
oracular_fail2ban: not-affected (0.11.2-2)
plucky_fail2ban: not-affected (0.11.2-2)
devel_fail2ban: not-affected (0.11.2-2)
