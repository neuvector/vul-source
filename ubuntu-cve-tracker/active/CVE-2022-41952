Candidate: CVE-2022-41952
PublicDate: 2022-11-22 16:15:00 UTC
References:
 https://github.com/matrix-org/synapse/security/advisories/GHSA-4822-jvwx-w47h
 https://github.com/matrix-org/synapse/pull/11784
 https://github.com/matrix-org/synapse/pull/11936
 https://github.com/matrix-org/synapse/releases/tag/v1.53.0
 https://github.com/matrix-org/synapse/releases/tag/v1.52.0
 https://www.cve.org/CVERecord?id=CVE-2022-41952
Description:
 Synapse before 1.52.0 with URL preview functionality enabled will attempt
 to generate URL previews for media stream URLs without properly limiting
 connection time. Connections will only be terminated after
 `max_spider_size` (default: 10M) bytes have been downloaded, which can in
 some cases lead to long-lived connections towards the streaming media
 server (for instance, Icecast). This can cause excessive traffic and
 connections toward such servers if their stream URL is, for example, posted
 to a large room with many Synapse instances with URL preview enabled.
 Version 1.52.0 implements a timeout mechanism which will terminate URL
 preview connections after 30 seconds. Since generating URL previews for
 media streams is not supported and always fails, 1.53.0 additionally
 implements an allow list for content types for which Synapse will even
 attempt to generate a URL preview. Upgrade to 1.53.0 to fully resolve the
 issue. As a workaround, turn off URL preview functionality by setting
 `url_preview_enabled: false` in the Synapse configuration file.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: 
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L [6.5 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L [5.3 MEDIUM]

Patches_matrix-synapse:
upstream_matrix-synapse: released (1.53.0-1)
trusty_matrix-synapse: ignored (end of standard support)
xenial_matrix-synapse: ignored (end of standard support)
bionic_matrix-synapse: ignored (end of standard support, was needs-triage)
esm-apps/bionic_matrix-synapse: needs-triage
focal_matrix-synapse: needs-triage
esm-apps/focal_matrix-synapse: needs-triage
jammy_matrix-synapse: not-affected (1.53.0-1)
esm-apps/jammy_matrix-synapse: not-affected (1.53.0-1)
kinetic_matrix-synapse: not-affected
lunar_matrix-synapse: not-affected
mantic_matrix-synapse: not-affected
noble_matrix-synapse: not-affected
esm-apps/noble_matrix-synapse: not-affected
oracular_matrix-synapse: not-affected
