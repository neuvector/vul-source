PublicDateAtUSN: 2021-02-16 17:15:00 UTC
Candidate: CVE-2021-23840
PublicDate: 2021-02-16 17:15:00 UTC
References:
 https://www.openssl.org/news/secadv/20210216.txt
 https://ubuntu.com/security/notices/USN-4738-1
 https://ubuntu.com/security/notices/USN-5088-1
 https://www.cve.org/CVERecord?id=CVE-2021-23840
 https://ubuntu.com/security/notices/USN-7018-1
Description:
 Calls to EVP_CipherUpdate, EVP_EncryptUpdate and EVP_DecryptUpdate may
 overflow the output length argument in some cases where the input length is
 close to the maximum permissable length for an integer on the platform. In
 such cases the return value from the function call will be 1 (indicating
 success), but the output length value will be negative. This could cause
 applications to behave incorrectly or crash. OpenSSL versions 1.1.1i and
 below are affected by this issue. Users of these versions should upgrade to
 OpenSSL 1.1.1j. OpenSSL versions 1.0.2x and below are affected by this
 issue. However OpenSSL 1.0.2 is out of support and no longer receiving
 public updates. Premium support customers of OpenSSL 1.0.2 should upgrade
 to 1.0.2y. Other users should upgrade to 1.1.1j. Fixed in OpenSSL 1.1.1j
 (Affected 1.1.1-1.1.1i). Fixed in OpenSSL 1.0.2y (Affected 1.0.2-1.0.2x).
Ubuntu-Description:
Notes:
 mdeslaur> edk2 doesn't use EVP_CipherUpdate, EVP_EncryptUpdate, or
 mdeslaur> EVP_DecryptUpdate, so it doesn't appear vulnerable to this issue
 mdeslaur> edk2 upstream says EVP_DecryptUpdate is used by drivers
Mitigation:
Bugs:
 https://bugzilla.tianocore.org/show_bug.cgi?id=3266 (edk2)
Priority: low
Discovered-by: Paul Kehrer
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_openssl:
 upstream: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=6a51b9e1d0cf0bf8515f7201b68fb0a3482b3dc1
upstream_openssl: released (1.1.1j)
precise/esm_openssl: ignored (end of life, was needs-triage)
trusty_openssl: ignored (end of standard support)
trusty/esm_openssl: released (1.0.1f-1ubuntu2.27+esm10)
esm-infra-legacy/trusty_openssl: not-affected (1.0.1f-1ubuntu2.27+esm10)
xenial_openssl: released (1.0.2g-1ubuntu4.19)
esm-infra/xenial_openssl: not-affected (1.0.2g-1ubuntu4.19)
fips/xenial_openssl: needed
fips-updates/xenial_openssl: released (1.0.2g-1ubuntu4.fips.4.19.3)
bionic_openssl: released (1.1.1-1ubuntu2.1~18.04.8)
esm-infra/bionic_openssl: not-affected (1.1.1-1ubuntu2.1~18.04.8)
fips/bionic_openssl: needed
fips-updates/bionic_openssl: released (1.1.1-1ubuntu2.fips.2.1~18.04.9.1)
focal_openssl: released (1.1.1f-1ubuntu2.2)
esm-infra/focal_openssl: not-affected (1.1.1f-1ubuntu2.2)
fips/focal_openssl: released (1.1.1f-1ubuntu2.fips.2.8)
fips-updates/focal_openssl: released (1.1.1f-1ubuntu2.fips.7.2)
groovy_openssl: released (1.1.1f-1ubuntu4.2)
hirsute_openssl: released (1.1.1j-1ubuntu1)
impish_openssl: released (1.1.1j-1ubuntu1)
jammy_openssl: released (1.1.1j-1ubuntu1)
fips-preview/jammy_openssl: released (1.1.1j-1ubuntu1)
fips-updates/jammy_openssl: released (1.1.1j-1ubuntu1)
kinetic_openssl: released (1.1.1j-1ubuntu1)
lunar_openssl: released (1.1.1j-1ubuntu1)
mantic_openssl: released (1.1.1j-1ubuntu1)
noble_openssl: released (1.1.1j-1ubuntu1)
oracular_openssl: released (1.1.1j-1ubuntu1)
plucky_openssl: released (1.1.1j-1ubuntu1)
devel_openssl: released (1.1.1j-1ubuntu1)

Patches_openssl1.0:
upstream_openssl1.0: released (1.0.2y)
precise/esm_openssl1.0: DNE
trusty_openssl1.0: DNE
trusty/esm_openssl1.0: DNE
esm-infra-legacy/trusty_openssl1.0: DNE
xenial_openssl1.0: DNE
bionic_openssl1.0: released (1.0.2n-1ubuntu5.6)
esm-infra/bionic_openssl1.0: not-affected (1.0.2n-1ubuntu5.6)
focal_openssl1.0: DNE
esm-infra/focal_openssl1.0: DNE
groovy_openssl1.0: DNE
hirsute_openssl1.0: DNE
impish_openssl1.0: DNE
jammy_openssl1.0: DNE
kinetic_openssl1.0: DNE
lunar_openssl1.0: DNE
mantic_openssl1.0: DNE
noble_openssl1.0: DNE
oracular_openssl1.0: DNE
plucky_openssl1.0: DNE
devel_openssl1.0: DNE

Patches_nodejs:
upstream_nodejs: needs-triage
precise/esm_nodejs: DNE
trusty_nodejs: ignored (end of standard support)
trusty/esm_nodejs: not-affected (uses system openssl)
esm-infra-legacy/trusty_nodejs: not-affected (uses system openssl)
xenial_nodejs: not-affected (uses system openssl)
esm-apps/xenial_nodejs: not-affected (uses system openssl)
bionic_nodejs: not-affected (uses system openssl1.0)
esm-apps/bionic_nodejs: not-affected (uses system openssl1.0)
focal_nodejs: not-affected (uses system openssl1.1)
esm-apps/focal_nodejs: not-affected (uses system openssl1.1)
groovy_nodejs: not-affected (uses system openssl1.1)
hirsute_nodejs: not-affected (uses system openssl1.1)
impish_nodejs: not-affected (uses system openssl1.1)
jammy_nodejs: needed
esm-apps/jammy_nodejs: needed
kinetic_nodejs: not-affected (uses system openssl1.1)
lunar_nodejs: not-affected (uses system openssl1.1)
mantic_nodejs: not-affected (uses system openssl1.1)
noble_nodejs: not-affected (uses system openssl1.1)
esm-apps/noble_nodejs: not-affected (uses system openssl1.1)
oracular_nodejs: not-affected (uses system openssl1.1)
plucky_nodejs: not-affected (uses system openssl1.1)
devel_nodejs: not-affected (uses system openssl1.1)

Patches_edk2:
upstream_edk2: not-affected
precise/esm_edk2: DNE
trusty_edk2: ignored (end of standard support)
trusty/esm_edk2: DNE
esm-infra-legacy/trusty_edk2: DNE
xenial_edk2: ignored (end of standard support)
esm-apps/xenial_edk2: needs-triage
bionic_edk2: ignored (end of standard support, was needed)
esm-apps/bionic_edk2: needed
focal_edk2: released (0~20191122.bd85bf54-2ubuntu3.3)
esm-infra/focal_edk2: not-affected (0~20191122.bd85bf54-2ubuntu3.3)
groovy_edk2: ignored (end of life)
hirsute_edk2: released (2020.11-4ubuntu0.1)
impish_edk2: not-affected (2021.08~rc0-2)
jammy_edk2: not-affected (2021.08~rc0-2)
kinetic_edk2: not-affected (2021.08~rc0-2)
lunar_edk2: not-affected (2021.08~rc0-2)
mantic_edk2: not-affected (2021.08~rc0-2)
noble_edk2: not-affected (2021.08~rc0-2)
oracular_edk2: not-affected (2021.08~rc0-2)
plucky_edk2: not-affected (2021.08~rc0-2)
devel_edk2: not-affected (2021.08~rc0-2)
