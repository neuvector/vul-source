Candidate: CVE-2022-39374
PublicDate: 2023-05-26 14:15:00 UTC
References:
 https://bugzilla.redhat.com/show_bug.cgi?id=2209956
 https://www.cve.org/CVERecord?id=CVE-2022-39374
Description:
 Synapse is an open-source Matrix homeserver written and maintained by the
 Matrix.org Foundation. If Synapse and a malicious homeserver are both
 joined to the same room, the malicious homeserver can trick Synapse into
 accepting previously rejected events into its view of the current state of
 that room. This can be exploited in a way that causes all further messages
 and state changes sent in that room from the vulnerable homeserver to be
 rejected. This issue has been patched in version 1.68.0
Ubuntu-Description:
Notes:
 john-breton> In older matrix-synapse releases, v2 of state/ had not been
 john-breton> introduced, and as such the vulnerability is not present.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: john-breton
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H [6.5 MEDIUM]

Patches_matrix-synapse:
 upstream: https://github.com/matrix-org/synapse/pull/13723
upstream_matrix-synapse: released (1.68.0)
trusty_matrix-synapse: ignored (end of standard support)
xenial_matrix-synapse: ignored (end of standard support)
bionic_matrix-synapse: ignored (end of standard support, was needs-triage)
esm-apps/bionic_matrix-synapse: not-affected (code not present)
focal_matrix-synapse: needed
esm-apps/focal_matrix-synapse: needed
jammy_matrix-synapse: needed
esm-apps/jammy_matrix-synapse: needed
kinetic_matrix-synapse: ignored (end of life, was needs-triage)
lunar_matrix-synapse: ignored (end of life, was needs-triage)
mantic_matrix-synapse: ignored (end of life, was needs-triage)
noble_matrix-synapse: not-affected (1.100.0-1ubuntu1)
esm-apps/noble_matrix-synapse: not-affected (1.100.0-1ubuntu1)
oracular_matrix-synapse: not-affected (1.100.0-1ubuntu1)
devel_matrix-synapse: not-affected (1.121.0-5)
