Candidate: CVE-2022-31163
PublicDate: 2022-07-22 04:15:00 UTC
References:
 https://github.com/tzinfo/tzinfo/security/advisories/GHSA-5cm2-9h8c-rvfx
 https://github.com/tzinfo/tzinfo/commit/ca29f349856d62cb2b2edb3257d9ddd2f97b3c27
 https://github.com/tzinfo/tzinfo/releases/tag/v0.3.61
 https://github.com/tzinfo/tzinfo/releases/tag/v1.2.10
 https://www.cve.org/CVERecord?id=CVE-2022-31163
Description:
 TZInfo is a Ruby library that provides access to time zone data and allows
 times to be converted using time zone rules. Versions prior to 0.36.1, as
 well as those prior to 1.2.10 when used with the Ruby data source
 tzinfo-data, are vulnerable to relative path traversal. With the Ruby data
 source, time zones are defined in Ruby files. There is one file per time
 zone. Time zone files are loaded with `require` on demand. In the affected
 versions, `TZInfo::Timezone.get` fails to validate time zone identifiers
 correctly, allowing a new line character within the identifier. With Ruby
 version 1.9.3 and later, `TZInfo::Timezone.get` can be made to load
 unintended files with `require`, executing them within the Ruby process.
 Versions 0.3.61 and 1.2.10 include fixes to correctly validate time zone
 identifiers. Versions 2.0.0 and later are not vulnerable. Version 0.3.61
 can still load arbitrary files from the Ruby load path if their name
 follows the rules for a valid time zone identifier and the file has a
 prefix of `tzinfo/definition` within a directory in the load path.
 Applications should ensure that untrusted files are not placed in a
 directory on the load path. As a workaround, the time zone identifier can
 be validated before passing to `TZInfo::Timezone.get` by ensuring it
 matches the regular expression
 `\A[A-Za-z0-9+\-_]+(?:\/[A-Za-z0-9+\-_]+)*\z`.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H [7.5 HIGH]
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]


Patches_ruby-tzinfo:
upstream_ruby-tzinfo: needs-triage
trusty_ruby-tzinfo: ignored (end of standard support)
xenial_ruby-tzinfo: ignored (end of standard support)
esm-apps/xenial_ruby-tzinfo: needs-triage
bionic_ruby-tzinfo: ignored (end of standard support, was needs-triage)
esm-apps/bionic_ruby-tzinfo: needs-triage
focal_ruby-tzinfo: ignored (end of standard support, was needs-triage)
esm-apps/focal_ruby-tzinfo: needs-triage
jammy_ruby-tzinfo: needs-triage
esm-apps/jammy_ruby-tzinfo: needs-triage
kinetic_ruby-tzinfo: ignored (end of life, was needs-triage)
lunar_ruby-tzinfo: ignored (end of life, was needs-triage)
mantic_ruby-tzinfo: ignored (end of life, was needs-triage)
noble_ruby-tzinfo: needs-triage
esm-apps/noble_ruby-tzinfo: needs-triage
oracular_ruby-tzinfo: needs-triage
plucky_ruby-tzinfo: needs-triage
devel_ruby-tzinfo: needs-triage
