PublicDateAtUSN: 2023-02-04 20:15:00 UTC
Candidate: CVE-2023-25193
PublicDate: 2023-02-04 20:15:00 UTC
References:
 https://github.com/harfbuzz/harfbuzz/blob/2822b589bc837fae6f66233e2cf2eef0f6ce8470/src/hb-ot-layout-gsubgpos.hh
 https://chromium.googlesource.com/chromium/src/+/e1f324aa681af54101c1f2d173d92adb80e37088/DEPS#361
 https://github.com/harfbuzz/harfbuzz/commit/85be877925ddbf34f74a1229f3ca1716bb6170dc (reverted)
 https://ubuntu.com/security/notices/USN-6263-1
 https://ubuntu.com/security/notices/USN-6272-1
 https://www.cve.org/CVERecord?id=CVE-2023-25193
Description:
 hb-ot-layout-gsubgpos.hh in HarfBuzz through 6.0.0 allows attackers to
 trigger O(n^2) growth via consecutive marks during the process of looking
 back for base glyphs when attaching marks.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> commit 85be877925ddbf34f74a1229f3ca1716bb6170dc that was
  claimed to fix the issue, got reverted in commit
  661050b4659ee490dfe622821bc7fde7d1c40510, there are comments on the first
  discussing possible regressions. Instead, the commits listed in the
  patches section seems to properly fix the issue.
 rodrigo-zaiden> for commit 30b84faba, _infos_set_glyph_flags() can be
  found as _unsafe_to_break_set_mask() for versios prior to 3.3.0, down to
  version 1.5.0, where the later was added.
 rodrigo-zaiden> GPOS lookups (src/OT/Layout/GPOS) moved to the current
  code baseline in version 4.4.1, before it, some of the methods can be
  found in src/hb-ot-layout-gsubgpos.hh.
 rodrigo-zaiden> releases prior to bionic does not have any of the code
  being fixed. bionic itself could be patched with some of the commits, but
  not all. a careful check seems necessary to evaluate if really possible
  to fix it.
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1030612
Priority: low
Discovered-by:
Assigned-to: mdeslaur(main)
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_harfbuzz:
 upstream: https://github.com/harfbuzz/harfbuzz/commit/8708b9e081192786c027bb7f5f23d76dbe5c19e8
 upstream: https://github.com/harfbuzz/harfbuzz/commit/30b84faba7811bed1b7c9828afd719f20e0086da
 upstream: https://github.com/harfbuzz/harfbuzz/commit/1930760bc2c2b4185a772e38b6ecc174a95a47b2
 upstream: https://github.com/harfbuzz/harfbuzz/commit/64fa5cd482d0be2e215998aa1c2a05b978133e7c
upstream_harfbuzz: released (7.0.0)
trusty_harfbuzz: ignored (end of standard support)
trusty/esm_harfbuzz: not-affected (code not present)
esm-infra-legacy/trusty_harfbuzz: not-affected (code not present)
xenial_harfbuzz: ignored (end of standard support)
esm-infra/xenial_harfbuzz: not-affected (code not present)
bionic_harfbuzz: ignored (end of standard support, was needs-triage)
esm-infra/bionic_harfbuzz: needs-triage
focal_harfbuzz: needed
jammy_harfbuzz: needed
kinetic_harfbuzz: ignored (end of life, was needed)
lunar_harfbuzz: ignored (end of life, was needed)
mantic_harfbuzz: ignored (end of life, was needed)
noble_harfbuzz: not-affected (8.3.0-2build2)
oracular_harfbuzz: not-affected (8.3.0-2build2)
devel_harfbuzz: not-affected (8.3.0-2build2)

Patches_openjdk:
upstream_openjdk: needs-triage
trusty_openjdk: ignored (end of standard support)
xenial_openjdk: ignored (end of standard support)
bionic_openjdk: ignored (end of standard support)
focal_openjdk: DNE
jammy_openjdk: DNE
lunar_openjdk: DNE
mantic_openjdk: DNE
noble_openjdk: DNE
oracular_openjdk: DNE
devel_openjdk: DNE

Patches_openjdk-8:
upstream_openjdk-8: needs-triage
trusty_openjdk-8: DNE
xenial_openjdk-8: ignored (end of standard support)
esm-infra/xenial_openjdk-8: not-affected (code not present)
bionic_openjdk-8: ignored (end of standard support)
esm-apps/bionic_openjdk-8: not-affected (code not present)
focal_openjdk-8: not-affected (code not present)
esm-apps/focal_openjdk-8: not-affected (code not present)
jammy_openjdk-8: not-affected (code not present)
esm-apps/jammy_openjdk-8: not-affected (code not present)
lunar_openjdk-8: not-affected (code not present)
mantic_openjdk-8: not-affected (code not present)
noble_openjdk-8: not-affected (code not present)
esm-apps/noble_openjdk-8: not-affected (code not present)
oracular_openjdk-8: not-affected (code not present)
devel_openjdk-8: not-affected (code not present)

Patches_openjdk-9:
upstream_openjdk-9: needs-triage
trusty_openjdk-9: DNE
xenial_openjdk-9: ignored (end of standard support)
esm-apps/xenial_openjdk-9: ignored (no longer supported by upstream)
bionic_openjdk-9: DNE
focal_openjdk-9: DNE
jammy_openjdk-9: DNE
lunar_openjdk-9: DNE
mantic_openjdk-9: DNE
noble_openjdk-9: DNE
oracular_openjdk-9: DNE
devel_openjdk-9: DNE

Patches_openjdk-lts:
upstream_openjdk-lts: needs-triage
trusty_openjdk-lts: DNE
xenial_openjdk-lts: DNE
bionic_openjdk-lts: ignored (end of standard support)
esm-infra/bionic_openjdk-lts: released (11.0.20+8-1ubuntu1~18.04)
focal_openjdk-lts: released (11.0.20+8-1ubuntu1~20.04)
jammy_openjdk-lts: released (11.0.20+8-1ubuntu1~22.04)
lunar_openjdk-lts: released (11.0.20+8-1ubuntu1~23.04)
mantic_openjdk-lts: released (11.0.20+8-1ubuntu1)
noble_openjdk-lts: released (11.0.20+8-1ubuntu1)
esm-apps/noble_openjdk-lts: not-affected (11.0.20+8-1ubuntu1)
oracular_openjdk-lts: released (11.0.20+8-1ubuntu1)
devel_openjdk-lts: released (11.0.20+8-1ubuntu1)

Patches_openjdk-13:
upstream_openjdk-13: needs-triage
trusty_openjdk-13: DNE
xenial_openjdk-13: DNE
bionic_openjdk-13: DNE
focal_openjdk-13: ignored (superseded by openjdk-17)
esm-apps/focal_openjdk-13: ignored (superseded by openjdk-17)
jammy_openjdk-13: DNE
lunar_openjdk-13: DNE
mantic_openjdk-13: DNE
noble_openjdk-13: DNE
oracular_openjdk-13: DNE
devel_openjdk-13: DNE

Patches_openjdk-16:
upstream_openjdk-16: needs-triage
trusty_openjdk-16: DNE
xenial_openjdk-16: DNE
bionic_openjdk-16: DNE
focal_openjdk-16: ignored (superseded by openjdk-17)
esm-apps/focal_openjdk-16: ignored (superseded by openjdk-17)
jammy_openjdk-16: DNE
lunar_openjdk-16: DNE
mantic_openjdk-16: DNE
noble_openjdk-16: DNE
oracular_openjdk-16: DNE
devel_openjdk-16: DNE

Patches_openjdk-17:
upstream_openjdk-17: needs-triage
trusty_openjdk-17: DNE
xenial_openjdk-17: DNE
bionic_openjdk-17: ignored (end of standard support)
esm-apps/bionic_openjdk-17: released (17.0.8+7-1~18.04)
focal_openjdk-17: released (17.0.8+7-1~20.04.2)
jammy_openjdk-17: released (17.0.8+7-1~22.04)
esm-apps/jammy_openjdk-17: not-affected (17.0.8+7-1~22.04)
lunar_openjdk-17: released (17.0.8+7-1~23.04)
mantic_openjdk-17: not-affected (17.0.8+7-1)
noble_openjdk-17: not-affected (17.0.8+7-1)
oracular_openjdk-17: not-affected (17.0.8+7-1)
devel_openjdk-17: not-affected (17.0.8+7-1)

Patches_openjdk-18:
upstream_openjdk-18: needs-triage
trusty_openjdk-18: DNE
xenial_openjdk-18: DNE
bionic_openjdk-18: DNE
focal_openjdk-18: DNE
jammy_openjdk-18: ignored (superseded by openjdk-19)
esm-apps/jammy_openjdk-18: ignored (superseded by openjdk-19)
lunar_openjdk-18: ignored (superseded by openjdk-19)
mantic_openjdk-18: DNE
noble_openjdk-18: DNE
oracular_openjdk-18: DNE
devel_openjdk-18: DNE

Patches_openjdk-19:
upstream_openjdk-19: needs-triage
trusty_openjdk-19: DNE
xenial_openjdk-19: DNE
bionic_openjdk-19: DNE
focal_openjdk-19: DNE
jammy_openjdk-19: ignored (no longer supported by upstream)
lunar_openjdk-19: ignored (superseded by openjdk-20)
mantic_openjdk-19: ignored (end of life, was ignored [superseded by openjdk-20])
noble_openjdk-19: DNE
oracular_openjdk-19: DNE
devel_openjdk-19: DNE

Patches_openjdk-20:
upstream_openjdk-20: needs-triage
trusty_openjdk-20: DNE
xenial_openjdk-20: DNE
bionic_openjdk-20: DNE
focal_openjdk-20: DNE
jammy_openjdk-20: DNE
lunar_openjdk-20: released (20.0.2+9+ds1-0ubuntu1~23.04)
mantic_openjdk-20: not-affected (20.0.2+9-1)
noble_openjdk-20: DNE
oracular_openjdk-20: DNE
devel_openjdk-20: DNE

Patches_openjdk-21:
upstream_openjdk-21: released (21-ga)
trusty_openjdk-21: DNE
xenial_openjdk-21: DNE
bionic_openjdk-21: DNE
focal_openjdk-21: released (21.0.1+12-2~20.04)
jammy_openjdk-21: released (21.0.1+12-2~22.04)
lunar_openjdk-21: released (21.0.1+12-2~23.04)
mantic_openjdk-21: not-affected (21+35-1)
noble_openjdk-21: not-affected (21+35-1)
oracular_openjdk-21: not-affected (21+35-1)
devel_openjdk-21: not-affected (21+35-1)

Patches_openjdk-22:
upstream_openjdk-22: needs-triage
trusty_openjdk-22: DNE
xenial_openjdk-22: DNE
bionic_openjdk-22: DNE
focal_openjdk-22: DNE
jammy_openjdk-22: DNE
lunar_openjdk-22: DNE
mantic_openjdk-22: not-affected
oracular_openjdk-22: needs-triage
devel_openjdk-22: DNE
