Candidate: CVE-2022-21682
PublicDate: 2022-01-13 21:15:00 UTC
References:
 https://github.com/flatpak/flatpak/security/advisories/GHSA-8ch7-5j3h-g4fx
 https://www.cve.org/CVERecord?id=CVE-2022-21682
Description:
 Flatpak is a Linux application sandboxing and distribution framework. A
 path traversal vulnerability affects versions of Flatpak prior to 1.12.3
 and 1.10.6. flatpak-builder applies `finish-args` last in the build. At
 this point the build directory will have the full access that is specified
 in the manifest, so running `flatpak build` against it will gain those
 permissions. Normally this will not be done, so this is not problem.
 However, if `--mirror-screenshots-url` is specified, then flatpak-builder
 will launch `flatpak build --nofilesystem=host appstream-utils
 mirror-screenshots` after finalization, which can lead to issues even with
 the `--nofilesystem=host` protection. In normal use, the only issue is that
 these empty directories can be created wherever the user has write
 permissions. However, a malicious application could replace the
 `appstream-util` binary and potentially do something more hostile. This has
 been resolved in Flatpak 1.12.3 and 1.10.6 by changing the behaviour of
 `--nofilesystem=home` and `--nofilesystem=host`.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/flatpak/+bug/1957716
Priority: low
Discovered-by:
Assigned-to: alexmurray
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N [7.7 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N [6.5 MEDIUM]


Patches_flatpak:
 upstream: https://github.com/flatpak/flatpak/commit/445bddeee657fdc8d2a0a1f0de12975400d4fc1a
 upstream: https://github.com/flatpak/flatpak/commit/4d11f77aa7fd3e64cfa80af89d92567ab9e8e6fa
upstream_flatpak: released (1.12.3-1)
trusty_flatpak: ignored (end of standard support)
xenial_flatpak: ignored (end of standard support)
bionic_flatpak: ignored (end of standard support, was needs-triage)
esm-apps/bionic_flatpak: needs-triage
focal_flatpak: ignored (end of standard support, was needs-triage)
esm-infra/focal_flatpak: DNE (focal was needs-triage)
esm-apps/focal_flatpak: needs-triage
hirsute_flatpak: ignored (end of life)
impish_flatpak: ignored (end of life)
jammy_flatpak: needs-triage
esm-apps/jammy_flatpak: needs-triage
kinetic_flatpak: ignored (end of life, was needs-triage)
lunar_flatpak: not-affected (1.14.0-2)
mantic_flatpak: not-affected (1.14.0-2)
noble_flatpak: not-affected (1.14.0-2)
esm-apps/noble_flatpak: not-affected (1.14.0-2)
oracular_flatpak: not-affected (1.14.0-2)
plucky_flatpak: not-affected (1.14.0-2)
devel_flatpak: not-affected (1.14.0-2)
