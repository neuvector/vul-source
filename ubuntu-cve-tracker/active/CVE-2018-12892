Candidate: CVE-2018-12892
PublicDate: 2018-07-02 17:29:00 UTC
References:
 https://xenbits.xen.org/xsa/advisory-266.html
 https://www.cve.org/CVERecord?id=CVE-2018-12892
Description:
 An issue was discovered in Xen 4.7 through 4.10.x. libxl fails to pass the
 readonly flag to qemu when setting up a SCSI disk, due to what was probably
 an erroneous merge conflict resolution. Malicious guest administrators or
 (in some situations) users may be able to write to supposedly read-only
 disk images. Only emulated SCSI disks (specified as "sd" in the libxl disk
 configuration, or an equivalent) are affected. IDE disks ("hd") are not
 affected (because attempts to make them readonly are rejected).
 Additionally, CDROM devices (that is, devices specified to be presented to
 the guest as CDROMs, regardless of the nature of the backing storage on the
 host) are not affected; they are always read only. Only systems using
 qemu-xen (rather than qemu-xen-traditional) as the device model version are
 vulnerable. Only systems using libxl or libxl-based toolstacks are
 vulnerable. (This includes xl, and libvirt with the libxl driver.) The
 vulnerability is present in Xen versions 4.7 and later. (In earlier
 versions, provided that the patch for XSA-142 has been applied, attempts to
 create read only disks are rejected.) If the host and guest together
 usually support PVHVM, the issue is exploitable only if the malicious guest
 administrator has control of the guest kernel or guest kernel command line.
Ubuntu-Description:
Notes:
 mdeslaur> hypervisor packages are in universe. For
 mdeslaur> issues in the hypervisor, add appropriate
 mdeslaur> tags to each section, ex:
 mdeslaur> Tags_xen: universe-binary
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H [9.9 CRITICAL]

Patches_xen:
Tags_xen: universe-binary
upstream_xen: released (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
precise/esm_xen: DNE
trusty_xen: ignored (end of standard support)
trusty/esm_xen: DNE (trusty was needs-triage)
esm-infra-legacy/trusty_xen: DNE (trusty/esm was DNE [trusty was needs-triage])
xenial_xen: not-affected (code not present)
esm-infra/xenial_xen: not-affected (code not present)
artful_xen: ignored (end of life)
bionic_xen: ignored (end of standard support, was needed)
esm-infra/bionic_xen: needed
cosmic_xen: ignored (end of life)
disco_xen: ignored (end of life)
eoan_xen: ignored (end of life)
focal_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
esm-apps/focal_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
groovy_xen: ignored (end of life)
hirsute_xen: ignored (end of life)
impish_xen: ignored (end of life)
jammy_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
esm-apps/jammy_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
kinetic_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
lunar_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
mantic_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
noble_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
esm-apps/noble_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
oracular_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
plucky_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
questing_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)
devel_xen: not-affected (4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9)

