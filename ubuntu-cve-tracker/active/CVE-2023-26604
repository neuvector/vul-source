Candidate: CVE-2023-26604
PublicDate: 2023-03-03 16:15:00 UTC
References:
 https://medium.com/@zenmoviefornotification/saidov-maxim-cve-2023-26604-c1232a526ba7
 https://github.com/systemd/systemd/blob/main/NEWS#L4335-L4340
 https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-2-insecure-functionality/
 https://www.cve.org/CVERecord?id=CVE-2023-26604
Description:
 systemd before 247 does not adequately block local privilege escalation for
 some Sudo configurations, e.g., plausible sudoers files in which the
 "systemctl status" command may be executed. Specifically, systemd does not
 set LESSSECURE to 1, and thus other programs may be launched from the less
 program. This presents a substantial security risk when running systemctl
 from Sudo, because less executes as root when the terminal size is too
 small to show the complete systemctl output.
Ubuntu-Description:
Notes:
 rodrigo-zaiden> on https://github.com/systemd/systemd/issues/5666
  upstream claims this is not a vulnerability.
 rodrigo-zaiden> upstream feature SYSTEMD_PAGERSECURE implemented
  in systemd version 247.
 mdeslaur> This is only an issue if an administrator configured systemctl
 mdeslaur> access using sudo instead of using policykit, which is an
 mdeslaur> unlikely scenario. Per Red Hat bug, systemctl commands that use
 mdeslaur> the pager can run unprivileged. Setting priority to "low".
Mitigation:
Bugs:
 https://github.com/systemd/systemd/issues/5666
 https://bugzilla.redhat.com/show_bug.cgi?id=2175611
Priority: low
Discovered-by: Steve Hay
Assigned-to:
CVSS:
 cisa-adp: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]

Patches_systemd:
 upstream: https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0
 upstream: https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108
 upstream: https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c
upstream_systemd: needs-triage
trusty_systemd: ignored (end of standard support)
trusty/esm_systemd: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_systemd: needs-triage
xenial_systemd: ignored (end of standard support)
esm-infra/xenial_systemd: needs-triage
bionic_systemd: ignored (end of standard support, was needed)
esm-infra/bionic_systemd: needed
focal_systemd: ignored (end of standard support, was needed)
esm-infra/focal_systemd: needed
jammy_systemd: not-affected (249.11-0ubuntu3.6)
kinetic_systemd: not-affected (251.4-1ubuntu7)
lunar_systemd: not-affected (252.4-1ubuntu1)
mantic_systemd: not-affected (252.4-1ubuntu1)
noble_systemd: not-affected (252.4-1ubuntu1)
oracular_systemd: not-affected (252.4-1ubuntu1)
plucky_systemd: not-affected (252.4-1ubuntu1)
questing_systemd: not-affected (252.4-1ubuntu1)
devel_systemd: not-affected (252.4-1ubuntu1)
