Candidate: CVE-2022-32209
PublicDate: 2022-06-24 15:15:00 UTC
References:
 https://hackerone.com/reports/1530898
 https://discuss.rubyonrails.org/t/cve-2022-32209-possible-xss-vulnerability-in-rails-sanitizer/80800
 https://github.com/rails/rails-html-sanitizer/commit/45a5c10fed3d9aa141594c80afa06d748fa0967d (v1.4.3)
 https://www.cve.org/CVERecord?id=CVE-2022-32209
Description:
 # Possible XSS Vulnerability in Rails::Html::SanitizerThere is a possible
 XSS vulnerability with certain configurations of
 Rails::Html::Sanitizer.This vulnerability has been assigned the CVE
 identifier CVE-2022-32209.Versions Affected: ALLNot affected: NONEFixed
 Versions: v1.4.3## ImpactA possible XSS vulnerability with certain
 configurations of Rails::Html::Sanitizer may allow an attacker to inject
 content if the application developer has overridden the sanitizer's allowed
 tags to allow both `select` and `style` elements.Code is only impacted if
 allowed tags are being overridden. This may be done via application
 configuration:```ruby# In
 config/application.rbconfig.action_view.sanitized_allowed_tags = ["select",
 "style"]```see
 https://guides.rubyonrails.org/configuring.html#configuring-action-viewOr
 it may be done with a `:tags` option to the Action View helper
 `sanitize`:```<%= sanitize @comment.body, tags: ["select", "style"]
 %>```see
 https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-sanitizeOr
 it may be done with Rails::Html::SafeListSanitizer directly:```ruby#
 class-level optionRails::Html::SafeListSanitizer.allowed_tags = ["select",
 "style"]```or```ruby# instance-level
 optionRails::Html::SafeListSanitizer.new.sanitize(@article.body, tags:
 ["select", "style"])```All users overriding the allowed tags by any of the
 above mechanisms to include both "select" and "style" should either upgrade
 or use one of the workarounds immediately.## ReleasesThe FIXED releases are
 available at the normal locations.## WorkaroundsRemove either `select` or
 `style` from the overridden allowed tags.## CreditsThis vulnerability was
 responsibly reported by
 [windshock](https://hackerone.com/windshock?type=user).
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1013806
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N [6.1 MEDIUM]


Patches_ruby-rails-html-sanitizer:
 upstream: https://github.com/rails/rails-html-sanitizer/commit/45a5c10fed3d9aa141594c80afa06d748fa0967d
upstream_ruby-rails-html-sanitizer: released (1.4.3)
trusty_ruby-rails-html-sanitizer: DNE
xenial_ruby-rails-html-sanitizer: ignored (end of standard support, was needs-triage)
esm-apps/xenial_ruby-rails-html-sanitizer: needs-triage
bionic_ruby-rails-html-sanitizer: ignored (end of standard support, was needs-triage)
esm-apps/bionic_ruby-rails-html-sanitizer: needs-triage
focal_ruby-rails-html-sanitizer: ignored (end of standard support, was needs-triage)
esm-apps/focal_ruby-rails-html-sanitizer: needs-triage
impish_ruby-rails-html-sanitizer: ignored (end of life)
jammy_ruby-rails-html-sanitizer: needs-triage
esm-apps/jammy_ruby-rails-html-sanitizer: needs-triage
kinetic_ruby-rails-html-sanitizer: ignored (end of life, was needs-triage)
lunar_ruby-rails-html-sanitizer: ignored (end of life, was needs-triage)
mantic_ruby-rails-html-sanitizer: not-affected (1.4.4-1)
noble_ruby-rails-html-sanitizer: not-affected (1.4.4-1)
esm-apps/noble_ruby-rails-html-sanitizer: not-affected (1.4.4-1)
oracular_ruby-rails-html-sanitizer: not-affected (1.4.4-1)
plucky_ruby-rails-html-sanitizer: not-affected (1.4.4-1)
devel_ruby-rails-html-sanitizer: not-affected (1.4.4-1)
