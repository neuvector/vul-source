PublicDateAtUSN: 2023-01-25
Candidate: CVE-2022-3094
PublicDate: 2023-01-26 21:15:00 UTC
CRD: 2023-01-25
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3094
 https://kb.isc.org/docs/cve-2022-3094
 https://ubuntu.com/security/notices/USN-5827-1
Description:
 Sending a flood of dynamic DNS updates may cause `named` to allocate large
 amounts of memory. This, in turn, may cause `named` to exit due to a lack
 of free memory. We are not aware of any cases where this has been
 exploited. Memory is allocated prior to the checking of access permissions
 (ACLs) and is retained during the processing of a dynamic update from a
 client whose access credentials are accepted. Memory allocated to clients
 that are not permitted to send updates is released immediately upon
 rejection. The scope of this vulnerability is limited therefore to trusted
 clients who are permitted to make dynamic zone changes. If a dynamic update
 is REFUSED, memory will be released again very quickly. Therefore it is
 only likely to be possible to degrade or stop `named` by sending a flood of
 unaccepted dynamic updates comparable in magnitude to a query flood
 intended to achieve the same detrimental outcome. BIND 9.11 and earlier
 branches are also affected, but through exhaustion of internal resources
 rather than memory constraints. This may reduce performance but should not
 be a significant problem for most servers. Therefore we don't intend to
 address this for BIND versions prior to BIND 9.16. This issue affects BIND
 9 versions 9.16.0 through 9.16.36, 9.18.0 through 9.18.10, 9.19.0 through
 9.19.8, and 9.16.8-S1 through 9.16.36-S1.
Ubuntu-Description:
Notes:
 alexmurray> As of isc-dhcp-4.4.3-1, isc-dhcp vendors bind9 libs
 mdeslaur> bind 9.11 and earlier will exhaust internal resources before
 mdeslaur> exhausting memory constraints so this CVE is not a significant
 mdeslaur> issue in 9.11 and earlier and will not be fixed by upstream or
 mdeslaur> by Ubuntu.
Mitigation:
Bugs:
Priority: medium
Discovered-by: Rob Schulhof
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_bind9:
upstream_bind9: released (9.16.37,9.18.11,9.19.9)
trusty_bind9: ignored (out of standard support)
trusty/esm_bind9: not-affected
xenial_bind9: ignored (out of standard support)
esm-infra/xenial_bind9: not-affected
bionic_bind9: not-affected
focal_bind9: released (1:9.16.1-0ubuntu2.12)
jammy_bind9: released (1:9.18.1-1ubuntu1.3)
kinetic_bind9: released (1:9.18.4-2ubuntu2.1)
devel_bind9: pending (1:9.18.11-2ubuntu1)

Patches_isc-dhcp:
upstream_isc-dhcp: needs-triage
trusty_isc-dhcp: not-affected (code not present)
trusty/esm_isc-dhcp: not-affected (code not present)
xenial_isc-dhcp: not-affected (code not present)
esm-infra/xenial_isc-dhcp: not-affected (code not present)
bionic_isc-dhcp: not-affected (code not present)
focal_isc-dhcp: not-affected (code not present)
jammy_isc-dhcp: not-affected (code not present)
kinetic_isc-dhcp: not-affected (4.4.3-2ubuntu4)
devel_isc-dhcp: not-affected (4.4.3-P1-1ubuntu1)
