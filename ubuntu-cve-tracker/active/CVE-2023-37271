PublicDateAtUSN: 2023-07-11 18:15:00 UTC
Candidate: CVE-2023-37271
PublicDate: 2023-07-11 18:15:00 UTC
References:
 https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh
 https://github.com/zopefoundation/RestrictedPython/commit/c8eca66ae49081f0016d2e1f094c3d72095ef531
 https://www.cve.org/CVERecord?id=CVE-2023-37271
 https://ubuntu.com/security/notices/USN-7355-1
Description:
 RestrictedPython is a tool that helps to define a subset of the Python
 language which allows users to provide a program input into a trusted
 environment. RestrictedPython does not check access to stack frames and
 their attributes. Stack frames are accessible within at least generators
 and generator expressions, which are allowed inside RestrictedPython. Prior
 to versions 6.1 and 5.3, an attacker with access to a RestrictedPython
 environment can write code that gets the current stack frame in a generator
 and then walk the stack all the way beyond the RestrictedPython invocation
 boundary, thus breaking out of the restricted sandbox and potentially
 allowing arbitrary code execution in the Python interpreter. All
 RestrictedPython deployments that allow untrusted users to write Python
 code in the RestrictedPython environment are at risk. In terms of Zope and
 Plone, this would mean deployments where the administrator allows untrusted
 users to create and/or edit objects of type `Script (Python)`, `DTML
 Method`, `DTML Document` or `Zope Page Template`. This is a non-default
 configuration and likely to be extremely rare. The problem has been fixed
 in versions 6.1 and 5.3.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L [8.4 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H [9.9 CRITICAL]

Patches_restrictedpython:
upstream_restrictedpython: released (7.0)
trusty_restrictedpython: ignored (end of standard support)
xenial_restrictedpython: ignored (end of standard support)
esm-apps/xenial_restrictedpython: not-affected (code not present)
bionic_restrictedpython: ignored (end of standard support)
esm-apps/bionic_restrictedpython: not-affected (code not present)
focal_restrictedpython: ignored (end of standard support, was needed)
esm-apps/focal_restrictedpython: released (4.0~b3-2ubuntu0.1~esm1)
jammy_restrictedpython: needed
esm-apps/jammy_restrictedpython: released (4.0~b3-3ubuntu0.1~esm1)
kinetic_restrictedpython: ignored (end of life, was needs-triage)
lunar_restrictedpython: ignored (end of life, was needs-triage)
mantic_restrictedpython: ignored (end of life, was needs-triage)
noble_restrictedpython: not-affected (6.2-1)
esm-apps/noble_restrictedpython: not-affected (6.2-1)
oracular_restrictedpython: not-affected (6.2-1)
plucky_restrictedpython: not-affected (8.0-1)
devel_restrictedpython: not-affected (8.0-1)
