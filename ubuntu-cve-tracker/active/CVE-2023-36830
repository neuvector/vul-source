Candidate: CVE-2023-36830
PublicDate: 2023-07-06 16:15:00 UTC
References:
 https://github.com/sqlfluff/sqlfluff/security/advisories/GHSA-jqhc-m2j3-fjrx
 https://github.com/sqlfluff/sqlfluff/releases/tag/2.1.2
 https://www.cve.org/CVERecord?id=CVE-2023-36830
Description:
 SQLFluff is a SQL linter. Prior to version 2.1.2, in environments where
 untrusted users have access to the config files, there is a potential
 security vulnerability where those users could use the `library_path`
 config value to allow arbitrary python code to be executed via macros. For
 many users who use SQLFluff in the context of an environment where all
 users already have fairly escalated privileges, this may not be an issue -
 however in larger user bases, or where SQLFluff is bundled into another
 tool where developers still wish to give users access to supply their on
 rule configuration, this may be an issue. The 2.1.2 release offers the
 ability for the `library_path` argument to be overwritten on the command
 line by using the `--library-path` option. This overrides any values
 provided in the config files and effectively prevents this route of attack
 for users which have access to the config file, but not to the scripts
 which call the SQLFluff CLI directly. A similar option is provided for the
 Python API, where users also have a greater ability to further customise or
 override configuration as necessary. Unless `library_path` is explicitly
 required, SQLFluff maintainers recommend using the option `--library-path
 none` when invoking SQLFluff which will disable the `library-path` option
 entirely regardless of the options set in the configuration file or via
 inline config directives. As a workaround, limiting access to - or
 otherwise validating configuration files before they are ingested by
 SQLFluff will provides a similar effect and does not require upgrade.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L [6.3 MEDIUM]
 nvd: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]

Patches_sqlfluff:
upstream_sqlfluff: needs-triage
trusty_sqlfluff: ignored (end of standard support)
xenial_sqlfluff: ignored (end of standard support)
bionic_sqlfluff: ignored (end of standard support)
focal_sqlfluff: DNE
jammy_sqlfluff: DNE
kinetic_sqlfluff: DNE
lunar_sqlfluff: ignored (end of life, was needs-triage)
mantic_sqlfluff: ignored (end of life, was needs-triage)
noble_sqlfluff: needs-triage
esm-apps/noble_sqlfluff: needs-triage
oracular_sqlfluff: needs-triage
plucky_sqlfluff: needs-triage
devel_sqlfluff: needs-triage
