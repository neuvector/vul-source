Candidate: CVE-2021-39134
PublicDate: 2021-08-31 17:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39134
 https://github.com/npm/arborist/security/advisories/GHSA-2h3h-q99f-3fhc
 https://www.npmjs.com/package/@npmcli/arborist
Description:
 `@npmcli/arborist`, the library that calculates dependency trees and
 manages the `node_modules` folder hierarchy for the npm command line
 interface, aims to guarantee that package dependency contracts will be met,
 and the extraction of package contents will always be performed into the
 expected folder. This is, in part, accomplished by resolving dependency
 specifiers defined in `package.json` manifests for dependencies with a
 specific name, and nesting folders to resolve conflicting dependencies.
 When multiple dependencies differ only in the case of their name,
 Arborist's internal data structure saw them as separate items that could
 coexist within the same level in the `node_modules` hierarchy. However, on
 case-insensitive file systems (such as macOS and Windows), this is not the
 case. Combined with a symlink dependency such as `file:/some/path`, this
 allowed an attacker to create a situation in which arbitrary contents could
 be written to any location on the filesystem. For example, a package
 `pwn-a` could define a dependency in their `package.json` file such as
 `"foo": "file:/some/path"`. Another package, `pwn-b` could define a
 dependency such as `FOO: "file:foo.tgz"`. On case-insensitive file systems,
 if `pwn-a` was installed, and then `pwn-b` was installed afterwards, the
 contents of `foo.tgz` would be written to `/some/path`, and any existing
 contents of `/some/path` would be removed. Anyone using npm v7.20.6 or
 earlier on a case-insensitive filesystem is potentially affected. This is
 patched in @npmcli/arborist 2.8.2 which is included in npm v7.20.7 and
 above.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=993407
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H [7.8 HIGH]


Patches_npm:
upstream_npm: needs-triage
trusty_npm: ignored (out of standard support)
trusty/esm_npm: needs-triage
xenial_npm: ignored (out of standard support)
esm-apps/xenial_npm: needs-triage
bionic_npm: needs-triage
esm-apps/bionic_npm: needs-triage
focal_npm: needs-triage
esm-apps/focal_npm: needs-triage
hirsute_npm: ignored (reached end-of-life)
impish_npm: ignored (reached end-of-life)
jammy_npm: needs-triage
esm-apps/jammy_npm: needs-triage
kinetic_npm: needs-triage
lunar_npm: needs-triage
devel_npm: needs-triage
