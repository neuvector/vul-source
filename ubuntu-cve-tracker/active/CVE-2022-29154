PublicDateAtUSN: 2022-08-02 15:15:00 UTC
Candidate: CVE-2022-29154
PublicDate: 2022-08-02 15:15:00 UTC
References: 
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29154
 https://download.samba.org/pub/rsync/NEWS
 https://lists.samba.org/archive/rsync/2022-August/032860.html
 https://ubuntu.com/security/notices/USN-5921-1
Description:
 An issue was discovered in rsync before 3.2.5 that allows malicious remote
 servers to write arbitrary files inside the directories of connecting
 peers. The server chooses which files/directories are sent to the client.
 However, the rsync client performs insufficient validation of file names. A
 malicious rsync server (or Man-in-The-Middle attacker) can overwrite
 arbitrary files in the rsync client target directory and subdirectories
 (for example, overwrite the .ssh/authorized_keys file).
Ubuntu-Description: 
Notes: 
 mdeslaur> two additional commits were added later on...need to check if
 mdeslaur> more go in before the official release
 rodrigo-zaiden> Another commit was found to be part of the collection for
 rodrigo-zaiden> this CVE. 4 in total seems to address it. The missing commit
 rodrigo-zaiden> was added in historical order in the Patches section here.
 mdeslaur> many more commits were added into 3.2.5 than what is listed below
 mdeslaur> 3.2.5 introduced regressions which were fixed in 3.2.6 and 3.2.7
Mitigation: 
Bugs: 
 https://github.com/WayneD/rsync/issues/356 (regression bug)
 https://github.com/WayneD/rsync/issues/350 (regression bug)
 https://github.com/WayneD/rsync/issues/360 (regression bug)
Priority: medium
Discovered-by: Koen van Hove
Assigned-to: mdeslaur
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:H [7.4 HIGH]


Patches_rsync:
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=6b8db0f6440b28d26ef807d17517715c47e62bd9 (bp)
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=635d8c0632fa9549441ed468ff2cc167800f7fab (bp)
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=71090b7e2caefb5894c10b02d34e2c57e4de848b (bp)
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=b7231c7d02cfb65d291af74ff66e7d8c507ee871
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=7e5424b806e8eea053016268ad186276e9083b77
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=3d7015afa223494e3318495c2f5de9cb49229da9
 upstream: https://git.samba.org/?p=rsync.git;a=commit;h=2f7c583143bc6e80902139c23d9d7283f88fbc6a
 vendor: https://git.centos.org/rpms/rsync/blob/c7/f/SOURCES/rsync-3.1.2-cve-2022-29154.patch (3.1.2)
 vendor: https://git.centos.org/rpms/rsync/blob/c7/f/SOURCES/rsync-3.1.2-filtering-rules.patch (3.1.2 reg)
 vendor: https://git.centos.org/rpms/rsync/blob/c8/f/SOURCES/rsync-3.1.3-cve-2022-29154.patch (3.1.3)
 vendor: https://git.centos.org/rpms/rsync/blob/c8/f/SOURCES/rsync-3.1.3-filtering-rules.patch (3.1.3 reg)
upstream_rsync: released (3.2.5)
trusty_rsync: ignored (out of standard support)
trusty/esm_rsync: ignored (change too intrusive)
xenial_rsync: ignored (out of standard support)
esm-infra/xenial_rsync: ignored (change too intrusive)
bionic_rsync: released (3.1.2-2.1ubuntu1.6)
focal_rsync: released (3.1.3-8ubuntu0.5)
jammy_rsync: released (3.2.7-0ubuntu0.22.04.2)
kinetic_rsync: not-affected (3.2.5)
devel_rsync: not-affected (3.2.5)
