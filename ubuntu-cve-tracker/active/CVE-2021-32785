Candidate: CVE-2021-32785
PublicDate: 2021-07-22 22:15:00 UTC
References:
 https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-55r8-6w97-xxr4
 https://github.com/zmartzone/mod_auth_openidc/commit/dc672688dc1f2db7df8ad4abebc367116017a449 (v2.4.9)
 https://github.com/zmartzone/mod_auth_openidc/commit/dc672688dc1f2db7df8ad4abebc367116017a449
 https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9
 https://www.cve.org/CVERecord?id=CVE-2021-32785
Description:
 mod_auth_openidc is an authentication/authorization module for the Apache
 2.x HTTP server that functions as an OpenID Connect Relying Party,
 authenticating users against an OpenID Connect Provider. When
 mod_auth_openidc versions prior to 2.4.9 are configured to use an
 unencrypted Redis cache (`OIDCCacheEncrypt off`, `OIDCSessionType
 server-cache`, `OIDCCacheType redis`), `mod_auth_openidc` wrongly performed
 argument interpolation before passing Redis requests to `hiredis`, which
 would perform it again and lead to an uncontrolled format string bug.
 Initial assessment shows that this bug does not appear to allow gaining
 arbitrary code execution, but can reliably provoke a denial of service by
 repeatedly crashing the Apache workers. This bug has been corrected in
 version 2.4.9 by performing argument interpolation only once, using the
 `hiredis` API. As a workaround, this vulnerability can be mitigated by
 setting `OIDCCacheEncrypt` to `on`, as cache keys are cryptographically
 hashed before use when this option is enabled.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L [5.3 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]


Patches_libapache2-mod-auth-openidc:
upstream_libapache2-mod-auth-openidc: released (2.4.9-1)
trusty_libapache2-mod-auth-openidc: ignored (end of standard support)
trusty/esm_libapache2-mod-auth-openidc: DNE
esm-infra-legacy/trusty_libapache2-mod-auth-openidc: DNE
xenial_libapache2-mod-auth-openidc: ignored (end of standard support)
esm-apps/xenial_libapache2-mod-auth-openidc: not-affected (code not present)
bionic_libapache2-mod-auth-openidc: ignored (end of standard support, was needed)
esm-apps/bionic_libapache2-mod-auth-openidc: needed
focal_libapache2-mod-auth-openidc: ignored (end of standard support, was needed)
esm-apps/focal_libapache2-mod-auth-openidc: needed
hirsute_libapache2-mod-auth-openidc: ignored (end of life)
impish_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
jammy_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
esm-apps/jammy_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
kinetic_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
lunar_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
mantic_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
noble_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
esm-apps/noble_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
oracular_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
plucky_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
questing_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
devel_libapache2-mod-auth-openidc: not-affected (2.4.9-1)
