Candidate: CVE-2025-64076
PublicDate: 2025-11-18 18:16:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-64076
 https://github.com/agronholm/cbor2/pull/265
 https://github.com/agronholm/cbor2/commit/2349197bea8ebd1bf57a68f4a6549d8fd7585e66 (5.7.1)
 https://github.com/agronholm/cbor2/commit/851473490281f82d82560b2368284ef33cf6e8f9
Description:
 Multiple vulnerabilities exist in cbor2 through version 5.7.0 in the
 decode_definite_long_string() function of the C extension decoder
 (source/decoder.c): (1) Integer Underflow Leading to Out-of-Bounds Read
 (CWE-191, CWE-125): An incorrect variable reference and missing state reset
 in the chunk processing loop causes buffer_length to not be reset to zero
 after UTF-8 character consumption. This results in subsequent chunk_length
 calculations producing negative values (e.g., chunk_length = 65536 -
 buffer_length), which are passed as signed integers to the read() method,
 potentially triggering unlimited read operations and resource exhaustion.
 (2) Memory Leak via Missing Reference Count Release (CWE-401): The main
 processing loop fails to release Python object references (Py_DECREF) for
 chunk objects allocated in each iteration. For CBOR strings longer than
 65536 bytes, this causes cumulative memory leaks proportional to the
 payload size, enabling memory exhaustion attacks through repeated
 processing of large CBOR payloads. Both vulnerabilities can be exploited
 remotely without authentication by sending specially-crafted CBOR data
 containing definite-length text strings with multi-byte UTF-8 characters
 positioned at 65536-byte chunk boundaries. Successful exploitation results
 in denial of service through process crashes (CBORDecodeEOF exceptions) or
 memory exhaustion. The vulnerabilities affect all applications using
 cbor2's C extension to process untrusted CBOR data, including web APIs, IoT
 data collectors, and message queue processors. Fixed in commit
 851473490281f82d82560b2368284ef33cf6e8f9 pushed with released version
 5.7.1.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 https://github.com/agronholm/cbor2/issues/264
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 mitre: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_cbor2:
 upstream: https://github.com/agronholm/cbor2/commit/2349197bea8ebd1bf57a68f4a6549d8fd7585e66
upstream_cbor2: released (5.7.1-1)
jammy_cbor2: needs-triage
esm-apps/jammy_cbor2: needs-triage
noble_cbor2: needs-triage
esm-apps/noble_cbor2: needs-triage
plucky_cbor2: ignored (end of life, was needs-triage)
questing_cbor2: needs-triage
devel_cbor2: not-affected (5.7.1-1)
