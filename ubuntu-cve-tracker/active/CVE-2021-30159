Candidate: CVE-2021-30159
PublicDate: 2021-04-09 07:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-30159
 https://phabricator.wikimedia.org/T272386
 https://lists.wikimedia.org/pipermail/wikitech-l/2021-April/094418.html
 https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/49ce7dd2143d01cffd4dfd2f2af79b2b93672eac%5E%21/
Description:
 An issue was discovered in MediaWiki before 1.31.12 and 1.32.x through
 1.35.x before 1.35.2. Users can bypass intended restrictions on deleting
 pages in certain "fast double move" situations.
 MovePage::isValidMoveTarget() uses FOR UPDATE, but it's only called if
 Title::getArticleID() returns non-zero with no special flags. Next,
 MovePage::moveToInternal() will delete the page if
 getArticleID(READ_LATEST) is non-zero. Therefore, if the page is missing in
 the replica DB, isValidMove() will return true, and then moveToInternal()
 will unconditionally delete the page if it can be found in the master.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N [4.3 MEDIUM]


Patches_mediawiki:
upstream_mediawiki: released (1:1.35.2-1)
precise/esm_mediawiki: DNE
trusty_mediawiki: ignored (out of standard support)
trusty/esm_mediawiki: DNE
xenial_mediawiki: DNE
bionic_mediawiki: not-affected (code not present)
esm-apps/bionic_mediawiki: not-affected (code not present)
focal_mediawiki: needed
esm-apps/focal_mediawiki: needed
groovy_mediawiki: ignored (reached end-of-life)
hirsute_mediawiki: ignored (reached end-of-life)
impish_mediawiki: ignored (reached end-of-life)
jammy_mediawiki: needed
esm-apps/jammy_mediawiki: needed
kinetic_mediawiki: needed
lunar_mediawiki: needed
devel_mediawiki: needed
