PublicDateAtUSN: 2021-04-27 21:15:00 UTC
Candidate: CVE-2021-29472
PublicDate: 2021-04-27 21:15:00 UTC
References:
 https://github.com/composer/composer/security/advisories/GHSA-h5h8-pc6h-jvvx
 https://github.com/composer/composer/commit/083b73515d1d72bc61c6374440b3f8a37531f8cf
 https://getcomposer.org/
 https://ubuntu.com/security/notices/USN-5220-1
 https://www.cve.org/CVERecord?id=CVE-2021-29472
Description:
 Composer is a dependency manager for PHP. URLs for Mercurial repositories
 in the root composer.json and package source download URLs are not
 sanitized correctly. Specifically crafted URL values allow code to be
 executed in the HgDriver if hg/Mercurial is installed on the system. The
 impact to Composer users directly is limited as the composer.json file is
 typically under their own control and source download URLs can only be
 supplied by third party Composer repositories they explicitly trust to
 download and execute source code from, e.g. Composer plugins. The main
 impact is to services passing user input to Composer, including
 Packagist.org and Private Packagist. This allowed users to trigger remote
 code execution. The vulnerability has been patched on Packagist.org and
 Private Packagist within 12h of receiving the initial vulnerability report
 and based on a review of logs, to the best of our knowledge, was not abused
 by anyone. Other services/tools using VcsRepository/VcsDriver or
 derivatives may also be vulnerable and should upgrade their
 composer/composer dependency immediately. Versions 1.10.22 and 2.0.13
 include patches for this issue.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]


Patches_composer:
upstream_composer: released (2.0.9-2)
precise/esm_composer: DNE
trusty_composer: ignored (end of standard support)
trusty/esm_composer: DNE
esm-infra-legacy/trusty_composer: DNE
xenial_composer: ignored (end of standard support, was needs-triage)
esm-apps/xenial_composer: released (1.0.0~beta2-1ubuntu0.1~esm1)
bionic_composer: ignored (end of standard support, was needs-triage)
esm-apps/bionic_composer: released (1.6.3-1ubuntu0.1~esm1)
focal_composer: needed
esm-apps/focal_composer: released (1.10.1-1ubuntu0.1~esm1)
groovy_composer: ignored (end of life)
hirsute_composer: ignored (end of life)
impish_composer: not-affected (2.0.9-2)
jammy_composer: not-affected (2.0.9-2)
esm-apps/jammy_composer: not-affected (2.0.9-2)
kinetic_composer: not-affected (2.0.9-2)
lunar_composer: not-affected (2.0.9-2)
mantic_composer: not-affected (2.0.9-2)
noble_composer: not-affected (2.0.9-2)
esm-apps/noble_composer: not-affected (2.0.9-2)
oracular_composer: not-affected (2.0.9-2)
plucky_composer: not-affected (2.0.9-2)
devel_composer: not-affected (2.0.9-2)
