Candidate: CVE-2024-40627
PublicDate: 2024-07-15 20:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-40627
 https://github.com/busykoala/fastapi-opa/security/advisories/GHSA-5f5c-8rvc-j8wf
 https://github.com/busykoala/fastapi-opa/commit/9588109ff651f7ffc92687129c4956126443fb8c
 https://github.com/busykoala/fastapi-opa/blob/6dd6f8c87e908fe080784a74707f016f1422b58a/fastapi_opa/opa/opa_middleware.py#L79-L80
Description:
 Fastapi OPA is an opensource fastapi middleware which includes auth flow.
 HTTP `OPTIONS` requests are always allowed by `OpaMiddleware`, even when
 they lack authentication, and are passed through directly to the
 application. `OpaMiddleware` allows all HTTP `OPTIONS` requests without
 evaluating it against any policy. If an application provides different
 responses to HTTP `OPTIONS` requests based on an entity existing (such as
 to indicate whether an entity is writable on a system level), an
 unauthenticated attacker could discover which entities exist within an
 application. This issue has been addressed in release version 2.0.1. All
 users are advised to upgrade. There are no known workarounds for this
 vulnerability.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N [5.8 MEDIUM]

Patches_fastapi:
upstream_fastapi: needs-triage
focal_fastapi: DNE
esm-infra/focal_fastapi: DNE
jammy_fastapi: needs-triage
esm-apps/jammy_fastapi: needs-triage
noble_fastapi: needs-triage
esm-apps/noble_fastapi: needs-triage
oracular_fastapi: ignored (end of life, was needs-triage)
plucky_fastapi: needs-triage
questing_fastapi: needs-triage
devel_fastapi: needs-triage
