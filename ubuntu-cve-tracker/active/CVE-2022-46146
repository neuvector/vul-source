Candidate: CVE-2022-46146
PublicDate: 2022-11-29 14:15:00 UTC
References:
 https://www.openwall.com/lists/oss-security/2022/11/29/1
 https://github.com/prometheus/exporter-toolkit/security/advisories/GHSA-7rg2-cxvp-9p7p
 https://github.com/prometheus/exporter-toolkit/commit/5b1eab34484ddd353986bce736cd119d863e4ff5 (v0.8.2)
 https://github.com/prometheus/exporter-toolkit/commit/5b1eab34484ddd353986bce736cd119d863e4ff5
 http://www.openwall.com/lists/oss-security/2022/11/29/1
 http://www.openwall.com/lists/oss-security/2022/11/29/2
 http://www.openwall.com/lists/oss-security/2022/11/29/4
 https://www.cve.org/CVERecord?id=CVE-2022-46146
Description:
 Prometheus Exporter Toolkit is a utility package to build exporters. Prior
 to versions 0.7.2 and 0.8.2, if someone has access to a Prometheus web.yml
 file and users' bcrypted passwords, they can bypass security by poisoning
 the built-in authentication cache. Versions 0.7.2 and 0.8.2 contain a fix
 for the issue. There is no workaround, but attacker must have access to the
 hashed password to use this functionality.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1025127
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N [6.2 MEDIUM]
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]

Patches_golang-github-prometheus-exporter-toolkit:
upstream_golang-github-prometheus-exporter-toolkit: released (0.8.2-1)
trusty_golang-github-prometheus-exporter-toolkit: ignored (end of standard support)
xenial_golang-github-prometheus-exporter-toolkit: ignored (end of standard support)
bionic_golang-github-prometheus-exporter-toolkit: DNE
focal_golang-github-prometheus-exporter-toolkit: DNE
esm-infra/focal_golang-github-prometheus-exporter-toolkit: DNE
jammy_golang-github-prometheus-exporter-toolkit: needs-triage
esm-apps/jammy_golang-github-prometheus-exporter-toolkit: needs-triage
kinetic_golang-github-prometheus-exporter-toolkit: ignored (end of life, was needs-triage)
lunar_golang-github-prometheus-exporter-toolkit: ignored (end of life, was needs-triage)
mantic_golang-github-prometheus-exporter-toolkit: not-affected (0.8.2-2)
noble_golang-github-prometheus-exporter-toolkit: not-affected (0.8.2-2)
esm-apps/noble_golang-github-prometheus-exporter-toolkit: not-affected (0.8.2-2)
oracular_golang-github-prometheus-exporter-toolkit: not-affected (0.8.2-2)
plucky_golang-github-prometheus-exporter-toolkit: not-affected (0.8.2-2)
devel_golang-github-prometheus-exporter-toolkit: not-affected (0.8.2-2)

Patches_prometheus:
upstream_prometheus: needs-triage
trusty_prometheus: ignored (end of standard support)
xenial_prometheus: ignored (end of standard support)
esm-apps/xenial_prometheus: needs-triage
bionic_prometheus: ignored (end of standard support, was needs-triage)
esm-apps/bionic_prometheus: needs-triage
focal_prometheus: ignored (end of standard support, was needs-triage)
esm-infra/focal_prometheus: DNE (focal was needs-triage)
esm-apps/focal_prometheus: needs-triage
jammy_prometheus: needs-triage
esm-apps/jammy_prometheus: needs-triage
kinetic_prometheus: ignored (end of life, was needs-triage)
lunar_prometheus: ignored (end of life, was needs-triage)
mantic_prometheus: ignored (end of life, was needs-triage)
noble_prometheus: needs-triage
esm-apps/noble_prometheus: needs-triage
oracular_prometheus: needs-triage
plucky_prometheus: needs-triage
devel_prometheus: needs-triage
