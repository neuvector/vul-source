Candidate: CVE-2024-53858
PublicDate: 2024-11-27 22:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-53858
 https://github.com/cli/cli/security/advisories/GHSA-jwcm-9g39-pmcw
 https://git-scm.com/docs/gitcredentials
Description:
 The gh cli is GitHubâ€™s official command line tool. A security vulnerability
 has been identified in the GitHub CLI that could leak authentication tokens
 when cloning repositories containing `git` submodules hosted outside of
 GitHub.com and ghe.com. This vulnerability stems from several `gh` commands
 used to clone a repository with submodules from a non-GitHub host including
 `gh repo clone`, `gh repo fork`, and `gh pr checkout`. These GitHub CLI
 commands invoke git with instructions to retrieve authentication tokens
 using the `credential.helper` configuration variable for any host
 encountered. Prior to version `2.63.0`, hosts other than GitHub.com and
 ghe.com are treated as GitHub Enterprise Server hosts and have tokens
 sourced from the following environment variables before falling back to
 host-specific tokens stored within system-specific secured storage: 1.
 `GITHUB_ENTERPRISE_TOKEN`, 2. `GH_ENTERPRISE_TOKEN` and 3. `GITHUB_TOKEN`
 when the `CODESPACES` environment variable is set. The result being `git`
 sending authentication tokens when cloning submodules. In version `2.63.0`,
 these GitHub CLI commands will limit the hosts for which `gh` acts as a
 credential helper to source authentication tokens. Additionally,
 `GITHUB_TOKEN` will only be used for GitHub.com and ghe.com. Users are
 advised to upgrade. Additionally users are advised to revoke authentication
 tokens used with the GitHub CLI and to review their personal security log
 and any relevant audit logs for actions associated with their account or
 enterprise
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:

Patches_gh:
upstream_gh: needs-triage
focal_gh: DNE
jammy_gh: needs-triage
esm-apps/jammy_gh: needs-triage
noble_gh: needs-triage
esm-apps/noble_gh: needs-triage
oracular_gh: needs-triage
plucky_gh: needs-triage
devel_gh: needs-triage
