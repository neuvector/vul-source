PublicDateAtUSN: 2022-03-24 20:15:00 UTC
Candidate: CVE-2022-24769
PublicDate: 2022-03-24 20:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24769
 https://github.com/containerd/containerd/security/advisories/GHSA-c9cp-9c75-9v8c
 https://github.com/moby/moby/security/advisories/GHSA-2mm7-x5h6-5pvq
 https://github.com/moby/moby/releases/tag/v20.10.14
 https://ubuntu.com/security/notices/USN-5776-1
Description:
 Moby is an open-source project created by Docker to enable and accelerate
 software containerization. A bug was found in Moby (Docker Engine) prior to
 version 20.10.14 where containers were incorrectly started with non-empty
 inheritable Linux process capabilities, creating an atypical Linux
 environment and enabling programs with inheritable file capabilities to
 elevate those capabilities to the permitted set during `execve(2)`.
 Normally, when executable programs have specified permitted file
 capabilities, otherwise unprivileged users and processes can execute those
 programs and gain the specified file capabilities up to the bounding set.
 Due to this bug, containers which included executable programs with
 inheritable file capabilities allowed otherwise unprivileged users and
 processes to additionally gain these inheritable file capabilities up to
 the container's bounding set. Containers which use Linux users and groups
 to perform privilege separation inside the container are most directly
 impacted. This bug did not affect the container security sandbox as the
 inheritable set never contained more capabilities than were included in the
 container's bounding set. This bug has been fixed in Moby (Docker Engine)
 20.10.14. Running containers should be stopped, deleted, and recreated for
 the inheritable capabilities to be reset. This fix changes Moby (Docker
 Engine) behavior such that containers are started with a more typical Linux
 environment. As a workaround, the entry point of a container can be
 modified to use a utility like `capsh(1)` to drop inheritable capabilities
 prior to the primary process starting.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to: litios
CVSS:
 nvd: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L [5.9 MEDIUM]


Patches_containerd:
 upstream: https://github.com/moby/moby/commit/2bbc786e4c59761d722d2d1518cd0a32829bc07f
upstream_containerd: released (1.6.2~ds1-1,1.5.11)
trusty_containerd: ignored (out of standard support)
xenial_containerd: ignored (out of standard support)
esm-apps/xenial_containerd: needed
bionic_containerd: released (1.5.9-0ubuntu1~18.04.2)
esm-apps/bionic_containerd: released (1.5.9-0ubuntu1~18.04.2)
focal_containerd: released (1.5.9-0ubuntu1~20.04.6)
impish_containerd: ignored (reached end-of-life)
jammy_containerd: released (1.5.9-0ubuntu3.1)
kinetic_containerd: released (1.6.4-0ubuntu1)
lunar_containerd: not-affected (1.6.4-0ubuntu1)
devel_containerd: not-affected (1.6.4-0ubuntu1)
