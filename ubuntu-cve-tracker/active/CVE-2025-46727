PublicDateAtUSN: 2025-05-08
Candidate: CVE-2025-46727
PublicDate: 2025-05-07 23:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2025-46727
 https://github.com/rack/rack/commit/2bb5263b464b65ba4b648996a579dbd180d2b712
 https://github.com/rack/rack/commit/3f5a4249118d09d199fe480466c8c6717e43b6e3
 https://github.com/rack/rack/commit/cd6b70a1f2a1016b73dc906f924869f4902c2d74
 https://github.com/rack/rack/security/advisories/GHSA-gjh7-p2fx-99vx
 https://ubuntu.com/security/notices/USN-7507-1
Description:
 Rack is a modular Ruby web server interface. Prior to versions 2.2.14,
 3.0.16, and 3.1.14, `Rack::QueryParser` parses query strings and
 `application/x-www-form-urlencoded` bodies into Ruby data structures
 without imposing any limit on the number of parameters, allowing attackers
 to send requests with extremely large numbers of parameters. The
 vulnerability arises because `Rack::QueryParser` iterates over each
 `&`-separated key-value pair and adds it to a Hash without enforcing an
 upper bound on the total number of parameters. This allows an attacker to
 send a single request containing hundreds of thousands (or more) of
 parameters, which consumes excessive memory and CPU during parsing. An
 attacker can trigger denial of service by sending specifically crafted HTTP
 requests, which can cause memory exhaustion or pin CPU resources, stalling
 or crashing the Rack server. This results in full service disruption until
 the affected worker is restarted. Versions 2.2.14, 3.0.16, and 3.1.14 fix
 the issue. Some other mitigations are available. One may use middleware to
 enforce a maximum query string size or parameter count, or employ a reverse
 proxy (such as Nginx) to limit request sizes and reject oversized query
 strings or bodies. Limiting request body sizes and query string lengths at
 the web server or CDN level is an effective mitigation.
Ubuntu-Description:
Notes:
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]

Patches_ruby-rack:
upstream_ruby-rack: needs-triage
esm-infra-legacy/trusty_ruby-rack: ignored (changes too intrusive)
esm-apps/xenial_ruby-rack: ignored (changes too intrusive)
esm-apps/bionic_ruby-rack: ignored (changes too intrusive)
focal_ruby-rack: ignored (end of standard support, was needed)
esm-infra/focal_ruby-rack: DNE (focal was needed)
esm-apps/focal_ruby-rack: released (2.0.7-2ubuntu0.1+esm7)
jammy_ruby-rack: needed
esm-apps/jammy_ruby-rack: released (2.1.4-5ubuntu1.1+esm2)
noble_ruby-rack: released (2.2.7-1ubuntu0.3)
oracular_ruby-rack: released (2.2.7-1.1ubuntu0.2)
plucky_ruby-rack: released (2.2.7-1.1ubuntu0.25.04.1)
devel_ruby-rack: needed
