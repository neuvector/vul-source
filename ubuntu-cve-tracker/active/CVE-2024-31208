PublicDateAtUSN: 2024-04-23 18:15:00 UTC
Candidate: CVE-2024-31208
PublicDate: 2024-04-23 18:15:00 UTC
References:
 https://www.cve.org/CVERecord?id=CVE-2024-31208
 https://github.com/element-hq/synapse/security/advisories/GHSA-3h7q-rfh9-xm4v
 https://github.com/element-hq/synapse/commit/55b0aa847a61774b6a3acdc4b177a20dc019f01a
 https://github.com/element-hq/synapse/releases/tag/v1.105.1
 https://ubuntu.com/security/notices/USN-7444-1
Description:
 Synapse is an open-source Matrix homeserver. A remote Matrix user with
 malicious intent, sharing a room with Synapse instances before 1.105.1, can
 dispatch specially crafted events to exploit a weakness in the V2 state
 resolution algorithm. This can induce high CPU consumption and accumulate
 excessive data in the database of such instances, resulting in a denial of
 service. Servers in private federations, or those that do not federate, are
 not affected. Server administrators should upgrade to 1.105.1 or later.
 Some workarounds are available. One can ban the malicious users or ACL
 block servers from the rooms and/or leave the room and purge the room using
 the admin API.
Ubuntu-Description:
Notes:
 john-breton> matrix-synapse versions < 1.53.0-1 have major changes
 john-breton> that prevent a patch from being feasibly applied for
 john-breton> for this CVE.
 john-breton> Noble and oracular are FTBFS for matrix-synapse and
 john-breton> will be ignored due to the infeasibility of providing
 john-breton> fixes for the releases.
Mitigation:
Bugs:
Priority: medium
Discovered-by: Alexey Shchepin
Assigned-to:
CVSS:
 github: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H [6.5 MEDIUM]

Patches_matrix-synapse:
upstream_matrix-synapse: released (1.105.1)
esm-apps/bionic_matrix-synapse: ignored (patch infeasible)
focal_matrix-synapse: ignored (end of standard support, was ignored [patch infeasible])
esm-apps/focal_matrix-synapse: ignored (patch infeasible)
jammy_matrix-synapse: needed
esm-apps/jammy_matrix-synapse: released (1.53.0-1ubuntu0.1~esm2)
mantic_matrix-synapse: ignored (end of life, was needs-triage)
noble_matrix-synapse: ignored (fix infeasible)
esm-apps/noble_matrix-synapse: ignored (fix infeasible)
oracular_matrix-synapse: ignored (fix infeasible)

Patches_synapse:
upstream_synapse: needs-triage
esm-apps/xenial_synapse: needs-triage
esm-apps/bionic_synapse: needs-triage
focal_synapse: ignored (end of standard support, was needs-triage)
esm-apps/focal_synapse: needs-triage
jammy_synapse: needs-triage
esm-apps/jammy_synapse: needs-triage
mantic_synapse: ignored (end of life, was needs-triage)
noble_synapse: needs-triage
esm-apps/noble_synapse: needs-triage
oracular_synapse: needs-triage
plucky_synapse: needs-triage
devel_synapse: needs-triage
