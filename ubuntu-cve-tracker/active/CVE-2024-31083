PublicDateAtUSN: 2024-03-04 00:00:00 UTC
Candidate: CVE-2024-31083
PublicDate: 2024-04-05 12:15:00 UTC
CRD: 2024-03-04 00:00:00 UTC
References:
 https://ubuntu.com/security/notices/USN-6721-1
 https://ubuntu.com/security/notices/USN-6721-2
 https://www.cve.org/CVERecord?id=CVE-2024-31083
Description:
 A use-after-free vulnerability was found in the ProcRenderAddGlyphs()
 function of Xorg servers. This issue occurs when AllocateGlyph() is called
 to store new glyphs sent by the client to the X server, potentially
 resulting in multiple entries pointing to the same non-refcounted glyphs.
 Consequently, ProcRenderAddGlyphs() may free a glyph, leading to a
 use-after-free scenario when the same glyph pointer is subsequently
 accessed. This flaw allows an authenticated attacker to execute arbitrary
 code on the system by sending a specially crafted request.
Ubuntu-Description:
Notes:
 mdeslaur> xorg server is actually the xorg-server package
 mdeslaur> the xorg package only contains docs
 mdeslaur> xwayland package contains parts of xorg-server
 leosilva> introduced prior to X11R6.7
 sbeattie> potential regression introduced from this fix in LP:#2060354
Mitigation:
Bugs:
 https://bugs.launchpad.net/ubuntu/+source/xorg-server/+bug/2060354
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 redhat: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]

Patches_xorg:
upstream_xorg: not-affected
esm-infra/xenial_xorg: not-affected (code not present)
esm-infra/bionic_xorg: not-affected (code not present)
focal_xorg: not-affected (code not present)
esm-infra/focal_xorg: not-affected (code not present)
jammy_xorg: not-affected (code not present)
mantic_xorg: not-affected (code not present)
noble_xorg: not-affected (code not present)
oracular_xorg: not-affected (code not present)
plucky_xorg: not-affected (code not present)
devel_xorg: not-affected (code not present)

Patches_xorg-server:
upstream_xorg-server: needs-triage
trusty/esm_xorg-server: released (2:1.15.1-0ubuntu2.11+esm11)
esm-infra-legacy/trusty_xorg-server: released (2:1.15.1-0ubuntu2.11+esm11)
esm-infra/xenial_xorg-server: released (2:1.18.4-0ubuntu0.12+esm13)
esm-infra/bionic_xorg-server: released (2:1.19.6-1ubuntu4.15+esm8)
focal_xorg-server: released (2:1.20.13-1ubuntu1~20.04.17)
esm-infra/focal_xorg-server: released (2:1.20.13-1ubuntu1~20.04.17)
jammy_xorg-server: released (2:21.1.4-2ubuntu1.7~22.04.10)
mantic_xorg-server: released (2:21.1.7-3ubuntu2.9)
noble_xorg-server: released (2:21.1.12-1ubuntu1)
oracular_xorg-server: released (2:21.1.12-1ubuntu1)
plucky_xorg-server: released (2:21.1.12-1ubuntu1)
devel_xorg-server: released (2:21.1.12-1ubuntu1)

Patches_xwayland:
upstream_xwayland: needs-triage
focal_xwayland: DNE
esm-infra/focal_xwayland: DNE
jammy_xwayland: released (2:22.1.1-1ubuntu0.13)
mantic_xwayland: released (2:23.2.0-1ubuntu0.6)
noble_xwayland: not-affected (2:23.2.6-1)
oracular_xwayland: not-affected (2:23.2.6-1)
plucky_xwayland: not-affected (2:23.2.6-1)
devel_xwayland: not-affected (2:23.2.6-1)

Patches_xorg-server-hwe-16.04:
upstream_xorg-server-hwe-16.04: needs-triage
esm-infra/xenial_xorg-server-hwe-16.04: needs-triage
focal_xorg-server-hwe-16.04: DNE
esm-infra/focal_xorg-server-hwe-16.04: DNE
jammy_xorg-server-hwe-16.04: DNE
mantic_xorg-server-hwe-16.04: DNE
noble_xorg-server-hwe-16.04: DNE
oracular_xorg-server-hwe-16.04: DNE
plucky_xorg-server-hwe-16.04: DNE
devel_xorg-server-hwe-16.04: DNE

Patches_xorg-server-hwe-18.04:
upstream_xorg-server-hwe-18.04: needs-triage
esm-infra/bionic_xorg-server-hwe-18.04: needs-triage
focal_xorg-server-hwe-18.04: DNE
esm-infra/focal_xorg-server-hwe-18.04: DNE
jammy_xorg-server-hwe-18.04: DNE
mantic_xorg-server-hwe-18.04: DNE
noble_xorg-server-hwe-18.04: DNE
oracular_xorg-server-hwe-18.04: DNE
plucky_xorg-server-hwe-18.04: DNE
devel_xorg-server-hwe-18.04: DNE

Patches_xorg-hwe-16.04:
upstream_xorg-hwe-16.04: not-affected
esm-infra/xenial_xorg-hwe-16.04: not-affected (code not present)
focal_xorg-hwe-16.04: DNE
esm-infra/focal_xorg-hwe-16.04: DNE
jammy_xorg-hwe-16.04: DNE
mantic_xorg-hwe-16.04: DNE
noble_xorg-hwe-16.04: DNE
oracular_xorg-hwe-16.04: DNE
plucky_xorg-hwe-16.04: DNE
devel_xorg-hwe-16.04: DNE

Patches_xorg-hwe-18.04:
upstream_xorg-hwe-18.04: not-affected
esm-infra/bionic_xorg-hwe-18.04: not-affected (code not present)
focal_xorg-hwe-18.04: DNE
esm-infra/focal_xorg-hwe-18.04: DNE
jammy_xorg-hwe-18.04: DNE
mantic_xorg-hwe-18.04: DNE
noble_xorg-hwe-18.04: DNE
oracular_xorg-hwe-18.04: DNE
plucky_xorg-hwe-18.04: DNE
devel_xorg-hwe-18.04: DNE
