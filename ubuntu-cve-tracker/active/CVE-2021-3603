PublicDateAtUSN: 2021-06-17 12:15:00 UTC
Candidate: CVE-2021-3603
PublicDate: 2021-06-17 12:15:00 UTC
References:
 https://www.huntr.dev/bounties/1-PHPMailer/PHPMailer/
 https://github.com/PHPMailer/PHPMailer/commit/45f3c18dc6a2de1cb1bf49b9b249a9ee36a5f7f3 (v6.5.0)
 https://github.com/PHPMailer/PHPMailer/commit/45f3c18dc6a2de1cb1bf49b9b249a9ee36a5f7f3
 https://ubuntu.com/security/notices/USN-5956-1
 https://www.cve.org/CVERecord?id=CVE-2021-3603
Description:
 PHPMailer 6.4.1 and earlier contain a vulnerability that can result in
 untrusted code being called (if such code is injected into the host
 project's scope by other means). If the $patternselect parameter to
 validateAddress() is set to 'php' (the default, defined by
 PHPMailer::$validator), and the global namespace contains a function called
 php, it will be called in preference to the built-in validator of the same
 name. Mitigated in PHPMailer 6.5.0 by denying the use of simple strings as
 validator function names.
Ubuntu-Description:
Notes:
 ccdm94> the vulnerable code section seems to have been introduced by commit
 ccdm94> 77c0bc8d (v.5.2.15). For this reason, bionic and earlier are not
 ccdm94> vulnerable.
Mitigation:
Bugs:
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 huntr.dev: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H [8.1 HIGH]


Patches_libphp-phpmailer:
 upstream: https://github.com/PHPMailer/PHPMailer/commit/45f3c18dc6a2de1cb1bf49b9b249a9ee36a5f7f3
upstream_libphp-phpmailer: released (6.5.0)
trusty_libphp-phpmailer: ignored (end of standard support)
trusty/esm_libphp-phpmailer: DNE
esm-infra-legacy/trusty_libphp-phpmailer: DNE
xenial_libphp-phpmailer: ignored (end of standard support, was not-affected)
esm-apps/xenial_libphp-phpmailer: not-affected (code not present)
bionic_libphp-phpmailer: not-affected (code not present)
esm-apps/bionic_libphp-phpmailer: not-affected (code not present)
focal_libphp-phpmailer: ignored (end of standard support, was needed)
esm-apps/focal_libphp-phpmailer: released (6.0.6-0.1ubuntu0.1~esm1)
groovy_libphp-phpmailer: ignored (end of life)
hirsute_libphp-phpmailer: ignored (end of life)
impish_libphp-phpmailer: ignored (end of life)
jammy_libphp-phpmailer: needed
esm-apps/jammy_libphp-phpmailer: released (6.2.0-2ubuntu0.1~esm1)
kinetic_libphp-phpmailer: not-affected (6.6.3-1)
lunar_libphp-phpmailer: not-affected (6.6.3-1)
mantic_libphp-phpmailer: not-affected (6.6.3-1)
noble_libphp-phpmailer: not-affected (6.6.3-1)
esm-apps/noble_libphp-phpmailer: not-affected (6.6.3-1)
oracular_libphp-phpmailer: not-affected (6.6.3-1)
plucky_libphp-phpmailer: not-affected (6.6.3-1)
questing_libphp-phpmailer: not-affected (6.6.3-1)
devel_libphp-phpmailer: not-affected (6.6.3-1)
