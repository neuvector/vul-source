Candidate: CVE-2022-23634
PublicDate: 2022-02-11 22:15:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23634
 https://github.com/puma/puma/security/advisories/GHSA-rmj8-8hhh-gv5h
 https://github.com/puma/puma/commit/b70f451fe8abc0cff192c065d549778452e155bb
 https://groups.google.com/g/ruby-security-ann/c/FkTM-_7zSNA/m/K2RiMJBlBAAJ?utm_medium=email&utm_source=footer&pli=1
 https://github.com/advisories/GHSA-rmj8-8hhh-gv5h
 https://github.com/advisories/GHSA-wh98-p28r-vrc9
Description:
 Puma is a Ruby/Rack web server built for parallelism. Prior to `puma`
 version `5.6.2`, `puma` may not always call `close` on the response body.
 Rails, prior to version `7.0.2.2`, depended on the response body being
 closed in order for its `CurrentAttributes` implementation to work
 correctly. The combination of these two behaviors (Puma not closing the
 body + Rails' Executor implementation) causes information leakage. This
 problem is fixed in Puma versions 5.6.2 and 4.3.11. This problem is fixed
 in Rails versions 7.02.2, 6.1.4.6, 6.0.4.6, and 5.2.6.2. Upgrading to a
 patched Rails _or_ Puma version fixes the vulnerability.
Ubuntu-Description:
Notes:
 alexmurray> focal also appears to be affected but the affected code is in
  lib/puma/server.rb
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1005391
Priority: medium
Discovered-by:
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N [5.9 MEDIUM]


Patches_puma:
 upstream: https://github.com/puma/puma/commit/b70f451fe8abc0cff192c065d549778452e155bb
upstream_puma: needs-triage
trusty_puma: ignored (end of standard support)
xenial_puma: ignored (end of standard support)
focal_puma: needed
esm-apps/focal_puma: needed
impish_puma: ignored (end of life)
jammy_puma: needed
esm-apps/jammy_puma: needed
kinetic_puma: ignored (end of life, was needed)
lunar_puma: not-affected (5.6.5-3ubuntu1)
devel_puma: not-affected (5.6.5-3ubuntu1)
