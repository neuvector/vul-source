PublicDateAtUSN: 2022-07-27
Candidate: CVE-2022-32744
CRD: 2022-07-27
PublicDate: 2022-08-25 18:15:00 UTC
References: 
 https://www.samba.org/samba/security/CVE-2022-32744.html
 https://ubuntu.com/security/notices/USN-5542-1
 https://www.cve.org/CVERecord?id=CVE-2022-32744
Description:
 A flaw was found in Samba. The KDC accepts kpasswd requests encrypted with
 any key known to it. By encrypting forged kpasswd requests with its own
 key, a user can change other users' passwords, enabling full domain
 takeover.
Ubuntu-Description: 
Notes: 
 mdeslaur> patches for this issue in the bug for CVE-2022-2031
 mdeslaur> Fixing this in Ubuntu 18.04 LTS would require substantial
 mdeslaur> code backports. We will not be fixing this issue in Ubuntu 18.04
 mdeslaur> LTS. In environments where this is of concern, we recommend
 mdeslaur> updating to a more recent Ubuntu version, or disabling kpasswd
 mdeslaur> if this is not passible.
Mitigation: 
 kpasswd is not a critical protocol for the AD DC in most installations, it
 can be disabled by setting "kpasswd port = 0" in the smb.conf.
Bugs: 
 https://bugzilla.samba.org/show_bug.cgi?id=15074
 https://bugzilla.samba.org/show_bug.cgi?id=15109 (tracking bug)
Priority: medium
Discovered-by: Joseph Sutton
Assigned-to:
CVSS:
 nvd: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]


Patches_samba:
upstream_samba: needs-triage
trusty_samba: DNE
trusty/esm_samba: ignored (end of ESM support, was needs-triage)
esm-infra-legacy/trusty_samba: needs-triage
xenial_samba: DNE
esm-infra/xenial_samba: needs-triage
bionic_samba: ignored
esm-infra/bionic_samba: ignored
focal_samba: released (2:4.13.17~dfsg-0ubuntu1.20.04.1)
esm-infra/focal_samba: released (2:4.13.17~dfsg-0ubuntu1.20.04.1)
impish_samba: ignored (end of life)
jammy_samba: released (2:4.15.9+dfsg-0ubuntu0.2)
kinetic_samba: released (2:4.16.4+dfsg-2ubuntu1)
lunar_samba: released (2:4.16.4+dfsg-2ubuntu1)
mantic_samba: released (2:4.16.4+dfsg-2ubuntu1)
noble_samba: released (2:4.16.4+dfsg-2ubuntu1)
oracular_samba: released (2:4.16.4+dfsg-2ubuntu1)
plucky_samba: released (2:4.16.4+dfsg-2ubuntu1)
devel_samba: released (2:4.16.4+dfsg-2ubuntu1)
